var Mo=Object.defineProperty;var $o=(r,t,s)=>t in r?Mo(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s;var gl=(r,t,s)=>($o(r,typeof t!="symbol"?t+"":t,s),s);import{r as m,a as Oo,g as Bo,c as xs,R as Ur}from"./react-vendor-84598de7.js";import{n as Re}from"./xrpl-vendor-22698344.js";import{V as Er}from"./charts-vendor-81c85733.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=s(n);fetch(n.href,l)}})();var vi={exports:{}},Ua={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xo=m,Uo=Symbol.for("react.element"),Wo=Symbol.for("react.fragment"),qo=Object.prototype.hasOwnProperty,Ho=Xo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Vo={key:!0,ref:!0,__self:!0,__source:!0};function yi(r,t,s){var a,n={},l=null,i=null;s!==void 0&&(l=""+s),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(i=t.ref);for(a in t)qo.call(t,a)&&!Vo.hasOwnProperty(a)&&(n[a]=t[a]);if(r&&r.defaultProps)for(a in t=r.defaultProps,t)n[a]===void 0&&(n[a]=t[a]);return{$$typeof:Uo,type:r,key:l,ref:i,props:n,_owner:Ho.current}}Ua.Fragment=Wo;Ua.jsx=yi;Ua.jsxs=yi;vi.exports=Ua;var e=vi.exports,Sn={},bl=Oo;Sn.createRoot=bl.createRoot,Sn.hydrateRoot=bl.hydrateRoot;let zo={data:""},Ko=r=>typeof window=="object"?((r?r.querySelector("#_goober"):window._goober)||Object.assign((r||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:r||zo,Go=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Jo=/\/\*[^]*?\*\/|  +/g,vl=/\n+/g,Vs=(r,t)=>{let s="",a="",n="";for(let l in r){let i=r[l];l[0]=="@"?l[1]=="i"?s=l+" "+i+";":a+=l[1]=="f"?Vs(i,l):l+"{"+Vs(i,l[1]=="k"?"":t)+"}":typeof i=="object"?a+=Vs(i,t?t.replace(/([^,])+/g,o=>l.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,o):o?o+" "+c:c)):l):i!=null&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=Vs.p?Vs.p(l,i):l+":"+i+";")}return s+(t&&n?t+"{"+n+"}":n)+a},Ms={},wi=r=>{if(typeof r=="object"){let t="";for(let s in r)t+=s+wi(r[s]);return t}return r},Yo=(r,t,s,a,n)=>{let l=wi(r),i=Ms[l]||(Ms[l]=(c=>{let d=0,u=11;for(;d<c.length;)u=101*u+c.charCodeAt(d++)>>>0;return"go"+u})(l));if(!Ms[i]){let c=l!==r?r:(d=>{let u,h,g=[{}];for(;u=Go.exec(d.replace(Jo,""));)u[4]?g.shift():u[3]?(h=u[3].replace(vl," ").trim(),g.unshift(g[0][h]=g[0][h]||{})):g[0][u[1]]=u[2].replace(vl," ").trim();return g[0]})(r);Ms[i]=Vs(n?{["@keyframes "+i]:c}:c,s?"":"."+i)}let o=s&&Ms.g?Ms.g:null;return s&&(Ms.g=Ms[i]),((c,d,u,h)=>{h?d.data=d.data.replace(h,c):d.data.indexOf(c)===-1&&(d.data=u?c+d.data:d.data+c)})(Ms[i],t,a,o),i},Qo=(r,t,s)=>r.reduce((a,n,l)=>{let i=t[l];if(i&&i.call){let o=i(s),c=o&&o.props&&o.props.className||/^go/.test(o)&&o;i=c?"."+c:o&&typeof o=="object"?o.props?"":Vs(o,""):o===!1?"":o}return a+n+(i??"")},"");function Wa(r){let t=this||{},s=r.call?r(t.p):r;return Yo(s.unshift?s.raw?Qo(s,[].slice.call(arguments,1),t.p):s.reduce((a,n)=>Object.assign(a,n&&n.call?n(t.p):n),{}):s,Ko(t.target),t.g,t.o,t.k)}let ji,Cn,Tn;Wa.bind({g:1});let Os=Wa.bind({k:1});function Zo(r,t,s,a){Vs.p=t,ji=r,Cn=s,Tn=a}function Ks(r,t){let s=this||{};return function(){let a=arguments;function n(l,i){let o=Object.assign({},l),c=o.className||n.className;s.p=Object.assign({theme:Cn&&Cn()},o),s.o=/ *go\d+/.test(c),o.className=Wa.apply(s,a)+(c?" "+c:""),t&&(o.ref=i);let d=r;return r[0]&&(d=o.as||r,delete o.as),Tn&&d[0]&&Tn(o),ji(d,o)}return t?t(n):n}}var ec=r=>typeof r=="function",Pa=(r,t)=>ec(r)?r(t):r,tc=(()=>{let r=0;return()=>(++r).toString()})(),Ni=(()=>{let r;return()=>{if(r===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");r=!t||t.matches}return r}})(),sc=20,_i=(r,t)=>{switch(t.type){case 0:return{...r,toasts:[t.toast,...r.toasts].slice(0,sc)};case 1:return{...r,toasts:r.toasts.map(l=>l.id===t.toast.id?{...l,...t.toast}:l)};case 2:let{toast:s}=t;return _i(r,{type:r.toasts.find(l=>l.id===s.id)?1:0,toast:s});case 3:let{toastId:a}=t;return{...r,toasts:r.toasts.map(l=>l.id===a||a===void 0?{...l,dismissed:!0,visible:!1}:l)};case 4:return t.toastId===void 0?{...r,toasts:[]}:{...r,toasts:r.toasts.filter(l=>l.id!==t.toastId)};case 5:return{...r,pausedAt:t.time};case 6:let n=t.time-(r.pausedAt||0);return{...r,pausedAt:void 0,toasts:r.toasts.map(l=>({...l,pauseDuration:l.pauseDuration+n}))}}},ja=[],Na={toasts:[],pausedAt:void 0},or=r=>{Na=_i(Na,r),ja.forEach(t=>{t(Na)})},rc={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},ac=(r={})=>{let[t,s]=m.useState(Na);m.useEffect(()=>(ja.push(s),()=>{let n=ja.indexOf(s);n>-1&&ja.splice(n,1)}),[t]);let a=t.toasts.map(n=>{var l,i,o;return{...r,...r[n.type],...n,removeDelay:n.removeDelay||((l=r[n.type])==null?void 0:l.removeDelay)||(r==null?void 0:r.removeDelay),duration:n.duration||((i=r[n.type])==null?void 0:i.duration)||(r==null?void 0:r.duration)||rc[n.type],style:{...r.style,...(o=r[n.type])==null?void 0:o.style,...n.style}}});return{...t,toasts:a}},nc=(r,t="blank",s)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:r,pauseDuration:0,...s,id:(s==null?void 0:s.id)||tc()}),sa=r=>(t,s)=>{let a=nc(t,r,s);return or({type:2,toast:a}),a.id},ts=(r,t)=>sa("blank")(r,t);ts.error=sa("error");ts.success=sa("success");ts.loading=sa("loading");ts.custom=sa("custom");ts.dismiss=r=>{or({type:3,toastId:r})};ts.remove=r=>or({type:4,toastId:r});ts.promise=(r,t,s)=>{let a=ts.loading(t.loading,{...s,...s==null?void 0:s.loading});return typeof r=="function"&&(r=r()),r.then(n=>{let l=t.success?Pa(t.success,n):void 0;return l?ts.success(l,{id:a,...s,...s==null?void 0:s.success}):ts.dismiss(a),n}).catch(n=>{let l=t.error?Pa(t.error,n):void 0;l?ts.error(l,{id:a,...s,...s==null?void 0:s.error}):ts.dismiss(a)}),r};var lc=(r,t)=>{or({type:1,toast:{id:r,height:t}})},ic=()=>{or({type:5,time:Date.now()})},Hr=new Map,oc=1e3,cc=(r,t=oc)=>{if(Hr.has(r))return;let s=setTimeout(()=>{Hr.delete(r),or({type:4,toastId:r})},t);Hr.set(r,s)},dc=r=>{let{toasts:t,pausedAt:s}=ac(r);m.useEffect(()=>{if(s)return;let l=Date.now(),i=t.map(o=>{if(o.duration===1/0)return;let c=(o.duration||0)+o.pauseDuration-(l-o.createdAt);if(c<0){o.visible&&ts.dismiss(o.id);return}return setTimeout(()=>ts.dismiss(o.id),c)});return()=>{i.forEach(o=>o&&clearTimeout(o))}},[t,s]);let a=m.useCallback(()=>{s&&or({type:6,time:Date.now()})},[s]),n=m.useCallback((l,i)=>{let{reverseOrder:o=!1,gutter:c=8,defaultPosition:d}=i||{},u=t.filter(y=>(y.position||d)===(l.position||d)&&y.height),h=u.findIndex(y=>y.id===l.id),g=u.filter((y,f)=>f<h&&y.visible).length;return u.filter(y=>y.visible).slice(...o?[g+1]:[0,g]).reduce((y,f)=>y+(f.height||0)+c,0)},[t]);return m.useEffect(()=>{t.forEach(l=>{if(l.dismissed)cc(l.id,l.removeDelay);else{let i=Hr.get(l.id);i&&(clearTimeout(i),Hr.delete(l.id))}})},[t]),{toasts:t,handlers:{updateHeight:lc,startPause:ic,endPause:a,calculateOffset:n}}},uc=Os`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,pc=Os`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,mc=Os`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,hc=Ks("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${uc} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${pc} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${r=>r.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${mc} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,xc=Os`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,fc=Ks("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${r=>r.secondary||"#e0e0e0"};
  border-right-color: ${r=>r.primary||"#616161"};
  animation: ${xc} 1s linear infinite;
`,gc=Os`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,bc=Os`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,vc=Ks("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${gc} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${bc} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${r=>r.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,yc=Ks("div")`
  position: absolute;
`,wc=Ks("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,jc=Os`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Nc=Ks("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${jc} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,_c=({toast:r})=>{let{icon:t,type:s,iconTheme:a}=r;return t!==void 0?typeof t=="string"?m.createElement(Nc,null,t):t:s==="blank"?null:m.createElement(wc,null,m.createElement(fc,{...a}),s!=="loading"&&m.createElement(yc,null,s==="error"?m.createElement(hc,{...a}):m.createElement(vc,{...a})))},kc=r=>`
0% {transform: translate3d(0,${r*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Sc=r=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${r*-150}%,-1px) scale(.6); opacity:0;}
`,Cc="0%{opacity:0;} 100%{opacity:1;}",Tc="0%{opacity:1;} 100%{opacity:0;}",Ec=Ks("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Pc=Ks("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Ac=(r,t)=>{let s=r.includes("top")?1:-1,[a,n]=Ni()?[Cc,Tc]:[kc(s),Sc(s)];return{animation:t?`${Os(a)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Os(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Rc=m.memo(({toast:r,position:t,style:s,children:a})=>{let n=r.height?Ac(r.position||t||"top-center",r.visible):{opacity:0},l=m.createElement(_c,{toast:r}),i=m.createElement(Pc,{...r.ariaProps},Pa(r.message,r));return m.createElement(Ec,{className:r.className,style:{...n,...s,...r.style}},typeof a=="function"?a({icon:l,message:i}):m.createElement(m.Fragment,null,l,i))});Zo(m.createElement);var Fc=({id:r,className:t,style:s,onHeightUpdate:a,children:n})=>{let l=m.useCallback(i=>{if(i){let o=()=>{let c=i.getBoundingClientRect().height;a(r,c)};o(),new MutationObserver(o).observe(i,{subtree:!0,childList:!0,characterData:!0})}},[r,a]);return m.createElement("div",{ref:l,className:t,style:s},n)},Ic=(r,t)=>{let s=r.includes("top"),a=s?{top:0}:{bottom:0},n=r.includes("center")?{justifyContent:"center"}:r.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Ni()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(s?1:-1)}px)`,...a,...n}},Lc=Wa`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,ua=16,ki=({reverseOrder:r,position:t="top-center",toastOptions:s,gutter:a,children:n,containerStyle:l,containerClassName:i})=>{let{toasts:o,handlers:c}=dc(s);return m.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:ua,left:ua,right:ua,bottom:ua,pointerEvents:"none",...l},className:i,onMouseEnter:c.startPause,onMouseLeave:c.endPause},o.map(d=>{let u=d.position||t,h=c.calculateOffset(d,{reverseOrder:r,gutter:a,defaultPosition:t}),g=Ic(u,h);return m.createElement(Fc,{id:d.id,key:d.id,onHeightUpdate:c.updateHeight,className:d.visible?Lc:"",style:g},d.type==="custom"?Pa(d.message,d):n?n(d):m.createElement(Rc,{toast:d,position:u}))}))},k=ts;function Si(r,t){return function(){return r.apply(t,arguments)}}const{toString:Dc}=Object.prototype,{getPrototypeOf:tl}=Object,qa=(r=>t=>{const s=Dc.call(t);return r[s]||(r[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),Ss=r=>(r=r.toLowerCase(),t=>qa(t)===r),Ha=r=>t=>typeof t===r,{isArray:Ar}=Array,Qr=Ha("undefined");function Mc(r){return r!==null&&!Qr(r)&&r.constructor!==null&&!Qr(r.constructor)&&cs(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const Ci=Ss("ArrayBuffer");function $c(r){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(r):t=r&&r.buffer&&Ci(r.buffer),t}const Oc=Ha("string"),cs=Ha("function"),Ti=Ha("number"),Va=r=>r!==null&&typeof r=="object",Bc=r=>r===!0||r===!1,_a=r=>{if(qa(r)!=="object")return!1;const t=tl(r);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},Xc=Ss("Date"),Uc=Ss("File"),Wc=Ss("Blob"),qc=Ss("FileList"),Hc=r=>Va(r)&&cs(r.pipe),Vc=r=>{let t;return r&&(typeof FormData=="function"&&r instanceof FormData||cs(r.append)&&((t=qa(r))==="formdata"||t==="object"&&cs(r.toString)&&r.toString()==="[object FormData]"))},zc=Ss("URLSearchParams"),[Kc,Gc,Jc,Yc]=["ReadableStream","Request","Response","Headers"].map(Ss),Qc=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ra(r,t,{allOwnKeys:s=!1}={}){if(r===null||typeof r>"u")return;let a,n;if(typeof r!="object"&&(r=[r]),Ar(r))for(a=0,n=r.length;a<n;a++)t.call(null,r[a],a,r);else{const l=s?Object.getOwnPropertyNames(r):Object.keys(r),i=l.length;let o;for(a=0;a<i;a++)o=l[a],t.call(null,r[o],o,r)}}function Ei(r,t){t=t.toLowerCase();const s=Object.keys(r);let a=s.length,n;for(;a-- >0;)if(n=s[a],t===n.toLowerCase())return n;return null}const sr=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),Pi=r=>!Qr(r)&&r!==sr;function En(){const{caseless:r}=Pi(this)&&this||{},t={},s=(a,n)=>{const l=r&&Ei(t,n)||n;_a(t[l])&&_a(a)?t[l]=En(t[l],a):_a(a)?t[l]=En({},a):Ar(a)?t[l]=a.slice():t[l]=a};for(let a=0,n=arguments.length;a<n;a++)arguments[a]&&ra(arguments[a],s);return t}const Zc=(r,t,s,{allOwnKeys:a}={})=>(ra(t,(n,l)=>{s&&cs(n)?r[l]=Si(n,s):r[l]=n},{allOwnKeys:a}),r),ed=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),td=(r,t,s,a)=>{r.prototype=Object.create(t.prototype,a),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:t.prototype}),s&&Object.assign(r.prototype,s)},sd=(r,t,s,a)=>{let n,l,i;const o={};if(t=t||{},r==null)return t;do{for(n=Object.getOwnPropertyNames(r),l=n.length;l-- >0;)i=n[l],(!a||a(i,r,t))&&!o[i]&&(t[i]=r[i],o[i]=!0);r=s!==!1&&tl(r)}while(r&&(!s||s(r,t))&&r!==Object.prototype);return t},rd=(r,t,s)=>{r=String(r),(s===void 0||s>r.length)&&(s=r.length),s-=t.length;const a=r.indexOf(t,s);return a!==-1&&a===s},ad=r=>{if(!r)return null;if(Ar(r))return r;let t=r.length;if(!Ti(t))return null;const s=new Array(t);for(;t-- >0;)s[t]=r[t];return s},nd=(r=>t=>r&&t instanceof r)(typeof Uint8Array<"u"&&tl(Uint8Array)),ld=(r,t)=>{const a=(r&&r[Symbol.iterator]).call(r);let n;for(;(n=a.next())&&!n.done;){const l=n.value;t.call(r,l[0],l[1])}},id=(r,t)=>{let s;const a=[];for(;(s=r.exec(t))!==null;)a.push(s);return a},od=Ss("HTMLFormElement"),cd=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,a,n){return a.toUpperCase()+n}),yl=(({hasOwnProperty:r})=>(t,s)=>r.call(t,s))(Object.prototype),dd=Ss("RegExp"),Ai=(r,t)=>{const s=Object.getOwnPropertyDescriptors(r),a={};ra(s,(n,l)=>{let i;(i=t(n,l,r))!==!1&&(a[l]=i||n)}),Object.defineProperties(r,a)},ud=r=>{Ai(r,(t,s)=>{if(cs(r)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const a=r[s];if(cs(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},pd=(r,t)=>{const s={},a=n=>{n.forEach(l=>{s[l]=!0})};return Ar(r)?a(r):a(String(r).split(t)),s},md=()=>{},hd=(r,t)=>r!=null&&Number.isFinite(r=+r)?r:t,ln="abcdefghijklmnopqrstuvwxyz",wl="0123456789",Ri={DIGIT:wl,ALPHA:ln,ALPHA_DIGIT:ln+ln.toUpperCase()+wl},xd=(r=16,t=Ri.ALPHA_DIGIT)=>{let s="";const{length:a}=t;for(;r--;)s+=t[Math.random()*a|0];return s};function fd(r){return!!(r&&cs(r.append)&&r[Symbol.toStringTag]==="FormData"&&r[Symbol.iterator])}const gd=r=>{const t=new Array(10),s=(a,n)=>{if(Va(a)){if(t.indexOf(a)>=0)return;if(!("toJSON"in a)){t[n]=a;const l=Ar(a)?[]:{};return ra(a,(i,o)=>{const c=s(i,n+1);!Qr(c)&&(l[o]=c)}),t[n]=void 0,l}}return a};return s(r,0)},bd=Ss("AsyncFunction"),vd=r=>r&&(Va(r)||cs(r))&&cs(r.then)&&cs(r.catch),Fi=((r,t)=>r?setImmediate:t?((s,a)=>(sr.addEventListener("message",({source:n,data:l})=>{n===sr&&l===s&&a.length&&a.shift()()},!1),n=>{a.push(n),sr.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",cs(sr.postMessage)),yd=typeof queueMicrotask<"u"?queueMicrotask.bind(sr):typeof process<"u"&&process.nextTick||Fi,we={isArray:Ar,isArrayBuffer:Ci,isBuffer:Mc,isFormData:Vc,isArrayBufferView:$c,isString:Oc,isNumber:Ti,isBoolean:Bc,isObject:Va,isPlainObject:_a,isReadableStream:Kc,isRequest:Gc,isResponse:Jc,isHeaders:Yc,isUndefined:Qr,isDate:Xc,isFile:Uc,isBlob:Wc,isRegExp:dd,isFunction:cs,isStream:Hc,isURLSearchParams:zc,isTypedArray:nd,isFileList:qc,forEach:ra,merge:En,extend:Zc,trim:Qc,stripBOM:ed,inherits:td,toFlatObject:sd,kindOf:qa,kindOfTest:Ss,endsWith:rd,toArray:ad,forEachEntry:ld,matchAll:id,isHTMLForm:od,hasOwnProperty:yl,hasOwnProp:yl,reduceDescriptors:Ai,freezeMethods:ud,toObjectSet:pd,toCamelCase:cd,noop:md,toFiniteNumber:hd,findKey:Ei,global:sr,isContextDefined:Pi,ALPHABET:Ri,generateString:xd,isSpecCompliantForm:fd,toJSONObject:gd,isAsyncFn:bd,isThenable:vd,setImmediate:Fi,asap:yd};function ft(r,t,s,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",t&&(this.code=t),s&&(this.config=s),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}we.inherits(ft,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:we.toJSONObject(this.config),code:this.code,status:this.status}}});const Ii=ft.prototype,Li={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{Li[r]={value:r}});Object.defineProperties(ft,Li);Object.defineProperty(Ii,"isAxiosError",{value:!0});ft.from=(r,t,s,a,n,l)=>{const i=Object.create(Ii);return we.toFlatObject(r,i,function(c){return c!==Error.prototype},o=>o!=="isAxiosError"),ft.call(i,r.message,t,s,a,n),i.cause=r,i.name=r.name,l&&Object.assign(i,l),i};const wd=null;function Pn(r){return we.isPlainObject(r)||we.isArray(r)}function Di(r){return we.endsWith(r,"[]")?r.slice(0,-2):r}function jl(r,t,s){return r?r.concat(t).map(function(n,l){return n=Di(n),!s&&l?"["+n+"]":n}).join(s?".":""):t}function jd(r){return we.isArray(r)&&!r.some(Pn)}const Nd=we.toFlatObject(we,{},null,function(t){return/^is[A-Z]/.test(t)});function za(r,t,s){if(!we.isObject(r))throw new TypeError("target must be an object");t=t||new FormData,s=we.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,b){return!we.isUndefined(b[w])});const a=s.metaTokens,n=s.visitor||u,l=s.dots,i=s.indexes,c=(s.Blob||typeof Blob<"u"&&Blob)&&we.isSpecCompliantForm(t);if(!we.isFunction(n))throw new TypeError("visitor must be a function");function d(f){if(f===null)return"";if(we.isDate(f))return f.toISOString();if(!c&&we.isBlob(f))throw new ft("Blob is not supported. Use a Buffer instead.");return we.isArrayBuffer(f)||we.isTypedArray(f)?c&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function u(f,w,b){let P=f;if(f&&!b&&typeof f=="object"){if(we.endsWith(w,"{}"))w=a?w:w.slice(0,-2),f=JSON.stringify(f);else if(we.isArray(f)&&jd(f)||(we.isFileList(f)||we.endsWith(w,"[]"))&&(P=we.toArray(f)))return w=Di(w),P.forEach(function(_,W){!(we.isUndefined(_)||_===null)&&t.append(i===!0?jl([w],W,l):i===null?w:w+"[]",d(_))}),!1}return Pn(f)?!0:(t.append(jl(b,w,l),d(f)),!1)}const h=[],g=Object.assign(Nd,{defaultVisitor:u,convertValue:d,isVisitable:Pn});function y(f,w){if(!we.isUndefined(f)){if(h.indexOf(f)!==-1)throw Error("Circular reference detected in "+w.join("."));h.push(f),we.forEach(f,function(P,A){(!(we.isUndefined(P)||P===null)&&n.call(t,P,we.isString(A)?A.trim():A,w,g))===!0&&y(P,w?w.concat(A):[A])}),h.pop()}}if(!we.isObject(r))throw new TypeError("data must be an object");return y(r),t}function Nl(r){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function sl(r,t){this._pairs=[],r&&za(r,this,t)}const Mi=sl.prototype;Mi.append=function(t,s){this._pairs.push([t,s])};Mi.toString=function(t){const s=t?function(a){return t.call(this,a,Nl)}:Nl;return this._pairs.map(function(n){return s(n[0])+"="+s(n[1])},"").join("&")};function _d(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function $i(r,t,s){if(!t)return r;const a=s&&s.encode||_d;we.isFunction(s)&&(s={serialize:s});const n=s&&s.serialize;let l;if(n?l=n(t,s):l=we.isURLSearchParams(t)?t.toString():new sl(t,s).toString(a),l){const i=r.indexOf("#");i!==-1&&(r=r.slice(0,i)),r+=(r.indexOf("?")===-1?"?":"&")+l}return r}class kd{constructor(){this.handlers=[]}use(t,s,a){return this.handlers.push({fulfilled:t,rejected:s,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){we.forEach(this.handlers,function(a){a!==null&&t(a)})}}const _l=kd,Oi={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Sd=typeof URLSearchParams<"u"?URLSearchParams:sl,Cd=typeof FormData<"u"?FormData:null,Td=typeof Blob<"u"?Blob:null,Ed={isBrowser:!0,classes:{URLSearchParams:Sd,FormData:Cd,Blob:Td},protocols:["http","https","file","blob","url","data"]},rl=typeof window<"u"&&typeof document<"u",An=typeof navigator=="object"&&navigator||void 0,Pd=rl&&(!An||["ReactNative","NativeScript","NS"].indexOf(An.product)<0),Ad=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),Rd=rl&&window.location.href||"http://localhost",Fd=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:rl,hasStandardBrowserEnv:Pd,hasStandardBrowserWebWorkerEnv:Ad,navigator:An,origin:Rd},Symbol.toStringTag,{value:"Module"})),es={...Fd,...Ed};function Id(r,t){return za(r,new es.classes.URLSearchParams,Object.assign({visitor:function(s,a,n,l){return es.isNode&&we.isBuffer(s)?(this.append(a,s.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)}},t))}function Ld(r){return we.matchAll(/\w+|\[(\w*)]/g,r).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Dd(r){const t={},s=Object.keys(r);let a;const n=s.length;let l;for(a=0;a<n;a++)l=s[a],t[l]=r[l];return t}function Bi(r){function t(s,a,n,l){let i=s[l++];if(i==="__proto__")return!0;const o=Number.isFinite(+i),c=l>=s.length;return i=!i&&we.isArray(n)?n.length:i,c?(we.hasOwnProp(n,i)?n[i]=[n[i],a]:n[i]=a,!o):((!n[i]||!we.isObject(n[i]))&&(n[i]=[]),t(s,a,n[i],l)&&we.isArray(n[i])&&(n[i]=Dd(n[i])),!o)}if(we.isFormData(r)&&we.isFunction(r.entries)){const s={};return we.forEachEntry(r,(a,n)=>{t(Ld(a),n,s,0)}),s}return null}function Md(r,t,s){if(we.isString(r))try{return(t||JSON.parse)(r),we.trim(r)}catch(a){if(a.name!=="SyntaxError")throw a}return(s||JSON.stringify)(r)}const al={transitional:Oi,adapter:["xhr","http","fetch"],transformRequest:[function(t,s){const a=s.getContentType()||"",n=a.indexOf("application/json")>-1,l=we.isObject(t);if(l&&we.isHTMLForm(t)&&(t=new FormData(t)),we.isFormData(t))return n?JSON.stringify(Bi(t)):t;if(we.isArrayBuffer(t)||we.isBuffer(t)||we.isStream(t)||we.isFile(t)||we.isBlob(t)||we.isReadableStream(t))return t;if(we.isArrayBufferView(t))return t.buffer;if(we.isURLSearchParams(t))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(l){if(a.indexOf("application/x-www-form-urlencoded")>-1)return Id(t,this.formSerializer).toString();if((o=we.isFileList(t))||a.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return za(o?{"files[]":t}:t,c&&new c,this.formSerializer)}}return l||n?(s.setContentType("application/json",!1),Md(t)):t}],transformResponse:[function(t){const s=this.transitional||al.transitional,a=s&&s.forcedJSONParsing,n=this.responseType==="json";if(we.isResponse(t)||we.isReadableStream(t))return t;if(t&&we.isString(t)&&(a&&!this.responseType||n)){const i=!(s&&s.silentJSONParsing)&&n;try{return JSON.parse(t)}catch(o){if(i)throw o.name==="SyntaxError"?ft.from(o,ft.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:es.classes.FormData,Blob:es.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};we.forEach(["delete","get","head","post","put","patch"],r=>{al.headers[r]={}});const nl=al,$d=we.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Od=r=>{const t={};let s,a,n;return r&&r.split(`
`).forEach(function(i){n=i.indexOf(":"),s=i.substring(0,n).trim().toLowerCase(),a=i.substring(n+1).trim(),!(!s||t[s]&&$d[s])&&(s==="set-cookie"?t[s]?t[s].push(a):t[s]=[a]:t[s]=t[s]?t[s]+", "+a:a)}),t},kl=Symbol("internals");function $r(r){return r&&String(r).trim().toLowerCase()}function ka(r){return r===!1||r==null?r:we.isArray(r)?r.map(ka):String(r)}function Bd(r){const t=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=s.exec(r);)t[a[1]]=a[2];return t}const Xd=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function on(r,t,s,a,n){if(we.isFunction(a))return a.call(this,t,s);if(n&&(t=s),!!we.isString(t)){if(we.isString(a))return t.indexOf(a)!==-1;if(we.isRegExp(a))return a.test(t)}}function Ud(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,s,a)=>s.toUpperCase()+a)}function Wd(r,t){const s=we.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(r,a+s,{value:function(n,l,i){return this[a].call(this,t,n,l,i)},configurable:!0})})}class Ka{constructor(t){t&&this.set(t)}set(t,s,a){const n=this;function l(o,c,d){const u=$r(c);if(!u)throw new Error("header name must be a non-empty string");const h=we.findKey(n,u);(!h||n[h]===void 0||d===!0||d===void 0&&n[h]!==!1)&&(n[h||c]=ka(o))}const i=(o,c)=>we.forEach(o,(d,u)=>l(d,u,c));if(we.isPlainObject(t)||t instanceof this.constructor)i(t,s);else if(we.isString(t)&&(t=t.trim())&&!Xd(t))i(Od(t),s);else if(we.isHeaders(t))for(const[o,c]of t.entries())l(c,o,a);else t!=null&&l(s,t,a);return this}get(t,s){if(t=$r(t),t){const a=we.findKey(this,t);if(a){const n=this[a];if(!s)return n;if(s===!0)return Bd(n);if(we.isFunction(s))return s.call(this,n,a);if(we.isRegExp(s))return s.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,s){if(t=$r(t),t){const a=we.findKey(this,t);return!!(a&&this[a]!==void 0&&(!s||on(this,this[a],a,s)))}return!1}delete(t,s){const a=this;let n=!1;function l(i){if(i=$r(i),i){const o=we.findKey(a,i);o&&(!s||on(a,a[o],o,s))&&(delete a[o],n=!0)}}return we.isArray(t)?t.forEach(l):l(t),n}clear(t){const s=Object.keys(this);let a=s.length,n=!1;for(;a--;){const l=s[a];(!t||on(this,this[l],l,t,!0))&&(delete this[l],n=!0)}return n}normalize(t){const s=this,a={};return we.forEach(this,(n,l)=>{const i=we.findKey(a,l);if(i){s[i]=ka(n),delete s[l];return}const o=t?Ud(l):String(l).trim();o!==l&&delete s[l],s[o]=ka(n),a[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const s=Object.create(null);return we.forEach(this,(a,n)=>{a!=null&&a!==!1&&(s[n]=t&&we.isArray(a)?a.join(", "):a)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,s])=>t+": "+s).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...s){const a=new this(t);return s.forEach(n=>a.set(n)),a}static accessor(t){const a=(this[kl]=this[kl]={accessors:{}}).accessors,n=this.prototype;function l(i){const o=$r(i);a[o]||(Wd(n,i),a[o]=!0)}return we.isArray(t)?t.forEach(l):l(t),this}}Ka.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);we.reduceDescriptors(Ka.prototype,({value:r},t)=>{let s=t[0].toUpperCase()+t.slice(1);return{get:()=>r,set(a){this[s]=a}}});we.freezeMethods(Ka);const ks=Ka;function cn(r,t){const s=this||nl,a=t||s,n=ks.from(a.headers);let l=a.data;return we.forEach(r,function(o){l=o.call(s,l,n.normalize(),t?t.status:void 0)}),n.normalize(),l}function Xi(r){return!!(r&&r.__CANCEL__)}function Rr(r,t,s){ft.call(this,r??"canceled",ft.ERR_CANCELED,t,s),this.name="CanceledError"}we.inherits(Rr,ft,{__CANCEL__:!0});function Ui(r,t,s){const a=s.config.validateStatus;!s.status||!a||a(s.status)?r(s):t(new ft("Request failed with status code "+s.status,[ft.ERR_BAD_REQUEST,ft.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function qd(r){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return t&&t[1]||""}function Hd(r,t){r=r||10;const s=new Array(r),a=new Array(r);let n=0,l=0,i;return t=t!==void 0?t:1e3,function(c){const d=Date.now(),u=a[l];i||(i=d),s[n]=c,a[n]=d;let h=l,g=0;for(;h!==n;)g+=s[h++],h=h%r;if(n=(n+1)%r,n===l&&(l=(l+1)%r),d-i<t)return;const y=u&&d-u;return y?Math.round(g*1e3/y):void 0}}function Vd(r,t){let s=0,a=1e3/t,n,l;const i=(d,u=Date.now())=>{s=u,n=null,l&&(clearTimeout(l),l=null),r.apply(null,d)};return[(...d)=>{const u=Date.now(),h=u-s;h>=a?i(d,u):(n=d,l||(l=setTimeout(()=>{l=null,i(n)},a-h)))},()=>n&&i(n)]}const Aa=(r,t,s=3)=>{let a=0;const n=Hd(50,250);return Vd(l=>{const i=l.loaded,o=l.lengthComputable?l.total:void 0,c=i-a,d=n(c),u=i<=o;a=i;const h={loaded:i,total:o,progress:o?i/o:void 0,bytes:c,rate:d||void 0,estimated:d&&o&&u?(o-i)/d:void 0,event:l,lengthComputable:o!=null,[t?"download":"upload"]:!0};r(h)},s)},Sl=(r,t)=>{const s=r!=null;return[a=>t[0]({lengthComputable:s,total:r,loaded:a}),t[1]]},Cl=r=>(...t)=>we.asap(()=>r(...t)),zd=es.hasStandardBrowserEnv?((r,t)=>s=>(s=new URL(s,es.origin),r.protocol===s.protocol&&r.host===s.host&&(t||r.port===s.port)))(new URL(es.origin),es.navigator&&/(msie|trident)/i.test(es.navigator.userAgent)):()=>!0,Kd=es.hasStandardBrowserEnv?{write(r,t,s,a,n,l){const i=[r+"="+encodeURIComponent(t)];we.isNumber(s)&&i.push("expires="+new Date(s).toGMTString()),we.isString(a)&&i.push("path="+a),we.isString(n)&&i.push("domain="+n),l===!0&&i.push("secure"),document.cookie=i.join("; ")},read(r){const t=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(r){this.write(r,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Gd(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function Jd(r,t){return t?r.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):r}function Wi(r,t){return r&&!Gd(t)?Jd(r,t):t}const Tl=r=>r instanceof ks?{...r}:r;function nr(r,t){t=t||{};const s={};function a(d,u,h,g){return we.isPlainObject(d)&&we.isPlainObject(u)?we.merge.call({caseless:g},d,u):we.isPlainObject(u)?we.merge({},u):we.isArray(u)?u.slice():u}function n(d,u,h,g){if(we.isUndefined(u)){if(!we.isUndefined(d))return a(void 0,d,h,g)}else return a(d,u,h,g)}function l(d,u){if(!we.isUndefined(u))return a(void 0,u)}function i(d,u){if(we.isUndefined(u)){if(!we.isUndefined(d))return a(void 0,d)}else return a(void 0,u)}function o(d,u,h){if(h in t)return a(d,u);if(h in r)return a(void 0,d)}const c={url:l,method:l,data:l,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:o,headers:(d,u,h)=>n(Tl(d),Tl(u),h,!0)};return we.forEach(Object.keys(Object.assign({},r,t)),function(u){const h=c[u]||n,g=h(r[u],t[u],u);we.isUndefined(g)&&h!==o||(s[u]=g)}),s}const qi=r=>{const t=nr({},r);let{data:s,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:l,headers:i,auth:o}=t;t.headers=i=ks.from(i),t.url=$i(Wi(t.baseURL,t.url),r.params,r.paramsSerializer),o&&i.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let c;if(we.isFormData(s)){if(es.hasStandardBrowserEnv||es.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((c=i.getContentType())!==!1){const[d,...u]=c?c.split(";").map(h=>h.trim()).filter(Boolean):[];i.setContentType([d||"multipart/form-data",...u].join("; "))}}if(es.hasStandardBrowserEnv&&(a&&we.isFunction(a)&&(a=a(t)),a||a!==!1&&zd(t.url))){const d=n&&l&&Kd.read(l);d&&i.set(n,d)}return t},Yd=typeof XMLHttpRequest<"u",Qd=Yd&&function(r){return new Promise(function(s,a){const n=qi(r);let l=n.data;const i=ks.from(n.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:d}=n,u,h,g,y,f;function w(){y&&y(),f&&f(),n.cancelToken&&n.cancelToken.unsubscribe(u),n.signal&&n.signal.removeEventListener("abort",u)}let b=new XMLHttpRequest;b.open(n.method.toUpperCase(),n.url,!0),b.timeout=n.timeout;function P(){if(!b)return;const _=ks.from("getAllResponseHeaders"in b&&b.getAllResponseHeaders()),D={data:!o||o==="text"||o==="json"?b.responseText:b.response,status:b.status,statusText:b.statusText,headers:_,config:r,request:b};Ui(function(E){s(E),w()},function(E){a(E),w()},D),b=null}"onloadend"in b?b.onloadend=P:b.onreadystatechange=function(){!b||b.readyState!==4||b.status===0&&!(b.responseURL&&b.responseURL.indexOf("file:")===0)||setTimeout(P)},b.onabort=function(){b&&(a(new ft("Request aborted",ft.ECONNABORTED,r,b)),b=null)},b.onerror=function(){a(new ft("Network Error",ft.ERR_NETWORK,r,b)),b=null},b.ontimeout=function(){let W=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const D=n.transitional||Oi;n.timeoutErrorMessage&&(W=n.timeoutErrorMessage),a(new ft(W,D.clarifyTimeoutError?ft.ETIMEDOUT:ft.ECONNABORTED,r,b)),b=null},l===void 0&&i.setContentType(null),"setRequestHeader"in b&&we.forEach(i.toJSON(),function(W,D){b.setRequestHeader(D,W)}),we.isUndefined(n.withCredentials)||(b.withCredentials=!!n.withCredentials),o&&o!=="json"&&(b.responseType=n.responseType),d&&([g,f]=Aa(d,!0),b.addEventListener("progress",g)),c&&b.upload&&([h,y]=Aa(c),b.upload.addEventListener("progress",h),b.upload.addEventListener("loadend",y)),(n.cancelToken||n.signal)&&(u=_=>{b&&(a(!_||_.type?new Rr(null,r,b):_),b.abort(),b=null)},n.cancelToken&&n.cancelToken.subscribe(u),n.signal&&(n.signal.aborted?u():n.signal.addEventListener("abort",u)));const A=qd(n.url);if(A&&es.protocols.indexOf(A)===-1){a(new ft("Unsupported protocol "+A+":",ft.ERR_BAD_REQUEST,r));return}b.send(l||null)})},Zd=(r,t)=>{const{length:s}=r=r?r.filter(Boolean):[];if(t||s){let a=new AbortController,n;const l=function(d){if(!n){n=!0,o();const u=d instanceof Error?d:this.reason;a.abort(u instanceof ft?u:new Rr(u instanceof Error?u.message:u))}};let i=t&&setTimeout(()=>{i=null,l(new ft(`timeout ${t} of ms exceeded`,ft.ETIMEDOUT))},t);const o=()=>{r&&(i&&clearTimeout(i),i=null,r.forEach(d=>{d.unsubscribe?d.unsubscribe(l):d.removeEventListener("abort",l)}),r=null)};r.forEach(d=>d.addEventListener("abort",l));const{signal:c}=a;return c.unsubscribe=()=>we.asap(o),c}},eu=Zd,tu=function*(r,t){let s=r.byteLength;if(!t||s<t){yield r;return}let a=0,n;for(;a<s;)n=a+t,yield r.slice(a,n),a=n},su=async function*(r,t){for await(const s of ru(r))yield*tu(s,t)},ru=async function*(r){if(r[Symbol.asyncIterator]){yield*r;return}const t=r.getReader();try{for(;;){const{done:s,value:a}=await t.read();if(s)break;yield a}}finally{await t.cancel()}},El=(r,t,s,a)=>{const n=su(r,t);let l=0,i,o=c=>{i||(i=!0,a&&a(c))};return new ReadableStream({async pull(c){try{const{done:d,value:u}=await n.next();if(d){o(),c.close();return}let h=u.byteLength;if(s){let g=l+=h;s(g)}c.enqueue(new Uint8Array(u))}catch(d){throw o(d),d}},cancel(c){return o(c),n.return()}},{highWaterMark:2})},Ga=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Hi=Ga&&typeof ReadableStream=="function",au=Ga&&(typeof TextEncoder=="function"?(r=>t=>r.encode(t))(new TextEncoder):async r=>new Uint8Array(await new Response(r).arrayBuffer())),Vi=(r,...t)=>{try{return!!r(...t)}catch{return!1}},nu=Hi&&Vi(()=>{let r=!1;const t=new Request(es.origin,{body:new ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type");return r&&!t}),Pl=64*1024,Rn=Hi&&Vi(()=>we.isReadableStream(new Response("").body)),Ra={stream:Rn&&(r=>r.body)};Ga&&(r=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Ra[t]&&(Ra[t]=we.isFunction(r[t])?s=>s[t]():(s,a)=>{throw new ft(`Response type '${t}' is not supported`,ft.ERR_NOT_SUPPORT,a)})})})(new Response);const lu=async r=>{if(r==null)return 0;if(we.isBlob(r))return r.size;if(we.isSpecCompliantForm(r))return(await new Request(es.origin,{method:"POST",body:r}).arrayBuffer()).byteLength;if(we.isArrayBufferView(r)||we.isArrayBuffer(r))return r.byteLength;if(we.isURLSearchParams(r)&&(r=r+""),we.isString(r))return(await au(r)).byteLength},iu=async(r,t)=>{const s=we.toFiniteNumber(r.getContentLength());return s??lu(t)},ou=Ga&&(async r=>{let{url:t,method:s,data:a,signal:n,cancelToken:l,timeout:i,onDownloadProgress:o,onUploadProgress:c,responseType:d,headers:u,withCredentials:h="same-origin",fetchOptions:g}=qi(r);d=d?(d+"").toLowerCase():"text";let y=eu([n,l&&l.toAbortSignal()],i),f;const w=y&&y.unsubscribe&&(()=>{y.unsubscribe()});let b;try{if(c&&nu&&s!=="get"&&s!=="head"&&(b=await iu(u,a))!==0){let D=new Request(t,{method:"POST",body:a,duplex:"half"}),I;if(we.isFormData(a)&&(I=D.headers.get("content-type"))&&u.setContentType(I),D.body){const[E,G]=Sl(b,Aa(Cl(c)));a=El(D.body,Pl,E,G)}}we.isString(h)||(h=h?"include":"omit");const P="credentials"in Request.prototype;f=new Request(t,{...g,signal:y,method:s.toUpperCase(),headers:u.normalize().toJSON(),body:a,duplex:"half",credentials:P?h:void 0});let A=await fetch(f);const _=Rn&&(d==="stream"||d==="response");if(Rn&&(o||_&&w)){const D={};["status","statusText","headers"].forEach(_e=>{D[_e]=A[_e]});const I=we.toFiniteNumber(A.headers.get("content-length")),[E,G]=o&&Sl(I,Aa(Cl(o),!0))||[];A=new Response(El(A.body,Pl,E,()=>{G&&G(),w&&w()}),D)}d=d||"text";let W=await Ra[we.findKey(Ra,d)||"text"](A,r);return!_&&w&&w(),await new Promise((D,I)=>{Ui(D,I,{data:W,headers:ks.from(A.headers),status:A.status,statusText:A.statusText,config:r,request:f})})}catch(P){throw w&&w(),P&&P.name==="TypeError"&&/fetch/i.test(P.message)?Object.assign(new ft("Network Error",ft.ERR_NETWORK,r,f),{cause:P.cause||P}):ft.from(P,P&&P.code,r,f)}}),Fn={http:wd,xhr:Qd,fetch:ou};we.forEach(Fn,(r,t)=>{if(r){try{Object.defineProperty(r,"name",{value:t})}catch{}Object.defineProperty(r,"adapterName",{value:t})}});const Al=r=>`- ${r}`,cu=r=>we.isFunction(r)||r===null||r===!1,zi={getAdapter:r=>{r=we.isArray(r)?r:[r];const{length:t}=r;let s,a;const n={};for(let l=0;l<t;l++){s=r[l];let i;if(a=s,!cu(s)&&(a=Fn[(i=String(s)).toLowerCase()],a===void 0))throw new ft(`Unknown adapter '${i}'`);if(a)break;n[i||"#"+l]=a}if(!a){const l=Object.entries(n).map(([o,c])=>`adapter ${o} `+(c===!1?"is not supported by the environment":"is not available in the build"));let i=t?l.length>1?`since :
`+l.map(Al).join(`
`):" "+Al(l[0]):"as no adapter specified";throw new ft("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return a},adapters:Fn};function dn(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new Rr(null,r)}function Rl(r){return dn(r),r.headers=ks.from(r.headers),r.data=cn.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),zi.getAdapter(r.adapter||nl.adapter)(r).then(function(a){return dn(r),a.data=cn.call(r,r.transformResponse,a),a.headers=ks.from(a.headers),a},function(a){return Xi(a)||(dn(r),a&&a.response&&(a.response.data=cn.call(r,r.transformResponse,a.response),a.response.headers=ks.from(a.response.headers))),Promise.reject(a)})}const Ki="1.7.9",Ja={};["object","boolean","number","function","string","symbol"].forEach((r,t)=>{Ja[r]=function(a){return typeof a===r||"a"+(t<1?"n ":" ")+r}});const Fl={};Ja.transitional=function(t,s,a){function n(l,i){return"[Axios v"+Ki+"] Transitional option '"+l+"'"+i+(a?". "+a:"")}return(l,i,o)=>{if(t===!1)throw new ft(n(i," has been removed"+(s?" in "+s:"")),ft.ERR_DEPRECATED);return s&&!Fl[i]&&(Fl[i]=!0),t?t(l,i,o):!0}};Ja.spelling=function(t){return(s,a)=>!0};function du(r,t,s){if(typeof r!="object")throw new ft("options must be an object",ft.ERR_BAD_OPTION_VALUE);const a=Object.keys(r);let n=a.length;for(;n-- >0;){const l=a[n],i=t[l];if(i){const o=r[l],c=o===void 0||i(o,l,r);if(c!==!0)throw new ft("option "+l+" must be "+c,ft.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new ft("Unknown option "+l,ft.ERR_BAD_OPTION)}}const Sa={assertOptions:du,validators:Ja},As=Sa.validators;class Fa{constructor(t){this.defaults=t,this.interceptors={request:new _l,response:new _l}}async request(t,s){try{return await this._request(t,s)}catch(a){if(a instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const l=n.stack?n.stack.replace(/^.+\n/,""):"";try{a.stack?l&&!String(a.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+l):a.stack=l}catch{}}throw a}}_request(t,s){typeof t=="string"?(s=s||{},s.url=t):s=t||{},s=nr(this.defaults,s);const{transitional:a,paramsSerializer:n,headers:l}=s;a!==void 0&&Sa.assertOptions(a,{silentJSONParsing:As.transitional(As.boolean),forcedJSONParsing:As.transitional(As.boolean),clarifyTimeoutError:As.transitional(As.boolean)},!1),n!=null&&(we.isFunction(n)?s.paramsSerializer={serialize:n}:Sa.assertOptions(n,{encode:As.function,serialize:As.function},!0)),Sa.assertOptions(s,{baseUrl:As.spelling("baseURL"),withXsrfToken:As.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let i=l&&we.merge(l.common,l[s.method]);l&&we.forEach(["delete","get","head","post","put","patch","common"],f=>{delete l[f]}),s.headers=ks.concat(i,l);const o=[];let c=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(s)===!1||(c=c&&w.synchronous,o.unshift(w.fulfilled,w.rejected))});const d=[];this.interceptors.response.forEach(function(w){d.push(w.fulfilled,w.rejected)});let u,h=0,g;if(!c){const f=[Rl.bind(this),void 0];for(f.unshift.apply(f,o),f.push.apply(f,d),g=f.length,u=Promise.resolve(s);h<g;)u=u.then(f[h++],f[h++]);return u}g=o.length;let y=s;for(h=0;h<g;){const f=o[h++],w=o[h++];try{y=f(y)}catch(b){w.call(this,b);break}}try{u=Rl.call(this,y)}catch(f){return Promise.reject(f)}for(h=0,g=d.length;h<g;)u=u.then(d[h++],d[h++]);return u}getUri(t){t=nr(this.defaults,t);const s=Wi(t.baseURL,t.url);return $i(s,t.params,t.paramsSerializer)}}we.forEach(["delete","get","head","options"],function(t){Fa.prototype[t]=function(s,a){return this.request(nr(a||{},{method:t,url:s,data:(a||{}).data}))}});we.forEach(["post","put","patch"],function(t){function s(a){return function(l,i,o){return this.request(nr(o||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:l,data:i}))}}Fa.prototype[t]=s(),Fa.prototype[t+"Form"]=s(!0)});const Ca=Fa;class ll{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(l){s=l});const a=this;this.promise.then(n=>{if(!a._listeners)return;let l=a._listeners.length;for(;l-- >0;)a._listeners[l](n);a._listeners=null}),this.promise.then=n=>{let l;const i=new Promise(o=>{a.subscribe(o),l=o}).then(n);return i.cancel=function(){a.unsubscribe(l)},i},t(function(l,i,o){a.reason||(a.reason=new Rr(l,i,o),s(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const s=this._listeners.indexOf(t);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const t=new AbortController,s=a=>{t.abort(a)};return this.subscribe(s),t.signal.unsubscribe=()=>this.unsubscribe(s),t.signal}static source(){let t;return{token:new ll(function(n){t=n}),cancel:t}}}const uu=ll;function pu(r){return function(s){return r.apply(null,s)}}function mu(r){return we.isObject(r)&&r.isAxiosError===!0}const In={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(In).forEach(([r,t])=>{In[t]=r});const hu=In;function Gi(r){const t=new Ca(r),s=Si(Ca.prototype.request,t);return we.extend(s,Ca.prototype,t,{allOwnKeys:!0}),we.extend(s,t,null,{allOwnKeys:!0}),s.create=function(n){return Gi(nr(r,n))},s}const zt=Gi(nl);zt.Axios=Ca;zt.CanceledError=Rr;zt.CancelToken=uu;zt.isCancel=Xi;zt.VERSION=Ki;zt.toFormData=za;zt.AxiosError=ft;zt.Cancel=zt.CanceledError;zt.all=function(t){return Promise.all(t)};zt.spread=pu;zt.isAxiosError=mu;zt.mergeConfig=nr;zt.AxiosHeaders=ks;zt.formToJSON=r=>Bi(we.isHTMLForm(r)?new FormData(r):r);zt.getAdapter=zi.getAdapter;zt.HttpStatusCode=hu;zt.default=zt;const xu=zt,_s=[{url:"wss://xrplcluster.com",name:"XRPL Cluster"},{url:"wss://s1.ripple.com",name:"Ripple S1"},{url:"wss://s2.ripple.com",name:"Ripple S2"},{url:"wss://xrpl.ws",name:"XRPL.ws"},{url:"wss://ancient-stylish-snowflake.xrp-mainnet.quiknode.pro/4e504cf032eb3a85a185ec069480a11363600a96",name:"MEMEKINGS NODE"}];let Ns=null,pa=new Set;class fu{constructor(){this.client=null,this.connecting=!1,this.serverIndex=0}getNextServer(){return this.serverIndex=(this.serverIndex+1)%_s.length,_s[this.serverIndex]}async connect(t=0){if(this.client&&this.client.isConnected())return this.client;if(this.connecting)return await new Promise(s=>setTimeout(s,100)),this.connect(t);this.connecting=!0;try{const s=Ns!==null?Ns:this.serverIndex,a=_s[s];if(Ns===null&&pa.has(s)){this.connecting=!1;const n=this.getNextServer();return this.connect(t)}return this.client=new Re.Client(a.url,{timeout:8e3,connectionTimeout:8e3}),await Promise.race([this.client.connect(),new Promise((n,l)=>setTimeout(()=>l(new Error("Connection timeout after 8 seconds")),8e3))]),pa.delete(s),this.connecting=!1,this.client}catch{this.connecting=!1;const a=Ns!==null?Ns:this.serverIndex;if(pa.add(a),setTimeout(()=>pa.delete(a),6e4),Ns===null&&t<_s.length){const n=this.getNextServer();return this.connect(t+1)}else throw new Error(`Failed to connect after trying ${t+1} servers`)}}async disconnect(){if(this.client&&this.client.isConnected()){try{await this.client.disconnect()}catch{}this.client=null}}isConnected(){return this.client&&this.client.isConnected()}}const ar=new fu;async function gu(r){return new Promise(t=>setTimeout(t,r))}async function Ya(r,t=3,s=500){var n,l,i,o,c,d,u,h;let a;for(let g=0;g<t;g++)try{const y=await ar.connect();return await r(y)}catch(y){a=y;const f=((n=y.message)==null?void 0:n.includes("rate"))||((l=y.message)==null?void 0:l.includes("limit"))||((i=y.message)==null?void 0:i.includes("Too many"))||((o=y.data)==null?void 0:o.error)==="slowDown"||((c=y.data)==null?void 0:c.error)==="tooBusy",w=((d=y.message)==null?void 0:d.includes("timeout"))||((u=y.message)==null?void 0:u.includes("disconnect"))||((h=y.message)==null?void 0:h.includes("WebSocket"))||!ar.isConnected();if(f||w){const b=s*Math.pow(1.5,g),P=Math.random()*500,A=b+P;w&&await ar.disconnect(),await gu(A);continue}throw y}throw new Error(`Max retries (${t}) exceeded. Last error: ${a.message}`)}async function Zr(){return ar.connect()}async function bu(){return ar.disconnect()}async function Ji(r,t=3){return Ya(async s=>await s.request(r),t)}async function il(r,t,s=3){return Ya(async a=>await a.submitAndWait(r,{wallet:t}),s)}async function vu(r,t=3){return Ya(async s=>await s.autofill(r),t)}function Ln(){return _s}function Dn(){const r=Ns!==null?Ns:ar.serverIndex;return _s[r]}async function Mn(r){if(r<0||r>=_s.length)throw new Error("Invalid server index");Ns=r,localStorage.setItem("selectedNodeIndex",r.toString()),await ar.disconnect(),window.dispatchEvent(new CustomEvent("networkChanged",{detail:_s[r]}))}function yu(){Ns=null,localStorage.removeItem("selectedNodeIndex")}function Yi(){const r=localStorage.getItem("selectedNodeIndex");if(r!==null){const t=parseInt(r,10);if(t>=0&&t<_s.length)return Ns=t,_s[t]}return null}const Lt=Object.freeze(Object.defineProperty({__proto__:null,XRPL_SERVERS:_s,autofillWithRetry:vu,clearManualServer:yu,disconnectClient:bu,getAvailableServers:Ln,getClient:Zr,getCurrentServer:Dn,loadSavedServer:Yi,requestWithRetry:Ji,setManualServer:Mn,submitWithRetry:il,withRetry:Ya},Symbol.toStringTag,{value:"Module"})),ma=new Map,wu=1e4;async function Ia(r,t=!0){var s,a,n;if(!r)return 0;if(t&&ma.has(r)){const l=ma.get(r);if(Date.now()-l.timestamp<wu)return l.balance}try{const l=await Ji({command:"account_info",account:r,ledger_index:"validated"}),i=parseFloat(l.result.account_data.Balance)/1e6;return ma.set(r,{balance:i,timestamp:Date.now()}),i}catch(l){if(((s=l.data)==null?void 0:s.error)==="actNotFound")return ma.set(r,{balance:0,timestamp:Date.now()}),0;const i=(a=l.message)!=null&&a.includes("timeout")?"Connection to XRPL network timed out":(n=l.message)!=null&&n.includes("disconnect")?"Lost connection to XRPL network":l.message||"Failed to fetch balance from XRPL",o=new Error(i);throw o.originalError=l,o}}function ju({network:r,setNetwork:t}){return e.jsxs("div",{className:"flex gap-1 bg-gray-800/50 rounded-lg border border-gray-700/50 p-1",children:[e.jsx("button",{onClick:()=>t("testnet"),className:`py-1 px-2 text-sm rounded-md transition-all duration-200 ${r==="testnet"?"bg-gradient-to-r from-green-600 to-green-500 text-white shadow-lg shadow-green-500/20":"text-gray-400 hover:text-gray-300 hover:bg-gray-700/50"}`,children:"Test"}),e.jsx("button",{onClick:()=>t("mainnet"),className:`py-1 px-2 text-sm rounded-md transition-all duration-200 ${r==="mainnet"?"bg-gradient-to-r from-green-600 to-green-500 text-white shadow-lg shadow-green-500/20":"text-gray-400 hover:text-gray-300 hover:bg-gray-700/50"}`,children:"Main"})]})}function Nu({currentPage:r,onNavigate:t}){const[s,a]=m.useState(null),[n,l]=m.useState(!0),[i,o]=m.useState(null),[c,d]=m.useState(0),[u,h]=m.useState(!1),[g,y]=m.useState(null),[f,w]=m.useState(!1),b=m.useRef(null),P=m.useRef(null);m.useEffect(()=>{const E=G=>{b.current&&!b.current.contains(G.target)&&h(!1),P.current&&!P.current.contains(G.target)&&w(!1)};return(u||f)&&(document.addEventListener("mousedown",E),document.addEventListener("touchstart",E)),()=>{document.removeEventListener("mousedown",E),document.removeEventListener("touchstart",E)}},[u,f]),m.useEffect(()=>{W(),A();const E=Yi();y(E||Dn());const G=()=>A(),_e=ge=>y(ge.detail);return window.addEventListener("walletConnected",G),window.addEventListener("walletDisconnected",G),window.addEventListener("networkChanged",_e),()=>{window.removeEventListener("walletConnected",G),window.removeEventListener("walletDisconnected",G),window.removeEventListener("networkChanged",_e)}},[]),m.useEffect(()=>{i!=null&&i.address?_():d(0)},[i]);const A=()=>{const E=localStorage.getItem("connectedWallet");o(E?JSON.parse(E):null)},_=async()=>{if(i!=null&&i.address)try{const E=await Ia(i.address);d(E)}catch{}},W=async()=>{try{const E=await xu.get("https://api.coingecko.com/api/v3/simple/price?ids=ripple&vs_currencies=usd&include_24hr_change=true");a({price:E.data.ripple.usd,change:E.data.ripple.usd_24h_change}),l(!1)}catch{l(!1)}},D=async E=>{try{await Mn(E);const G=Ln();y(G[E]),w(!1)}catch{}},I=[{id:"dashboard",label:"Dashboard",icon:"📊"},{id:"top10",label:"Top 10",icon:"🏆"},{id:"kingslist",label:"Kings List",icon:"👑"},{id:"memes",label:"Memes",icon:"🚀"},{id:"pools",label:"Pools",icon:"🏊"},{id:"trade",label:"Trade",icon:"💱"},{id:"bottrader",label:"Bot Trader",icon:"🤖"},{id:"vault",label:"Vault",icon:"🏦"},{id:"mytokens",label:"My Tokens",icon:"💎"},{id:"xrprewards",label:"XRP Rewards",icon:"💰"},{id:"airdropper",label:"Airdropper",icon:"✈️"},{id:"analytics",label:"Analytics",icon:"📈"},{id:"aichat",label:"AI Chat",icon:"💬"},{id:"about",label:"About",icon:"ℹ️"},{id:"wallets",label:"Wallets",icon:"💼"},{id:"setup",label:"Setup",icon:"⚙️"}];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hidden lg:block fixed left-0 top-0 h-screen w-64 glass flex-col border-r border-purple-500/20",children:[e.jsxs("div",{className:"p-6 border-b border-purple-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("h1",{className:"text-3xl font-bold",children:[e.jsx("span",{className:"text-white",children:"MEME"}),e.jsx("span",{className:"bg-gradient-to-r from-purple-400 to-purple-600 bg-clip-text text-transparent",children:"KINGS"})]}),e.jsx("span",{className:"text-3xl",style:{filter:"drop-shadow(0 0 8px rgba(168, 85, 247, 0.8))",textShadow:"0 0 12px rgba(168, 85, 247, 0.6)"},children:"👑"})]}),e.jsx("p",{className:"text-purple-300/60 text-xs mt-1",children:"XRPL Meme Token Factory"})]}),e.jsx("nav",{className:"flex-1 p-4 space-y-2 overflow-y-auto",children:I.map(E=>e.jsxs("button",{onClick:()=>t(E.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-300 ${r===E.id?"bg-gradient-to-r from-purple-600 to-purple-700 text-white shadow-lg shadow-purple-500/50":"text-purple-300 hover:bg-purple-900/30 hover:text-purple-200"}`,children:[e.jsx("span",{className:"text-xl",children:E.icon}),e.jsx("span",{className:"font-medium",children:E.label})]},E.id))}),e.jsxs("div",{className:"p-4 border-t border-purple-500/20 space-y-2",children:[i&&e.jsxs("div",{className:"glass rounded-lg p-2 bg-green-500/10 border border-green-500/30",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-400 animate-pulse"}),e.jsx("span",{className:"text-green-300 text-[10px] font-medium",children:"Connected Wallet"})]}),e.jsx("div",{className:"text-purple-200 font-bold text-xs mb-0.5",children:i.name}),e.jsxs("div",{className:"text-purple-300 text-[10px] font-mono break-all",children:[i.address.slice(0,10),"...",i.address.slice(-8)]}),e.jsxs("div",{className:"text-purple-400 text-[10px] mt-1",children:[c.toFixed(3)," XRP"]})]}),e.jsxs("div",{className:"glass rounded-lg p-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-purple-300 text-[10px] font-medium",children:"XRP/USD"}),!n&&s&&e.jsxs("span",{className:`text-[10px] font-medium ${s.change>=0?"text-green-400":"text-red-400"}`,children:[s.change>=0?"↑":"↓"," ",Math.abs(s.change).toFixed(2),"%"]})]}),n?e.jsx("div",{className:"text-purple-400 text-xs animate-pulse",children:"Loading..."}):s?e.jsxs("div",{className:"text-lg font-bold text-purple-200",children:["$",s.price.toFixed(4)]}):e.jsx("div",{className:"text-purple-400 text-[10px]",children:"Unable to load"})]}),e.jsxs("div",{ref:P,className:"glass rounded-lg p-2 relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-purple-300 text-[10px] font-medium",children:"Network Node"}),e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-400 animate-pulse"})]}),e.jsxs("button",{onClick:()=>w(!f),className:"w-full flex items-center justify-between text-purple-200 text-[10px] hover:text-purple-100 transition-colors",children:[e.jsx("span",{className:"truncate",children:(g==null?void 0:g.name)||"Loading..."}),e.jsx("span",{className:"ml-2",children:f?"▲":"▼"})]}),f&&e.jsx("div",{className:"absolute left-0 right-0 mt-2 bg-gray-900 rounded-lg border border-purple-500/50 shadow-2xl z-[100] max-h-64 overflow-y-auto",children:Ln().map((E,G)=>e.jsx("button",{onClick:()=>D(G),className:`w-full text-left px-4 py-3 text-sm transition-colors border-b border-purple-500/20 last:border-b-0 ${(g==null?void 0:g.url)===E.url?"bg-purple-600 text-white":"text-purple-300 hover:bg-purple-900/60"}`,children:E.name},G))})]})]})]}),e.jsxs("div",{ref:b,className:"lg:hidden fixed top-0 left-0 right-0 glass border-b border-purple-500/20 z-50 backdrop-blur-lg",children:[e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("h1",{className:"text-2xl font-bold",children:[e.jsx("span",{className:"text-white",children:"MEME"}),e.jsx("span",{className:"bg-gradient-to-r from-purple-400 to-purple-600 bg-clip-text text-transparent",children:"KINGS"})]}),e.jsx("span",{className:"text-2xl",style:{filter:"drop-shadow(0 0 8px rgba(168, 85, 247, 0.8))",textShadow:"0 0 12px rgba(168, 85, 247, 0.6)"},children:"👑"})]}),e.jsx("button",{onClick:()=>h(!u),className:"p-2 rounded-lg text-purple-300 hover:bg-purple-900/30 transition-all duration-200 touch-manipulation active:scale-95","aria-label":"Toggle menu",children:e.jsx("svg",{className:"w-7 h-7",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})})]}),e.jsx("div",{className:`transition-all duration-300 ease-in-out overflow-hidden ${u?"max-h-[calc(100vh-80px)] opacity-100":"max-h-0 opacity-0"}`,children:e.jsxs("div",{className:"px-2 pb-3 space-y-1 max-h-[calc(100vh-100px)] overflow-y-auto",children:[I.map(E=>e.jsxs("button",{onClick:()=>{t(E.id),h(!1)},className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all duration-200 touch-manipulation active:scale-98 text-base ${r===E.id?"bg-gradient-to-r from-purple-600 to-purple-700 text-white shadow-lg":"text-purple-300 hover:bg-purple-900/30"}`,children:[e.jsx("span",{className:"text-xl",children:E.icon}),e.jsx("span",{className:"font-medium",children:E.label})]},E.id)),i&&e.jsxs("div",{className:"glass rounded-lg p-2 bg-green-500/10 border border-green-500/30 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-400 animate-pulse"}),e.jsx("span",{className:"text-green-300 text-[10px] font-medium",children:"Connected Wallet"})]}),e.jsx("div",{className:"text-purple-200 font-bold text-xs mb-0.5",children:i.name}),e.jsxs("div",{className:"text-purple-300 text-[10px] font-mono break-all",children:[i.address.slice(0,10),"...",i.address.slice(-8)]}),e.jsxs("div",{className:"text-purple-400 text-[10px] mt-1",children:[c.toFixed(3)," XRP"]})]}),e.jsxs("div",{className:"glass rounded-lg p-2 mt-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-purple-300 text-[10px] font-medium",children:"XRP/USD"}),!n&&s&&e.jsxs("span",{className:`text-[10px] font-medium ${s.change>=0?"text-green-400":"text-red-400"}`,children:[s.change>=0?"↑":"↓"," ",Math.abs(s.change).toFixed(2),"%"]})]}),n?e.jsx("div",{className:"text-purple-400 text-xs animate-pulse",children:"Loading..."}):s?e.jsxs("div",{className:"text-lg font-bold text-purple-200",children:["$",s.price.toFixed(4)]}):e.jsx("div",{className:"text-purple-400 text-[10px]",children:"Unable to load"})]}),e.jsxs("div",{className:"glass rounded-lg p-2 mt-1",children:[e.jsx("div",{className:"text-purple-300 text-[10px] font-medium mb-2",children:"Network"}),e.jsx(ju,{network:g||Dn(),setNetwork:E=>{Mn(E),y(E),window.location.reload()}})]})]})})]})]})}const _u="modulepreload",ku=function(r){return"/"+r},Il={},Pt=function(t,s,a){if(!s||s.length===0)return t();const n=document.getElementsByTagName("link");return Promise.all(s.map(l=>{if(l=ku(l),l in Il)return;Il[l]=!0;const i=l.endsWith(".css"),o=i?'[rel="stylesheet"]':"";if(!!a)for(let u=n.length-1;u>=0;u--){const h=n[u];if(h.href===l&&(!i||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${o}`))return;const d=document.createElement("link");if(d.rel=i?"stylesheet":_u,i||(d.as="script",d.crossOrigin=""),d.href=l,document.head.appendChild(d),i)return new Promise((u,h)=>{d.addEventListener("load",u),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})})).then(()=>t()).catch(l=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=l,window.dispatchEvent(i),!i.defaultPrevented)throw l})},Su=r=>{let t;return r?t=r:typeof fetch>"u"?t=(...s)=>Pt(()=>Promise.resolve().then(()=>Fr),void 0).then(({default:a})=>a(...s)):t=fetch,(...s)=>t(...s)};class ol extends Error{constructor(t,s="FunctionsError",a){super(t),this.name=s,this.context=a}}class Ll extends ol{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Dl extends ol{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Ml extends ol{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var $n;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})($n||($n={}));var Cu=globalThis&&globalThis.__awaiter||function(r,t,s,a){function n(l){return l instanceof s?l:new s(function(i){i(l)})}return new(s||(s=Promise))(function(l,i){function o(u){try{d(a.next(u))}catch(h){i(h)}}function c(u){try{d(a.throw(u))}catch(h){i(h)}}function d(u){u.done?l(u.value):n(u.value).then(o,c)}d((a=a.apply(r,t||[])).next())})};class Tu{constructor(t,{headers:s={},customFetch:a,region:n=$n.Any}={}){this.url=t,this.headers=s,this.region=n,this.fetch=Su(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Cu(this,arguments,void 0,function*(s,a={}){var n;try{const{headers:l,method:i,body:o,signal:c}=a;let d={},{region:u}=a;u||(u=this.region);const h=new URL(`${this.url}/${s}`);u&&u!=="any"&&(d["x-region"]=u,h.searchParams.set("forceFunctionRegion",u));let g;o&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",g=o):typeof o=="string"?(d["Content-Type"]="text/plain",g=o):typeof FormData<"u"&&o instanceof FormData?g=o:(d["Content-Type"]="application/json",g=JSON.stringify(o)));const y=yield this.fetch(h.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),l),body:g,signal:c}).catch(P=>{throw P.name==="AbortError"?P:new Ll(P)}),f=y.headers.get("x-relay-error");if(f&&f==="true")throw new Dl(y);if(!y.ok)throw new Ml(y);let w=((n=y.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),b;return w==="application/json"?b=yield y.json():w==="application/octet-stream"?b=yield y.blob():w==="text/event-stream"?b=y:w==="multipart/form-data"?b=yield y.formData():b=yield y.text(),{data:b,error:null,response:y}}catch(l){return l instanceof Error&&l.name==="AbortError"?{data:null,error:new Ll(l)}:{data:null,error:l,response:l instanceof Ml||l instanceof Dl?l.context:void 0}}})}}var ls={},cl={},Qa={},aa={},Za={},en={},Eu=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Pr=Eu();const Pu=Pr.fetch,Qi=Pr.fetch.bind(Pr),Zi=Pr.Headers,Au=Pr.Request,Ru=Pr.Response,Fr=Object.freeze(Object.defineProperty({__proto__:null,Headers:Zi,Request:Au,Response:Ru,default:Qi,fetch:Pu},Symbol.toStringTag,{value:"Module"})),Fu=Bo(Fr);var tn={};Object.defineProperty(tn,"__esModule",{value:!0});let Iu=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};tn.default=Iu;var eo=xs&&xs.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(en,"__esModule",{value:!0});const Lu=eo(Fu),Du=eo(tn);let Mu=class{constructor(t){var s,a;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(s=t.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=t.signal,this.isMaybeSingle=(a=t.isMaybeSingle)!==null&&a!==void 0?a:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Lu.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,s){return this.headers=new Headers(this.headers),this.headers.set(t,s),this}then(t,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let n=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{var i,o,c,d;let u=null,h=null,g=null,y=l.status,f=l.statusText;if(l.ok){if(this.method!=="HEAD"){const A=await l.text();A===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((i=this.headers.get("Accept"))===null||i===void 0)&&i.includes("application/vnd.pgrst.plan+text"))?h=A:h=JSON.parse(A))}const b=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),P=(c=l.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");b&&P&&P.length>1&&(g=parseInt(P[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(u={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,g=null,y=406,f="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const b=await l.text();try{u=JSON.parse(b),Array.isArray(u)&&l.status===404&&(h=[],u=null,y=200,f="OK")}catch{l.status===404&&b===""?(y=204,f="No Content"):u={message:b}}if(u&&this.isMaybeSingle&&(!((d=u==null?void 0:u.details)===null||d===void 0)&&d.includes("0 rows"))&&(u=null,y=200,f="OK"),u&&this.shouldThrowOnError)throw new Du.default(u)}return{error:u,data:h,count:g,status:y,statusText:f}});return this.shouldThrowOnError||(n=n.catch(l=>{var i,o,c;return{error:{message:`${(i=l==null?void 0:l.name)!==null&&i!==void 0?i:"FetchError"}: ${l==null?void 0:l.message}`,details:`${(o=l==null?void 0:l.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(c=l==null?void 0:l.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),n.then(t,s)}returns(){return this}overrideTypes(){return this}};en.default=Mu;var $u=xs&&xs.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Za,"__esModule",{value:!0});const Ou=$u(en);let Bu=class extends Ou.default{select(t){let s=!1;const a=(t??"*").split("").map(n=>/\s/.test(n)&&!s?"":(n==='"'&&(s=!s),n)).join("");return this.url.searchParams.set("select",a),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:s=!0,nullsFirst:a,foreignTable:n,referencedTable:l=n}={}){const i=l?`${l}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${s?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:s,referencedTable:a=s}={}){const n=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(n,`${t}`),this}range(t,s,{foreignTable:a,referencedTable:n=a}={}){const l=typeof n>"u"?"offset":`${n}.offset`,i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(l,`${t}`),this.url.searchParams.set(i,`${s-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:s=!1,settings:a=!1,buffers:n=!1,wal:l=!1,format:i="text"}={}){var o;const c=[t?"analyze":null,s?"verbose":null,a?"settings":null,n?"buffers":null,l?"wal":null].filter(Boolean).join("|"),d=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${d}"; options=${c};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};Za.default=Bu;var Xu=xs&&xs.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(aa,"__esModule",{value:!0});const Uu=Xu(Za);let Wu=class extends Uu.default{eq(t,s){return this.url.searchParams.append(t,`eq.${s}`),this}neq(t,s){return this.url.searchParams.append(t,`neq.${s}`),this}gt(t,s){return this.url.searchParams.append(t,`gt.${s}`),this}gte(t,s){return this.url.searchParams.append(t,`gte.${s}`),this}lt(t,s){return this.url.searchParams.append(t,`lt.${s}`),this}lte(t,s){return this.url.searchParams.append(t,`lte.${s}`),this}like(t,s){return this.url.searchParams.append(t,`like.${s}`),this}likeAllOf(t,s){return this.url.searchParams.append(t,`like(all).{${s.join(",")}}`),this}likeAnyOf(t,s){return this.url.searchParams.append(t,`like(any).{${s.join(",")}}`),this}ilike(t,s){return this.url.searchParams.append(t,`ilike.${s}`),this}ilikeAllOf(t,s){return this.url.searchParams.append(t,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(t,s){return this.url.searchParams.append(t,`ilike(any).{${s.join(",")}}`),this}is(t,s){return this.url.searchParams.append(t,`is.${s}`),this}in(t,s){const a=Array.from(new Set(s)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(t,`in.(${a})`),this}contains(t,s){return typeof s=="string"?this.url.searchParams.append(t,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(t,`cs.{${s.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(s)}`),this}containedBy(t,s){return typeof s=="string"?this.url.searchParams.append(t,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(t,`cd.{${s.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(s)}`),this}rangeGt(t,s){return this.url.searchParams.append(t,`sr.${s}`),this}rangeGte(t,s){return this.url.searchParams.append(t,`nxl.${s}`),this}rangeLt(t,s){return this.url.searchParams.append(t,`sl.${s}`),this}rangeLte(t,s){return this.url.searchParams.append(t,`nxr.${s}`),this}rangeAdjacent(t,s){return this.url.searchParams.append(t,`adj.${s}`),this}overlaps(t,s){return typeof s=="string"?this.url.searchParams.append(t,`ov.${s}`):this.url.searchParams.append(t,`ov.{${s.join(",")}}`),this}textSearch(t,s,{config:a,type:n}={}){let l="";n==="plain"?l="pl":n==="phrase"?l="ph":n==="websearch"&&(l="w");const i=a===void 0?"":`(${a})`;return this.url.searchParams.append(t,`${l}fts${i}.${s}`),this}match(t){return Object.entries(t).forEach(([s,a])=>{this.url.searchParams.append(s,`eq.${a}`)}),this}not(t,s,a){return this.url.searchParams.append(t,`not.${s}.${a}`),this}or(t,{foreignTable:s,referencedTable:a=s}={}){const n=a?`${a}.or`:"or";return this.url.searchParams.append(n,`(${t})`),this}filter(t,s,a){return this.url.searchParams.append(t,`${s}.${a}`),this}};aa.default=Wu;var qu=xs&&xs.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Qa,"__esModule",{value:!0});const Or=qu(aa);let Hu=class{constructor(t,{headers:s={},schema:a,fetch:n}){this.url=t,this.headers=new Headers(s),this.schema=a,this.fetch=n}select(t,s){const{head:a=!1,count:n}=s??{},l=a?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join("");return this.url.searchParams.set("select",o),n&&this.headers.append("Prefer",`count=${n}`),new Or.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:s,defaultToNull:a=!0}={}){var n;const l="POST";if(s&&this.headers.append("Prefer",`count=${s}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((o,c)=>o.concat(Object.keys(c)),[]);if(i.length>0){const o=[...new Set(i)].map(c=>`"${c}"`);this.url.searchParams.set("columns",o.join(","))}}return new Or.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(t,{onConflict:s,ignoreDuplicates:a=!1,count:n,defaultToNull:l=!0}={}){var i;const o="POST";if(this.headers.append("Prefer",`resolution=${a?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),n&&this.headers.append("Prefer",`count=${n}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new Or.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:s}={}){var a;const n="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new Or.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}delete({count:t}={}){var s;const a="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Or.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}};Qa.default=Hu;var to=xs&&xs.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(cl,"__esModule",{value:!0});const Vu=to(Qa),zu=to(aa);let Ku=class so{constructor(t,{headers:s={},schema:a,fetch:n}={}){this.url=t,this.headers=new Headers(s),this.schemaName=a,this.fetch=n}from(t){const s=new URL(`${this.url}/${t}`);return new Vu.default(s,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new so(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,s={},{head:a=!1,get:n=!1,count:l}={}){var i;let o;const c=new URL(`${this.url}/rpc/${t}`);let d;a||n?(o=a?"HEAD":"GET",Object.entries(s).filter(([h,g])=>g!==void 0).map(([h,g])=>[h,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([h,g])=>{c.searchParams.append(h,g)})):(o="POST",d=s);const u=new Headers(this.headers);return l&&u.set("Prefer",`count=${l}`),new zu.default({method:o,url:c,headers:u,schema:this.schemaName,body:d,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};cl.default=Ku;var Ir=xs&&xs.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ls,"__esModule",{value:!0});ls.PostgrestError=ls.PostgrestBuilder=ls.PostgrestTransformBuilder=ls.PostgrestFilterBuilder=ls.PostgrestQueryBuilder=ls.PostgrestClient=void 0;const ro=Ir(cl);ls.PostgrestClient=ro.default;const ao=Ir(Qa);ls.PostgrestQueryBuilder=ao.default;const no=Ir(aa);ls.PostgrestFilterBuilder=no.default;const lo=Ir(Za);ls.PostgrestTransformBuilder=lo.default;const io=Ir(en);ls.PostgrestBuilder=io.default;const oo=Ir(tn);ls.PostgrestError=oo.default;var Gu=ls.default={PostgrestClient:ro.default,PostgrestQueryBuilder:ao.default,PostgrestFilterBuilder:no.default,PostgrestTransformBuilder:lo.default,PostgrestBuilder:io.default,PostgrestError:oo.default};const{PostgrestClient:Ju,PostgrestQueryBuilder:hx,PostgrestFilterBuilder:xx,PostgrestTransformBuilder:fx,PostgrestBuilder:gx,PostgrestError:bx}=Gu;class Yu{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const s=process.versions;if(s&&s.node){const a=s.node,n=parseInt(a.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let s=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(s+=`

Suggested solution: ${t.workaround}`),new Error(s)}static createWebSocket(t,s){const a=this.getWebSocketConstructor();return new a(t,s)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const Qu="2.74.0",Zu=`realtime-js/${Qu}`,ep="1.0.0",On=1e4,tp=1e3,sp=100;var Vr;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(Vr||(Vr={}));var Kt;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(Kt||(Kt={}));var js;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(js||(js={}));var Bn;(function(r){r.websocket="websocket"})(Bn||(Bn={}));var er;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(er||(er={}));class rp{constructor(){this.HEADER_LENGTH=1}decode(t,s){return t.constructor===ArrayBuffer?s(this._binaryDecode(t)):s(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const s=new DataView(t),a=new TextDecoder;return this._decodeBroadcast(t,s,a)}_decodeBroadcast(t,s,a){const n=s.getUint8(1),l=s.getUint8(2);let i=this.HEADER_LENGTH+2;const o=a.decode(t.slice(i,i+n));i=i+n;const c=a.decode(t.slice(i,i+l));i=i+l;const d=JSON.parse(a.decode(t.slice(i,t.byteLength)));return{ref:null,topic:o,event:c,payload:d}}}class co{constructor(t,s){this.callback=t,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Dt;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(Dt||(Dt={}));const $l=(r,t,s={})=>{var a;const n=(a=s.skipTypes)!==null&&a!==void 0?a:[];return t?Object.keys(t).reduce((l,i)=>(l[i]=ap(i,r,t,n),l),{}):{}},ap=(r,t,s,a)=>{const n=t.find(o=>o.name===r),l=n==null?void 0:n.type,i=s[r];return l&&!a.includes(l)?uo(l,i):Xn(i)},uo=(r,t)=>{if(r.charAt(0)==="_"){const s=r.slice(1,r.length);return op(t,s)}switch(r){case Dt.bool:return np(t);case Dt.float4:case Dt.float8:case Dt.int2:case Dt.int4:case Dt.int8:case Dt.numeric:case Dt.oid:return lp(t);case Dt.json:case Dt.jsonb:return ip(t);case Dt.timestamp:return cp(t);case Dt.abstime:case Dt.date:case Dt.daterange:case Dt.int4range:case Dt.int8range:case Dt.money:case Dt.reltime:case Dt.text:case Dt.time:case Dt.timestamptz:case Dt.timetz:case Dt.tsrange:case Dt.tstzrange:return Xn(t);default:return Xn(t)}},Xn=r=>r,np=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},lp=r=>{if(typeof r=="string"){const t=parseFloat(r);if(!Number.isNaN(t))return t}return r},ip=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch{return r}return r},op=(r,t)=>{if(typeof r!="string")return r;const s=r.length-1,a=r[s];if(r[0]==="{"&&a==="}"){let l;const i=r.slice(1,s);try{l=JSON.parse("["+i+"]")}catch{l=i?i.split(","):[]}return l.map(o=>uo(t,o))}return r},cp=r=>typeof r=="string"?r.replace(" ","T"):r,po=r=>{let t=r;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class un{constructor(t,s,a={},n=On){this.channel=t,this.event=s,this.payload=a,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,s){var a;return this._hasReceived(t)&&s((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:s}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(s))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Ol;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(Ol||(Ol={}));class zr{constructor(t,s){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(s==null?void 0:s.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},n=>{const{onJoin:l,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=zr.syncState(this.state,n,l,i),this.pendingDiffs.forEach(c=>{this.state=zr.syncDiff(this.state,c,l,i)}),this.pendingDiffs=[],o()}),this.channel._on(a.diff,{},n=>{const{onJoin:l,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=zr.syncDiff(this.state,n,l,i),o())}),this.onJoin((n,l,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:l,newPresences:i})}),this.onLeave((n,l,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:l,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,s,a,n){const l=this.cloneDeep(t),i=this.transformState(s),o={},c={};return this.map(l,(d,u)=>{i[d]||(c[d]=u)}),this.map(i,(d,u)=>{const h=l[d];if(h){const g=u.map(b=>b.presence_ref),y=h.map(b=>b.presence_ref),f=u.filter(b=>y.indexOf(b.presence_ref)<0),w=h.filter(b=>g.indexOf(b.presence_ref)<0);f.length>0&&(o[d]=f),w.length>0&&(c[d]=w)}else o[d]=u}),this.syncDiff(l,{joins:o,leaves:c},a,n)}static syncDiff(t,s,a,n){const{joins:l,leaves:i}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return a||(a=()=>{}),n||(n=()=>{}),this.map(l,(o,c)=>{var d;const u=(d=t[o])!==null&&d!==void 0?d:[];if(t[o]=this.cloneDeep(c),u.length>0){const h=t[o].map(y=>y.presence_ref),g=u.filter(y=>h.indexOf(y.presence_ref)<0);t[o].unshift(...g)}a(o,u,c)}),this.map(i,(o,c)=>{let d=t[o];if(!d)return;const u=c.map(h=>h.presence_ref);d=d.filter(h=>u.indexOf(h.presence_ref)<0),t[o]=d,n(o,d,c),d.length===0&&delete t[o]}),t}static map(t,s){return Object.getOwnPropertyNames(t).map(a=>s(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((s,a)=>{const n=t[a];return"metas"in n?s[a]=n.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):s[a]=n,s},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Bl;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(Bl||(Bl={}));var Kr;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(Kr||(Kr={}));var $s;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})($s||($s={}));class dl{constructor(t,s={config:{}},a){var n,l;if(this.topic=t,this.params=s,this.socket=a,this.bindings={},this.state=Kt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new un(this,js.join,this.params,this.timeout),this.rejoinTimer=new co(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Kt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Kt.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Kt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Kt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Kt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(js.reply,{},(i,o)=>{this._trigger(this._replyEventName(o),i)}),this.presence=new zr(this),this.broadcastEndpointURL=po(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,s=this.timeout){var a,n,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Kt.closed){const{config:{broadcast:i,presence:o,private:c}}=this.params,d=(n=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(y=>y.filter))!==null&&n!==void 0?n:[],u=!!this.bindings[Kr.PRESENCE]&&this.bindings[Kr.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,h={},g={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(y=>t==null?void 0:t($s.CHANNEL_ERROR,y)),this._onClose(()=>t==null?void 0:t($s.CLOSED)),this.updateJoinPayload(Object.assign({config:g},h)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:y})=>{var f;if(this.socket.setAuth(),y===void 0){t==null||t($s.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,b=(f=w==null?void 0:w.length)!==null&&f!==void 0?f:0,P=[];for(let A=0;A<b;A++){const _=w[A],{filter:{event:W,schema:D,table:I,filter:E}}=_,G=y&&y[A];if(G&&G.event===W&&G.schema===D&&G.table===I&&G.filter===E)P.push(Object.assign(Object.assign({},_),{id:G.id}));else{this.unsubscribe(),this.state=Kt.errored,t==null||t($s.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=P,t&&t($s.SUBSCRIBED);return}}).receive("error",y=>{this.state=Kt.errored,t==null||t($s.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(y).join(", ")||"error")))}).receive("timeout",()=>{t==null||t($s.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,s={}){return await this.send({type:"presence",event:"track",payload:t},s.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,s,a){return this.state===Kt.joined&&t===Kr.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,s,a)}async send(t,s={}){var a,n;if(!this._canPush()&&t.type==="broadcast"){const{event:l,payload:i}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:i,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=s.timeout)!==null&&a!==void 0?a:this.timeout);return await((n=d.body)===null||n===void 0?void 0:n.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var i,o,c;const d=this._push(t.type,t,s.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.ack)&&l("ok"),d.receive("ok",()=>l("ok")),d.receive("error",()=>l("error")),d.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Kt.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(js.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(n=>{a=new un(this,js.leave,{},t),a.receive("ok",()=>{s(),n("ok")}).receive("timeout",()=>{s(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a==null||a.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Kt.closed,this.bindings={}}async _fetchWithTimeout(t,s,a){const n=new AbortController,l=setTimeout(()=>n.abort(),a),i=await this.socket.fetch(t,Object.assign(Object.assign({},s),{signal:n.signal}));return clearTimeout(l),i}_push(t,s,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new un(this,t,s,a);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>sp){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(t,s,a){return s}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,s,a){var n,l;const i=t.toLocaleLowerCase(),{close:o,error:c,leave:d,join:u}=js;if(a&&[o,c,d,u].indexOf(i)>=0&&a!==this._joinRef())return;let g=this._onMessage(i,s,a);if(s&&!g)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(y=>{var f,w,b;return((f=y.filter)===null||f===void 0?void 0:f.event)==="*"||((b=(w=y.filter)===null||w===void 0?void 0:w.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===i}).map(y=>y.callback(g,a)):(l=this.bindings[i])===null||l===void 0||l.filter(y=>{var f,w,b,P,A,_;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in y){const W=y.id,D=(f=y.filter)===null||f===void 0?void 0:f.event;return W&&((w=s.ids)===null||w===void 0?void 0:w.includes(W))&&(D==="*"||(D==null?void 0:D.toLocaleLowerCase())===((b=s.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const W=(A=(P=y==null?void 0:y.filter)===null||P===void 0?void 0:P.event)===null||A===void 0?void 0:A.toLocaleLowerCase();return W==="*"||W===((_=s==null?void 0:s.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===i}).map(y=>{if(typeof g=="object"&&"ids"in g){const f=g.data,{schema:w,table:b,commit_timestamp:P,type:A,errors:_}=f;g=Object.assign(Object.assign({},{schema:w,table:b,commit_timestamp:P,eventType:A,new:{},old:{},errors:_}),this._getPayloadRecords(f))}y.callback(g,a)})}_isClosed(){return this.state===Kt.closed}_isJoined(){return this.state===Kt.joined}_isJoining(){return this.state===Kt.joining}_isLeaving(){return this.state===Kt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,s,a){const n=t.toLocaleLowerCase(),l={type:n,filter:s,callback:a};return this.bindings[n]?this.bindings[n].push(l):this.bindings[n]=[l],this}_off(t,s){const a=t.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(n=>{var l;return!(((l=n.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===a&&dl.isEqual(n.filter,s))})),this}static isEqual(t,s){if(Object.keys(t).length!==Object.keys(s).length)return!1;for(const a in t)if(t[a]!==s[a])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(js.close,{},t)}_onError(t){this._on(js.error,{},s=>t(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Kt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const s={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(s.new=$l(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(s.old=$l(t.columns,t.old_record)),s}}const pn=()=>{},ha={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},dp=[1e3,2e3,5e3,1e4],up=1e4,pp=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class mp{constructor(t,s){var a;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=On,this.transport=null,this.heartbeatIntervalMs=ha.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=pn,this.ref=0,this.reconnectTimer=null,this.logger=pn,this.conn=null,this.sendBuffer=[],this.serializer=new rp,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>{let l;return n?l=n:typeof fetch>"u"?l=(...i)=>Pt(()=>Promise.resolve().then(()=>Fr),void 0).then(({default:o})=>o(...i)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):l=fetch,(...i)=>l(...i)},!(!((a=s==null?void 0:s.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${t}/${Bn.websocket}`,this.httpEndpoint=po(t),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s==null?void 0:s.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Yu.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const s=t.message;throw s.includes("Node.js")?new Error(`${s}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${s}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ep}))}disconnect(t,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},t?this.conn.close(t,s??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const s=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const t=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,s,a){this.logger(t,s,a)}connectionState(){switch(this.conn&&this.conn.readyState){case Vr.connecting:return er.Connecting;case Vr.open:return er.Open;case Vr.closing:return er.Closing;default:return er.Closed}}isConnected(){return this.connectionState()===er.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,s={config:{}}){const a=`realtime:${t}`,n=this.getChannels().find(l=>l.topic===a);if(n)return n;{const l=new dl(`realtime:${t}`,s,this);return this.channels.push(l),l}}push(t){const{topic:s,event:a,payload:n,ref:l}=t,i=()=>{this.encode(t,o=>{var c;(c=this.conn)===null||c===void 0||c.send(o)})};this.log("push",`${s} ${a} (${l})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(s){this.log("error","error in heartbeat callback",s)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(s){this.log("error","error in heartbeat callback",s)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(tp,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},ha.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(s){this.log("error","error in heartbeat callback",s)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let s=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${t}"`),s.unsubscribe())}_remove(t){this.channels=this.channels.filter(s=>s.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,s=>{if(s.topic==="phoenix"&&s.event==="phx_reply")try{this.heartbeatCallback(s.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}s.ref&&s.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:n,payload:l,ref:i}=s,o=i?`(${i})`:"",c=l.status||"";this.log("receive",`${c} ${a} ${n} ${o}`.trim(),l),this.channels.filter(d=>d._isMember(a)).forEach(d=>d._trigger(n,l,i)),this._triggerStateCallbacks("message",s)})}_clearTimer(t){var s;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var s;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(js.error))}_appendParams(t,s){if(Object.keys(s).length===0)return t;const a=t.match(/\?/)?"&":"?",n=new URLSearchParams(s);return`${t}${a}${n}`}_workerObjectUrl(t){let s;if(t)s=t;else{const a=new Blob([pp],{type:"application/javascript"});s=URL.createObjectURL(a)}return s}_setConnectionState(t,s=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=s)}async _performAuth(t=null){let s;t?s=t:this.accessToken?s=await this.accessToken():s=this.accessTokenValue,this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(a=>{const n={access_token:s,version:Zu};s&&a.updateJoinPayload(n),a.joinedOnce&&a._isJoined()&&a._push(js.access_token,{access_token:s})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(s=>{this.log("error",`error setting auth in ${t}`,s)})}_triggerStateCallbacks(t,s){try{this.stateChangeCallbacks[t].forEach(a=>{try{a(s)}catch(n){this.log("error",`error in ${t} callback`,n)}})}catch(a){this.log("error",`error triggering ${t} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new co(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ha.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var s,a,n,l,i,o,c,d,u;if(this.transport=(s=t==null?void 0:t.transport)!==null&&s!==void 0?s:null,this.timeout=(a=t==null?void 0:t.timeout)!==null&&a!==void 0?a:On,this.heartbeatIntervalMs=(n=t==null?void 0:t.heartbeatIntervalMs)!==null&&n!==void 0?n:ha.HEARTBEAT_INTERVAL,this.worker=(l=t==null?void 0:t.worker)!==null&&l!==void 0?l:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:pn,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:h=>dp[h-1]||up,this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(h,g)=>g(JSON.stringify(h)),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class ul extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Vt(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class hp extends ul{constructor(t,s,a){super(t),this.name="StorageApiError",this.status=s,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Un extends ul{constructor(t,s){super(t),this.name="StorageUnknownError",this.originalError=s}}var xp=globalThis&&globalThis.__awaiter||function(r,t,s,a){function n(l){return l instanceof s?l:new s(function(i){i(l)})}return new(s||(s=Promise))(function(l,i){function o(u){try{d(a.next(u))}catch(h){i(h)}}function c(u){try{d(a.throw(u))}catch(h){i(h)}}function d(u){u.done?l(u.value):n(u.value).then(o,c)}d((a=a.apply(r,t||[])).next())})};const mo=r=>{let t;return r?t=r:typeof fetch>"u"?t=(...s)=>Pt(()=>Promise.resolve().then(()=>Fr),void 0).then(({default:a})=>a(...s)):t=fetch,(...s)=>t(...s)},fp=()=>xp(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Pt(()=>Promise.resolve().then(()=>Fr),void 0)).Response:Response}),Wn=r=>{if(Array.isArray(r))return r.map(s=>Wn(s));if(typeof r=="function"||r!==Object(r))return r;const t={};return Object.entries(r).forEach(([s,a])=>{const n=s.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[n]=Wn(a)}),t},gp=r=>{if(typeof r!="object"||r===null)return!1;const t=Object.getPrototypeOf(r);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)};var cr=globalThis&&globalThis.__awaiter||function(r,t,s,a){function n(l){return l instanceof s?l:new s(function(i){i(l)})}return new(s||(s=Promise))(function(l,i){function o(u){try{d(a.next(u))}catch(h){i(h)}}function c(u){try{d(a.throw(u))}catch(h){i(h)}}function d(u){u.done?l(u.value):n(u.value).then(o,c)}d((a=a.apply(r,t||[])).next())})};const mn=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),bp=(r,t,s)=>cr(void 0,void 0,void 0,function*(){const a=yield fp();r instanceof a&&!(s!=null&&s.noResolveJson)?r.json().then(n=>{const l=r.status||500,i=(n==null?void 0:n.statusCode)||l+"";t(new hp(mn(n),l,i))}).catch(n=>{t(new Un(mn(n),n))}):t(new Un(mn(r),r))}),vp=(r,t,s,a)=>{const n={method:r,headers:(t==null?void 0:t.headers)||{}};return r==="GET"||!a?n:(gp(a)?(n.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n.body=JSON.stringify(a)):n.body=a,t!=null&&t.duplex&&(n.duplex=t.duplex),Object.assign(Object.assign({},n),s))};function na(r,t,s,a,n,l){return cr(this,void 0,void 0,function*(){return new Promise((i,o)=>{r(s,vp(t,a,n,l)).then(c=>{if(!c.ok)throw c;return a!=null&&a.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>bp(c,o,a))})})}function La(r,t,s,a){return cr(this,void 0,void 0,function*(){return na(r,"GET",t,s,a)})}function Fs(r,t,s,a,n){return cr(this,void 0,void 0,function*(){return na(r,"POST",t,a,n,s)})}function qn(r,t,s,a,n){return cr(this,void 0,void 0,function*(){return na(r,"PUT",t,a,n,s)})}function yp(r,t,s,a){return cr(this,void 0,void 0,function*(){return na(r,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),a)})}function ho(r,t,s,a,n){return cr(this,void 0,void 0,function*(){return na(r,"DELETE",t,a,n,s)})}var wp=globalThis&&globalThis.__awaiter||function(r,t,s,a){function n(l){return l instanceof s?l:new s(function(i){i(l)})}return new(s||(s=Promise))(function(l,i){function o(u){try{d(a.next(u))}catch(h){i(h)}}function c(u){try{d(a.throw(u))}catch(h){i(h)}}function d(u){u.done?l(u.value):n(u.value).then(o,c)}d((a=a.apply(r,t||[])).next())})};class jp{constructor(t,s){this.downloadFn=t,this.shouldThrowOnError=s}then(t,s){return this.execute().then(t,s)}execute(){return wp(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Vt(t))return{data:null,error:t};throw t}})}}var Np=globalThis&&globalThis.__awaiter||function(r,t,s,a){function n(l){return l instanceof s?l:new s(function(i){i(l)})}return new(s||(s=Promise))(function(l,i){function o(u){try{d(a.next(u))}catch(h){i(h)}}function c(u){try{d(a.throw(u))}catch(h){i(h)}}function d(u){u.done?l(u.value):n(u.value).then(o,c)}d((a=a.apply(r,t||[])).next())})};class _p{constructor(t,s){this.downloadFn=t,this.shouldThrowOnError=s}asStream(){return new jp(this.downloadFn,this.shouldThrowOnError)}then(t,s){return this.execute().then(t,s)}execute(){return Np(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Vt(t))return{data:null,error:t};throw t}})}}var as=globalThis&&globalThis.__awaiter||function(r,t,s,a){function n(l){return l instanceof s?l:new s(function(i){i(l)})}return new(s||(s=Promise))(function(l,i){function o(u){try{d(a.next(u))}catch(h){i(h)}}function c(u){try{d(a.throw(u))}catch(h){i(h)}}function d(u){u.done?l(u.value):n(u.value).then(o,c)}d((a=a.apply(r,t||[])).next())})};const kp={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Xl={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Sp{constructor(t,s={},a,n){this.shouldThrowOnError=!1,this.url=t,this.headers=s,this.bucketId=a,this.fetch=mo(n)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,s,a,n){return as(this,void 0,void 0,function*(){try{let l;const i=Object.assign(Object.assign({},Xl),n);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&a instanceof Blob?(l=new FormData,l.append("cacheControl",i.cacheControl),c&&l.append("metadata",this.encodeMetadata(c)),l.append("",a)):typeof FormData<"u"&&a instanceof FormData?(l=a,l.append("cacheControl",i.cacheControl),c&&l.append("metadata",this.encodeMetadata(c))):(l=a,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,c&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),n!=null&&n.headers&&(o=Object.assign(Object.assign({},o),n.headers));const d=this._removeEmptyFolders(s),u=this._getFinalPath(d),h=yield(t=="PUT"?qn:Fs)(this.fetch,`${this.url}/object/${u}`,l,Object.assign({headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:d,id:h.Id,fullPath:h.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Vt(l))return{data:null,error:l};throw l}})}upload(t,s,a){return as(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,s,a)})}uploadToSignedUrl(t,s,a,n){return as(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(t),i=this._getFinalPath(l),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",s);try{let c;const d=Object.assign({upsert:Xl.upsert},n),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&a instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",a)):typeof FormData<"u"&&a instanceof FormData?(c=a,c.append("cacheControl",d.cacheControl)):(c=a,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const h=yield qn(this.fetch,o.toString(),c,{headers:u});return{data:{path:l,fullPath:h.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Vt(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,s){return as(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t);const n=Object.assign({},this.headers);s!=null&&s.upsert&&(n["x-upsert"]="true");const l=yield Fs(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:n}),i=new URL(this.url+l.url),o=i.searchParams.get("token");if(!o)throw new ul("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Vt(a))return{data:null,error:a};throw a}})}update(t,s,a){return as(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,s,a)})}move(t,s,a){return as(this,void 0,void 0,function*(){try{return{data:yield Fs(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:s,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vt(n))return{data:null,error:n};throw n}})}copy(t,s,a){return as(this,void 0,void 0,function*(){try{return{data:{path:(yield Fs(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:s,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vt(n))return{data:null,error:n};throw n}})}createSignedUrl(t,s,a){return as(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t),l=yield Fs(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:s},a!=null&&a.transform?{transform:a.transform}:{}),{headers:this.headers});const i=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${i}`)},{data:l,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vt(n))return{data:null,error:n};throw n}})}createSignedUrls(t,s,a){return as(this,void 0,void 0,function*(){try{const n=yield Fs(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:t},{headers:this.headers}),l=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return{data:n.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${l}`):null})),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vt(n))return{data:null,error:n};throw n}})}download(t,s){const n=typeof(s==null?void 0:s.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((s==null?void 0:s.transform)||{}),i=l?`?${l}`:"",o=this._getFinalPath(t),c=()=>La(this.fetch,`${this.url}/${n}/${o}${i}`,{headers:this.headers,noResolveJson:!0});return new _p(c,this.shouldThrowOnError)}info(t){return as(this,void 0,void 0,function*(){const s=this._getFinalPath(t);try{const a=yield La(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:Wn(a),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Vt(a))return{data:null,error:a};throw a}})}exists(t){return as(this,void 0,void 0,function*(){const s=this._getFinalPath(t);try{return yield yp(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Vt(a)&&a instanceof Un){const n=a.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:a}}throw a}})}getPublicUrl(t,s){const a=this._getFinalPath(t),n=[],l=s!=null&&s.download?`download=${s.download===!0?"":s.download}`:"";l!==""&&n.push(l);const o=typeof(s==null?void 0:s.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((s==null?void 0:s.transform)||{});c!==""&&n.push(c);let d=n.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${a}${d}`)}}}remove(t){return as(this,void 0,void 0,function*(){try{return{data:yield ho(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Vt(s))return{data:null,error:s};throw s}})}list(t,s,a){return as(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},kp),s),{prefix:t||""});return{data:yield Fs(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},a),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vt(n))return{data:null,error:n};throw n}})}listV2(t,s){return as(this,void 0,void 0,function*(){try{const a=Object.assign({},t);return{data:yield Fs(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,a,{headers:this.headers},s),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Vt(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const s=[];return t.width&&s.push(`width=${t.width}`),t.height&&s.push(`height=${t.height}`),t.resize&&s.push(`resize=${t.resize}`),t.format&&s.push(`format=${t.format}`),t.quality&&s.push(`quality=${t.quality}`),s.join("&")}}const Cp="2.74.0",Tp={"X-Client-Info":`storage-js/${Cp}`};var xr=globalThis&&globalThis.__awaiter||function(r,t,s,a){function n(l){return l instanceof s?l:new s(function(i){i(l)})}return new(s||(s=Promise))(function(l,i){function o(u){try{d(a.next(u))}catch(h){i(h)}}function c(u){try{d(a.throw(u))}catch(h){i(h)}}function d(u){u.done?l(u.value):n(u.value).then(o,c)}d((a=a.apply(r,t||[])).next())})};class Ep{constructor(t,s={},a,n){this.shouldThrowOnError=!1;const l=new URL(t);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Tp),s),this.fetch=mo(a)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return xr(this,void 0,void 0,function*(){try{return{data:yield La(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Vt(t))return{data:null,error:t};throw t}})}getBucket(t){return xr(this,void 0,void 0,function*(){try{return{data:yield La(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Vt(s))return{data:null,error:s};throw s}})}createBucket(t){return xr(this,arguments,void 0,function*(s,a={public:!1}){try{return{data:yield Fs(this.fetch,`${this.url}/bucket`,{id:s,name:s,type:a.type,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Vt(n))return{data:null,error:n};throw n}})}updateBucket(t,s){return xr(this,void 0,void 0,function*(){try{return{data:yield qn(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Vt(a))return{data:null,error:a};throw a}})}emptyBucket(t){return xr(this,void 0,void 0,function*(){try{return{data:yield Fs(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Vt(s))return{data:null,error:s};throw s}})}deleteBucket(t){return xr(this,void 0,void 0,function*(){try{return{data:yield ho(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Vt(s))return{data:null,error:s};throw s}})}}class Pp extends Ep{constructor(t,s={},a,n){super(t,s,a,n)}from(t){return new Sp(this.url,this.headers,t,this.fetch)}}const Ap="2.74.0";let Wr="";typeof Deno<"u"?Wr="deno":typeof document<"u"?Wr="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Wr="react-native":Wr="node";const Rp={"X-Client-Info":`supabase-js-${Wr}/${Ap}`},Fp={headers:Rp},Ip={schema:"public"},Lp={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Dp={};var Mp=globalThis&&globalThis.__awaiter||function(r,t,s,a){function n(l){return l instanceof s?l:new s(function(i){i(l)})}return new(s||(s=Promise))(function(l,i){function o(u){try{d(a.next(u))}catch(h){i(h)}}function c(u){try{d(a.throw(u))}catch(h){i(h)}}function d(u){u.done?l(u.value):n(u.value).then(o,c)}d((a=a.apply(r,t||[])).next())})};const $p=r=>{let t;return r?t=r:typeof fetch>"u"?t=Qi:t=fetch,(...s)=>t(...s)},Op=()=>typeof Headers>"u"?Zi:Headers,Bp=(r,t,s)=>{const a=$p(s),n=Op();return(l,i)=>Mp(void 0,void 0,void 0,function*(){var o;const c=(o=yield t())!==null&&o!==void 0?o:r;let d=new n(i==null?void 0:i.headers);return d.has("apikey")||d.set("apikey",r),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),a(l,Object.assign(Object.assign({},i),{headers:d}))})};var Xp=globalThis&&globalThis.__awaiter||function(r,t,s,a){function n(l){return l instanceof s?l:new s(function(i){i(l)})}return new(s||(s=Promise))(function(l,i){function o(u){try{d(a.next(u))}catch(h){i(h)}}function c(u){try{d(a.throw(u))}catch(h){i(h)}}function d(u){u.done?l(u.value):n(u.value).then(o,c)}d((a=a.apply(r,t||[])).next())})};function Up(r){return r.endsWith("/")?r:r+"/"}function Wp(r,t){var s,a;const{db:n,auth:l,realtime:i,global:o}=r,{db:c,auth:d,realtime:u,global:h}=t,g={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},d),l),realtime:Object.assign(Object.assign({},u),i),storage:{},global:Object.assign(Object.assign(Object.assign({},h),o),{headers:Object.assign(Object.assign({},(s=h==null?void 0:h.headers)!==null&&s!==void 0?s:{}),(a=o==null?void 0:o.headers)!==null&&a!==void 0?a:{})}),accessToken:()=>Xp(this,void 0,void 0,function*(){return""})};return r.accessToken?g.accessToken=r.accessToken:delete g.accessToken,g}function qp(r){const t=r==null?void 0:r.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Up(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const xo="2.74.0",Sr=30*1e3,Hn=3,hn=Hn*Sr,Hp="http://localhost:9999",Vp="supabase.auth.token",zp={"X-Client-Info":`gotrue-js/${xo}`},Vn="X-Supabase-Api-Version",fo={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Kp=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Gp=10*60*1e3;class ea extends Error{constructor(t,s,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=a}}function ct(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class Jp extends ea{constructor(t,s,a){super(t,s,a),this.name="AuthApiError",this.status=s,this.code=a}}function Yp(r){return ct(r)&&r.name==="AuthApiError"}class tr extends ea{constructor(t,s){super(t),this.name="AuthUnknownError",this.originalError=s}}class Gs extends ea{constructor(t,s,a,n){super(t,a,n),this.name=s,this.status=a}}class qs extends Gs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Qp(r){return ct(r)&&r.name==="AuthSessionMissingError"}class fr extends Gs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class xa extends Gs{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class fa extends Gs{constructor(t,s=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Zp(r){return ct(r)&&r.name==="AuthImplicitGrantRedirectError"}class Ul extends Gs{constructor(t,s=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class zn extends Gs{constructor(t,s){super(t,"AuthRetryableFetchError",s,void 0)}}function xn(r){return ct(r)&&r.name==="AuthRetryableFetchError"}class Wl extends Gs{constructor(t,s,a){super(t,"AuthWeakPasswordError",s,"weak_password"),this.reasons=a}}class Kn extends Gs{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Da="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ql=` 	
\r=`.split(""),em=(()=>{const r=new Array(128);for(let t=0;t<r.length;t+=1)r[t]=-1;for(let t=0;t<ql.length;t+=1)r[ql[t].charCodeAt(0)]=-2;for(let t=0;t<Da.length;t+=1)r[Da[t].charCodeAt(0)]=t;return r})();function Hl(r,t,s){if(r!==null)for(t.queue=t.queue<<8|r,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;s(Da[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;s(Da[a]),t.queuedBits-=6}}function go(r,t,s){const a=em[r];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)s(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function Vl(r){const t=[],s=i=>{t.push(String.fromCodePoint(i))},a={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},l=i=>{rm(i,a,s)};for(let i=0;i<r.length;i+=1)go(r.charCodeAt(i),n,l);return t.join("")}function tm(r,t){if(r<=127){t(r);return}else if(r<=2047){t(192|r>>6),t(128|r&63);return}else if(r<=65535){t(224|r>>12),t(128|r>>6&63),t(128|r&63);return}else if(r<=1114111){t(240|r>>18),t(128|r>>12&63),t(128|r>>6&63),t(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function sm(r,t){for(let s=0;s<r.length;s+=1){let a=r.charCodeAt(s);if(a>55295&&a<=56319){const n=(a-55296)*1024&65535;a=(r.charCodeAt(s+1)-56320&65535|n)+65536,s+=1}tm(a,t)}}function rm(r,t,s){if(t.utf8seq===0){if(r<=127){s(r);return}for(let a=1;a<6;a+=1)if(!(r>>7-a&1)){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=r&31;else if(t.utf8seq===3)t.codepoint=r&15;else if(t.utf8seq===4)t.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|r&63,t.utf8seq-=1,t.utf8seq===0&&s(t.codepoint)}}function Tr(r){const t=[],s={queue:0,queuedBits:0},a=n=>{t.push(n)};for(let n=0;n<r.length;n+=1)go(r.charCodeAt(n),s,a);return new Uint8Array(t)}function am(r){const t=[];return sm(r,s=>t.push(s)),new Uint8Array(t)}function rr(r){const t=[],s={queue:0,queuedBits:0},a=n=>{t.push(n)};return r.forEach(n=>Hl(n,s,a)),Hl(null,s,a),t.join("")}function nm(r){return Math.round(Date.now()/1e3)+r}function lm(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const t=Math.random()*16|0;return(r=="x"?t:t&3|8).toString(16)})}const os=()=>typeof window<"u"&&typeof document<"u",Js={tested:!1,writable:!1},bo=()=>{if(!os())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Js.tested)return Js.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Js.tested=!0,Js.writable=!0}catch{Js.tested=!0,Js.writable=!1}return Js.writable};function im(r){const t={},s=new URL(r);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((n,l)=>{t[l]=n})}catch{}return s.searchParams.forEach((a,n)=>{t[n]=a}),t}const vo=r=>{let t;return r?t=r:typeof fetch>"u"?t=(...s)=>Pt(()=>Promise.resolve().then(()=>Fr),void 0).then(({default:a})=>a(...s)):t=fetch,(...s)=>t(...s)},om=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",Cr=async(r,t,s)=>{await r.setItem(t,JSON.stringify(s))},Ys=async(r,t)=>{const s=await r.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch{return s}},Xs=async(r,t)=>{await r.removeItem(t)};class sn{constructor(){this.promise=new sn.promiseConstructor((t,s)=>{this.resolve=t,this.reject=s})}}sn.promiseConstructor=Promise;function fn(r){const t=r.split(".");if(t.length!==3)throw new Kn("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!Kp.test(t[a]))throw new Kn("JWT not in base64url format");return{header:JSON.parse(Vl(t[0])),payload:JSON.parse(Vl(t[1])),signature:Tr(t[2]),raw:{header:t[0],payload:t[1]}}}async function cm(r){return await new Promise(t=>{setTimeout(()=>t(null),r)})}function dm(r,t){return new Promise((a,n)=>{(async()=>{for(let l=0;l<1/0;l++)try{const i=await r(l);if(!t(l,null,i)){a(i);return}}catch(i){if(!t(l,i)){n(i);return}}})()})}function um(r){return("0"+r.toString(16)).substr(-2)}function pm(){const t=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=s.length;let n="";for(let l=0;l<56;l++)n+=s.charAt(Math.floor(Math.random()*a));return n}return crypto.getRandomValues(t),Array.from(t,um).join("")}async function mm(r){const s=new TextEncoder().encode(r),a=await crypto.subtle.digest("SHA-256",s),n=new Uint8Array(a);return Array.from(n).map(l=>String.fromCharCode(l)).join("")}async function hm(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return r;const s=await mm(r);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function gr(r,t,s=!1){const a=pm();let n=a;s&&(n+="/PASSWORD_RECOVERY"),await Cr(r,`${t}-code-verifier`,n);const l=await hm(a);return[l,a===l?"plain":"s256"]}const xm=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function fm(r){const t=r.headers.get(Vn);if(!t||!t.match(xm))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function gm(r){if(!r)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(r<=t)throw new Error("JWT has expired")}function bm(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const vm=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function br(r){if(!vm.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function gn(){const r={};return new Proxy(r,{get:(t,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const a=s.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function zl(r){return JSON.parse(JSON.stringify(r))}var ym=globalThis&&globalThis.__rest||function(r,t){var s={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&t.indexOf(a)<0&&(s[a]=r[a]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(r);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(r,a[n])&&(s[a[n]]=r[a[n]]);return s};const Zs=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),wm=[502,503,504];async function Kl(r){var t;if(!om(r))throw new zn(Zs(r),0);if(wm.includes(r.status))throw new zn(Zs(r),r.status);let s;try{s=await r.json()}catch(l){throw new tr(Zs(l),l)}let a;const n=fm(r);if(n&&n.getTime()>=fo["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?a=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(a=s.error_code),a){if(a==="weak_password")throw new Wl(Zs(s),r.status,((t=s.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new qs}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((l,i)=>l&&typeof i=="string",!0))throw new Wl(Zs(s),r.status,s.weak_password.reasons);throw new Jp(Zs(s),r.status||500,a)}const jm=(r,t,s,a)=>{const n={method:r,headers:(t==null?void 0:t.headers)||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),n.body=JSON.stringify(a),Object.assign(Object.assign({},n),s))};async function ht(r,t,s,a){var n;const l=Object.assign({},a==null?void 0:a.headers);l[Vn]||(l[Vn]=fo["2024-01-01"].name),a!=null&&a.jwt&&(l.Authorization=`Bearer ${a.jwt}`);const i=(n=a==null?void 0:a.query)!==null&&n!==void 0?n:{};a!=null&&a.redirectTo&&(i.redirect_to=a.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await Nm(r,t,s+o,{headers:l,noResolveJson:a==null?void 0:a.noResolveJson},{},a==null?void 0:a.body);return a!=null&&a.xform?a==null?void 0:a.xform(c):{data:Object.assign({},c),error:null}}async function Nm(r,t,s,a,n,l){const i=jm(t,a,n,l);let o;try{o=await r(s,Object.assign({},i))}catch(c){throw new zn(Zs(c),0)}if(o.ok||await Kl(o),a!=null&&a.noResolveJson)return o;try{return await o.json()}catch(c){await Kl(c)}}function ws(r){var t;let s=null;Sm(r)&&(s=Object.assign({},r),r.expires_at||(s.expires_at=nm(r.expires_in)));const a=(t=r.user)!==null&&t!==void 0?t:r;return{data:{session:s,user:a},error:null}}function Gl(r){const t=ws(r);return!t.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0)&&(t.data.weak_password=r.weak_password),t}function zs(r){var t;return{data:{user:(t=r.user)!==null&&t!==void 0?t:r},error:null}}function _m(r){return{data:r,error:null}}function km(r){const{action_link:t,email_otp:s,hashed_token:a,redirect_to:n,verification_type:l}=r,i=ym(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:s,hashed_token:a,redirect_to:n,verification_type:l},c=Object.assign({},i);return{data:{properties:o,user:c},error:null}}function Jl(r){return r}function Sm(r){return r.access_token&&r.refresh_token&&r.expires_in}const bn=["global","local","others"];var Cm=globalThis&&globalThis.__rest||function(r,t){var s={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&t.indexOf(a)<0&&(s[a]=r[a]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(r);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(r,a[n])&&(s[a[n]]=r[a[n]]);return s};class Tm{constructor({url:t="",headers:s={},fetch:a}){this.url=t,this.headers=s,this.fetch=vo(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,s=bn[0]){if(bn.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${bn.join(", ")}`);try{return await ht(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(ct(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,s={}){try{return await ht(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:zs})}catch(a){if(ct(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:s}=t,a=Cm(t,["options"]),n=Object.assign(Object.assign({},a),s);return"newEmail"in a&&(n.new_email=a==null?void 0:a.newEmail,delete n.newEmail),await ht(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:km,redirectTo:s==null?void 0:s.redirectTo})}catch(s){if(ct(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(t){try{return await ht(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:zs})}catch(s){if(ct(s))return{data:{user:null},error:s};throw s}}async listUsers(t){var s,a,n,l,i,o,c;try{const d={nextPage:null,lastPage:0,total:0},u=await ht(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(s=t==null?void 0:t.page)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:"",per_page:(l=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&l!==void 0?l:""},xform:Jl});if(u.error)throw u.error;const h=await u.json(),g=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,y=(c=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return y.length>0&&(y.forEach(f=>{const w=parseInt(f.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(f.split(";")[1].split("=")[1]);d[`${b}Page`]=w}),d.total=parseInt(g)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(ct(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){br(t);try{return await ht(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:zs})}catch(s){if(ct(s))return{data:{user:null},error:s};throw s}}async updateUserById(t,s){br(t);try{return await ht(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:s,headers:this.headers,xform:zs})}catch(a){if(ct(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,s=!1){br(t);try{return await ht(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:s},xform:zs})}catch(a){if(ct(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){br(t.userId);try{const{data:s,error:a}=await ht(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:s,error:a}}catch(s){if(ct(s))return{data:null,error:s};throw s}}async _deleteFactor(t){br(t.userId),br(t.id);try{return{data:await ht(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(s){if(ct(s))return{data:null,error:s};throw s}}async _listOAuthClients(t){var s,a,n,l,i,o,c;try{const d={nextPage:null,lastPage:0,total:0},u=await ht(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(s=t==null?void 0:t.page)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:"",per_page:(l=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&l!==void 0?l:""},xform:Jl});if(u.error)throw u.error;const h=await u.json(),g=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,y=(c=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return y.length>0&&(y.forEach(f=>{const w=parseInt(f.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(f.split(";")[1].split("=")[1]);d[`${b}Page`]=w}),d.total=parseInt(g)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(ct(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(t){try{return await ht(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(ct(s))return{data:null,error:s};throw s}}async _getOAuthClient(t){try{return await ht(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(ct(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(t){try{return await ht(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(ct(s))return{data:null,error:s};throw s}}async _regenerateOAuthClientSecret(t){try{return await ht(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(ct(s))return{data:null,error:s};throw s}}}function Yl(r={}){return{getItem:t=>r[t]||null,setItem:(t,s)=>{r[t]=s},removeItem:t=>{delete r[t]}}}const vr={debug:!!(globalThis&&bo()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class yo extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Em extends yo{}async function Pm(r,t,s){vr.debug;const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),vr.debug},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async n=>{if(n){vr.debug;try{return await s()}finally{vr.debug}}else{if(t===0)throw vr.debug,new Em(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(vr.debug)try{const l=await globalThis.navigator.locks.query()}catch{}return await s()}}))}function Am(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function wo(r){if(!/^0x[a-fA-F0-9]{40}$/.test(r))throw new Error(`@supabase/auth-js: Address "${r}" is invalid.`);return r.toLowerCase()}function Rm(r){return parseInt(r,16)}function Fm(r){const t=new TextEncoder().encode(r);return"0x"+Array.from(t,a=>a.toString(16).padStart(2,"0")).join("")}function Im(r){var t;const{chainId:s,domain:a,expirationTime:n,issuedAt:l=new Date,nonce:i,notBefore:o,requestId:c,resources:d,scheme:u,uri:h,version:g}=r;{if(!Number.isInteger(s))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${s}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(g!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${g}`);if(!((t=r.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${r.statement}`)}const y=wo(r.address),f=u?`${u}://${a}`:a,w=r.statement?`${r.statement}
`:"",b=`${f} wants you to sign in with your Ethereum account:
${y}

${w}`;let P=`URI: ${h}
Version: ${g}
Chain ID: ${s}${i?`
Nonce: ${i}`:""}
Issued At: ${l.toISOString()}`;if(n&&(P+=`
Expiration Time: ${n.toISOString()}`),o&&(P+=`
Not Before: ${o.toISOString()}`),c&&(P+=`
Request ID: ${c}`),d){let A=`
Resources:`;for(const _ of d){if(!_||typeof _!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${_}`);A+=`
- ${_}`}P+=A}return`${b}
${P}`}class Ht extends Error{constructor({message:t,code:s,cause:a,name:n}){var l;super(t,{cause:a}),this.__isWebAuthnError=!0,this.name=(l=n??(a instanceof Error?a.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=s}}class Ma extends Ht{constructor(t,s){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s,message:t}),this.name="WebAuthnUnknownError",this.originalError=s}}function Lm({error:r,options:t}){var s,a,n;const{publicKey:l}=t;if(!l)throw Error("options was missing required publicKey property");if(r.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Ht({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:r})}else if(r.name==="ConstraintError"){if(((s=l.authenticatorSelection)===null||s===void 0?void 0:s.requireResidentKey)===!0)return new Ht({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:r});if(t.mediation==="conditional"&&((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Ht({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:r});if(((n=l.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Ht({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:r})}else{if(r.name==="InvalidStateError")return new Ht({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:r});if(r.name==="NotAllowedError")return new Ht({message:r.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r});if(r.name==="NotSupportedError")return l.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new Ht({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:r}):new Ht({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:r});if(r.name==="SecurityError"){const i=window.location.hostname;if(No(i)){if(l.rp.id!==i)return new Ht({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:r})}else return new Ht({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:r})}else if(r.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new Ht({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:r})}else if(r.name==="UnknownError")return new Ht({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:r})}return new Ht({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r})}function Dm({error:r,options:t}){const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(r.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Ht({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:r})}else{if(r.name==="NotAllowedError")return new Ht({message:r.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r});if(r.name==="SecurityError"){const a=window.location.hostname;if(No(a)){if(s.rpId!==a)return new Ht({message:`The RP ID "${s.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:r})}else return new Ht({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:r})}else if(r.name==="UnknownError")return new Ht({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:r})}return new Ht({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r})}var jo=globalThis&&globalThis.__rest||function(r,t){var s={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&t.indexOf(a)<0&&(s[a]=r[a]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(r);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(r,a[n])&&(s[a[n]]=r[a[n]]);return s};class Mm{createNewAbortSignal(){if(this.controller){const s=new Error("Cancelling existing WebAuthn API call for new one");s.name="AbortError",this.controller.abort(s)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const $m=new Mm;function Om(r){if(!r)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(r);const{challenge:t,user:s,excludeCredentials:a}=r,n=jo(r,["challenge","user","excludeCredentials"]),l=Tr(t).buffer,i=Object.assign(Object.assign({},s),{id:Tr(s.id).buffer}),o=Object.assign(Object.assign({},n),{challenge:l,user:i});if(a&&a.length>0){o.excludeCredentials=new Array(a.length);for(let c=0;c<a.length;c++){const d=a[c];o.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:Tr(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return o}function Bm(r){if(!r)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(r);const{challenge:t,allowCredentials:s}=r,a=jo(r,["challenge","allowCredentials"]),n=Tr(t).buffer,l=Object.assign(Object.assign({},a),{challenge:n});if(s&&s.length>0){l.allowCredentials=new Array(s.length);for(let i=0;i<s.length;i++){const o=s[i];l.allowCredentials[i]=Object.assign(Object.assign({},o),{id:Tr(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return l}function Xm(r){var t;if("toJSON"in r&&typeof r.toJSON=="function")return r.toJSON();const s=r;return{id:r.id,rawId:r.id,response:{attestationObject:rr(new Uint8Array(r.response.attestationObject)),clientDataJSON:rr(new Uint8Array(r.response.clientDataJSON))},type:"public-key",clientExtensionResults:r.getClientExtensionResults(),authenticatorAttachment:(t=s.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Um(r){var t;if("toJSON"in r&&typeof r.toJSON=="function")return r.toJSON();const s=r,a=r.getClientExtensionResults(),n=r.response;return{id:r.id,rawId:r.id,response:{authenticatorData:rr(new Uint8Array(n.authenticatorData)),clientDataJSON:rr(new Uint8Array(n.clientDataJSON)),signature:rr(new Uint8Array(n.signature)),userHandle:n.userHandle?rr(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(t=s.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function No(r){return r==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(r)}function Ql(){var r,t;return!!(os()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((r=navigator==null?void 0:navigator.credentials)===null||r===void 0?void 0:r.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function Wm(r){try{const t=await navigator.credentials.create(r);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ma("Browser returned unexpected credential type",t)}:{data:null,error:new Ma("Empty credential response",t)}}catch(t){return{data:null,error:Lm({error:t,options:r})}}}async function qm(r){try{const t=await navigator.credentials.get(r);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ma("Browser returned unexpected credential type",t)}:{data:null,error:new Ma("Empty credential response",t)}}catch(t){return{data:null,error:Dm({error:t,options:r})}}}const Hm={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},Vm={userVerification:"preferred",hints:["security-key"]};function $a(...r){const t=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),s=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),a={};for(const n of r)if(n)for(const l in n){const i=n[l];if(i!==void 0)if(Array.isArray(i))a[l]=i;else if(s(i))a[l]=i;else if(t(i)){const o=a[l];t(o)?a[l]=$a(o,i):a[l]=$a(i)}else a[l]=i}return a}function zm(r,t){return $a(Hm,r,t||{})}function Km(r,t){return $a(Vm,r,t||{})}class Gm{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:s,friendlyName:a,signal:n},l){try{const{data:i,error:o}=await this.client.mfa.challenge({factorId:t,webauthn:s});if(!i)return{data:null,error:o};const c=n??$m.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:d}=i.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${a}`),d.displayName||(d.displayName=d.name)}switch(i.webauthn.type){case"create":{const d=zm(i.webauthn.credential_options.publicKey,l==null?void 0:l.create),{data:u,error:h}=await Wm({publicKey:d,signal:c});return u?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}case"request":{const d=Km(i.webauthn.credential_options.publicKey,l==null?void 0:l.request),{data:u,error:h}=await qm(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:d,signal:c}));return u?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}}}catch(i){return ct(i)?{data:null,error:i}:{data:null,error:new tr("Unexpected error in challenge",i)}}}async _verify({challengeId:t,factorId:s,webauthn:a}){return this.client.mfa.verify({factorId:s,challengeId:t,webauthn:a})}async _authenticate({factorId:t,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}},l){if(!s)return{data:null,error:new ea("rpId is required for WebAuthn authentication")};try{if(!Ql())return{data:null,error:new tr("Browser does not support WebAuthn",null)};const{data:i,error:o}=await this.challenge({factorId:t,webauthn:{rpId:s,rpOrigins:a},signal:n},{request:l});if(!i)return{data:null,error:o};const{webauthn:c}=i;return this._verify({factorId:t,challengeId:i.challengeId,webauthn:{type:c.type,rpId:s,rpOrigins:a,credential_response:c.credential_response}})}catch(i){return ct(i)?{data:null,error:i}:{data:null,error:new tr("Unexpected error in authenticate",i)}}}async _register({friendlyName:t,rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n},l){if(!s)return{data:null,error:new ea("rpId is required for WebAuthn registration")};try{if(!Ql())return{data:null,error:new tr("Browser does not support WebAuthn",null)};const{data:i,error:o}=await this._enroll({friendlyName:t});if(!i)return await this.client.mfa.listFactors().then(u=>{var h;return(h=u.data)===null||h===void 0?void 0:h.all.find(g=>g.factor_type==="webauthn"&&g.friendly_name===t&&g.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:o};const{data:c,error:d}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:s,rpOrigins:a},signal:n},{create:l});return c?this._verify({factorId:i.id,challengeId:c.challengeId,webauthn:{rpId:s,rpOrigins:a,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(i){return ct(i)?{data:null,error:i}:{data:null,error:new tr("Unexpected error in register",i)}}}}Am();const Jm={url:Hp,storageKey:Vp,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:zp,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Zl(r,t,s){return await s()}const yr={};class ta{get jwks(){var t,s;return(s=(t=yr[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(t){yr[this.storageKey]=Object.assign(Object.assign({},yr[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,s;return(s=(t=yr[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){yr[this.storageKey]=Object.assign(Object.assign({},yr[this.storageKey]),{cachedAt:t})}constructor(t){var s,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ta.nextInstanceID,ta.nextInstanceID+=1,this.instanceID>0&&os();const n=Object.assign(Object.assign({},Jm),t);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Tm({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=vo(n.fetch),this.lock=n.lock||Zl,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:os()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=Pm:this.lock=Zl,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Gm(this)},this.persistSession?(n.storage?this.storage=n.storage:bo()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Yl(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=Yl(this.memoryStorage)),os()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch{}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${xo}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const s=im(window.location.href);let a="none";if(this._isImplicitGrantCallback(s)?a="implicit":await this._isPKCECallback(s)&&(a="pkce"),os()&&this.detectSessionInUrl&&a!=="none"){const{data:n,error:l}=await this._getSessionFromURL(s,a);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),Zp(l)){const c=(t=l.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:i,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return ct(s)?{error:s}:{error:new tr("Unexpected error during initialization",s)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var s,a,n;try{const l=await ht(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.captchaToken}},xform:ws}),{data:i,error:o}=l;if(o||!i)return{data:{user:null,session:null},error:o};const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(l){if(ct(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(t){var s,a,n;try{let l;if("email"in t){const{email:u,password:h,options:g}=t;let y=null,f=null;this.flowType==="pkce"&&([y,f]=await gr(this.storage,this.storageKey)),l=await ht(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:g==null?void 0:g.emailRedirectTo,body:{email:u,password:h,data:(s=g==null?void 0:g.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:y,code_challenge_method:f},xform:ws})}else if("phone"in t){const{phone:u,password:h,options:g}=t;l=await ht(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(a=g==null?void 0:g.data)!==null&&a!==void 0?a:{},channel:(n=g==null?void 0:g.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken}},xform:ws})}else throw new xa("You must provide either an email or phone number and a password");const{data:i,error:o}=l;if(o||!i)return{data:{user:null,session:null},error:o};const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(l){if(ct(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(t){try{let s;if("email"in t){const{email:l,password:i,options:o}=t;s=await ht(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Gl})}else if("phone"in t){const{phone:l,password:i,options:o}=t;s=await ht(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Gl})}else throw new xa("You must provide either an email or phone number and a password");const{data:a,error:n}=s;return n?{data:{user:null,session:null},error:n}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new fr}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:n})}catch(s){if(ct(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOAuth(t){var s,a,n,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(n=t.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:s}=t;switch(s){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}}async signInWithEthereum(t){var s,a,n,l,i,o,c,d,u,h,g;let y,f;if("message"in t)y=t.message,f=t.signature;else{const{chain:w,wallet:b,statement:P,options:A}=t;let _;if(os())if(typeof b=="object")_=b;else{const _e=window;if("ethereum"in _e&&typeof _e.ethereum=="object"&&"request"in _e.ethereum&&typeof _e.ethereum.request=="function")_=_e.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(A!=null&&A.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=b}const W=new URL((s=A==null?void 0:A.url)!==null&&s!==void 0?s:window.location.href),D=await _.request({method:"eth_requestAccounts"}).then(_e=>_e).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!D||D.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const I=wo(D[0]);let E=(a=A==null?void 0:A.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!E){const _e=await _.request({method:"eth_chainId"});E=Rm(_e)}const G={domain:W.host,address:I,statement:P,uri:W.href,version:"1",chainId:E,nonce:(n=A==null?void 0:A.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(i=(l=A==null?void 0:A.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(o=A==null?void 0:A.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(c=A==null?void 0:A.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=A==null?void 0:A.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=A==null?void 0:A.signInWithEthereum)===null||u===void 0?void 0:u.resources};y=Im(G),f=await _.request({method:"personal_sign",params:[Fm(y),I]})}try{const{data:w,error:b}=await ht(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:y,signature:f},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(g=t.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:ws});if(b)throw b;return!w||!w.session||!w.user?{data:{user:null,session:null},error:new fr}:(w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),{data:Object.assign({},w),error:b})}catch(w){if(ct(w))return{data:{user:null,session:null},error:w};throw w}}async signInWithSolana(t){var s,a,n,l,i,o,c,d,u,h,g,y;let f,w;if("message"in t)f=t.message,w=t.signature;else{const{chain:b,wallet:P,statement:A,options:_}=t;let W;if(os())if(typeof P=="object")W=P;else{const I=window;if("solana"in I&&typeof I.solana=="object"&&("signIn"in I.solana&&typeof I.solana.signIn=="function"||"signMessage"in I.solana&&typeof I.solana.signMessage=="function"))W=I.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof P!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");W=P}const D=new URL((s=_==null?void 0:_.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in W&&W.signIn){const I=await W.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_==null?void 0:_.signInWithSolana),{version:"1",domain:D.host,uri:D.href}),A?{statement:A}:null));let E;if(Array.isArray(I)&&I[0]&&typeof I[0]=="object")E=I[0];else if(I&&typeof I=="object"&&"signedMessage"in I&&"signature"in I)E=I;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in E&&"signature"in E&&(typeof E.signedMessage=="string"||E.signedMessage instanceof Uint8Array)&&E.signature instanceof Uint8Array)f=typeof E.signedMessage=="string"?E.signedMessage:new TextDecoder().decode(E.signedMessage),w=E.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in W)||typeof W.signMessage!="function"||!("publicKey"in W)||typeof W!="object"||!W.publicKey||!("toBase58"in W.publicKey)||typeof W.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");f=[`${D.host} wants you to sign in with your Solana account:`,W.publicKey.toBase58(),...A?["",A,""]:[""],"Version: 1",`URI: ${D.href}`,`Issued At: ${(n=(a=_==null?void 0:_.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((l=_==null?void 0:_.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((i=_==null?void 0:_.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((o=_==null?void 0:_.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((c=_==null?void 0:_.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((d=_==null?void 0:_.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((h=(u=_==null?void 0:_.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",..._.signInWithSolana.resources.map(E=>`- ${E}`)]:[]].join(`
`);const I=await W.signMessage(new TextEncoder().encode(f),"utf8");if(!I||!(I instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=I}}try{const{data:b,error:P}=await ht(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:f,signature:rr(w)},!((g=t.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(y=t.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:ws});if(P)throw P;return!b||!b.session||!b.user?{data:{user:null,session:null},error:new fr}:(b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),{data:Object.assign({},b),error:P})}catch(b){if(ct(b))return{data:{user:null,session:null},error:b};throw b}}async _exchangeCodeForSession(t){const s=await Ys(this.storage,`${this.storageKey}-code-verifier`),[a,n]=(s??"").split("/");try{const{data:l,error:i}=await ht(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:ws});if(await Xs(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new fr}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:n??null}),error:i})}catch(l){if(ct(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(t){try{const{options:s,provider:a,token:n,access_token:l,nonce:i}=t,o=await ht(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:n,access_token:l,nonce:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:ws}),{data:c,error:d}=o;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new fr}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(s){if(ct(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOtp(t){var s,a,n,l,i;try{if("email"in t){const{email:o,options:c}=t;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await gr(this.storage,this.storageKey));const{error:h}=await ht(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:o,options:c}=t,{data:d,error:u}=await ht(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(l=c==null?void 0:c.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new xa("You must provide either an email or phone number.")}catch(o){if(ct(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var s,a;try{let n,l;"options"in t&&(n=(s=t.options)===null||s===void 0?void 0:s.redirectTo,l=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:i,error:o}=await ht(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:n,xform:ws});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,d=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(n){if(ct(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(t){var s,a,n;try{let l=null,i=null;return this.flowType==="pkce"&&([l,i]=await gr(this.storage,this.storageKey)),await ht(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(s=t.options)===null||s===void 0?void 0:s.redirectTo)!==null&&a!==void 0?a:void 0}),!((n=t==null?void 0:t.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:i}),headers:this.headers,xform:_m})}catch(l){if(ct(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:s},error:a}=t;if(a)throw a;if(!s)throw new qs;const{error:n}=await ht(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return{data:{user:null,session:null},error:n}})}catch(t){if(ct(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const s=`${this.url}/resend`;if("email"in t){const{email:a,type:n,options:l}=t,{error:i}=await ht(this.fetch,"POST",s,{headers:this.headers,body:{email:a,type:n,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:a,type:n,options:l}=t,{data:i,error:o}=await ht(this.fetch,"POST",s,{headers:this.headers,body:{phone:a,type:n,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new xa("You must provide either an email or phone number and a type")}catch(s){if(ct(s))return{data:{user:null,session:null},error:s};throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(t,s){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await a,await s()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=s();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await t(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const s=await Ys(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?t=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<hn:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){const i=await Ys(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=gn()}if(this.storage.isServer&&t.user){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,d,u)=>(!i&&d==="user"&&(i=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:t},error:null}}const{data:n,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{session:null},error:l}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await ht(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:zs}):await this._useSession(async s=>{var a,n,l;const{data:i,error:o}=s;if(o)throw o;return!(!((a=i.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new qs}:await ht(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&l!==void 0?l:void 0,xform:zs})})}catch(s){if(ct(s))return Qp(s)&&(await this._removeSession(),await Xs(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:s};throw s}}async updateUser(t,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,s))}async _updateUser(t,s={}){try{return await this._useSession(async a=>{const{data:n,error:l}=a;if(l)throw l;if(!n.session)throw new qs;const i=n.session;let o=null,c=null;this.flowType==="pkce"&&t.email!=null&&([o,c]=await gr(this.storage,this.storageKey));const{data:d,error:u}=await ht(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s==null?void 0:s.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:c}),jwt:i.access_token,xform:zs});if(u)throw u;return i.user=d.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(a){if(ct(a))return{data:{user:null},error:a};throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new qs;const s=Date.now()/1e3;let a=s,n=!0,l=null;const{payload:i}=fn(t.access_token);if(i.exp&&(a=i.exp,n=a<=s),n){const{data:o,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!o)return{data:{user:null,session:null},error:null};l=o}else{const{data:o,error:c}=await this._getUser(t.access_token);if(c)throw c;l={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:a-s,expires_at:a},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(s){if(ct(s))return{data:{session:null,user:null},error:s};throw s}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async s=>{var a;if(!t){const{data:i,error:o}=s;if(o)throw o;t=(a=i.session)!==null&&a!==void 0?a:void 0}if(!(t!=null&&t.refresh_token))throw new qs;const{data:n,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{user:null,session:null},error:l}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(s){if(ct(s))return{data:{user:null,session:null},error:s};throw s}}async _getSessionFromURL(t,s){try{if(!os())throw new fa("No browser detected.");if(t.error||t.error_description||t.error_code)throw new fa(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new Ul("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new fa("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Ul("No code detected.");const{data:A,error:_}=await this._exchangeCodeForSession(t.code);if(_)throw _;const W=new URL(window.location.href);return W.searchParams.delete("code"),window.history.replaceState(window.history.state,"",W.toString()),{data:{session:A.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:n,access_token:l,refresh_token:i,expires_in:o,expires_at:c,token_type:d}=t;if(!l||!o||!i||!d)throw new fa("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(o);let g=u+h;c&&(g=parseInt(c)),(g-u)*1e3<=Sr;const f=g-h;u-f>=120||u-f<0;const{data:w,error:b}=await this._getUser(l);if(b)throw b;const P={provider_token:a,provider_refresh_token:n,access_token:l,expires_in:h,expires_at:g,refresh_token:i,token_type:d,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:P,redirectType:t.type},error:null}}catch(a){if(ct(a))return{data:{session:null,redirectType:null},error:a};throw a}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const s=await Ys(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&s)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async s=>{var a;const{data:n,error:l}=s;if(l)return{error:l};const i=(a=n.session)===null||a===void 0?void 0:a.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(Yp(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await Xs(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const s=lm(),a={id:s,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async s=>{var a,n;try{const{data:{session:l},error:i}=s;if(i)throw i;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l)}})}async resetPasswordForEmail(t,s={}){let a=null,n=null;this.flowType==="pkce"&&([a,n]=await gr(this.storage,this.storageKey,!0));try{return await ht(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:n,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(l){if(ct(l))return{data:null,error:l};throw l}}async getUserIdentities(){var t;try{const{data:s,error:a}=await this.getUser();if(a)throw a;return{data:{identities:(t=s.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(s){if(ct(s))return{data:null,error:s};throw s}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var s;try{const{data:a,error:n}=await this._useSession(async l=>{var i,o,c,d,u;const{data:h,error:g}=l;if(g)throw g;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await ht(this.fetch,"GET",y,{headers:this.headers,jwt:(u=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return os()&&!(!((s=t.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(a==null?void 0:a.url),{data:{provider:t.provider,url:a==null?void 0:a.url},error:null}}catch(a){if(ct(a))return{data:{provider:t.provider,url:null},error:a};throw a}}async linkIdentityIdToken(t){return await this._useSession(async s=>{var a;try{const{error:n,data:{session:l}}=s;if(n)throw n;const{options:i,provider:o,token:c,access_token:d,nonce:u}=t,h=await ht(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=l==null?void 0:l.access_token)!==null&&a!==void 0?a:void 0,body:{provider:o,id_token:c,access_token:d,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:ws}),{data:g,error:y}=h;return y?{data:{user:null,session:null},error:y}:!g||!g.session||!g.user?{data:{user:null,session:null},error:new fr}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("USER_UPDATED",g.session)),{data:g,error:y})}catch(n){if(ct(n))return{data:{user:null,session:null},error:n};throw n}})}async unlinkIdentity(t){try{return await this._useSession(async s=>{var a,n;const{data:l,error:i}=s;if(i)throw i;return await ht(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(n=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&n!==void 0?n:void 0})})}catch(s){if(ct(s))return{data:null,error:s};throw s}}async _refreshAccessToken(t){const s=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{const a=Date.now();return await dm(async n=>(n>0&&await cm(200*Math.pow(2,n-1)),this._debug(s,"refreshing attempt",n),await ht(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ws})),(n,l)=>{const i=200*Math.pow(2,n);return l&&xn(l)&&Date.now()+i-a<Sr})}catch(a){if(this._debug(s,"error",a),ct(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(s,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,s){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",s,"url",a),os()&&!s.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t,s;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const n=await Ys(this.storage,this.storageKey);if(n&&this.userStorage){let i=await Ys(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:n.user},await Cr(this.userStorage,this.storageKey+"-user",i)),n.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:gn()}else if(n&&!n.user&&!n.user){const i=await Ys(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(n.user=i.user,await Xs(this.storage,this.storageKey+"-user"),await Cr(this.storage,this.storageKey,n)):n.user=gn()}if(this._debug(a,"session from storage",n),!this._isValidSession(n)){this._debug(a,"session is not valid"),n!==null&&await this._removeSession();return}const l=((s=n.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<hn;if(this._debug(a,`session has${l?"":" not"} expired with margin of ${hn}s`),l){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(xn(i)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(n.access_token);!o&&(i!=null&&i.user)?(n.user=i.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(i){this._debug(a,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(a,"error",n);return}finally{this._debug(a,"end")}}async _callRefreshToken(t){var s,a;if(!t)throw new qs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new sn;const{data:l,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!l.session)throw new qs;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const o={data:l.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(l){if(this._debug(n,"error",l),ct(l)){const i={data:null,error:l};return xn(l)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(i),i}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(l),l}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(t,s,a=!0){const n=`#_notifyAllSubscribers(${t})`;this._debug(n,"begin",s,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:s});const l=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,s)}catch(c){l.push(c)}});if(await Promise.all(i),l.length>0){for(let o=0;o<l.length;o+=1);throw l[0]}}finally{this._debug(n,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const s=Object.assign({},t),a=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&s.user&&await Cr(this.userStorage,this.storageKey+"-user",{user:s.user});const n=Object.assign({},s);delete n.user;const l=zl(n);await Cr(this.storage,this.storageKey,l)}else{const n=zl(s);await Cr(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await Xs(this.storage,this.storageKey),await Xs(this.storage,this.storageKey+"-code-verifier"),await Xs(this.storage,this.storageKey+"-user"),this.userStorage&&await Xs(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&os()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch{}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Sr);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async s=>{const{data:{session:a}}=s;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((a.expires_at*1e3-t)/Sr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Sr}ms, refresh threshold is ${Hn} ticks`),n<=Hn&&await this._callRefreshToken(a.refresh_token)})}catch{}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof yo)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!os()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch{}}async _onVisibilityChanged(t){const s=`#_onVisibilityChanged(${t})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,s,a){const n=[`provider=${encodeURIComponent(s)}`];if(a!=null&&a.redirectTo&&n.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a!=null&&a.scopes&&n.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[l,i]=await gr(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(o.toString())}if(a!=null&&a.queryParams){const l=new URLSearchParams(a.queryParams);n.push(l.toString())}return a!=null&&a.skipBrowserRedirect&&n.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${n.join("&")}`}async _unenroll(t){try{return await this._useSession(async s=>{var a;const{data:n,error:l}=s;return l?{data:null,error:l}:await ht(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token})})}catch(s){if(ct(s))return{data:null,error:s};throw s}}async _enroll(t){try{return await this._useSession(async s=>{var a,n;const{data:l,error:i}=s;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:d}=await ht(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(a=l==null?void 0:l.session)===null||a===void 0?void 0:a.access_token});return d?{data:null,error:d}:(t.factorType==="totp"&&c.type==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(s){if(ct(s))return{data:null,error:s};throw s}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var a;const{data:n,error:l}=s;if(l)return{data:null,error:l};const i=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?Xm(t.webauthn.credential_response):Um(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:c}=await ht(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:i,headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:c})})}catch(s){if(ct(s))return{data:null,error:s};throw s}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var a;const{data:n,error:l}=s;if(l)return{data:null,error:l};const i=await ht(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token});if(i.error)return i;const{data:o}=i;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:Om(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:Bm(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(s){if(ct(s))return{data:null,error:s};throw s}})}async _challengeAndVerify(t){const{data:s,error:a}=await this._challenge({factorId:t.factorId});return a?{data:null,error:a}:await this._verify({factorId:t.factorId,challengeId:s.id,code:t.code})}async _listFactors(){var t;const{data:{user:s},error:a}=await this.getUser();if(a)return{data:null,error:a};const n={all:[],phone:[],totp:[],webauthn:[]};for(const l of(t=s==null?void 0:s.factors)!==null&&t!==void 0?t:[])n.all.push(l),l.status==="verified"&&n[l.factor_type].push(l);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var s,a;const{data:{session:n},error:l}=t;if(l)return{data:null,error:l};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=fn(n.access_token);let o=null;i.aal&&(o=i.aal);let c=o;((a=(s=n.user.factors)===null||s===void 0?void 0:s.filter(h=>h.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(c="aal2");const u=i.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,s={keys:[]}){let a=s.keys.find(o=>o.kid===t);if(a)return a;const n=Date.now();if(a=this.jwks.keys.find(o=>o.kid===t),a&&this.jwks_cached_at+Gp>n)return a;const{data:l,error:i}=await ht(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=n,a=l.keys.find(o=>o.kid===t),!a)?null:a}async getClaims(t,s={}){try{let a=t;if(!a){const{data:y,error:f}=await this.getSession();if(f||!y.session)return{data:null,error:f};a=y.session.access_token}const{header:n,payload:l,signature:i,raw:{header:o,payload:c}}=fn(a);s!=null&&s.allowExpired||gm(l.exp);const d=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,s!=null&&s.keys?{keys:s.keys}:s==null?void 0:s.jwks);if(!d){const{error:y}=await this.getUser(a);if(y)throw y;return{data:{claims:l,header:n,signature:i},error:null}}const u=bm(n.alg),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,i,am(`${o}.${c}`)))throw new Kn("Invalid JWT signature");return{data:{claims:l,header:n,signature:i},error:null}}catch(a){if(ct(a))return{data:null,error:a};throw a}}}ta.nextInstanceID=0;const Ym=ta;class Qm extends Ym{constructor(t){super(t)}}var Zm=globalThis&&globalThis.__awaiter||function(r,t,s,a){function n(l){return l instanceof s?l:new s(function(i){i(l)})}return new(s||(s=Promise))(function(l,i){function o(u){try{d(a.next(u))}catch(h){i(h)}}function c(u){try{d(a.throw(u))}catch(h){i(h)}}function d(u){u.done?l(u.value):n(u.value).then(o,c)}d((a=a.apply(r,t||[])).next())})};class e0{constructor(t,s,a){var n,l,i;this.supabaseUrl=t,this.supabaseKey=s;const o=qp(t);if(!s)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const c=`sb-${o.hostname.split(".")[0]}-auth-token`,d={db:Ip,realtime:Dp,auth:Object.assign(Object.assign({},Lp),{storageKey:c}),global:Fp},u=Wp(a??{},d);this.storageKey=(n=u.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(l=u.global.headers)!==null&&l!==void 0?l:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=u.auth)!==null&&i!==void 0?i:{},this.headers,u.global.fetch),this.fetch=Bp(s,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new Ju(new URL("rest/v1",o).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new Pp(this.storageUrl.href,this.headers,this.fetch,a==null?void 0:a.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new Tu(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,s={},a={}){return this.rest.rpc(t,s,a)}channel(t,s={config:{}}){return this.realtime.channel(t,s)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){return Zm(this,void 0,void 0,function*(){var t,s;if(this.accessToken)return yield this.accessToken();const{data:a}=yield this.auth.getSession();return(s=(t=a.session)===null||t===void 0?void 0:t.access_token)!==null&&s!==void 0?s:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:s,detectSessionInUrl:a,storage:n,userStorage:l,storageKey:i,flowType:o,lock:c,debug:d},u,h){const g={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Qm({url:this.authUrl.href,headers:Object.assign(Object.assign({},g),u),storageKey:i,autoRefreshToken:t,persistSession:s,detectSessionInUrl:a,storage:n,userStorage:l,flowType:o,lock:c,debug:d,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(y=>y.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new mp(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,a)=>{this._handleTokenChanged(s,"CLIENT",a==null?void 0:a.access_token)})}_handleTokenChanged(t,s,a){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==a?(this.changedAccessToken=a,this.realtime.setAuth(a)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const t0=(r,t,s)=>new e0(r,t,s);function s0(){if(typeof window<"u"||typeof process>"u")return!1;const r=process.version;if(r==null)return!1;const t=r.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}s0();const r0="https://evlhnwqfnnozottgfwam.supabase.co",a0="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV2bGhud3Fmbm5vem90dGdmd2FtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk4NzU5ODYsImV4cCI6MjA3NTQ1MTk4Nn0.xzB23ELtSev8FkU8QPaQe1GUHSzk8ldoaCuWqrvKoDI",S=t0(r0,a0),Gr={BALANCE:5*60*1e3,POOL_DATA:3*60*1e3,TOKEN_HOLDERS:10*60*1e3,PRICE_DATA:2*60*1e3,LP_POSITION:5*60*1e3,TOKEN_LIST:5*60*1e3,MARKET_DATA:2*60*1e3},n0=(r,t=5*60*1e3)=>{try{const s=localStorage.getItem(r),a=localStorage.getItem(`${r}_timestamp`);if(s&&a&&Date.now()-parseInt(a)<t)return JSON.parse(s)}catch{}return null},l0=(r,t)=>{try{localStorage.setItem(r,JSON.stringify(t)),localStorage.setItem(`${r}_timestamp`,Date.now().toString())}catch{}};var vt={},rn={};rn.byteLength=c0;rn.toByteArray=u0;rn.fromByteArray=h0;var Is=[],ms=[],i0=typeof Uint8Array<"u"?Uint8Array:Array,vn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var wr=0,o0=vn.length;wr<o0;++wr)Is[wr]=vn[wr],ms[vn.charCodeAt(wr)]=wr;ms["-".charCodeAt(0)]=62;ms["_".charCodeAt(0)]=63;function _o(r){var t=r.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var s=r.indexOf("=");s===-1&&(s=t);var a=s===t?0:4-s%4;return[s,a]}function c0(r){var t=_o(r),s=t[0],a=t[1];return(s+a)*3/4-a}function d0(r,t,s){return(t+s)*3/4-s}function u0(r){var t,s=_o(r),a=s[0],n=s[1],l=new i0(d0(r,a,n)),i=0,o=n>0?a-4:a,c;for(c=0;c<o;c+=4)t=ms[r.charCodeAt(c)]<<18|ms[r.charCodeAt(c+1)]<<12|ms[r.charCodeAt(c+2)]<<6|ms[r.charCodeAt(c+3)],l[i++]=t>>16&255,l[i++]=t>>8&255,l[i++]=t&255;return n===2&&(t=ms[r.charCodeAt(c)]<<2|ms[r.charCodeAt(c+1)]>>4,l[i++]=t&255),n===1&&(t=ms[r.charCodeAt(c)]<<10|ms[r.charCodeAt(c+1)]<<4|ms[r.charCodeAt(c+2)]>>2,l[i++]=t>>8&255,l[i++]=t&255),l}function p0(r){return Is[r>>18&63]+Is[r>>12&63]+Is[r>>6&63]+Is[r&63]}function m0(r,t,s){for(var a,n=[],l=t;l<s;l+=3)a=(r[l]<<16&16711680)+(r[l+1]<<8&65280)+(r[l+2]&255),n.push(p0(a));return n.join("")}function h0(r){for(var t,s=r.length,a=s%3,n=[],l=16383,i=0,o=s-a;i<o;i+=l)n.push(m0(r,i,i+l>o?o:i+l));return a===1?(t=r[s-1],n.push(Is[t>>2]+Is[t<<4&63]+"==")):a===2&&(t=(r[s-2]<<8)+r[s-1],n.push(Is[t>>10]+Is[t>>4&63]+Is[t<<2&63]+"=")),n.join("")}var pl={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */pl.read=function(r,t,s,a,n){var l,i,o=n*8-a-1,c=(1<<o)-1,d=c>>1,u=-7,h=s?n-1:0,g=s?-1:1,y=r[t+h];for(h+=g,l=y&(1<<-u)-1,y>>=-u,u+=o;u>0;l=l*256+r[t+h],h+=g,u-=8);for(i=l&(1<<-u)-1,l>>=-u,u+=a;u>0;i=i*256+r[t+h],h+=g,u-=8);if(l===0)l=1-d;else{if(l===c)return i?NaN:(y?-1:1)*(1/0);i=i+Math.pow(2,a),l=l-d}return(y?-1:1)*i*Math.pow(2,l-a)};pl.write=function(r,t,s,a,n,l){var i,o,c,d=l*8-n-1,u=(1<<d)-1,h=u>>1,g=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=a?0:l-1,f=a?1:-1,w=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,i=u):(i=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-i))<1&&(i--,c*=2),i+h>=1?t+=g/c:t+=g*Math.pow(2,1-h),t*c>=2&&(i++,c/=2),i+h>=u?(o=0,i=u):i+h>=1?(o=(t*c-1)*Math.pow(2,n),i=i+h):(o=t*Math.pow(2,h-1)*Math.pow(2,n),i=0));n>=8;r[s+y]=o&255,y+=f,o/=256,n-=8);for(i=i<<n|o,d+=n;d>0;r[s+y]=i&255,y+=f,i/=256,d-=8);r[s+y-f]|=w*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(r){const t=rn,s=pl,a=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=o,r.SlowBuffer=A,r.INSPECT_MAX_BYTES=50;const n=2147483647;r.kMaxLength=n,o.TYPED_ARRAY_SUPPORT=l(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u";function l(){try{const v=new Uint8Array(1),p={foo:function(){return 42}};return Object.setPrototypeOf(p,Uint8Array.prototype),Object.setPrototypeOf(v,p),v.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function i(v){if(v>n)throw new RangeError('The value "'+v+'" is invalid for option "size"');const p=new Uint8Array(v);return Object.setPrototypeOf(p,o.prototype),p}function o(v,p,x){if(typeof v=="number"){if(typeof p=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return h(v)}return c(v,p,x)}o.poolSize=8192;function c(v,p,x){if(typeof v=="string")return g(v,p);if(ArrayBuffer.isView(v))return f(v);if(v==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof v);if(tt(v,ArrayBuffer)||v&&tt(v.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(tt(v,SharedArrayBuffer)||v&&tt(v.buffer,SharedArrayBuffer)))return w(v,p,x);if(typeof v=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const R=v.valueOf&&v.valueOf();if(R!=null&&R!==v)return o.from(R,p,x);const H=b(v);if(H)return H;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof v[Symbol.toPrimitive]=="function")return o.from(v[Symbol.toPrimitive]("string"),p,x);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof v)}o.from=function(v,p,x){return c(v,p,x)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function d(v){if(typeof v!="number")throw new TypeError('"size" argument must be of type number');if(v<0)throw new RangeError('The value "'+v+'" is invalid for option "size"')}function u(v,p,x){return d(v),v<=0?i(v):p!==void 0?typeof x=="string"?i(v).fill(p,x):i(v).fill(p):i(v)}o.alloc=function(v,p,x){return u(v,p,x)};function h(v){return d(v),i(v<0?0:P(v)|0)}o.allocUnsafe=function(v){return h(v)},o.allocUnsafeSlow=function(v){return h(v)};function g(v,p){if((typeof p!="string"||p==="")&&(p="utf8"),!o.isEncoding(p))throw new TypeError("Unknown encoding: "+p);const x=_(v,p)|0;let R=i(x);const H=R.write(v,p);return H!==x&&(R=R.slice(0,H)),R}function y(v){const p=v.length<0?0:P(v.length)|0,x=i(p);for(let R=0;R<p;R+=1)x[R]=v[R]&255;return x}function f(v){if(tt(v,Uint8Array)){const p=new Uint8Array(v);return w(p.buffer,p.byteOffset,p.byteLength)}return y(v)}function w(v,p,x){if(p<0||v.byteLength<p)throw new RangeError('"offset" is outside of buffer bounds');if(v.byteLength<p+(x||0))throw new RangeError('"length" is outside of buffer bounds');let R;return p===void 0&&x===void 0?R=new Uint8Array(v):x===void 0?R=new Uint8Array(v,p):R=new Uint8Array(v,p,x),Object.setPrototypeOf(R,o.prototype),R}function b(v){if(o.isBuffer(v)){const p=P(v.length)|0,x=i(p);return x.length===0||v.copy(x,0,0,p),x}if(v.length!==void 0)return typeof v.length!="number"||nt(v.length)?i(0):y(v);if(v.type==="Buffer"&&Array.isArray(v.data))return y(v.data)}function P(v){if(v>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return v|0}function A(v){return+v!=v&&(v=0),o.alloc(+v)}o.isBuffer=function(p){return p!=null&&p._isBuffer===!0&&p!==o.prototype},o.compare=function(p,x){if(tt(p,Uint8Array)&&(p=o.from(p,p.offset,p.byteLength)),tt(x,Uint8Array)&&(x=o.from(x,x.offset,x.byteLength)),!o.isBuffer(p)||!o.isBuffer(x))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(p===x)return 0;let R=p.length,H=x.length;for(let z=0,ae=Math.min(R,H);z<ae;++z)if(p[z]!==x[z]){R=p[z],H=x[z];break}return R<H?-1:H<R?1:0},o.isEncoding=function(p){switch(String(p).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(p,x){if(!Array.isArray(p))throw new TypeError('"list" argument must be an Array of Buffers');if(p.length===0)return o.alloc(0);let R;if(x===void 0)for(x=0,R=0;R<p.length;++R)x+=p[R].length;const H=o.allocUnsafe(x);let z=0;for(R=0;R<p.length;++R){let ae=p[R];if(tt(ae,Uint8Array))z+ae.length>H.length?(o.isBuffer(ae)||(ae=o.from(ae)),ae.copy(H,z)):Uint8Array.prototype.set.call(H,ae,z);else if(o.isBuffer(ae))ae.copy(H,z);else throw new TypeError('"list" argument must be an Array of Buffers');z+=ae.length}return H};function _(v,p){if(o.isBuffer(v))return v.length;if(ArrayBuffer.isView(v)||tt(v,ArrayBuffer))return v.byteLength;if(typeof v!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof v);const x=v.length,R=arguments.length>2&&arguments[2]===!0;if(!R&&x===0)return 0;let H=!1;for(;;)switch(p){case"ascii":case"latin1":case"binary":return x;case"utf8":case"utf-8":return he(v).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x*2;case"hex":return x>>>1;case"base64":return be(v).length;default:if(H)return R?-1:he(v).length;p=(""+p).toLowerCase(),H=!0}}o.byteLength=_;function W(v,p,x){let R=!1;if((p===void 0||p<0)&&(p=0),p>this.length||((x===void 0||x>this.length)&&(x=this.length),x<=0)||(x>>>=0,p>>>=0,x<=p))return"";for(v||(v="utf8");;)switch(v){case"hex":return He(this,p,x);case"utf8":case"utf-8":return se(this,p,x);case"ascii":return me(this,p,x);case"latin1":case"binary":return ve(this,p,x);case"base64":return J(this,p,x);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return pe(this,p,x);default:if(R)throw new TypeError("Unknown encoding: "+v);v=(v+"").toLowerCase(),R=!0}}o.prototype._isBuffer=!0;function D(v,p,x){const R=v[p];v[p]=v[x],v[x]=R}o.prototype.swap16=function(){const p=this.length;if(p%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let x=0;x<p;x+=2)D(this,x,x+1);return this},o.prototype.swap32=function(){const p=this.length;if(p%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let x=0;x<p;x+=4)D(this,x,x+3),D(this,x+1,x+2);return this},o.prototype.swap64=function(){const p=this.length;if(p%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let x=0;x<p;x+=8)D(this,x,x+7),D(this,x+1,x+6),D(this,x+2,x+5),D(this,x+3,x+4);return this},o.prototype.toString=function(){const p=this.length;return p===0?"":arguments.length===0?se(this,0,p):W.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(p){if(!o.isBuffer(p))throw new TypeError("Argument must be a Buffer");return this===p?!0:o.compare(this,p)===0},o.prototype.inspect=function(){let p="";const x=r.INSPECT_MAX_BYTES;return p=this.toString("hex",0,x).replace(/(.{2})/g,"$1 ").trim(),this.length>x&&(p+=" ... "),"<Buffer "+p+">"},a&&(o.prototype[a]=o.prototype.inspect),o.prototype.compare=function(p,x,R,H,z){if(tt(p,Uint8Array)&&(p=o.from(p,p.offset,p.byteLength)),!o.isBuffer(p))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof p);if(x===void 0&&(x=0),R===void 0&&(R=p?p.length:0),H===void 0&&(H=0),z===void 0&&(z=this.length),x<0||R>p.length||H<0||z>this.length)throw new RangeError("out of range index");if(H>=z&&x>=R)return 0;if(H>=z)return-1;if(x>=R)return 1;if(x>>>=0,R>>>=0,H>>>=0,z>>>=0,this===p)return 0;let ae=z-H,qe=R-x;const Ie=Math.min(ae,qe),Je=this.slice(H,z),et=p.slice(x,R);for(let ze=0;ze<Ie;++ze)if(Je[ze]!==et[ze]){ae=Je[ze],qe=et[ze];break}return ae<qe?-1:qe<ae?1:0};function I(v,p,x,R,H){if(v.length===0)return-1;if(typeof x=="string"?(R=x,x=0):x>2147483647?x=2147483647:x<-2147483648&&(x=-2147483648),x=+x,nt(x)&&(x=H?0:v.length-1),x<0&&(x=v.length+x),x>=v.length){if(H)return-1;x=v.length-1}else if(x<0)if(H)x=0;else return-1;if(typeof p=="string"&&(p=o.from(p,R)),o.isBuffer(p))return p.length===0?-1:E(v,p,x,R,H);if(typeof p=="number")return p=p&255,typeof Uint8Array.prototype.indexOf=="function"?H?Uint8Array.prototype.indexOf.call(v,p,x):Uint8Array.prototype.lastIndexOf.call(v,p,x):E(v,[p],x,R,H);throw new TypeError("val must be string, number or Buffer")}function E(v,p,x,R,H){let z=1,ae=v.length,qe=p.length;if(R!==void 0&&(R=String(R).toLowerCase(),R==="ucs2"||R==="ucs-2"||R==="utf16le"||R==="utf-16le")){if(v.length<2||p.length<2)return-1;z=2,ae/=2,qe/=2,x/=2}function Ie(et,ze){return z===1?et[ze]:et.readUInt16BE(ze*z)}let Je;if(H){let et=-1;for(Je=x;Je<ae;Je++)if(Ie(v,Je)===Ie(p,et===-1?0:Je-et)){if(et===-1&&(et=Je),Je-et+1===qe)return et*z}else et!==-1&&(Je-=Je-et),et=-1}else for(x+qe>ae&&(x=ae-qe),Je=x;Je>=0;Je--){let et=!0;for(let ze=0;ze<qe;ze++)if(Ie(v,Je+ze)!==Ie(p,ze)){et=!1;break}if(et)return Je}return-1}o.prototype.includes=function(p,x,R){return this.indexOf(p,x,R)!==-1},o.prototype.indexOf=function(p,x,R){return I(this,p,x,R,!0)},o.prototype.lastIndexOf=function(p,x,R){return I(this,p,x,R,!1)};function G(v,p,x,R){x=Number(x)||0;const H=v.length-x;R?(R=Number(R),R>H&&(R=H)):R=H;const z=p.length;R>z/2&&(R=z/2);let ae;for(ae=0;ae<R;++ae){const qe=parseInt(p.substr(ae*2,2),16);if(nt(qe))return ae;v[x+ae]=qe}return ae}function _e(v,p,x,R){return We(he(p,v.length-x),v,x,R)}function ge(v,p,x,R){return We(Oe(p),v,x,R)}function Ce(v,p,x,R){return We(be(p),v,x,R)}function ue(v,p,x,R){return We($(p,v.length-x),v,x,R)}o.prototype.write=function(p,x,R,H){if(x===void 0)H="utf8",R=this.length,x=0;else if(R===void 0&&typeof x=="string")H=x,R=this.length,x=0;else if(isFinite(x))x=x>>>0,isFinite(R)?(R=R>>>0,H===void 0&&(H="utf8")):(H=R,R=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const z=this.length-x;if((R===void 0||R>z)&&(R=z),p.length>0&&(R<0||x<0)||x>this.length)throw new RangeError("Attempt to write outside buffer bounds");H||(H="utf8");let ae=!1;for(;;)switch(H){case"hex":return G(this,p,x,R);case"utf8":case"utf-8":return _e(this,p,x,R);case"ascii":case"latin1":case"binary":return ge(this,p,x,R);case"base64":return Ce(this,p,x,R);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ue(this,p,x,R);default:if(ae)throw new TypeError("Unknown encoding: "+H);H=(""+H).toLowerCase(),ae=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function J(v,p,x){return p===0&&x===v.length?t.fromByteArray(v):t.fromByteArray(v.slice(p,x))}function se(v,p,x){x=Math.min(v.length,x);const R=[];let H=p;for(;H<x;){const z=v[H];let ae=null,qe=z>239?4:z>223?3:z>191?2:1;if(H+qe<=x){let Ie,Je,et,ze;switch(qe){case 1:z<128&&(ae=z);break;case 2:Ie=v[H+1],(Ie&192)===128&&(ze=(z&31)<<6|Ie&63,ze>127&&(ae=ze));break;case 3:Ie=v[H+1],Je=v[H+2],(Ie&192)===128&&(Je&192)===128&&(ze=(z&15)<<12|(Ie&63)<<6|Je&63,ze>2047&&(ze<55296||ze>57343)&&(ae=ze));break;case 4:Ie=v[H+1],Je=v[H+2],et=v[H+3],(Ie&192)===128&&(Je&192)===128&&(et&192)===128&&(ze=(z&15)<<18|(Ie&63)<<12|(Je&63)<<6|et&63,ze>65535&&ze<1114112&&(ae=ze))}}ae===null?(ae=65533,qe=1):ae>65535&&(ae-=65536,R.push(ae>>>10&1023|55296),ae=56320|ae&1023),R.push(ae),H+=qe}return X(R)}const F=4096;function X(v){const p=v.length;if(p<=F)return String.fromCharCode.apply(String,v);let x="",R=0;for(;R<p;)x+=String.fromCharCode.apply(String,v.slice(R,R+=F));return x}function me(v,p,x){let R="";x=Math.min(v.length,x);for(let H=p;H<x;++H)R+=String.fromCharCode(v[H]&127);return R}function ve(v,p,x){let R="";x=Math.min(v.length,x);for(let H=p;H<x;++H)R+=String.fromCharCode(v[H]);return R}function He(v,p,x){const R=v.length;(!p||p<0)&&(p=0),(!x||x<0||x>R)&&(x=R);let H="";for(let z=p;z<x;++z)H+=M[v[z]];return H}function pe(v,p,x){const R=v.slice(p,x);let H="";for(let z=0;z<R.length-1;z+=2)H+=String.fromCharCode(R[z]+R[z+1]*256);return H}o.prototype.slice=function(p,x){const R=this.length;p=~~p,x=x===void 0?R:~~x,p<0?(p+=R,p<0&&(p=0)):p>R&&(p=R),x<0?(x+=R,x<0&&(x=0)):x>R&&(x=R),x<p&&(x=p);const H=this.subarray(p,x);return Object.setPrototypeOf(H,o.prototype),H};function xe(v,p,x){if(v%1!==0||v<0)throw new RangeError("offset is not uint");if(v+p>x)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(p,x,R){p=p>>>0,x=x>>>0,R||xe(p,x,this.length);let H=this[p],z=1,ae=0;for(;++ae<x&&(z*=256);)H+=this[p+ae]*z;return H},o.prototype.readUintBE=o.prototype.readUIntBE=function(p,x,R){p=p>>>0,x=x>>>0,R||xe(p,x,this.length);let H=this[p+--x],z=1;for(;x>0&&(z*=256);)H+=this[p+--x]*z;return H},o.prototype.readUint8=o.prototype.readUInt8=function(p,x){return p=p>>>0,x||xe(p,1,this.length),this[p]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(p,x){return p=p>>>0,x||xe(p,2,this.length),this[p]|this[p+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(p,x){return p=p>>>0,x||xe(p,2,this.length),this[p]<<8|this[p+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(p,x){return p=p>>>0,x||xe(p,4,this.length),(this[p]|this[p+1]<<8|this[p+2]<<16)+this[p+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(p,x){return p=p>>>0,x||xe(p,4,this.length),this[p]*16777216+(this[p+1]<<16|this[p+2]<<8|this[p+3])},o.prototype.readBigUInt64LE=fe(function(p){p=p>>>0,ye(p,"offset");const x=this[p],R=this[p+7];(x===void 0||R===void 0)&&te(p,this.length-8);const H=x+this[++p]*2**8+this[++p]*2**16+this[++p]*2**24,z=this[++p]+this[++p]*2**8+this[++p]*2**16+R*2**24;return BigInt(H)+(BigInt(z)<<BigInt(32))}),o.prototype.readBigUInt64BE=fe(function(p){p=p>>>0,ye(p,"offset");const x=this[p],R=this[p+7];(x===void 0||R===void 0)&&te(p,this.length-8);const H=x*2**24+this[++p]*2**16+this[++p]*2**8+this[++p],z=this[++p]*2**24+this[++p]*2**16+this[++p]*2**8+R;return(BigInt(H)<<BigInt(32))+BigInt(z)}),o.prototype.readIntLE=function(p,x,R){p=p>>>0,x=x>>>0,R||xe(p,x,this.length);let H=this[p],z=1,ae=0;for(;++ae<x&&(z*=256);)H+=this[p+ae]*z;return z*=128,H>=z&&(H-=Math.pow(2,8*x)),H},o.prototype.readIntBE=function(p,x,R){p=p>>>0,x=x>>>0,R||xe(p,x,this.length);let H=x,z=1,ae=this[p+--H];for(;H>0&&(z*=256);)ae+=this[p+--H]*z;return z*=128,ae>=z&&(ae-=Math.pow(2,8*x)),ae},o.prototype.readInt8=function(p,x){return p=p>>>0,x||xe(p,1,this.length),this[p]&128?(255-this[p]+1)*-1:this[p]},o.prototype.readInt16LE=function(p,x){p=p>>>0,x||xe(p,2,this.length);const R=this[p]|this[p+1]<<8;return R&32768?R|4294901760:R},o.prototype.readInt16BE=function(p,x){p=p>>>0,x||xe(p,2,this.length);const R=this[p+1]|this[p]<<8;return R&32768?R|4294901760:R},o.prototype.readInt32LE=function(p,x){return p=p>>>0,x||xe(p,4,this.length),this[p]|this[p+1]<<8|this[p+2]<<16|this[p+3]<<24},o.prototype.readInt32BE=function(p,x){return p=p>>>0,x||xe(p,4,this.length),this[p]<<24|this[p+1]<<16|this[p+2]<<8|this[p+3]},o.prototype.readBigInt64LE=fe(function(p){p=p>>>0,ye(p,"offset");const x=this[p],R=this[p+7];(x===void 0||R===void 0)&&te(p,this.length-8);const H=this[p+4]+this[p+5]*2**8+this[p+6]*2**16+(R<<24);return(BigInt(H)<<BigInt(32))+BigInt(x+this[++p]*2**8+this[++p]*2**16+this[++p]*2**24)}),o.prototype.readBigInt64BE=fe(function(p){p=p>>>0,ye(p,"offset");const x=this[p],R=this[p+7];(x===void 0||R===void 0)&&te(p,this.length-8);const H=(x<<24)+this[++p]*2**16+this[++p]*2**8+this[++p];return(BigInt(H)<<BigInt(32))+BigInt(this[++p]*2**24+this[++p]*2**16+this[++p]*2**8+R)}),o.prototype.readFloatLE=function(p,x){return p=p>>>0,x||xe(p,4,this.length),s.read(this,p,!0,23,4)},o.prototype.readFloatBE=function(p,x){return p=p>>>0,x||xe(p,4,this.length),s.read(this,p,!1,23,4)},o.prototype.readDoubleLE=function(p,x){return p=p>>>0,x||xe(p,8,this.length),s.read(this,p,!0,52,8)},o.prototype.readDoubleBE=function(p,x){return p=p>>>0,x||xe(p,8,this.length),s.read(this,p,!1,52,8)};function le(v,p,x,R,H,z){if(!o.isBuffer(v))throw new TypeError('"buffer" argument must be a Buffer instance');if(p>H||p<z)throw new RangeError('"value" argument is out of bounds');if(x+R>v.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(p,x,R,H){if(p=+p,x=x>>>0,R=R>>>0,!H){const qe=Math.pow(2,8*R)-1;le(this,p,x,R,qe,0)}let z=1,ae=0;for(this[x]=p&255;++ae<R&&(z*=256);)this[x+ae]=p/z&255;return x+R},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(p,x,R,H){if(p=+p,x=x>>>0,R=R>>>0,!H){const qe=Math.pow(2,8*R)-1;le(this,p,x,R,qe,0)}let z=R-1,ae=1;for(this[x+z]=p&255;--z>=0&&(ae*=256);)this[x+z]=p/ae&255;return x+R},o.prototype.writeUint8=o.prototype.writeUInt8=function(p,x,R){return p=+p,x=x>>>0,R||le(this,p,x,1,255,0),this[x]=p&255,x+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(p,x,R){return p=+p,x=x>>>0,R||le(this,p,x,2,65535,0),this[x]=p&255,this[x+1]=p>>>8,x+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(p,x,R){return p=+p,x=x>>>0,R||le(this,p,x,2,65535,0),this[x]=p>>>8,this[x+1]=p&255,x+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(p,x,R){return p=+p,x=x>>>0,R||le(this,p,x,4,4294967295,0),this[x+3]=p>>>24,this[x+2]=p>>>16,this[x+1]=p>>>8,this[x]=p&255,x+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(p,x,R){return p=+p,x=x>>>0,R||le(this,p,x,4,4294967295,0),this[x]=p>>>24,this[x+1]=p>>>16,this[x+2]=p>>>8,this[x+3]=p&255,x+4};function $e(v,p,x,R,H){ie(p,R,H,v,x,7);let z=Number(p&BigInt(4294967295));v[x++]=z,z=z>>8,v[x++]=z,z=z>>8,v[x++]=z,z=z>>8,v[x++]=z;let ae=Number(p>>BigInt(32)&BigInt(4294967295));return v[x++]=ae,ae=ae>>8,v[x++]=ae,ae=ae>>8,v[x++]=ae,ae=ae>>8,v[x++]=ae,x}function Ne(v,p,x,R,H){ie(p,R,H,v,x,7);let z=Number(p&BigInt(4294967295));v[x+7]=z,z=z>>8,v[x+6]=z,z=z>>8,v[x+5]=z,z=z>>8,v[x+4]=z;let ae=Number(p>>BigInt(32)&BigInt(4294967295));return v[x+3]=ae,ae=ae>>8,v[x+2]=ae,ae=ae>>8,v[x+1]=ae,ae=ae>>8,v[x]=ae,x+8}o.prototype.writeBigUInt64LE=fe(function(p,x=0){return $e(this,p,x,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=fe(function(p,x=0){return Ne(this,p,x,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(p,x,R,H){if(p=+p,x=x>>>0,!H){const Ie=Math.pow(2,8*R-1);le(this,p,x,R,Ie-1,-Ie)}let z=0,ae=1,qe=0;for(this[x]=p&255;++z<R&&(ae*=256);)p<0&&qe===0&&this[x+z-1]!==0&&(qe=1),this[x+z]=(p/ae>>0)-qe&255;return x+R},o.prototype.writeIntBE=function(p,x,R,H){if(p=+p,x=x>>>0,!H){const Ie=Math.pow(2,8*R-1);le(this,p,x,R,Ie-1,-Ie)}let z=R-1,ae=1,qe=0;for(this[x+z]=p&255;--z>=0&&(ae*=256);)p<0&&qe===0&&this[x+z+1]!==0&&(qe=1),this[x+z]=(p/ae>>0)-qe&255;return x+R},o.prototype.writeInt8=function(p,x,R){return p=+p,x=x>>>0,R||le(this,p,x,1,127,-128),p<0&&(p=255+p+1),this[x]=p&255,x+1},o.prototype.writeInt16LE=function(p,x,R){return p=+p,x=x>>>0,R||le(this,p,x,2,32767,-32768),this[x]=p&255,this[x+1]=p>>>8,x+2},o.prototype.writeInt16BE=function(p,x,R){return p=+p,x=x>>>0,R||le(this,p,x,2,32767,-32768),this[x]=p>>>8,this[x+1]=p&255,x+2},o.prototype.writeInt32LE=function(p,x,R){return p=+p,x=x>>>0,R||le(this,p,x,4,2147483647,-2147483648),this[x]=p&255,this[x+1]=p>>>8,this[x+2]=p>>>16,this[x+3]=p>>>24,x+4},o.prototype.writeInt32BE=function(p,x,R){return p=+p,x=x>>>0,R||le(this,p,x,4,2147483647,-2147483648),p<0&&(p=4294967295+p+1),this[x]=p>>>24,this[x+1]=p>>>16,this[x+2]=p>>>8,this[x+3]=p&255,x+4},o.prototype.writeBigInt64LE=fe(function(p,x=0){return $e(this,p,x,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=fe(function(p,x=0){return Ne(this,p,x,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function q(v,p,x,R,H,z){if(x+R>v.length)throw new RangeError("Index out of range");if(x<0)throw new RangeError("Index out of range")}function ee(v,p,x,R,H){return p=+p,x=x>>>0,H||q(v,p,x,4),s.write(v,p,x,R,23,4),x+4}o.prototype.writeFloatLE=function(p,x,R){return ee(this,p,x,!0,R)},o.prototype.writeFloatBE=function(p,x,R){return ee(this,p,x,!1,R)};function L(v,p,x,R,H){return p=+p,x=x>>>0,H||q(v,p,x,8),s.write(v,p,x,R,52,8),x+8}o.prototype.writeDoubleLE=function(p,x,R){return L(this,p,x,!0,R)},o.prototype.writeDoubleBE=function(p,x,R){return L(this,p,x,!1,R)},o.prototype.copy=function(p,x,R,H){if(!o.isBuffer(p))throw new TypeError("argument should be a Buffer");if(R||(R=0),!H&&H!==0&&(H=this.length),x>=p.length&&(x=p.length),x||(x=0),H>0&&H<R&&(H=R),H===R||p.length===0||this.length===0)return 0;if(x<0)throw new RangeError("targetStart out of bounds");if(R<0||R>=this.length)throw new RangeError("Index out of range");if(H<0)throw new RangeError("sourceEnd out of bounds");H>this.length&&(H=this.length),p.length-x<H-R&&(H=p.length-x+R);const z=H-R;return this===p&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(x,R,H):Uint8Array.prototype.set.call(p,this.subarray(R,H),x),z},o.prototype.fill=function(p,x,R,H){if(typeof p=="string"){if(typeof x=="string"?(H=x,x=0,R=this.length):typeof R=="string"&&(H=R,R=this.length),H!==void 0&&typeof H!="string")throw new TypeError("encoding must be a string");if(typeof H=="string"&&!o.isEncoding(H))throw new TypeError("Unknown encoding: "+H);if(p.length===1){const ae=p.charCodeAt(0);(H==="utf8"&&ae<128||H==="latin1")&&(p=ae)}}else typeof p=="number"?p=p&255:typeof p=="boolean"&&(p=Number(p));if(x<0||this.length<x||this.length<R)throw new RangeError("Out of range index");if(R<=x)return this;x=x>>>0,R=R===void 0?this.length:R>>>0,p||(p=0);let z;if(typeof p=="number")for(z=x;z<R;++z)this[z]=p;else{const ae=o.isBuffer(p)?p:o.from(p,H),qe=ae.length;if(qe===0)throw new TypeError('The value "'+p+'" is invalid for argument "value"');for(z=0;z<R-x;++z)this[z+x]=ae[z%qe]}return this};const re={};function B(v,p,x){re[v]=class extends x{constructor(){super(),Object.defineProperty(this,"message",{value:p.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${v}]`,this.stack,delete this.name}get code(){return v}set code(H){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:H,writable:!0})}toString(){return`${this.name} [${v}]: ${this.message}`}}}B("ERR_BUFFER_OUT_OF_BOUNDS",function(v){return v?`${v} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),B("ERR_INVALID_ARG_TYPE",function(v,p){return`The "${v}" argument must be of type number. Received type ${typeof p}`},TypeError),B("ERR_OUT_OF_RANGE",function(v,p,x){let R=`The value of "${v}" is out of range.`,H=x;return Number.isInteger(x)&&Math.abs(x)>2**32?H=Y(String(x)):typeof x=="bigint"&&(H=String(x),(x>BigInt(2)**BigInt(32)||x<-(BigInt(2)**BigInt(32)))&&(H=Y(H)),H+="n"),R+=` It must be ${p}. Received ${H}`,R},RangeError);function Y(v){let p="",x=v.length;const R=v[0]==="-"?1:0;for(;x>=R+4;x-=3)p=`_${v.slice(x-3,x)}${p}`;return`${v.slice(0,x)}${p}`}function oe(v,p,x){ye(p,"offset"),(v[p]===void 0||v[p+x]===void 0)&&te(p,v.length-(x+1))}function ie(v,p,x,R,H,z){if(v>x||v<p){const ae=typeof p=="bigint"?"n":"";let qe;throw z>3?p===0||p===BigInt(0)?qe=`>= 0${ae} and < 2${ae} ** ${(z+1)*8}${ae}`:qe=`>= -(2${ae} ** ${(z+1)*8-1}${ae}) and < 2 ** ${(z+1)*8-1}${ae}`:qe=`>= ${p}${ae} and <= ${x}${ae}`,new re.ERR_OUT_OF_RANGE("value",qe,v)}oe(R,H,z)}function ye(v,p){if(typeof v!="number")throw new re.ERR_INVALID_ARG_TYPE(p,"number",v)}function te(v,p,x){throw Math.floor(v)!==v?(ye(v,x),new re.ERR_OUT_OF_RANGE(x||"offset","an integer",v)):p<0?new re.ERR_BUFFER_OUT_OF_BOUNDS:new re.ERR_OUT_OF_RANGE(x||"offset",`>= ${x?1:0} and <= ${p}`,v)}const U=/[^+/0-9A-Za-z-_]/g;function ke(v){if(v=v.split("=")[0],v=v.trim().replace(U,""),v.length<2)return"";for(;v.length%4!==0;)v=v+"=";return v}function he(v,p){p=p||1/0;let x;const R=v.length;let H=null;const z=[];for(let ae=0;ae<R;++ae){if(x=v.charCodeAt(ae),x>55295&&x<57344){if(!H){if(x>56319){(p-=3)>-1&&z.push(239,191,189);continue}else if(ae+1===R){(p-=3)>-1&&z.push(239,191,189);continue}H=x;continue}if(x<56320){(p-=3)>-1&&z.push(239,191,189),H=x;continue}x=(H-55296<<10|x-56320)+65536}else H&&(p-=3)>-1&&z.push(239,191,189);if(H=null,x<128){if((p-=1)<0)break;z.push(x)}else if(x<2048){if((p-=2)<0)break;z.push(x>>6|192,x&63|128)}else if(x<65536){if((p-=3)<0)break;z.push(x>>12|224,x>>6&63|128,x&63|128)}else if(x<1114112){if((p-=4)<0)break;z.push(x>>18|240,x>>12&63|128,x>>6&63|128,x&63|128)}else throw new Error("Invalid code point")}return z}function Oe(v){const p=[];for(let x=0;x<v.length;++x)p.push(v.charCodeAt(x)&255);return p}function $(v,p){let x,R,H;const z=[];for(let ae=0;ae<v.length&&!((p-=2)<0);++ae)x=v.charCodeAt(ae),R=x>>8,H=x%256,z.push(H),z.push(R);return z}function be(v){return t.toByteArray(ke(v))}function We(v,p,x,R){let H;for(H=0;H<R&&!(H+x>=p.length||H>=v.length);++H)p[H+x]=v[H];return H}function tt(v,p){return v instanceof p||v!=null&&v.constructor!=null&&v.constructor.name!=null&&v.constructor.name===p.name}function nt(v){return v!==v}const M=function(){const v="0123456789abcdef",p=new Array(256);for(let x=0;x<16;++x){const R=x*16;for(let H=0;H<16;++H)p[R+H]=v[x]+v[H]}return p}();function fe(v){return typeof BigInt>"u"?K:v}function K(){throw new Error("BigInt not supported")}})(vt);const x0="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySW5mb3JtYXRpb24iOnsiaWQiOiJjYzJlODE1OC00Zjg5LTQ0MTUtOGRjNS0xYjhiODE3ZjJhNGQiLCJlbWFpbCI6ImRpdmVyY2l0eXJlY29yZHNAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInBpbl9wb2xpY3kiOnsicmVnaW9ucyI6W3siZGVzaXJlZFJlcGxpY2F0aW9uQ291bnQiOjEsImlkIjoiRlJBMSJ9LHsiZGVzaXJlZFJlcGxpY2F0aW9uQ291bnQiOjEsImlkIjoiTllDMSJ9XSwidmVyc2lvbiI6MX0sIm1mYV9lbmFibGVkIjpmYWxzZSwic3RhdHVzIjoiQUNUSVZFIn0sImF1dGhlbnRpY2F0aW9uVHlwZSI6InNjb3BlZEtleSIsInNjb3BlZEtleUtleSI6IjUyYTYyNTYxMTFiZWU1MTI5Njc3Iiwic2NvcGVkS2V5U2VjcmV0IjoiNzM1NzkzYjU3MjY3OTJiZWExNTQ5OTQwOGM4YzE4NjJhYjUzNDVhYTNlNGQ2N2U3MTA5YmFkYzQ2ZWNjOTBjNSIsImV4cCI6MTc3NTcxMzUzNn0.YYXsotBUiPEFdu40xv0sLrLGuU6CGsVDMjbqjB5zEjA",f0="https://api.pinata.cloud/pinning/pinFileToIPFS",g0="https://gateway.pinata.cloud/ipfs/",Oa=async r=>{try{const t=new FormData;t.append("file",r);const s=JSON.stringify({name:`token-${Date.now()}-${r.name}`});t.append("pinataMetadata",s);const a=JSON.stringify({cidVersion:1});t.append("pinataOptions",a);const n=await fetch(f0,{method:"POST",headers:{Authorization:`Bearer ${x0}`},body:t});if(!n.ok){const o=await n.text();throw new Error(`Failed to upload image to Pinata: ${n.status} ${o}`)}const l=await n.json();return`${g0}${l.IpfsHash}`}catch(t){throw t}},b0="TokenImageCache",v0=1,ps="images",ei=7*24*60*60*1e3;class y0{constructor(){this.db=null,this.memoryCache=new Map,this.initDB()}async initDB(){return new Promise((t,s)=>{const a=indexedDB.open(b0,v0);a.onerror=()=>{t(null)},a.onsuccess=n=>{this.db=n.target.result,t(this.db)},a.onupgradeneeded=n=>{const l=n.target.result;l.objectStoreNames.contains(ps)||l.createObjectStore(ps,{keyPath:"url"}).createIndex("timestamp","timestamp",{unique:!1})}})}async get(t){return this.memoryCache.has(t)?this.memoryCache.get(t):this.db?new Promise(s=>{try{const l=this.db.transaction([ps],"readonly").objectStore(ps).get(t);l.onsuccess=()=>{const i=l.result;i?Date.now()-i.timestamp<ei?(this.memoryCache.set(t,i.data),s(i.data)):(this.delete(t),s(null)):s(null)},l.onerror=()=>s(null)}catch{s(null)}}):null}async set(t,s){if(this.memoryCache.set(t,s),!!this.db)return new Promise(a=>{try{const i=this.db.transaction([ps],"readwrite").objectStore(ps).put({url:t,data:s,timestamp:Date.now()});i.onsuccess=()=>a(!0),i.onerror=()=>a(!1)}catch{a(!1)}})}async delete(t){if(this.memoryCache.delete(t),!!this.db)return new Promise(s=>{try{const l=this.db.transaction([ps],"readwrite").objectStore(ps).delete(t);l.onsuccess=()=>s(!0),l.onerror=()=>s(!1)}catch{s(!1)}})}async clear(){if(this.memoryCache.clear(),!!this.db)return new Promise(t=>{try{const n=this.db.transaction([ps],"readwrite").objectStore(ps).clear();n.onsuccess=()=>t(!0),n.onerror=()=>t(!1)}catch{t(!1)}})}async cleanOldEntries(){if(this.db)return new Promise(t=>{try{const s=Date.now()-ei,l=this.db.transaction([ps],"readwrite").objectStore(ps).index("timestamp"),i=IDBKeyRange.upperBound(s),o=l.openCursor(i);o.onsuccess=c=>{const d=c.target.result;d?(d.delete(),d.continue()):t(!0)},o.onerror=()=>t(!1)}catch{t(!1)}})}}const Gn=new y0,ti=r=>{if(!r)return null;if(r.startsWith("ipfs://"))return r.replace("ipfs://","");const t=r.match(/\/ipfs\/([a-zA-Z0-9]+)/);if(t)return t[1];const s=r.match(/\/(Qm[a-zA-Z0-9]{44}|bafyb[a-zA-Z0-9]{50,})/);return s?s[1]:r.startsWith("http")?null:r},w0=r=>r?r.startsWith("http://")?r.replace("http://","https://"):r:null,ga=["https://gateway.pinata.cloud/ipfs/","https://ipfs.io/ipfs/","https://cloudflare-ipfs.com/ipfs/","https://dweb.link/ipfs/"];function j0({token:r,size:t="md",className:s=""}){const a=m.useMemo(()=>`token-img-${r.id}`,[r.id]),n=m.useMemo(()=>r.image_url,[r.image_url]),[l,i]=m.useState(!1),[o,c]=m.useState(!1),[d,u]=m.useState(0),[h,g]=m.useState(0),y=m.useRef(null),[f,w]=m.useState(null),b=m.useRef(!0),P={sm:"w-8 h-8 min-w-[2rem] min-h-[2rem] text-sm",md:"w-12 h-12 min-w-[3rem] min-h-[3rem] text-xl",lg:"w-16 h-16 min-w-[4rem] min-h-[4rem] text-2xl",xl:"w-20 h-20 min-w-[5rem] min-h-[5rem] text-3xl","2xl":"w-24 h-24 min-w-[6rem] min-h-[6rem] text-4xl","3xl":"w-32 h-32 min-w-[8rem] min-h-[8rem] text-6xl"},A=P[t]||P.md;m.useEffect(()=>(b.current=!0,()=>{b.current=!1}),[]),m.useEffect(()=>{if(!n){i(!0);return}if(y.current===n&&o)return;(async()=>{const D=await Gn.get(a);if(D&&b.current){w(D),c(!0),i(!1),y.current=n;return}if(y.current!==n){b.current&&(i(!1),c(!1),u(0),g(0)),y.current=n;let I=w0(n);if(I.includes("gateway.pinata.cloud")||I.includes("ipfs.io")||I.includes("cloudflare-ipfs.com")||I.includes("dweb.link"))b.current&&w(I);else{const E=ti(n);E&&(I=`${ga[0]}${E}`),b.current&&w(I)}}})()},[n,a,o]);const _=()=>{const W=ti(r.image_url);if(W&&d<ga.length-1){const D=d+1;u(D),w(`${ga[D]}${W}`),g(0)}else h<1?(g(D=>D+1),W&&(u(0),w(`${ga[0]}${W}`))):i(!0)};return f&&!l?e.jsx("div",{className:`relative inline-block ${A} flex-shrink-0`,children:e.jsxs("div",{className:"relative w-full h-full rounded-full overflow-hidden border-2 border-purple-500 bg-gradient-to-br from-purple-500 to-purple-700",children:[!o&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white font-bold",children:r.token_name[0]}),e.jsx("img",{src:f,alt:r.token_name,className:`w-full h-full object-cover transition-opacity duration-200 ${o?"opacity-100":"opacity-0"}`,onLoad:async()=>{b.current&&(await Gn.set(a,f),b.current&&c(!0))},onError:_,loading:"lazy",decoding:"async",crossOrigin:"anonymous"},`${r.id}-${d}-${h}`)]})}):e.jsx("div",{className:`${A} rounded-full bg-gradient-to-br from-purple-500 to-purple-700 flex items-center justify-center text-white font-bold ${s} flex-shrink-0 aspect-square`,children:r.token_name[0]})}const Ft=m.memo(j0,(r,t)=>r.token.id===t.token.id&&r.token.image_url===t.token.image_url&&r.size===t.size&&r.className===t.className),Jt=async({userAddress:r,actionType:t,description:s,details:a={},txHash:n=null,tokenId:l=null})=>{try{const{error:i}=await S.from("activity_logs").insert([{user_address:r,action_type:t,description:s,details:a,tx_hash:n,token_id:l}])}catch{}},Yt={TOKEN_CREATED:"token_created",TOKEN_SENT:"token_sent",TOKEN_RECEIVED:"token_received",TRUSTLINE_CREATED:"trustline_created",SWAP_EXECUTED:"swap_executed",AMM_CREATED:"amm_created",WALLET_CONNECTED:"wallet_connected",WALLET_DISCONNECTED:"wallet_disconnected",BOT_CREATED:"bot_created",BOT_TRADE:"bot_trade",FAILED_TRADE:"failed_trade",START_EARNING:"start_earning",STOP_EARNING:"stop_earning",CLAIM_EARNINGS:"claim_earnings"},si=.01;function ml({token:r,balance:t,wallet:s,onClose:a,onSuccess:n}){const[l,i]=m.useState(""),[o,c]=m.useState(""),[d,u]=m.useState(!1),h=async()=>{if(!l||!o){k.error("Please fill in all fields");return}if(parseFloat(o)<=0){k.error("Amount must be greater than 0");return}if(parseFloat(o)>parseFloat(t)){k.error("Insufficient balance");return}if(!Re.isValidClassicAddress(l)){k.error("Invalid recipient address");return}u(!0);try{const g=new Re.Client("wss://s.altnet.rippletest.net:51233");await g.connect();const y=Re.Wallet.fromSeed(s.seed),f={TransactionType:"Payment",Account:s.address,Destination:l,Amount:{currency:r.currency_code,value:o,issuer:r.issuer_address}},w=await g.autofill(f),b=y.sign(w),P=await g.submitAndWait(b.tx_blob);if(P.result.meta.TransactionResult==="tesSUCCESS")await Jt({userAddress:s.address,actionType:Yt.TOKEN_SENT,description:`Sent ${o} ${r.token_name} to ${l.slice(0,8)}...`,details:{amount:o,token_name:r.token_name,from:s.address,to:l},txHash:P.result.hash,tokenId:r.id}),k.success(`Sent ${o} ${r.token_name} successfully! Fee: ${si} XRP`),await g.disconnect(),n(),a();else throw new Error("Transaction failed: "+P.result.meta.TransactionResult)}catch(g){k.error("Failed to send tokens: "+g.message)}finally{u(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:a,children:e.jsxs("div",{className:"glass rounded-lg max-w-lg w-full p-6",onClick:g=>g.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-2xl font-bold text-purple-200",children:["Send ",r.token_name]}),e.jsx("button",{onClick:a,className:"text-purple-400 hover:text-purple-300 text-2xl",children:"×"})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-6 p-4 glass rounded-lg",children:[e.jsx(Ft,{token:r,size:"lg"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-200 font-bold",children:r.token_name}),e.jsxs("div",{className:"text-purple-400 text-sm",children:["Available: ",parseFloat(t).toFixed(4)]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Recipient Address"}),e.jsx("input",{type:"text",value:l,onChange:g=>i(g.target.value),placeholder:"rXXXXXXXXXXXXXXXXXXXXXXXXXXXX",className:"input w-full text-purple-200 font-mono text-sm"}),e.jsx("div",{className:"text-purple-400 text-xs mt-1",children:"Enter the XRPL address to send to"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Amount"}),e.jsx("input",{type:"number",value:o,onChange:g=>c(g.target.value),placeholder:"0.00",step:"0.0001",className:"input w-full text-purple-200 text-lg"}),e.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[e.jsx("span",{className:"text-purple-400",children:"Min: 0.0001"}),e.jsxs("button",{onClick:()=>c(t),className:"text-purple-400 hover:text-purple-300",children:["Max: ",parseFloat(t).toFixed(4)]})]})]}),e.jsxs("div",{className:"glass rounded-lg p-4 bg-blue-500/10 border border-blue-500/30",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-blue-300",children:"Network Fee"}),e.jsxs("span",{className:"text-blue-200 font-bold",children:[si," XRP"]})]}),e.jsx("div",{className:"text-blue-400 text-xs",children:"Platform fee for processing the transaction"})]}),e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:[e.jsx("div",{className:"text-yellow-200 font-medium mb-1",children:"⚠️ Important"}),e.jsx("p",{className:"text-yellow-300 text-xs",children:"Double-check the recipient address. Transactions cannot be reversed once confirmed."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:h,disabled:d||!l||!o,className:"flex-1 btn-primary text-white py-3 rounded-lg font-medium disabled:opacity-50",children:d?"⏳ Sending...":`📤 Send ${o||"0"} ${r.token_name}`}),e.jsx("button",{onClick:a,disabled:d,className:"btn text-purple-300 px-6 py-3 rounded-lg font-medium disabled:opacity-50",children:"Cancel"})]})]})]})})}var N0=Object.defineProperty,Ba=Object.getOwnPropertySymbols,ko=Object.prototype.hasOwnProperty,So=Object.prototype.propertyIsEnumerable,ri=(r,t,s)=>t in r?N0(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,_0=(r,t)=>{for(var s in t||(t={}))ko.call(t,s)&&ri(r,s,t[s]);if(Ba)for(var s of Ba(t))So.call(t,s)&&ri(r,s,t[s]);return r},k0=(r,t)=>{var s={};for(var a in r)ko.call(r,a)&&t.indexOf(a)<0&&(s[a]=r[a]);if(r!=null&&Ba)for(var a of Ba(r))t.indexOf(a)<0&&So.call(r,a)&&(s[a]=r[a]);return s};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var lr;(r=>{const t=class{constructor(c,d,u,h){if(this.version=c,this.errorCorrectionLevel=d,this.modules=[],this.isFunction=[],c<t.MIN_VERSION||c>t.MAX_VERSION)throw new RangeError("Version value out of range");if(h<-1||h>7)throw new RangeError("Mask value out of range");this.size=c*4+17;let g=[];for(let f=0;f<this.size;f++)g.push(!1);for(let f=0;f<this.size;f++)this.modules.push(g.slice()),this.isFunction.push(g.slice());this.drawFunctionPatterns();const y=this.addEccAndInterleave(u);if(this.drawCodewords(y),h==-1){let f=1e9;for(let w=0;w<8;w++){this.applyMask(w),this.drawFormatBits(w);const b=this.getPenaltyScore();b<f&&(h=w,f=b),this.applyMask(w)}}l(0<=h&&h<=7),this.mask=h,this.applyMask(h),this.drawFormatBits(h),this.isFunction=[]}static encodeText(c,d){const u=r.QrSegment.makeSegments(c);return t.encodeSegments(u,d)}static encodeBinary(c,d){const u=r.QrSegment.makeBytes(c);return t.encodeSegments([u],d)}static encodeSegments(c,d,u=1,h=40,g=-1,y=!0){if(!(t.MIN_VERSION<=u&&u<=h&&h<=t.MAX_VERSION)||g<-1||g>7)throw new RangeError("Invalid value");let f,w;for(f=u;;f++){const _=t.getNumDataCodewords(f,d)*8,W=o.getTotalBits(c,f);if(W<=_){w=W;break}if(f>=h)throw new RangeError("Data too long")}for(const _ of[t.Ecc.MEDIUM,t.Ecc.QUARTILE,t.Ecc.HIGH])y&&w<=t.getNumDataCodewords(f,_)*8&&(d=_);let b=[];for(const _ of c){a(_.mode.modeBits,4,b),a(_.numChars,_.mode.numCharCountBits(f),b);for(const W of _.getData())b.push(W)}l(b.length==w);const P=t.getNumDataCodewords(f,d)*8;l(b.length<=P),a(0,Math.min(4,P-b.length),b),a(0,(8-b.length%8)%8,b),l(b.length%8==0);for(let _=236;b.length<P;_^=253)a(_,8,b);let A=[];for(;A.length*8<b.length;)A.push(0);return b.forEach((_,W)=>A[W>>>3]|=_<<7-(W&7)),new t(f,d,A,g)}getModule(c,d){return 0<=c&&c<this.size&&0<=d&&d<this.size&&this.modules[d][c]}getModules(){return this.modules}drawFunctionPatterns(){for(let u=0;u<this.size;u++)this.setFunctionModule(6,u,u%2==0),this.setFunctionModule(u,6,u%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const c=this.getAlignmentPatternPositions(),d=c.length;for(let u=0;u<d;u++)for(let h=0;h<d;h++)u==0&&h==0||u==0&&h==d-1||u==d-1&&h==0||this.drawAlignmentPattern(c[u],c[h]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(c){const d=this.errorCorrectionLevel.formatBits<<3|c;let u=d;for(let g=0;g<10;g++)u=u<<1^(u>>>9)*1335;const h=(d<<10|u)^21522;l(h>>>15==0);for(let g=0;g<=5;g++)this.setFunctionModule(8,g,n(h,g));this.setFunctionModule(8,7,n(h,6)),this.setFunctionModule(8,8,n(h,7)),this.setFunctionModule(7,8,n(h,8));for(let g=9;g<15;g++)this.setFunctionModule(14-g,8,n(h,g));for(let g=0;g<8;g++)this.setFunctionModule(this.size-1-g,8,n(h,g));for(let g=8;g<15;g++)this.setFunctionModule(8,this.size-15+g,n(h,g));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let c=this.version;for(let u=0;u<12;u++)c=c<<1^(c>>>11)*7973;const d=this.version<<12|c;l(d>>>18==0);for(let u=0;u<18;u++){const h=n(d,u),g=this.size-11+u%3,y=Math.floor(u/3);this.setFunctionModule(g,y,h),this.setFunctionModule(y,g,h)}}drawFinderPattern(c,d){for(let u=-4;u<=4;u++)for(let h=-4;h<=4;h++){const g=Math.max(Math.abs(h),Math.abs(u)),y=c+h,f=d+u;0<=y&&y<this.size&&0<=f&&f<this.size&&this.setFunctionModule(y,f,g!=2&&g!=4)}}drawAlignmentPattern(c,d){for(let u=-2;u<=2;u++)for(let h=-2;h<=2;h++)this.setFunctionModule(c+h,d+u,Math.max(Math.abs(h),Math.abs(u))!=1)}setFunctionModule(c,d,u){this.modules[d][c]=u,this.isFunction[d][c]=!0}addEccAndInterleave(c){const d=this.version,u=this.errorCorrectionLevel;if(c.length!=t.getNumDataCodewords(d,u))throw new RangeError("Invalid argument");const h=t.NUM_ERROR_CORRECTION_BLOCKS[u.ordinal][d],g=t.ECC_CODEWORDS_PER_BLOCK[u.ordinal][d],y=Math.floor(t.getNumRawDataModules(d)/8),f=h-y%h,w=Math.floor(y/h);let b=[];const P=t.reedSolomonComputeDivisor(g);for(let _=0,W=0;_<h;_++){let D=c.slice(W,W+w-g+(_<f?0:1));W+=D.length;const I=t.reedSolomonComputeRemainder(D,P);_<f&&D.push(0),b.push(D.concat(I))}let A=[];for(let _=0;_<b[0].length;_++)b.forEach((W,D)=>{(_!=w-g||D>=f)&&A.push(W[_])});return l(A.length==y),A}drawCodewords(c){if(c.length!=Math.floor(t.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let d=0;for(let u=this.size-1;u>=1;u-=2){u==6&&(u=5);for(let h=0;h<this.size;h++)for(let g=0;g<2;g++){const y=u-g,w=(u+1&2)==0?this.size-1-h:h;!this.isFunction[w][y]&&d<c.length*8&&(this.modules[w][y]=n(c[d>>>3],7-(d&7)),d++)}}l(d==c.length*8)}applyMask(c){if(c<0||c>7)throw new RangeError("Mask value out of range");for(let d=0;d<this.size;d++)for(let u=0;u<this.size;u++){let h;switch(c){case 0:h=(u+d)%2==0;break;case 1:h=d%2==0;break;case 2:h=u%3==0;break;case 3:h=(u+d)%3==0;break;case 4:h=(Math.floor(u/3)+Math.floor(d/2))%2==0;break;case 5:h=u*d%2+u*d%3==0;break;case 6:h=(u*d%2+u*d%3)%2==0;break;case 7:h=((u+d)%2+u*d%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[d][u]&&h&&(this.modules[d][u]=!this.modules[d][u])}}getPenaltyScore(){let c=0;for(let g=0;g<this.size;g++){let y=!1,f=0,w=[0,0,0,0,0,0,0];for(let b=0;b<this.size;b++)this.modules[g][b]==y?(f++,f==5?c+=t.PENALTY_N1:f>5&&c++):(this.finderPenaltyAddHistory(f,w),y||(c+=this.finderPenaltyCountPatterns(w)*t.PENALTY_N3),y=this.modules[g][b],f=1);c+=this.finderPenaltyTerminateAndCount(y,f,w)*t.PENALTY_N3}for(let g=0;g<this.size;g++){let y=!1,f=0,w=[0,0,0,0,0,0,0];for(let b=0;b<this.size;b++)this.modules[b][g]==y?(f++,f==5?c+=t.PENALTY_N1:f>5&&c++):(this.finderPenaltyAddHistory(f,w),y||(c+=this.finderPenaltyCountPatterns(w)*t.PENALTY_N3),y=this.modules[b][g],f=1);c+=this.finderPenaltyTerminateAndCount(y,f,w)*t.PENALTY_N3}for(let g=0;g<this.size-1;g++)for(let y=0;y<this.size-1;y++){const f=this.modules[g][y];f==this.modules[g][y+1]&&f==this.modules[g+1][y]&&f==this.modules[g+1][y+1]&&(c+=t.PENALTY_N2)}let d=0;for(const g of this.modules)d=g.reduce((y,f)=>y+(f?1:0),d);const u=this.size*this.size,h=Math.ceil(Math.abs(d*20-u*10)/u)-1;return l(0<=h&&h<=9),c+=h*t.PENALTY_N4,l(0<=c&&c<=2568888),c}getAlignmentPatternPositions(){if(this.version==1)return[];{const c=Math.floor(this.version/7)+2,d=this.version==32?26:Math.ceil((this.version*4+4)/(c*2-2))*2;let u=[6];for(let h=this.size-7;u.length<c;h-=d)u.splice(1,0,h);return u}}static getNumRawDataModules(c){if(c<t.MIN_VERSION||c>t.MAX_VERSION)throw new RangeError("Version number out of range");let d=(16*c+128)*c+64;if(c>=2){const u=Math.floor(c/7)+2;d-=(25*u-10)*u-55,c>=7&&(d-=36)}return l(208<=d&&d<=29648),d}static getNumDataCodewords(c,d){return Math.floor(t.getNumRawDataModules(c)/8)-t.ECC_CODEWORDS_PER_BLOCK[d.ordinal][c]*t.NUM_ERROR_CORRECTION_BLOCKS[d.ordinal][c]}static reedSolomonComputeDivisor(c){if(c<1||c>255)throw new RangeError("Degree out of range");let d=[];for(let h=0;h<c-1;h++)d.push(0);d.push(1);let u=1;for(let h=0;h<c;h++){for(let g=0;g<d.length;g++)d[g]=t.reedSolomonMultiply(d[g],u),g+1<d.length&&(d[g]^=d[g+1]);u=t.reedSolomonMultiply(u,2)}return d}static reedSolomonComputeRemainder(c,d){let u=d.map(h=>0);for(const h of c){const g=h^u.shift();u.push(0),d.forEach((y,f)=>u[f]^=t.reedSolomonMultiply(y,g))}return u}static reedSolomonMultiply(c,d){if(c>>>8||d>>>8)throw new RangeError("Byte out of range");let u=0;for(let h=7;h>=0;h--)u=u<<1^(u>>>7)*285,u^=(d>>>h&1)*c;return l(u>>>8==0),u}finderPenaltyCountPatterns(c){const d=c[1];l(d<=this.size*3);const u=d>0&&c[2]==d&&c[3]==d*3&&c[4]==d&&c[5]==d;return(u&&c[0]>=d*4&&c[6]>=d?1:0)+(u&&c[6]>=d*4&&c[0]>=d?1:0)}finderPenaltyTerminateAndCount(c,d,u){return c&&(this.finderPenaltyAddHistory(d,u),d=0),d+=this.size,this.finderPenaltyAddHistory(d,u),this.finderPenaltyCountPatterns(u)}finderPenaltyAddHistory(c,d){d[0]==0&&(c+=this.size),d.pop(),d.unshift(c)}};let s=t;s.MIN_VERSION=1,s.MAX_VERSION=40,s.PENALTY_N1=3,s.PENALTY_N2=3,s.PENALTY_N3=40,s.PENALTY_N4=10,s.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],s.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],r.QrCode=s;function a(c,d,u){if(d<0||d>31||c>>>d)throw new RangeError("Value out of range");for(let h=d-1;h>=0;h--)u.push(c>>>h&1)}function n(c,d){return(c>>>d&1)!=0}function l(c){if(!c)throw new Error("Assertion error")}const i=class{constructor(c,d,u){if(this.mode=c,this.numChars=d,this.bitData=u,d<0)throw new RangeError("Invalid argument");this.bitData=u.slice()}static makeBytes(c){let d=[];for(const u of c)a(u,8,d);return new i(i.Mode.BYTE,c.length,d)}static makeNumeric(c){if(!i.isNumeric(c))throw new RangeError("String contains non-numeric characters");let d=[];for(let u=0;u<c.length;){const h=Math.min(c.length-u,3);a(parseInt(c.substr(u,h),10),h*3+1,d),u+=h}return new i(i.Mode.NUMERIC,c.length,d)}static makeAlphanumeric(c){if(!i.isAlphanumeric(c))throw new RangeError("String contains unencodable characters in alphanumeric mode");let d=[],u;for(u=0;u+2<=c.length;u+=2){let h=i.ALPHANUMERIC_CHARSET.indexOf(c.charAt(u))*45;h+=i.ALPHANUMERIC_CHARSET.indexOf(c.charAt(u+1)),a(h,11,d)}return u<c.length&&a(i.ALPHANUMERIC_CHARSET.indexOf(c.charAt(u)),6,d),new i(i.Mode.ALPHANUMERIC,c.length,d)}static makeSegments(c){return c==""?[]:i.isNumeric(c)?[i.makeNumeric(c)]:i.isAlphanumeric(c)?[i.makeAlphanumeric(c)]:[i.makeBytes(i.toUtf8ByteArray(c))]}static makeEci(c){let d=[];if(c<0)throw new RangeError("ECI assignment value out of range");if(c<128)a(c,8,d);else if(c<16384)a(2,2,d),a(c,14,d);else if(c<1e6)a(6,3,d),a(c,21,d);else throw new RangeError("ECI assignment value out of range");return new i(i.Mode.ECI,0,d)}static isNumeric(c){return i.NUMERIC_REGEX.test(c)}static isAlphanumeric(c){return i.ALPHANUMERIC_REGEX.test(c)}getData(){return this.bitData.slice()}static getTotalBits(c,d){let u=0;for(const h of c){const g=h.mode.numCharCountBits(d);if(h.numChars>=1<<g)return 1/0;u+=4+g+h.bitData.length}return u}static toUtf8ByteArray(c){c=encodeURI(c);let d=[];for(let u=0;u<c.length;u++)c.charAt(u)!="%"?d.push(c.charCodeAt(u)):(d.push(parseInt(c.substr(u+1,2),16)),u+=2);return d}};let o=i;o.NUMERIC_REGEX=/^[0-9]*$/,o.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,o.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",r.QrSegment=o})(lr||(lr={}));(r=>{(t=>{const s=class{constructor(n,l){this.ordinal=n,this.formatBits=l}};let a=s;a.LOW=new s(0,1),a.MEDIUM=new s(1,0),a.QUARTILE=new s(2,3),a.HIGH=new s(3,2),t.Ecc=a})(r.QrCode||(r.QrCode={}))})(lr||(lr={}));(r=>{(t=>{const s=class{constructor(n,l){this.modeBits=n,this.numBitsCharCount=l}numCharCountBits(n){return this.numBitsCharCount[Math.floor((n+7)/17)]}};let a=s;a.NUMERIC=new s(1,[10,12,14]),a.ALPHANUMERIC=new s(2,[9,11,13]),a.BYTE=new s(4,[8,16,16]),a.KANJI=new s(8,[8,10,12]),a.ECI=new s(7,[0,0,0]),t.Mode=a})(r.QrSegment||(r.QrSegment={}))})(lr||(lr={}));var qr=lr;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var S0={L:qr.QrCode.Ecc.LOW,M:qr.QrCode.Ecc.MEDIUM,Q:qr.QrCode.Ecc.QUARTILE,H:qr.QrCode.Ecc.HIGH},C0=128,T0="L",E0="#FFFFFF",P0="#000000",A0=!1,Co=4,R0=.1;function F0(r,t=0){const s=[];return r.forEach(function(a,n){let l=null;a.forEach(function(i,o){if(!i&&l!==null){s.push(`M${l+t} ${n+t}h${o-l}v1H${l+t}z`),l=null;return}if(o===a.length-1){if(!i)return;l===null?s.push(`M${o+t},${n+t} h1v1H${o+t}z`):s.push(`M${l+t},${n+t} h${o+1-l}v1H${l+t}z`);return}i&&l===null&&(l=o)})}),s.join("")}function I0(r,t){return r.slice().map((s,a)=>a<t.y||a>=t.y+t.h?s:s.map((n,l)=>l<t.x||l>=t.x+t.w?n:!1))}function L0(r,t,s,a){if(a==null)return null;const n=s?Co:0,l=r.length+n*2,i=Math.floor(t*R0),o=l/t,c=(a.width||i)*o,d=(a.height||i)*o,u=a.x==null?r.length/2-c/2:a.x*o,h=a.y==null?r.length/2-d/2:a.y*o;let g=null;if(a.excavate){let y=Math.floor(u),f=Math.floor(h),w=Math.ceil(c+u-y),b=Math.ceil(d+h-f);g={x:y,y:f,w,h:b}}return{x:u,y:h,h:d,w:c,excavation:g}}(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})();function D0(r){const t=r,{value:s,size:a=C0,level:n=T0,bgColor:l=E0,fgColor:i=P0,includeMargin:o=A0,imageSettings:c}=t,d=k0(t,["value","size","level","bgColor","fgColor","includeMargin","imageSettings"]);let u=qr.QrCode.encodeText(s,S0[n]).getModules();const h=o?Co:0,g=u.length+h*2,y=L0(u,a,o,c);let f=null;c!=null&&y!=null&&(y.excavation!=null&&(u=I0(u,y.excavation)),f=Ur.createElement("image",{xlinkHref:c.src,height:y.h,width:y.w,x:y.x+h,y:y.y+h,preserveAspectRatio:"none"}));const w=F0(u,h);return Ur.createElement("svg",_0({height:a,width:a,viewBox:`0 0 ${g} ${g}`},d),Ur.createElement("path",{fill:l,d:`M0,0 h${g}v${g}H0z`,shapeRendering:"crispEdges"}),Ur.createElement("path",{fill:i,d:w,shapeRendering:"crispEdges"}),f)}function hl({token:r,wallet:t,onClose:s}){const[a,n]=m.useState(!1),l=()=>{navigator.clipboard.writeText(t.address),n(!0),k.success("Address copied to clipboard!"),setTimeout(()=>n(!1),2e3)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"glass rounded-xl shadow-2xl max-w-md w-full border border-purple-500/30",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-200",children:"Receive Tokens"}),e.jsx("button",{onClick:s,className:"text-purple-400 hover:text-purple-200 text-2xl",children:"×"})]}),e.jsx("div",{className:"mb-6 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[e.jsx(Ft,{token:r,size:"lg"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200",children:r.token_name}),e.jsx("p",{className:"text-sm text-purple-400",children:r.currency_code})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg mb-4 flex justify-center",children:e.jsx(D0,{value:t.address,size:200,level:"H",includeMargin:!0})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-purple-300 mb-2",children:"Your Wallet Address"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:t.address,readOnly:!0,className:"flex-1 px-4 py-2 bg-purple-900/30 border border-purple-500/30 rounded-lg text-purple-200 font-mono text-sm"}),e.jsx("button",{onClick:l,className:`px-4 py-2 rounded-lg font-medium transition-all ${a?"bg-green-500 text-white":"bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white"}`,children:a?"✓ Copied":"📋 Copy"})]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-4",children:e.jsxs("p",{className:"text-yellow-200 text-sm",children:[e.jsx("strong",{children:"Important:"})," Make sure the sender has set up a trustline for this token before sending. Share your wallet address with them."]})}),e.jsx("div",{className:"flex gap-3",children:e.jsx("button",{onClick:s,className:"flex-1 bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white font-bold py-3 rounded-lg transition-all",children:"Close"})})]})})})}function an({token:r,onClose:t}){const s=m.useRef(null),a=m.useRef(null),n=m.useRef(null),l=m.useRef(null),i=m.useRef(null),o=m.useRef(null),c=m.useRef([]),d=m.useRef(null),[u,h]=m.useState(null),[g,y]=m.useState(!0),[f,w]=m.useState("area"),[b,P]=m.useState("1h"),[A,_]=m.useState(0),[W,D]=m.useState(0),[I,E]=m.useState(!1),[G,_e]=m.useState(!1),[ge,Ce]=m.useState(null),[ue,J]=m.useState(0);m.useEffect(()=>(X(),se(),()=>{He()}),[r]),m.useEffect(()=>{ge&&r&&F()},[ge,r]);const se=()=>{const B=localStorage.getItem("connectedWallet");B&&Ce(JSON.parse(B))},F=async()=>{if(!(!ge||!r))try{const B=new Re.Client(ge.network==="mainnet"?"wss://xrplcluster.com":"wss://s.altnet.rippletest.net:51233");await B.connect();const ie=((await B.request({command:"account_lines",account:ge.address,ledger_index:"validated"})).result.lines||[]).find(ye=>ye.account===r.issuer_address&&(ye.currency===r.currency_hex||ye.currency===r.currency_code));J(ie?parseFloat(ie.balance):0),await B.disconnect()}catch{J(0)}};m.useEffect(()=>(u&&s.current&&a.current&&xe(),()=>{He()}),[u,f,b]),m.useEffect(()=>{if(!(r!=null&&r.amm_pool_created))return;const B=async()=>{var oe;try{const{data:ie}=await S.from("pool_data_cache").select("*").eq("token_id",r.id).gte("last_updated",new Date(Date.now()-3e5).toISOString()).maybeSingle();if(ie){const ke=parseFloat(ie.price);_(ke);return}const{requestWithRetry:ye}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),te=r.currency_code.length>3?Buffer.from(r.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):r.currency_code,U=await ye({command:"amm_info",asset:{currency:"XRP"},asset2:{currency:te,issuer:r.issuer_address},ledger_index:"validated"});if((oe=U==null?void 0:U.result)!=null&&oe.amm){const ke=U.result.amm,he=parseFloat(ke.amount)/1e6,Oe=parseFloat(ke.amount2.value),$=he/Oe;_($)}}catch{}};B();const Y=setInterval(B,5e3);return()=>clearInterval(Y)},[r]);const X=async()=>{var B,Y;if(!r.amm_pool_created){y(!1);return}try{const{data:oe}=await S.from("pool_data_cache").select("*").eq("token_id",r.id).gte("last_updated",new Date(Date.now()-3e5).toISOString()).maybeSingle();if(oe){const U=parseFloat(oe.xrp_amount),ke=parseFloat(oe.token_amount),he=parseFloat(oe.price);if(h({xrpAmount:U,tokenAmount:ke,price:he,lpTokens:parseFloat(oe.lp_tokens||0),accountId:oe.account_id}),_(he),r.amm_xrp_amount&&r.amm_asset_amount){const Oe=r.amm_xrp_amount/r.amm_asset_amount,$=(he-Oe)/Oe*100;D($)}y(!1);return}const{requestWithRetry:ie}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),ye=r.currency_code.length>3?Buffer.from(r.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):r.currency_code,te=await ie({command:"amm_info",asset:{currency:"XRP"},asset2:{currency:ye,issuer:r.issuer_address},ledger_index:"validated"});if(te.result.amm){const U=te.result.amm,ke=parseFloat(U.amount)/1e6,he=parseFloat(U.amount2.value),Oe=ke/he;if(h({xrpAmount:ke,tokenAmount:he,price:Oe,lpTokens:parseFloat(((B=U.lp_token)==null?void 0:B.value)||0),accountId:U.account}),_(Oe),r.amm_xrp_amount&&r.amm_asset_amount){const $=r.amm_xrp_amount/r.amm_asset_amount,be=(Oe-$)/$*100;D(be)}await S.from("pool_data_cache").upsert({token_id:r.id,xrp_amount:ke,token_amount:he,lp_tokens:parseFloat(((Y=U.lp_token)==null?void 0:Y.value)||0),price:Oe,account_id:U.account,volume_24h:0,price_change_24h:0,last_updated:new Date().toISOString()},{onConflict:"token_id"})}}catch{}finally{y(!1)}},me=()=>{if(!u)return[];const B=u.price,Y=[],oe=Math.floor(Date.now()/1e3);let ie;switch(b){case"5m":ie=1;break;case"15m":ie=4;break;case"30m":ie=8;break;case"1h":ie=24;break;case"4h":ie=96;break;case"1d":ie=168;break;default:ie=24}for(let ye=ie;ye>=0;ye--){const te=oe-ye*3600,U=(Math.random()-.5)*.3,ke=(ie-ye)/ie*.15,he=B*(1+U+ke);Y.push({time:te,value:he,open:he*.98,high:he*1.03,low:he*.97,close:he,volume:Math.random()*1e4+1e3})}return c.current=Y,Y},ve=()=>{He(),!(!u||!i.current)&&(d.current=setInterval(()=>{pe()},5e3))},He=()=>{d.current&&(clearInterval(d.current),d.current=null)},pe=()=>{if(!u||!i.current||c.current.length===0)return;const B=c.current[c.current.length-1],Y=Math.floor(Date.now()/1e3),oe=(Math.random()-.5)*.02,ie=A||u.price*(1+oe);if(Y-B.time>=60){const ye={time:Y,value:ie,open:B.close||ie,high:Math.max(ie,B.close||ie)*1.002,low:Math.min(ie,B.close||ie)*.998,close:ie,volume:Math.random()*5e3+500};c.current.push(ye),c.current.length>500&&c.current.shift();try{f==="area"||f==="line"||f==="baseline"?i.current.update({time:ye.time,value:ye.value}):i.current.update({time:ye.time,open:ye.open,high:ye.high,low:ye.low,close:ye.close}),o.current&&o.current.update({time:ye.time,value:ye.volume,color:ye.close>=ye.open?"rgba(34, 197, 94, 0.5)":"rgba(239, 68, 68, 0.5)"})}catch{}}},xe=()=>{if(!(!s.current||!a.current||!u))try{n.current&&(n.current.remove(),n.current=null),l.current&&(l.current.remove(),l.current=null),s.current&&(s.current.innerHTML=""),a.current&&(a.current.innerHTML="");const B=Er(s.current,{width:s.current.clientWidth,height:400,layout:{background:{color:"transparent"},textColor:"#a78bfa"},grid:{vertLines:{color:"rgba(139, 92, 246, 0.1)"},horzLines:{color:"rgba(139, 92, 246, 0.1)"}},rightPriceScale:{borderColor:"rgba(139, 92, 246, 0.3)",scaleMargins:{top:.1,bottom:.1}},timeScale:{borderColor:"rgba(139, 92, 246, 0.3)",timeVisible:!0,secondsVisible:!1,visible:!1}});n.current=B;const Y=me();if(!Y||Y.length===0)throw new Error("Unable to generate chart data");let oe;const ie={type:"price",precision:8,minMove:1e-8};switch(f){case"bars":oe=B.addBarSeries({upColor:"#22c55e",downColor:"#ef4444",priceFormat:ie}),oe.setData(Y.map(he=>({time:he.time,open:he.open,high:he.high,low:he.low,close:he.close})));break;case"candlestick":oe=B.addCandlestickSeries({upColor:"#22c55e",downColor:"#ef4444",borderVisible:!1,wickUpColor:"#22c55e",wickDownColor:"#ef4444",priceFormat:ie}),oe.setData(Y.map(he=>({time:he.time,open:he.open,high:he.high,low:he.low,close:he.close})));break;case"hollow":oe=B.addCandlestickSeries({upColor:"transparent",downColor:"#ef4444",borderUpColor:"#22c55e",borderDownColor:"#ef4444",wickUpColor:"#22c55e",wickDownColor:"#ef4444",priceFormat:ie}),oe.setData(Y.map(he=>({time:he.time,open:he.open,high:he.high,low:he.low,close:he.close})));break;case"line":oe=B.addLineSeries({color:"#8b5cf6",lineWidth:2,priceFormat:ie}),oe.setData(Y.map(he=>({time:he.time,value:he.close})));break;case"area":oe=B.addAreaSeries({topColor:"rgba(139, 92, 246, 0.4)",bottomColor:"rgba(139, 92, 246, 0.0)",lineColor:"#8b5cf6",lineWidth:2,priceFormat:ie}),oe.setData(Y.map(he=>({time:he.time,value:he.close})));break;case"baseline":oe=B.addBaselineSeries({topLineColor:"#22c55e",topFillColor1:"rgba(34, 197, 94, 0.4)",topFillColor2:"rgba(34, 197, 94, 0.0)",bottomLineColor:"#ef4444",bottomFillColor1:"rgba(239, 68, 68, 0.0)",bottomFillColor2:"rgba(239, 68, 68, 0.4)",priceFormat:ie}),oe.setData(Y.map(he=>({time:he.time,value:he.close})));break;case"heikin":oe=B.addCandlestickSeries({upColor:"#22c55e",downColor:"#ef4444",borderVisible:!1,wickUpColor:"#22c55e",wickDownColor:"#ef4444",priceFormat:ie});const ke=Y.map((he,Oe)=>{if(Oe===0)return he;const $=Y[Oe-1],be=(he.open+he.high+he.low+he.close)/4,We=($.open+$.close)/2,tt=Math.max(he.high,We,be),nt=Math.min(he.low,We,be);return{time:he.time,open:We,high:tt,low:nt,close:be}});oe.setData(ke);break;default:oe=B.addAreaSeries({topColor:"rgba(139, 92, 246, 0.4)",bottomColor:"rgba(139, 92, 246, 0.0)",lineColor:"#8b5cf6",lineWidth:2,priceFormat:ie}),oe.setData(Y.map(he=>({time:he.time,value:he.close})))}i.current=oe;const ye=Er(a.current,{width:a.current.clientWidth,height:100,layout:{background:{color:"transparent"},textColor:"#a78bfa"},grid:{vertLines:{color:"rgba(139, 92, 246, 0.1)"},horzLines:{color:"rgba(139, 92, 246, 0.1)"}},rightPriceScale:{borderColor:"rgba(139, 92, 246, 0.3)",scaleMargins:{top:.1,bottom:.1}},timeScale:{borderColor:"rgba(139, 92, 246, 0.3)",timeVisible:!0,secondsVisible:!1}});l.current=ye;const te=ye.addHistogramSeries({color:"#8b5cf6",priceFormat:{type:"volume"}});te.setData(Y.map(ke=>({time:ke.time,value:ke.volume,color:ke.close>=ke.open?"rgba(34, 197, 94, 0.5)":"rgba(239, 68, 68, 0.5)"}))),o.current=te,B.timeScale().fitContent(),ye.timeScale().fitContent(),B.timeScale().subscribeVisibleTimeRangeChange(()=>{const ke=B.timeScale().getVisibleRange();ke&&ye.timeScale().setVisibleRange(ke)});const U=()=>{n.current&&s.current&&n.current.applyOptions({width:s.current.clientWidth}),l.current&&a.current&&l.current.applyOptions({width:a.current.clientWidth})};window.addEventListener("resize",U),setTimeout(()=>{ve()},100)}catch{}},le=()=>A>0?A:(u==null?void 0:u.price)>0?u.price:r.amm_xrp_amount>0&&r.amm_asset_amount>0?r.amm_xrp_amount/r.amm_asset_amount:0,$e=()=>{const B=le();return!B||!r.supply?0:r.supply*B},Ne=()=>(u==null?void 0:u.xrpAmount)||r.amm_xrp_amount||0,q=()=>(u==null?void 0:u.tokenAmount)||r.amm_asset_amount||0,ee=()=>{const B=$e();return!B||B===0?0:B*.12},L=le(),re=$e();return e.jsxs("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:t,children:[e.jsxs("div",{className:"glass rounded-lg max-w-6xl w-full max-h-[90vh] overflow-y-auto",onClick:B=>B.stopPropagation(),children:[e.jsxs("div",{className:"sticky top-0 glass border-b border-purple-500/20 p-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Ft,{token:r,size:"lg"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-purple-200",children:r.token_name}),e.jsx("p",{className:"text-purple-400 text-sm",children:r.currency_code})]})]}),e.jsx("button",{onClick:t,className:"text-purple-400 hover:text-purple-300 text-3xl leading-none",children:"×"})]}),e.jsx("div",{className:"p-6 space-y-6",children:g?e.jsx("div",{className:"text-center text-purple-400 py-8",children:"Loading live data..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"Price"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[L>0?L.toFixed(8):"0.00000000"," XRP"]}),W!==0&&e.jsxs("div",{className:`text-sm mt-1 ${W>=0?"text-green-400":"text-red-400"}`,children:[W>=0?"↑":"↓"," ",Math.abs(W).toFixed(2),"% (24h)"]})]}),e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"Market Cap"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[re>0?re.toFixed(4):"0.0000"," XRP"]}),e.jsx("div",{className:"text-purple-500 text-xs mt-1",children:"Fully diluted"})]}),e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"24h Volume"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[ee()>0?ee().toFixed(2):"0.00"," XRP"]}),e.jsx("div",{className:"text-purple-500 text-xs mt-1",children:"Estimated"})]})]}),u&&e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200",children:"Price Chart"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:b,onChange:B=>P(B.target.value),className:"input px-3 py-1 text-sm text-purple-200",children:[e.jsx("option",{value:"5m",children:"5m"}),e.jsx("option",{value:"15m",children:"15m"}),e.jsx("option",{value:"30m",children:"30m"}),e.jsx("option",{value:"1h",children:"1h"}),e.jsx("option",{value:"4h",children:"4h"}),e.jsx("option",{value:"1d",children:"1d"})]}),e.jsxs("select",{value:f,onChange:B=>w(B.target.value),className:"input px-3 py-1 text-sm text-purple-200",children:[e.jsx("option",{value:"candlestick",children:"Candles"}),e.jsx("option",{value:"bars",children:"Bars"}),e.jsx("option",{value:"hollow",children:"Hollow"}),e.jsx("option",{value:"heikin",children:"Heikin Ashi"}),e.jsx("option",{value:"line",children:"Line"}),e.jsx("option",{value:"area",children:"Area"}),e.jsx("option",{value:"baseline",children:"Baseline"})]})]})]}),e.jsx("div",{ref:s,className:"w-full mb-2"}),e.jsx("div",{ref:a,className:"w-full"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-purple-200 mb-4",children:"Token Details"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-400",children:"Total Supply"}),e.jsx("span",{className:"text-purple-200 font-bold",children:(r.supply||0).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-400",children:"Circulating"}),e.jsx("span",{className:"text-purple-200 font-bold",children:((r.supply||0)*.9).toLocaleString()})]}),r.amm_pool_created&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-400",children:"AMM Liquidity"}),e.jsx("span",{className:"text-purple-200 font-bold",children:q()>0?q().toLocaleString():"0.322"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-400",children:"XRP Locked"}),e.jsxs("span",{className:"text-purple-200 font-bold",children:[Ne()>0?Ne().toFixed(2):"2.80"," XRP"]})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-400",children:"Status"}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${r.amm_pool_created?"bg-green-500/20 text-green-400":"bg-yellow-500/20 text-yellow-400"}`,children:r.amm_pool_created?"✓ Active":"○ Pending"})]})]})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-purple-200 mb-4",children:"Blockchain Info"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"Issuer Address"}),e.jsx("div",{className:"text-purple-300 text-xs font-mono bg-black/30 p-2 rounded break-all",children:r.issuer_address})]}),r.tx_hash&&e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"Creation TX"}),e.jsx("div",{className:"text-purple-300 text-xs font-mono bg-black/30 p-2 rounded break-all",children:r.tx_hash})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"Created"}),e.jsx("div",{className:"text-purple-300 text-sm",children:new Date(r.created_at).toLocaleString()})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[ge&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>E(!0),className:"bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-bold px-4 py-3 rounded-lg shadow-lg",children:"📤 Send"}),e.jsx("button",{onClick:()=>_e(!0),className:"bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white font-bold px-4 py-3 rounded-lg shadow-lg",children:"📥 Receive"})]}),e.jsx("button",{onClick:()=>{localStorage.setItem("selectedTradeToken",JSON.stringify(r)),window.dispatchEvent(new CustomEvent("navigateToTrade",{detail:r})),t()},className:"bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white font-bold px-4 py-3 rounded-lg shadow-lg",children:"💱 Trade on MEMEKINGS"}),e.jsx("button",{onClick:()=>{window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"bottrader"})),t()},className:"bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white font-bold px-4 py-3 rounded-lg shadow-lg",children:"🤖 Bot Trader"}),e.jsx("button",{onClick:()=>{window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"pools"})),t()},className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-bold px-4 py-3 rounded-lg shadow-lg",children:"💧 LP Pools"}),e.jsx("button",{onClick:()=>{window.dispatchEvent(new CustomEvent("navigateToToken",{detail:r.token_name})),t()},className:"bg-gradient-to-r from-indigo-500 to-indigo-600 hover:from-indigo-600 hover:to-indigo-700 text-white font-bold px-4 py-3 rounded-lg shadow-lg",children:"👁️ View Full Profile"}),e.jsx("a",{href:`https://xrpscan.com/account/${r.issuer_address}`,target:"_blank",rel:"noopener noreferrer",className:"bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white font-bold px-4 py-3 rounded-lg shadow-lg text-center",children:"🔍 Explorer"}),e.jsx("button",{onClick:t,className:"bg-purple-900/30 border border-purple-500/30 hover:bg-purple-900/50 text-purple-200 font-medium px-4 py-3 rounded-lg",children:"← Back"})]})]})})]}),I&&ge&&e.jsx(ml,{token:r,balance:ue,wallet:ge,onClose:()=>E(!1),onSuccess:()=>{E(!1),F()}}),G&&ge&&e.jsx(hl,{token:r,wallet:ge,onClose:()=>_e(!1)})]})}function Xa({token:r,connectedWallet:t,tokenBalance:s=0,onTrustlineUpdate:a,className:n="",size:l="md",showDropdown:i=!1,isDropdownOpen:o=!1,onDropdownToggle:c=null}){const[d,u]=m.useState(!1),[h,g]=m.useState(!1),[y,f]=m.useState(!0),[w,b]=m.useState(!1),P=c?o:w,A=c||b,_=ge=>ge.currency_hex?ge.currency_hex:ge.currency_code?ge.currency_code.length>3?vt.Buffer.from(ge.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):ge.currency_code:null,W=ge=>ge.issuer_address||ge.issuer||null;m.useEffect(()=>{t&&r?D():(f(!1),g(!1))},[r==null?void 0:r.id,t==null?void 0:t.address]);const D=async()=>{if(!t||!r){f(!1);return}const ge=_(r),Ce=W(r);if(!ge||!Ce){f(!1);return}f(!0);try{const ue=`${t.address}_${ge}_${Ce}`,J=6e4,{data:se}=await S.from("wallet_trustlines").select("*").eq("wallet_address",t.address).eq("token_id",r.id).maybeSingle();if(se&&Date.now()-new Date(se.last_checked).getTime()<J){g(se.has_trustline),f(!1);return}await I()}catch{await I()}},I=async()=>{var J;if(!t||!r){f(!1);return}const ge=_(r),Ce=W(r);if(!ge||!Ce){f(!1);return}f(!0);let ue=null;try{const se=t.network==="mainnet"?"wss://xrplcluster.com":"wss://s.altnet.rippletest.net:51233";ue=new Re.Client(se),await Promise.race([ue.connect(),new Promise((ve,He)=>setTimeout(()=>He(new Error("Connection timeout")),1e4))]);const me=((await Promise.race([ue.request({command:"account_lines",account:t.address,ledger_index:"validated"}),new Promise((ve,He)=>setTimeout(()=>He(new Error("Request timeout")),1e4))])).result.lines||[]).some(ve=>ve.currency===ge&&ve.account===Ce);g(me),await S.from("wallet_trustlines").upsert({wallet_address:t.address,token_id:r.id,currency:ge,issuer:Ce,has_trustline:me,last_checked:new Date().toISOString()},{onConflict:"wallet_address,token_id"})}catch(se){(J=se.data)==null||J.error,g(!1)}finally{try{ue&&ue.isConnected()&&await ue.disconnect()}catch{}f(!1)}},E=async()=>{var J,se,F,X;if(!t){k.error("Please connect a wallet first");return}if(!r){k.error("Token information not available");return}const ge=_(r),Ce=W(r);if(!ge||!Ce){k.error("Token missing required information (currency or issuer)");return}if(!t.seed){k.error("Wallet seed not available. Please reconnect your wallet.");return}u(!0);let ue=null;try{const me=t.network==="mainnet"?"wss://xrplcluster.com":"wss://s.altnet.rippletest.net:51233";if(ue=new Re.Client(me),await Promise.race([ue.connect(),new Promise((ee,L)=>setTimeout(()=>L(new Error("Connection timeout")),15e3))]),((await Promise.race([ue.request({command:"account_lines",account:t.address,ledger_index:"validated"}),new Promise((ee,L)=>setTimeout(()=>L(new Error("Request timeout")),1e4))])).result.lines||[]).some(ee=>ee.currency===ge&&ee.account===Ce)){k.success("You already have a trustline for this token!"),g(!0),u(!1),ue&&ue.isConnected()&&await ue.disconnect();return}const xe=Re.Wallet.fromSeed(t.seed);if(xe.address!==t.address)throw new Error("Wallet address mismatch. Please reconnect your wallet.");const le={TransactionType:"TrustSet",Account:xe.address,LimitAmount:{currency:ge,issuer:Ce,value:"1000000000"}},$e=await ue.autofill(le),Ne=xe.sign($e),q=await Promise.race([ue.submitAndWait(Ne.tx_blob),new Promise((ee,L)=>setTimeout(()=>L(new Error("Transaction timeout")),3e4))]);if(q.result.meta.TransactionResult==="tesSUCCESS")k.success(`Trustline set for ${r.name||r.symbol}!`),g(!0),await S.from("wallet_trustlines").upsert({wallet_address:t.address,token_id:r.id,currency:ge,issuer:Ce,has_trustline:!0,last_checked:new Date().toISOString()},{onConflict:"wallet_address,token_id"}),await Jt({type:Yt.TRUSTLINE_CREATED,walletAddress:t.address,details:{token:r.name||r.symbol,symbol:r.symbol,issuer:Ce,currency:ge}}),a&&a();else{const ee=q.result.meta.TransactionResult;let L="Failed to set trustline";switch(ee){case"tecNO_DST_INSUF_XRP":L="Insufficient XRP balance. You need at least 10 XRP reserve.";break;case"tecDST_TAG_NEEDED":L="Destination tag required.";break;case"tecNO_LINE_INSUF_RESERVE":L="Insufficient reserve. You need more XRP in your wallet.";break;case"tecUNFUNDED":L="Wallet is unfunded. Please add XRP to your wallet.";break;case"tefPAST_SEQ":L="Transaction sequence error. Please try again.";break;case"terRETRY":L="Network busy. Please retry in a moment.";break;default:L=`Failed: ${ee}`}k.error(L)}}catch(me){let ve="Failed to set up trustline";me.message.includes("timeout")||me.message.includes("Timeout")?ve="Connection timed out. The network may be slow. Please try again.":me.message.includes("Connection")||me.message.includes("connect")?ve="Unable to connect to the XRPL network. Please check your internet connection and try again.":me.message.includes("address mismatch")?ve=me.message:((J=me.data)==null?void 0:J.error)==="actNotFound"?ve="Your wallet is not activated on the network. Please send at least 2 XRP to your wallet first.":((se=me.data)==null?void 0:se.error)==="amendmentBlocked"?ve="This transaction type is blocked by the network. Please try again later.":((F=me.data)==null?void 0:F.error_code)===19?ve="Insufficient XRP balance. You need at least 2 XRP plus reserve for trustlines.":me.name==="RippledError"?ve=`Network error: ${((X=me.data)==null?void 0:X.error_message)||"Unknown error"}`:me.message&&(ve=`Error: ${me.message}`),k.error(ve)}finally{try{ue&&ue.isConnected()&&await ue.disconnect()}catch{}u(!1)}},G=async()=>{var J,se;if(!t){k.error("Please connect a wallet first");return}if(s>0){k.error("Cannot remove trustline with non-zero balance. Balance must be 0.");return}const ge=_(r),Ce=W(r);if(!ge||!Ce){k.error("Token missing required information");return}if(!t.seed){k.error("Wallet seed not available. Please reconnect your wallet.");return}u(!0);let ue=null;try{if(await I(),!h){k("No trustline exists for this token",{icon:"ℹ️"}),u(!1);return}const F=t.network==="mainnet"?"wss://xrplcluster.com":"wss://s.altnet.rippletest.net:51233";ue=new Re.Client(F),await Promise.race([ue.connect(),new Promise((xe,le)=>setTimeout(()=>le(new Error("Connection timeout")),15e3))]);const X=Re.Wallet.fromSeed(t.seed);if(X.address!==t.address)throw new Error("Wallet address mismatch. Please reconnect your wallet.");const me={TransactionType:"TrustSet",Account:X.address,LimitAmount:{currency:ge,issuer:Ce,value:"0"}},ve=await ue.autofill(me),He=X.sign(ve),pe=await Promise.race([ue.submitAndWait(He.tx_blob),new Promise((xe,le)=>setTimeout(()=>le(new Error("Transaction timeout")),3e4))]);if(pe.result.meta.TransactionResult==="tesSUCCESS")k.success(`Trustline removed for ${r.name||r.symbol}!`),g(!1),await S.from("wallet_trustlines").upsert({wallet_address:t.address,token_id:r.id,currency:ge,issuer:Ce,has_trustline:!1,last_checked:new Date().toISOString()},{onConflict:"wallet_address,token_id"}),await Jt({type:Yt.TRUSTLINE_REMOVED,walletAddress:t.address,details:{token:r.name||r.symbol,symbol:r.symbol,issuer:Ce,currency:ge}}),a&&a();else{const xe=pe.result.meta.TransactionResult;let le="Failed to remove trustline";switch(xe){case"tecNO_LINE":le="Trustline does not exist.";break;case"tecHAS_OBLIGATIONS":le="Cannot remove trustline with obligations.";break;default:le=`Failed: ${xe}`}k.error(le)}}catch(F){let X="Failed to remove trustline";F.message.includes("timeout")||F.message.includes("Timeout")?X="Connection timed out. The network may be slow. Please try again.":F.message.includes("Connection")||F.message.includes("connect")?X="Unable to connect to the XRPL network. Please check your internet connection and try again.":F.message.includes("address mismatch")?X=F.message:((J=F.data)==null?void 0:J.error)==="actNotFound"?X="Your wallet is not activated on the network.":F.name==="RippledError"?X=`Network error: ${((se=F.data)==null?void 0:se.error_message)||"Unknown error"}`:F.message&&(X=`Error: ${F.message}`),k.error(X)}finally{try{ue&&ue.isConnected()&&await ue.disconnect()}catch{}u(!1)}},_e=()=>{switch(l){case"sm":return"px-3 py-2 text-xs";case"lg":return"px-6 py-3 text-base";default:return"px-4 py-2 text-sm"}};return y?e.jsx("button",{disabled:!0,className:`bg-gray-700 text-gray-400 rounded-lg disabled:opacity-50 cursor-not-allowed ${_e()} ${n}`,children:e.jsxs("svg",{className:"animate-spin h-4 w-4 inline",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):t?i?e.jsxs("div",{className:`relative trust-dropdown ${n}`,children:[e.jsx("button",{onClick:ge=>{ge.stopPropagation(),c?c(r.id):A(!P)},disabled:d||y,className:`w-full bg-gradient-to-r from-green-600 to-green-500 text-white rounded-lg hover:from-green-500 hover:to-green-400 disabled:opacity-50 shadow-lg shadow-green-500/20 transition-all duration-300 flex items-center justify-center gap-2 ${_e()}`,children:d?e.jsxs("svg",{className:"animate-spin h-4 w-4 inline",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:h?"✓ Trusted":"Trust"}),e.jsx("svg",{className:`w-4 h-4 transition-transform ${P?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),P&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-64 bg-gradient-to-br from-purple-900 to-purple-800 border border-purple-500/30 rounded-lg shadow-xl overflow-hidden backdrop-blur-xl",style:{zIndex:9999},onClick:ge=>ge.stopPropagation(),children:[e.jsxs("button",{onClick:()=>{c?c(null):A(!1),E()},disabled:d||h,className:"w-full px-4 py-3 text-left hover:bg-purple-600/30 transition-colors flex items-center gap-3 border-b border-purple-500/20 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-green-600/20 flex items-center justify-center text-green-400",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-purple-100 font-medium",children:"Setup"}),e.jsx("div",{className:"text-purple-300 text-xs",children:"Add this token trustline"})]})]}),e.jsxs("button",{onClick:()=>{c?c(null):A(!1),G()},disabled:d||!h||s>0,className:"w-full px-4 py-3 text-left hover:bg-purple-600/30 transition-colors flex items-center gap-3 border-b border-purple-500/20 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-red-600/20 flex items-center justify-center text-red-400",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-purple-100 font-medium",children:"Remove"}),e.jsx("div",{className:"text-purple-300 text-xs",children:s>0?"Balance must be 0":"Remove empty trustline"})]})]}),e.jsxs("a",{href:`https://xrpscan.com/account/${W(r)}`,target:"_blank",rel:"noopener noreferrer",className:"w-full px-4 py-3 text-left hover:bg-purple-600/30 transition-colors flex items-center gap-3",onClick:()=>{c?c(null):A(!1)},children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-600/20 flex items-center justify-center text-blue-400",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-purple-100 font-medium",children:"XRPScan Link"}),e.jsx("div",{className:"text-purple-300 text-xs",children:"View issuer details"})]})]})]})]}):h?s>0?e.jsx("button",{disabled:!0,className:`bg-gray-700 text-gray-400 rounded-lg disabled:opacity-50 cursor-not-allowed ${_e()} ${n}`,title:"Trustline active with balance",children:"✓ Trusted"}):e.jsx("button",{onClick:G,disabled:d,className:`bg-gradient-to-r from-red-600 to-red-500 text-white rounded-lg hover:from-red-500 hover:to-red-400 disabled:opacity-50 shadow-lg shadow-red-500/20 transition-all duration-300 ${_e()} ${n}`,title:"Remove trustline (balance is 0)",children:d?e.jsxs("svg",{className:"animate-spin h-4 w-4 inline",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Remove Trust"}):e.jsx("button",{onClick:E,disabled:d,className:`bg-gradient-to-r from-green-600 to-green-500 text-white rounded-lg hover:from-green-500 hover:to-green-400 disabled:opacity-50 shadow-lg shadow-green-500/20 transition-all duration-300 ${_e()} ${n}`,children:d?e.jsxs("svg",{className:"animate-spin h-4 w-4 inline",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Trust"}):i?e.jsx("div",{className:`relative trust-dropdown ${n}`,children:e.jsx("button",{disabled:!0,className:`w-full bg-gray-700 text-gray-400 rounded-lg disabled:opacity-50 cursor-not-allowed flex items-center justify-center gap-2 ${_e()}`,children:e.jsx("span",{children:"Connect Wallet"})})}):e.jsx("button",{disabled:!0,className:`bg-gray-700 text-gray-400 rounded-lg disabled:opacity-50 cursor-not-allowed ${_e()} ${n}`,children:"Connect Wallet"})}const ai=["ABLE","ACID","AGED","ALSO","AREA","ARMY","AWAY","BABY","BACK","BALL","BAND","BANK","BASE","BATH","BEAR","BEAT","BEEN","BEER","BELL","BELT","BEST","BILL","BIRD","BLOW","BLUE","BOAT","BODY","BOMB","BOND","BONE","BOOK","BOOM","BORN","BOSS","BOTH","BOWL","BULK","BURN","BUSH","BUSY","CAFE","CAKE","CALL","CALM","CAME","CAMP","CARD","CARE","CART","CASE","CASH","CAST","CELL","CHAT","CHEF","CHIP","CITY","CLUB","COAL","COAT","CODE","COLD","COME","COOK","COOL","COPE","COPY","CORE","CORN","COST","CREW","CROP","DARK","DATA","DATE","DAWN","DAYS","DEAD","DEAL","DEAR","DEBT","DEEP","DENY","DESK","DIAL","DIET","DISC","DISK","DIVE","DOCK","DOES","DOGS","DONE","DOOR","DOSE","DOWN","DRAW","DREW","DROP","DRUG","DUAL","DUCK","DUMP","DUST","DUTY","EACH","EARN","EASE","EAST","EASY","ECHO","EDGE","ELSE","EVEN","EVER","EVIL","EXIT","FACE","FACT","FAIL","FAIR","FALL","FARM","FAST","FATE","FEAR","FEED","FEEL","FEET","FELL","FELT","FILE","FILL","FILM","FIND","FINE","FIRE","FIRM","FISH","FLAT","FLED","FLEW","FLOW","FOLK","FOOD","FOOT","FORD","FORM","FORT","FOUL","FOUR","FREE","FROM","FUEL","FULL","FUND","GAIN","GAME","GATE","GAVE","GEAR","GENE","GIFT","GIRL","GIVE","GLAD","GOAL","GOES","GOLD","GOLF","GONE","GOOD","GRAD","GRAY","GREW","GREY","GRIP","GROW","GULF","HAIR","HALF","HALL","HAND","HANG","HARD","HARM","HATE","HAVE","HEAD","HEAR","HEAT","HELD","HELL","HELP","HERE","HERO","HIGH","HILL","HIRE","HOLD","HOLE","HOLY","HOME","HOPE","HOST","HOUR","HUGE","HUNG","HUNT","HURT","IDEA","INCH","INTO","IRON","ITEM","JACK","JANE","JAZZ","JEAN","JOHN","JOIN","JUMP","JUNE","JURY","JUST","KEEN","KEEP","KENT","KEPT","KICK","KILL","KIND","KING","KNEE","KNEW","KNOW","LACK","LADY","LAID","LAKE","LAND","LANE","LAST","LATE","LEAD","LEFT","LESS","LIED","LIFE","LIFT","LIKE","LINE","LINK","LIST","LIVE","LOAD","LOAN","LOCK","LONE","LONG","LOOK","LORD","LOSE","LOSS","LOST","LOTS","LOUD","LOVE","LUCK","LUNG","MADE","MAIL","MAIN","MAKE","MALE","MALL","MANY","MARK","MASS","MATE","MATH","MEAL","MEAN","MEAT","MEET","MENU","MERE","MESS","MICE","MILE","MILK","MILL","MIND","MINE","MISS","MODE","MOOD","MOON","MORE","MOST","MOVE","MUCH","MUST","MYTH","NAME","NAVY","NEAR","NECK","NEED","NEWS","NEXT","NICE","NINE","NONE","NOON","NORM","NOSE","NOTE","NOVEL","NURSE","OKAY","ONCE","ONES","ONLY","ONTO","OPEN","ORAL","OVEN","OVER","PACE","PACK","PAGE","PAID","PAIN","PAIR","PALM","PARK","PART","PASS","PAST","PATH","PEAK","PICK","PIER","PILE","PINE","PINK","PIPE","PLAN","PLAY","PLOT","PLUG","PLUS","POEM","POET","POLL","POND","POOL","POOR","PORT","POST","POUR","PRAY","PRAY","PURE","PUSH","RACE","RACK","RAIL","RAIN","RANK","RARE","RATE","READ","REAL","REAR","RELY","RENT","REST","RICE","RICH","RIDE","RING","RISE","RISK","ROAD","ROCK","RODE","ROLE","ROLL","ROOF","ROOM","ROOT","ROPE","ROSE","RUDE","RULE","RUSH","RUTH","SAFE","SAGA","SAGE","SAID","SAKE","SALE","SALT","SAME","SAND","SANK","SAVE","SEAT","SEED","SEEK","SEEM","SEEN","SELF","SELL","SEND","SENT","SEPT","SHED","SHIP","SHOP","SHOT","SHOW","SHUT","SICK","SIDE","SIGN","SILK","SING","SINK","SITE","SIZE","SKIN","SKIP","SLOW","SNOW","SOFT","SOIL","SOLD","SOLE","SOME","SONG","SOON","SORT","SOUL","SOUP","SOUR","SPAN","SPEC","SPIN","SPOT","STAR","STAY","STEM","STEP","STIR","STOP","SUCH","SUED","SUIT","SUNG","SURE","SWIM","TALE","TALK","TALL","TANK","TAPE","TASK","TEAM","TEAR","TECH","TELL","TEND","TERM","TEST","TEXT","THAN","THAT","THEM","THEN","THEY","THIN","THIS","THOU","THUS","TIDE","TIED","TIER","TILL","TIME","TINY","TOLL","TONE","TOOK","TOOL","TOPS","TORN","TOUR","TOWN","TOYS","TREE","TREK","TRIM","TRIO","TRIP","TRUE","TUBE","TUNE","TURN","TWIN","TYPE","UNIT","UPON","USED","USER","VARY","VAST","VERY","VICE","VIEW","VISA","VOTE","WAGE","WAIT","WAKE","WALK","WALL","WANT","WARD","WARM","WARN","WASH","WAVE","WAYS","WEAK","WEAR","WEEK","WELL","WENT","WERE","WEST","WHAT","WHEN","WHOM","WIDE","WIFE","WILD","WILL","WIND","WINE","WING","WIRE","WISE","WISH","WITH","WOOD","WORD","WORE","WORK","WORM","WORN","WRAP","YARD","YEAH","YEAR","YELL","YOUR","ZONE","ZOOM","MOON","PEEL","BEAM","LEAN","PEAK","RAGE","VIBE","DOGE"],M0=()=>ai[Math.floor(Math.random()*ai.length)],Jn="token-updated",$0=r=>{const t=new CustomEvent(Jn,{detail:{tokenId:r,timestamp:Date.now()}});window.dispatchEvent(t)},la=r=>{const t=s=>r(s.detail);return window.addEventListener(Jn,t),()=>window.removeEventListener(Jn,t)},Yn=async r=>{try{const{data:t,error:s}=await S.from("meme_tokens").select("id, featured_order").eq("is_featured",!0).order("featured_order",{ascending:!0,nullsLast:!0});if(s)throw s;const a=[];t.forEach((l,i)=>{i<2?a.push(S.from("meme_tokens").update({featured_order:i+2}).eq("id",l.id)):a.push(S.from("meme_tokens").update({is_featured:!1,featured_order:null}).eq("id",l.id))}),await Promise.all(a);const{error:n}=await S.from("meme_tokens").update({is_featured:!0,featured_order:1}).eq("id",r);if(n)throw n}catch(t){throw t}},ni=async(r,t)=>{try{if(t===null||t===0){const{error:i}=await S.from("meme_tokens").update({is_featured:!1,featured_order:null}).eq("id",r);if(i)throw i;return}if(t<1||t>3)throw new Error("Featured position must be between 1 and 3");const{data:s,error:a}=await S.from("meme_tokens").select("id, featured_order").eq("is_featured",!0).order("featured_order",{ascending:!0,nullsLast:!0});if(a)throw a;const n=s.find(i=>i.featured_order===t);if(n&&n.id!==r){const i=s.filter(h=>h.id!==r&&h.id!==n.id),o=[t],c=[1,2,3].filter(h=>h!==t),d=[];i.forEach(h=>{const g=c.find(y=>!o.includes(y));g?(o.push(g),d.push(S.from("meme_tokens").update({featured_order:g}).eq("id",h.id))):d.push(S.from("meme_tokens").update({is_featured:!1,featured_order:null}).eq("id",h.id))});const u=c[0];d.push(S.from("meme_tokens").update({featured_order:u}).eq("id",n.id)),await Promise.all(d)}else{const i=s.filter(u=>u.id!==r),o=[t],c=[1,2,3].filter(u=>u!==t),d=[];i.forEach(u=>{const h=c.find(g=>!o.includes(g));h?(o.push(h),d.push(S.from("meme_tokens").update({featured_order:h}).eq("id",u.id))):d.push(S.from("meme_tokens").update({is_featured:!1,featured_order:null}).eq("id",u.id))}),await Promise.all(d)}const{error:l}=await S.from("meme_tokens").update({is_featured:!0,featured_order:t}).eq("id",r);if(l)throw l}catch(s){throw s}},yn=[{value:"Meme",color:"from-pink-500 to-rose-500",bgColor:"bg-gradient-to-r from-pink-500/20 to-rose-500/20",textColor:"text-pink-300",emoji:"😂"},{value:"Gaming",color:"from-violet-500 to-purple-500",bgColor:"bg-gradient-to-r from-violet-500/20 to-purple-500/20",textColor:"text-violet-300",emoji:"🎮"},{value:"DeFi",color:"from-blue-500 to-cyan-500",bgColor:"bg-gradient-to-r from-blue-500/20 to-cyan-500/20",textColor:"text-blue-300",emoji:"💰"},{value:"Utility",color:"from-green-500 to-emerald-500",bgColor:"bg-gradient-to-r from-green-500/20 to-emerald-500/20",textColor:"text-green-300",emoji:"🔧"},{value:"Community",color:"from-orange-500 to-amber-500",bgColor:"bg-gradient-to-r from-orange-500/20 to-amber-500/20",textColor:"text-orange-300",emoji:"👥"},{value:"NFT",color:"from-indigo-500 to-blue-500",bgColor:"bg-gradient-to-r from-indigo-500/20 to-blue-500/20",textColor:"text-indigo-300",emoji:"🎨"},{value:"AI",color:"from-teal-500 to-cyan-500",bgColor:"bg-gradient-to-r from-teal-500/20 to-cyan-500/20",textColor:"text-teal-300",emoji:"🤖"},{value:"Other",color:"from-gray-500 to-slate-500",bgColor:"bg-gradient-to-r from-gray-500/20 to-slate-500/20",textColor:"text-gray-300",emoji:"📦"}],O0=r=>yn.find(s=>s.value===r)||yn[yn.length-1],ir=({category:r,size:t="sm"})=>{const s=O0(r),a={xs:"text-xs px-1.5 py-0.5",sm:"text-xs px-2 py-1",md:"text-sm px-3 py-1.5",lg:"text-base px-4 py-2"};return e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full font-medium ${s.bgColor} ${s.textColor} ${a[t]}`,children:[e.jsx("span",{children:s.emoji}),e.jsx("span",{children:s.value})]})},hs=r=>{if(!r)return 0;const t=new Date(r),a=Math.abs(new Date-t);return Math.ceil(a/(1e3*60*60*24))},li="rKxBBMmY969Ph1y63ddVfYyN7xmxwDfVq6",B0=1,X0=async()=>{try{const{data:r,error:t}=await S.rpc("get_active_featured_spots");if(t)throw t;return r||[]}catch{return[]}},U0=async r=>{try{const{data:t,error:s}=await S.rpc("is_featured_spot_available",{spot_pos:r});if(s)throw s;return t}catch{return!1}},W0=async({tokenId:r,spotPosition:t,hours:s,walletSeed:a,walletAddress:n,xrpAmount:l,receiverAddress:i})=>{try{const o=l||s*B0,c=n===li||i&&n===i;let d=null;if(c)d="FREE_ADMIN_RECEIVER";else{const f=await Zr(),w=Re.Wallet.fromSeed(a),b={TransactionType:"Payment",Account:w.address,Amount:Re.xrpToDrops(o),Destination:li,Memos:[{Memo:{MemoType:vt.Buffer.from("featured_spot","utf8").toString("hex").toUpperCase(),MemoData:vt.Buffer.from(JSON.stringify({tokenId:r,spotPosition:t,hours:s,deal:l?"day_buyout":"standard"}),"utf8").toString("hex").toUpperCase()}}]},P=await f.autofill(b),A=w.sign(P),_=await f.submitAndWait(A.tx_blob);if(_.result.meta.TransactionResult!=="tesSUCCESS")throw new Error(`Transaction failed: ${_.result.meta.TransactionResult}`);d=_.result.hash}const u=new Date,h=new Date(u.getTime()+s*60*60*1e3),{data:g,error:y}=await S.from("featured_spot_purchases").insert({token_id:r,wallet_address:n,spot_position:t,hours_purchased:s,xrp_amount:c?0:o,tx_hash:d,started_at:u.toISOString(),expires_at:h.toISOString(),is_active:!0}).select().single();if(y)throw y;return{success:!0,purchase:g,txHash:d,wasFree:c}}catch(o){throw o}},q0="rphatRpwXcPAo7CVm46dC78JAQ6kLMqb2M";function H0({isOpen:r,onClose:t,token:s,walletSeed:a,walletAddress:n}){const[l,i]=m.useState(null),[o,c]=m.useState(1),[d,u]=m.useState(!1),[h,g]=m.useState([]),[y,f]=m.useState({}),[w,b]=m.useState(!0),[P,A]=m.useState(!1),_=1,W=24,D=20,I=n===q0,E=P?D:o*_,G=P?W:o;m.useEffect(()=>{r&&_e()},[r]);const _e=async()=>{b(!0);try{const J=await X0();g(J);const se={};for(let F=1;F<=3;F++)se[F]=await U0(F);f(se)}catch{k.error("Failed to load spot availability")}finally{b(!1)}},ge=async()=>{if(!l){k.error("Please select a spot");return}if(!a||!n){k.error("Wallet not connected");return}if(!y[l]){k.error("This spot is currently occupied");return}u(!0);const J=k.loading("Processing payment...");try{const se=await W0({tokenId:s.id,spotPosition:l,hours:G,walletSeed:a,walletAddress:n,xrpAmount:E,receiverAddress:s.receiver_address});k.dismiss(J),se.wasFree?k.success(e.jsxs("div",{children:[e.jsx("div",{className:"font-bold",children:"Featured spot activated!"}),e.jsxs("div",{className:"text-sm",children:[s.token_name," is now in spot #",l," for ",G," hour",G>1?"s":""," (FREE for admin/receiver)"]})]}),{duration:5e3}):k.success(e.jsxs("div",{children:[e.jsx("div",{className:"font-bold",children:"Featured spot purchased!"}),e.jsxs("div",{className:"text-sm",children:[s.token_name," is now in spot #",l," for ",G," hour",G>1?"s":""]})]}),{duration:5e3}),t()}catch(se){k.dismiss(J),k.error(se.message||"Failed to purchase featured spot")}finally{u(!1)}},Ce=J=>h.find(se=>se.spot_position===J),ue=J=>{const se=new Date,X=new Date(J)-se;if(X<=0)return"Expired";const me=Math.floor(X/(1e3*60*60)),ve=Math.floor(X%(1e3*60*60)/(1e3*60));return me>0?`${me}h ${ve}m remaining`:`${ve}m remaining`};return r?e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-200",children:"Purchase Featured Spot"}),e.jsx("button",{onClick:t,className:"text-purple-400 hover:text-purple-200 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s&&e.jsx("div",{className:"glass rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ft,{token:s,size:"2xl"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200",children:s.token_name}),e.jsx("p",{className:"text-purple-400",children:s.currency_code})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-3 font-semibold",children:"Select Spot Position"}),w?e.jsx("div",{className:"text-center text-purple-400 py-8",children:"Loading availability..."}):e.jsx("div",{className:"grid grid-cols-3 gap-4",children:[1,2,3].map(J=>{const se=Ce(J),F=y[J];return e.jsx("button",{type:"button",onClick:()=>F&&i(J),disabled:!F||d,className:`p-4 rounded-lg border-2 transition-all ${l===J?"border-green-500 bg-green-500/20":F?"border-purple-500/30 bg-purple-500/10 hover:border-purple-500/50":"border-red-500/30 bg-red-500/10 opacity-60 cursor-not-allowed"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-200 mb-2",children:["Spot #",J]}),F?e.jsx("div",{className:"text-green-400 text-sm font-medium",children:"✓ Available"}):se?e.jsxs("div",{className:"text-red-400 text-xs",children:[e.jsx("div",{children:"Occupied"}),e.jsx("div",{className:"mt-1",children:ue(se.expires_at)})]}):e.jsx("div",{className:"text-red-400 text-sm",children:"Occupied"})]})},J)})})]}),I&&e.jsx("div",{className:"bg-gradient-to-r from-yellow-500/20 to-orange-500/20 border-2 border-yellow-500/50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-3xl",children:"⭐"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-yellow-200 font-bold text-lg mb-2",children:"Special Receiver Wallet Deal!"}),e.jsx("p",{className:"text-yellow-100 text-sm mb-3",children:"Get a full 24-hour featured spot for only 20 XRP - Save 4 XRP!"}),e.jsx("button",{type:"button",onClick:()=>{A(!P),P||c(24)},className:`px-4 py-2 rounded-lg font-semibold transition-all ${P?"bg-yellow-500 text-black":"bg-yellow-500/30 text-yellow-200 hover:bg-yellow-500/40"}`,children:P?"✓ Day Buyout Selected":"Use Day Buyout (24hrs for 20 XRP)"})]})]})}),!P&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2 font-semibold",children:"Hours to Feature"}),e.jsx("input",{type:"number",min:"1",max:"168",value:o,onChange:J=>c(Math.max(1,parseInt(J.target.value)||1)),className:"w-full bg-purple-900/30 border border-purple-500/30 rounded-lg px-4 py-3 text-purple-200 focus:outline-none focus:border-purple-500",disabled:d}),e.jsx("p",{className:"text-purple-400 text-sm mt-2",children:"1 XRP per hour. Maximum 168 hours (7 days)."})]}),e.jsxs("div",{className:"glass rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-purple-300",children:[e.jsx("span",{children:"Rate:"}),e.jsx("span",{children:P?"Special Deal":`${_} XRP/hour`})]}),e.jsxs("div",{className:"flex justify-between text-purple-300",children:[e.jsx("span",{children:"Duration:"}),e.jsxs("span",{children:[G," hour",G>1?"s":""]})]}),P&&e.jsxs("div",{className:"flex justify-between text-green-400 text-sm",children:[e.jsx("span",{children:"Regular Cost:"}),e.jsxs("span",{className:"line-through",children:[W," XRP"]})]}),P&&e.jsxs("div",{className:"flex justify-between text-green-400 text-sm font-semibold",children:[e.jsx("span",{children:"You Save:"}),e.jsx("span",{children:"4 XRP"})]}),e.jsx("div",{className:"border-t border-purple-500/30 pt-2 mt-2",children:e.jsxs("div",{className:"flex justify-between text-xl font-bold text-purple-200",children:[e.jsx("span",{children:"Total Cost:"}),e.jsxs("span",{className:P?"text-yellow-400":"",children:[E," XRP"]})]})})]}),e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"text-blue-400 text-xl",children:"ℹ️"}),e.jsxs("div",{className:"text-blue-200 text-sm space-y-1",children:[e.jsx("p",{children:e.jsx("strong",{children:"How it works:"})}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsx("li",{children:"Your token will appear in the selected top spot"}),e.jsx("li",{children:"Featured tokens get premium visibility on the dashboard"}),e.jsx("li",{children:"The spot is reserved for the duration you purchase"}),e.jsx("li",{children:"After expiration, the spot becomes available again"})]})]})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:t,disabled:d,className:"flex-1 glass hover:bg-purple-500/20 text-purple-300 py-3 rounded-lg transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:ge,disabled:!l||d||w,className:"flex-1 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white py-3 rounded-lg font-semibold transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Processing...":`Pay ${E} XRP`})]})]})]})}):null}function V0({isOpen:r,onClose:t,tokens:s,onSelectToken:a}){const[n,l]=m.useState("");if(!r)return null;const i=s.filter(o=>o.token_name.toLowerCase().includes(n.toLowerCase())||o.currency_code.toLowerCase().includes(n.toLowerCase()));return e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-2xl p-6 max-w-2xl w-full max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-200",children:"Select a Token to Feature"}),e.jsx("button",{onClick:t,className:"text-purple-400 hover:text-purple-200 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search tokens...",value:n,onChange:o=>l(o.target.value),className:"w-full bg-purple-900/30 border border-purple-500/30 rounded-lg px-4 py-3 text-purple-200 placeholder-purple-400/50 focus:outline-none focus:border-purple-500"})}),e.jsx("div",{className:"flex-1 overflow-y-auto space-y-2",children:i.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-4xl mb-4",children:"🔍"}),e.jsx("p",{className:"text-purple-400",children:"No tokens found"})]}):i.map(o=>e.jsx("button",{onClick:()=>a(o),className:"w-full glass rounded-lg p-4 hover:bg-purple-500/20 transition-all text-left",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ft,{token:o,size:"xl"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-purple-200",children:o.token_name}),e.jsx("p",{className:"text-purple-400 text-sm",children:o.currency_code})]}),o.amm_pool_created&&e.jsx("span",{className:"px-3 py-1 bg-green-500/20 text-green-400 text-sm rounded-full",children:"Pool Active"})]})},o.id))})]})})}const z0="sEd7W72aANTbLTG98XDhU1yfotPJdhu";async function nn(r){try{const{data:t,error:s}=await S.from("token_creation_rewards").select("*").eq("wallet_address",r).order("created_at",{ascending:!1});if(s)throw s;const a=t.filter(c=>!c.claimed),n=t.filter(c=>c.claimed),l=a.reduce((c,d)=>c+parseFloat(d.reward_amount),0),i=n.reduce((c,d)=>c+parseFloat(d.reward_amount),0),o=l+i;return{allRewards:t,unclaimedRewards:a,claimedRewards:n,totalUnclaimed:l,totalClaimed:i,totalRewards:o,tokenCount:t.length}}catch(t){throw t}}async function xl(r,t){try{const{unclaimedRewards:s,totalUnclaimed:a}=await nn(r);if(a===0)throw new Error("No rewards to claim");const{getClient:n}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),l=await n(),i=Re.Wallet.fromSeed(z0),o=Re.Wallet.fromSeed(t),c={TransactionType:"Payment",Account:i.address,Destination:o.address,Amount:Re.xrpToDrops(a.toFixed(6)),Memos:[{Memo:{MemoData:Buffer.from("Token Creation Rewards Claim","utf8").toString("hex").toUpperCase()}}]},d=await l.autofill(c),u=i.sign(d),h=await l.submitAndWait(u.tx_blob);if(h.result.meta.TransactionResult!=="tesSUCCESS")throw new Error(`Payment failed: ${h.result.meta.TransactionResult}`);const g=s.map(f=>f.id),{error:y}=await S.from("token_creation_rewards").update({claimed:!0,claimed_at:new Date().toISOString(),claim_tx_hash:h.result.hash}).in("id",g);if(y)throw y;return{success:!0,amount:a,txHash:h.result.hash,rewardsCount:s.length}}catch(s){throw s}}function K0({wallet:r,xrpPrice:t=2.5}){const[s,a]=m.useState(null),[n,l]=m.useState(!0),[i,o]=m.useState(!1),[c,d]=m.useState(!1);m.useEffect(()=>{r!=null&&r.address&&u()},[r]);const u=async()=>{if(r!=null&&r.address)try{l(!0);const f=await nn(r.address);a(f)}catch{}finally{l(!1)}},h=()=>{d(!0)},g=async()=>{if(!(r!=null&&r.seed)){k.error("Wallet seed not available"),d(!1);return}if(s.totalUnclaimed===0){k.error("No rewards to claim"),d(!1);return}try{o(!0);const f=await xl(r.address,r.seed);k.success(`Successfully claimed ${f.amount.toFixed(2)} XRP!`,{duration:5e3}),d(!1),await u()}catch(f){k.error(f.message||"Failed to claim rewards"),d(!1)}finally{o(!1)}};if(n)return e.jsx("div",{className:"glass rounded-lg p-4 sm:p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-purple-500/20 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-8 bg-purple-500/20 rounded w-1/2"})]})});if(!s)return null;const y=s.totalRewards>0;return e.jsxs("div",{className:`glass rounded-lg p-4 sm:p-6 relative overflow-hidden ${s.totalUnclaimed>0?"border-2 border-green-500/50 shadow-lg shadow-green-500/20":"border border-purple-500/30"}`,children:[s.totalUnclaimed>0&&e.jsx("div",{className:"absolute inset-0 opacity-30",style:{background:"linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(5, 150, 105, 0.1) 100%)",animation:"glow-pulse 3s ease-in-out infinite"}}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-purple-400 text-xs sm:text-sm mb-2",children:"💰 Token Creation Rewards"}),e.jsxs("div",{className:"flex items-baseline gap-2 flex-wrap mb-2",children:[e.jsxs("div",{className:`text-2xl sm:text-3xl font-bold ${s.totalUnclaimed>0?"text-green-400":"text-purple-300"}`,children:[s.totalUnclaimed.toFixed(2)," XRP"]}),s.totalUnclaimed>0&&e.jsx("div",{className:"text-green-300 text-sm sm:text-base font-medium",children:"Available to Claim"})]}),e.jsx("div",{className:"text-purple-300 text-xs sm:text-sm mb-3",children:s.totalUnclaimed>0?e.jsxs(e.Fragment,{children:["$",(s.totalUnclaimed*t).toFixed(2)," USD | ",s.unclaimedRewards.length," tokens created"]}):y?e.jsxs(e.Fragment,{children:["Total Earned: ",s.totalRewards.toFixed(2)," XRP | ",s.tokenCount," tokens created | All claimed!"]}):e.jsx(e.Fragment,{children:"Create tokens on the Memes page to earn 0.10 XRP per token"})}),e.jsxs("button",{onClick:h,className:`w-full font-bold px-4 py-2 rounded-lg text-sm transition-all ${s.totalUnclaimed>0?"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white":"bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white"}`,style:{boxShadow:s.totalUnclaimed>0?"0 0 15px rgba(16, 185, 129, 0.3)":"0 0 15px rgba(168, 85, 247, 0.3)",animation:s.totalUnclaimed>0?"glow-pulse 2s ease-in-out infinite":"none"},children:["💰 Claim ",s.totalUnclaimed.toFixed(2)," XRP"]})]}),e.jsx("style",{children:`
        @keyframes glow-pulse {
          0%, 100% {
            opacity: 0.3;
          }
          50% {
            opacity: 0.5;
          }
        }
      `}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:()=>d(!1),children:e.jsxs("div",{className:"glass rounded-lg max-w-md w-full p-8",onClick:f=>f.stopPropagation(),children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-4",children:"Claim Rewards"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"glass-inner rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Amount to Claim"}),e.jsxs("div",{className:"text-3xl font-bold text-green-400",children:[s.totalUnclaimed.toFixed(2)," XRP"]}),e.jsxs("div",{className:"text-green-300 text-sm mt-1",children:["$",(s.totalUnclaimed*t).toFixed(2)," USD"]})]}),s.totalUnclaimed===0&&e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsx("p",{className:"text-yellow-300 text-sm",children:"⚠️ No rewards available to claim. Create tokens on the Memes page to earn 0.10 XRP per token!"})}),s.totalUnclaimed>0&&e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:e.jsxs("p",{className:"text-blue-300 text-sm",children:[e.jsx("strong",{children:"ℹ️ Claiming Process:"}),e.jsx("br",{}),"• XRP will be sent to: ",r.address.slice(0,15),"...",e.jsx("br",{}),"• From ",s.unclaimedRewards.length," token creation",s.unclaimedRewards.length>1?"s":"",e.jsx("br",{}),"• No fees - completely free!",e.jsx("br",{}),"• Takes a few seconds to process"]})})]}),e.jsxs("div",{className:"flex gap-3",children:[s.totalUnclaimed>0?e.jsx("button",{onClick:g,disabled:i,className:"flex-1 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold px-6 py-3 rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:i?"⏳ Claiming...":`💰 Claim ${s.totalUnclaimed.toFixed(2)} XRP`}):e.jsx("button",{onClick:()=>d(!1),className:"flex-1 bg-purple-600 hover:bg-purple-700 text-white font-bold px-6 py-3 rounded-lg",children:"Close"}),s.totalUnclaimed>0&&e.jsx("button",{onClick:()=>d(!1),disabled:i,className:"btn text-purple-300 px-6 py-3 rounded-lg font-medium disabled:opacity-50",children:"Cancel"})]})]})})]})}const G0="sEd7bAfzqZWKxaatJpoWzTvENyaTg1Y",wn="rKxBBMmY969Ph1y63ddVfYyN7xmxwDfVq6",J0="sEd7W72aANTbLTG98XDhU1yfotPJdhu";function ii(){var Wt,da;const[r,t]=m.useState([]),[s,a]=m.useState({}),[n,l]=m.useState({}),[i,o]=m.useState(null),[c,d]=m.useState({totalTokens:0,totalValue:0,topPerformer:null,recentActivity:[]}),[u,h]=m.useState(0),[g,y]=m.useState({totalXrpLocked:0,totalMarketCap:0}),[f,w]=m.useState({totalXrpLocked:0,totalMarketCap:0}),[b,P]=m.useState({totalTrustlines:0,totalHolders:0,trustlines24hAgo:0,holders24hAgo:0}),[A,_]=m.useState(0),[W,D]=m.useState(!1),[I,E]=m.useState(!1),[G,_e]=m.useState(!1),[ge,Ce]=m.useState(""),[ue,J]=m.useState(null),[se,F]=m.useState(!1),[X,me]=m.useState(!1),[ve,He]=m.useState(""),[pe,xe]=m.useState({name:"",issuer:"",supply:"1000000",xrpLocked:"1",description:"",twitterHandle:"",websiteUrl:""}),[le,$e]=m.useState(null),[Ne,q]=m.useState(null),[ee,L]=m.useState(!1),[re,B]=m.useState(()=>window.innerWidth<768?"grid":"list"),[Y,oe]=m.useState("grid"),[ie,ye]=m.useState(null),[te,U]=m.useState(!1),[ke,he]=m.useState([]),[Oe,$]=m.useState(!1),[be,We]=m.useState(!1),[tt,nt]=m.useState(""),[M,fe]=m.useState(null),[K,v]=m.useState(null),[p,x]=m.useState(null),[R,H]=m.useState(null),[z,ae]=m.useState(!1),[qe,Ie]=m.useState(!1),[Je,et]=m.useState([]),[ze,dt]=m.useState(0),[Rt,Tt]=m.useState(!1),[wt,Mt]=m.useState(null),[ut,jt]=m.useState(""),[pt,lt]=m.useState("all"),[j,Q]=m.useState("all"),[Z,Se]=m.useState("newest"),[Ae,de]=m.useState("desc"),[Pe,Ve]=m.useState(1),[Ye,Le]=m.useState("all"),[at,T]=m.useState("all"),[ne,Fe]=m.useState(null),[Xe,st]=m.useState(null),[gt,Qe]=m.useState(!1),[ot,yt]=m.useState({}),[Nt,xt]=m.useState(!1),[Ge,kt]=m.useState(!1),[bt,St]=m.useState(null),Ct=100;m.useEffect(()=>{(async()=>{await Bt(),await Cs(),_t(),Gt()})();const C=setInterval(()=>{Bt(),Gt()},6e4),V=()=>{_t()};return window.addEventListener("walletConnected",V),window.addEventListener("walletDisconnected",V),()=>{clearInterval(C),window.removeEventListener("walletConnected",V),window.removeEventListener("walletDisconnected",V)}},[]),m.useEffect(()=>{const N=C=>{ne&&!C.target.closest(".swap-dropdown")&&Fe(null),Xe&&!C.target.closest(".trust-dropdown")&&st(null)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[ne,Xe]),m.useEffect(()=>{r.length>0&&Object.keys(s).length===0&&bs()},[r]),m.useEffect(()=>{const N=setInterval(()=>{r.length>0&&bs(!1)},3e5);return()=>clearInterval(N)},[r]),m.useEffect(()=>{Object.keys(s).length>0&&fs()},[s,r]),m.useEffect(()=>{r.length>0&&b.totalTrustlines===0&&(Qt(),$t())},[r]),m.useEffect(()=>{i&&Object.keys(s).length>0&&Object.keys(n).length===0&&Xt()},[i,s]),m.useEffect(()=>{if(r.length>0){const N={};r.forEach(V=>{if(V.amm_pool_created){const ce=parseFloat(Et(V));ot[V.id]||(N[V.id]=ce)}}),Object.keys(N).length>0&&yt(V=>({...V,...N}));const C=setInterval(()=>{const V={};r.forEach(ce=>{ce.amm_pool_created&&(V[ce.id]=parseFloat(Et(ce)))}),yt(V)},6e4);return()=>clearInterval(C)}},[r]);const _t=()=>{const N=localStorage.getItem("connectedWallet");o(N?JSON.parse(N):null)},Gt=async()=>{var N;try{const V=await(await fetch("https://api.coingecko.com/api/v3/simple/price?ids=ripple&vs_currencies=usd")).json();h(((N=V.ripple)==null?void 0:N.usd)||0)}catch{}},fs=()=>{let N=0,C=0,V=0,ce=0;const je=Date.now()-24*60*60*1e3;r.forEach(De=>{const Ee=s[De.id];if(Ee){N+=Ee.xrpAmount;const Me=Ee.price,Ze=De.supply||0;C+=Me*Ze,new Date(De.created_at).getTime()>je||(V+=Ee.xrpAmount,ce+=Me*Ze)}}),y({totalXrpLocked:N,totalMarketCap:C}),w({totalXrpLocked:V,totalMarketCap:ce})},$t=()=>{const N=Date.now()-864e5,C=r.filter(V=>new Date(V.created_at).getTime()>N);_(C.length)},Qt=async()=>{const N=new Re.Client("wss://xrplcluster.com");try{await N.connect();let C=0;const V=new Set,ce=new Set,je=Date.now()-24*60*60*1e3,De=r.filter(Me=>new Date(Me.created_at).getTime()>je);let Ee=0;for(const Me of r){if(!Me.amm_pool_created)continue;const Ze=De.some(Be=>Be.id===Me.id);try{const Be=Me.currency_code.length>3?vt.Buffer.from(Me.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):Me.currency_code,Ke=await N.request({command:"account_lines",account:Me.issuer_address,ledger_index:"validated"});if(Ke.result.lines){const rt=Ke.result.lines.filter(mt=>Me.currency_code.length>3?mt.currency===Be:mt.currency===Me.currency_code);C+=rt.length,Ze||(Ee+=rt.length),rt.forEach(mt=>{parseFloat(mt.balance)>0&&(V.add(mt.account),Ze||ce.add(mt.account))})}}catch{}}P({totalTrustlines:C,totalHolders:V.size,trustlines24hAgo:Ee,holders24hAgo:ce.size}),await N.disconnect()}catch{}},Bt=async()=>{try{const N=n0("dashboard_tokens",Gr.TOKEN_LIST);if(N){t(N),setFilteredTokens(N);return}const{data:C,error:V}=await S.from("meme_tokens").select("*").order("created_at",{ascending:!1});if(V)throw V;const ce=C||[],{data:je}=await S.from("pool_data_cache").select("*").gte("last_updated",new Date(Date.now()-Gr.POOL_DATA).toISOString());if(je&&je.length>0){const Ee={};je.forEach(Me=>{Ee[Me.token_id]=Me}),ce.forEach(Me=>{if(Me.amm_pool_created){const Ze=Ee[Me.id];Ze&&(Me.amm_xrp_amount=parseFloat(Ze.xrp_amount),Me.amm_asset_amount=parseFloat(Ze.token_amount))}})}t(ce),l0("dashboard_tokens",ce);const De={totalTokens:ce.length,totalValue:ce.reduce((Ee,Me)=>Ee+(Me.amm_xrp_amount||0),0),topPerformer:ce[0]||null,recentActivity:ce.slice(0,5)};d(De)}catch{}},Cs=async()=>{try{const{data:N,error:C}=await S.from("pool_data_cache").select("*");if(!C&&N&&N.length>0){const V={};N.forEach(ce=>{V[ce.token_id]={xrpAmount:parseFloat(ce.xrp_amount),tokenAmount:parseFloat(ce.token_amount),lpTokens:parseFloat(ce.lp_tokens),price:parseFloat(ce.price),accountId:ce.account_id,volume24h:parseFloat(ce.volume_24h||0),priceChange24h:parseFloat(ce.price_change_24h||0)}}),a(V)}}catch{}},gs=async N=>{try{const C=new Date(Date.now()-864e5).toISOString(),{data:V,error:ce}=await S.from("trade_history").select("token_id, xrp_amount").in("token_id",N).gte("created_at",C);if(ce)throw ce;const je={};return N.forEach(De=>je[De]=0),V&&V.length>0&&V.forEach(De=>{const Ee=parseFloat(De.xrp_amount||0);je[De.token_id]=(je[De.token_id]||0)+Ee}),je}catch{return{}}},bs=async(N=!1)=>{var C;try{const{data:ce,error:je}=await S.from("pool_data_cache").select("*").gte("last_updated",new Date(Date.now()-3e5).toISOString());if(!N&&ce&&ce.length>0&&!je){const Ke={};ce.forEach(rt=>{Ke[rt.token_id]={xrpAmount:parseFloat(rt.xrp_amount),tokenAmount:parseFloat(rt.token_amount),lpTokens:parseFloat(rt.lp_tokens),price:parseFloat(rt.price),accountId:rt.account_id,volume24h:parseFloat(rt.volume_24h||0),priceChange24h:parseFloat(rt.price_change_24h||0)}}),a(Ke);return}const{requestWithRetry:De}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),Ee={},Me=r.filter(Ke=>Ke.amm_pool_created),Ze=await gs(Me.map(Ke=>Ke.id));for(const Ke of r)if(Ke.amm_pool_created)try{const rt=Ke.currency_code.length>3?vt.Buffer.from(Ke.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):Ke.currency_code,mt=await De({command:"amm_info",asset:{currency:"XRP"},asset2:{currency:rt,issuer:Ke.issuer_address},ledger_index:"validated"});if(mt.result.amm){const It=mt.result.amm,Ot=parseFloat(It.amount)/1e6,At=parseFloat(It.amount2.value),qt=parseFloat(((C=It.lp_token)==null?void 0:C.value)||0),us=Ze[Ke.id]||0;Ee[Ke.id]={xrpAmount:Ot,tokenAmount:At,lpTokens:qt,price:Ot/At,accountId:It.account,volume24h:us}}}catch{}const Be=Object.entries(Ee).map(([Ke,rt])=>({token_id:Ke,xrp_amount:rt.xrpAmount,token_amount:rt.tokenAmount,lp_tokens:rt.lpTokens,price:rt.price,account_id:rt.accountId,volume_24h:rt.volume24h||0,price_change_24h:0,last_updated:new Date().toISOString()}));if(Be.length>0)for(const Ke of Be)await S.from("pool_data_cache").upsert(Ke,{onConflict:"token_id"});a(Ee)}catch{}},Xt=async()=>{if(!i)return;const N=new Re.Client("wss://xrplcluster.com");try{await N.connect();const C=await N.request({command:"account_lines",account:i.address,ledger_index:"validated"}),V={};C.result.lines&&C.result.lines.forEach(ce=>{const je=r.find(De=>{const Ee=s[De.id];return Ee&&ce.account===Ee.accountId});je&&(V[je.id]=ce.balance)}),l(V),await N.disconnect()}catch{}},Ut=()=>{if(ve!=="divercity"){k.error("Incorrect password!");return}me(!1),E(!0),He("")},Ts=N=>{const C=N.target.files[0];if(C){$e(C);const V=new FileReader;V.onloadend=()=>{q(V.result)},V.readAsDataURL(C)}},O=async()=>{if(!pe.name||!pe.issuer){k.error("Token name and issuer are required");return}try{L(!0);let N=null;le&&(N=await Oa(le));const C={token_name:pe.name,currency_code:pe.name,issuer_address:pe.issuer,receiver_address:"Manual Entry",supply:parseFloat(pe.supply),amm_xrp_amount:parseFloat(pe.xrpLocked),amm_pool_created:!0,status:"manual",amm_asset_amount:parseFloat(pe.supply)*.9,description:pe.description||null,twitter_handle:pe.twitterHandle||null,website_url:pe.websiteUrl||null};N&&(C.image_url=N);const{data:V,error:ce}=await S.from("meme_tokens").insert([C]).select();if(ce)throw ce;V&&V[0]&&await Yn(V[0].id),k.success(`Token ${pe.name} added successfully!`),E(!1),xe({name:"",issuer:"",supply:"1000000",xrpLocked:"1",description:"",twitterHandle:"",websiteUrl:""}),$e(null),q(null),Bt()}catch{k.error("Failed to add token")}finally{L(!1)}},Te=async()=>{var V,ce;if(ge!=="divercity"){k.error("Incorrect password!");return}D(!0),_e(!1),Ie(!0),Tt(!1),dt(0),et([{title:"Generating Token Name",status:"pending"},{title:"Connecting to XRPL",status:"pending"},{title:"Validating Wallets",status:"pending"},{title:"Creating Trust Line",status:"pending"},{title:"Issuing Tokens",status:"pending"},{title:"Saving to Database",status:"pending"},{title:"Creating AMM Pool",status:"pending"},{title:"Complete",status:"pending"}]);const C=(je,De,Ee={})=>{et(Me=>Me.map((Ze,Be)=>Be===je?{...Ze,status:De,...Ee}:Ze)),dt(je)};try{C(0,"active");const je=M0();C(0,"complete",{data:`Token name: ${je}`}),C(1,"active");const De=new Re.Client("wss://s.altnet.rippletest.net:51233");await De.connect(),C(1,"complete"),C(2,"active");const Ee=Re.Wallet.fromSeed(G0),Me=Re.Wallet.fromSeed(J0);try{await De.request({command:"account_info",account:Ee.address})}catch(is){if(((V=is.data)==null?void 0:V.error)==="actNotFound"){C(2,"error",{error:"Issuer wallet not funded"}),k.error("Issuer wallet needs XRP. Please fund: "+Ee.address),await De.disconnect(),D(!1);return}}try{await De.request({command:"account_info",account:Me.address})}catch(is){if(((ce=is.data)==null?void 0:ce.error)==="actNotFound"){C(2,"error",{error:"Receiver wallet not funded"}),k.error("Receiver wallet needs XRP. Please fund: "+Me.address),await De.disconnect(),D(!1);return}}C(2,"complete"),C(3,"active");const Ze={TransactionType:"TrustSet",Account:Me.address,LimitAmount:{currency:je,issuer:Ee.address,value:"1000000"}},Be=await De.autofill(Ze),Ke=Me.sign(Be),rt=await De.submitAndWait(Ke.tx_blob);if(rt.result.meta.TransactionResult!=="tesSUCCESS")throw C(3,"error",{error:rt.result.meta.TransactionResult}),new Error("Trust line creation failed: "+rt.result.meta.TransactionResult);C(3,"complete",{txHash:rt.result.hash}),C(4,"active");const mt={TransactionType:"Payment",Account:Ee.address,Destination:Me.address,Amount:{currency:je,value:"1000000",issuer:Ee.address}},It=await De.autofill(mt),Ot=Ee.sign(It),At=await De.submitAndWait(Ot.tx_blob);if(At.result.meta.TransactionResult!=="tesSUCCESS")throw C(4,"error",{error:At.result.meta.TransactionResult}),new Error("Token issuance failed: "+At.result.meta.TransactionResult);C(4,"complete",{txHash:At.result.hash}),C(5,"active");const{data:qt,error:us}=await S.from("meme_tokens").insert([{token_name:je,currency_code:je,issuer_address:Ee.address,receiver_address:Me.address,supply:1e6,tx_hash:At.result.hash,status:"issued",amm_pool_created:!1}]).select().single();if(us)throw C(5,"error",{error:us.message}),us;await Yn(qt.id),await Jt({userAddress:Ee.address,actionType:Yt.TOKEN_CREATED,description:`Created random meme token "${je}" with 1M supply`,details:{token_name:je,supply:1e6,issuer:Ee.address},txHash:At.result.hash,tokenId:qt.id}),C(5,"complete"),C(6,"active");try{const is={TransactionType:"AMMCreate",Account:Me.address,Amount:{currency:je,value:"900000",issuer:Ee.address},Amount2:Re.xrpToDrops("1"),TradingFee:500},Es=await De.autofill(is),Ps=Me.sign(Es),Ds=await De.submitAndWait(Ps.tx_blob);Ds.result.meta.TransactionResult==="tesSUCCESS"?(await S.from("meme_tokens").update({amm_pool_created:!0,amm_tx_hash:Ds.result.hash,amm_asset_amount:9e5,amm_xrp_amount:1,initial_asset_amount:9e5,initial_xrp_amount:1,status:"amm_created"}).eq("id",qt.id),await Jt({userAddress:Me.address,actionType:Yt.AMM_CREATED,description:`Created AMM pool for ${je} with 900K tokens and 1 XRP`,details:{token_name:je,token_amount:9e5,xrp_amount:1},txHash:Ds.result.hash,tokenId:qt.id}),C(6,"complete",{txHash:Ds.result.hash})):C(6,"error",{error:Ds.result.meta.TransactionResult})}catch(is){C(6,"error",{error:is.message})}await De.disconnect(),C(7,"complete"),Tt(!0),Mt({name:je,supply:1e6,issuer:Ee.address,receiver:Me.address,token:qt}),Bt()}catch(je){k.error(`Failed to create token: ${je.message}`),Ie(!1)}finally{D(!1),Ce("")}},Ue=N=>{if(!N.amm_pool_created||!N.amm_xrp_amount||!N.amm_asset_amount)return 0;const C=N.amm_xrp_amount/N.amm_asset_amount;return(N.supply*C).toFixed(4)},it=N=>{const C=s[N.id];return C?C.price.toFixed(8):!N.amm_pool_created||!N.amm_xrp_amount||!N.amm_asset_amount?0:(N.amm_xrp_amount/N.amm_asset_amount).toFixed(8)},Et=N=>{const C=s[N.id];return C?(C.xrpAmount*.15).toFixed(2):N.amm_pool_created?((N.amm_xrp_amount||0)*.15).toFixed(2):"-"},ss=N=>{const C=s[N.id];if(!C||!C.price)return"0.00";const V=parseFloat(N.initial_xrp_amount)||parseFloat(N.amm_xrp_amount),ce=parseFloat(N.initial_asset_amount)||parseFloat(N.amm_asset_amount);if(!V||!ce||ce===0)return"0.00";const je=C.price,De=V/ce;return!De||De===0?"0.00":((je-De)/De*100).toFixed(2)},rs=N=>{const C=parseFloat(Et(N));if(!C||C===0||!ot[N.id])return"0.00";const V=ot[N.id];return!V||V===0?"0.00":((C-V)/V*100).toFixed(2)},vs=N=>{Z===N?de(Ae==="asc"?"desc":"asc"):(Se(N),de("desc"))},Bs=N=>{const C=it(N),V=Ue(N),ce=vt.Buffer.from(N.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"),je=`https://xrpl.services/?issuer=${N.issuer_address}&currency=${ce}&limit=${N.supply}`,De=`https://xmagnetic.org/dex/${N.currency_code}+${N.issuer_address}_XRP+XRP?network=mainnet`,Ee=`🚀 ${N.token_name} Token Info

💰 Supply: ${N.supply.toLocaleString()}
📊 Price: ${C} XRP
💎 Market Cap: ${V} XRP
✅ Status: ${N.amm_pool_created?"AMM Pool Active":"Pending"}

🔗 Trust Line:
${je}

💱 Trade on Magnetic:
${De}

MORE #MEME COINS @ MEMEKINGS.ONLINE

#XRPL #Crypto #XRP`,Me=`https://twitter.com/intent/tweet?text=${encodeURIComponent(Ee)}`;window.open(Me,"_blank","width=550,height=420")},oa=(N,C=null)=>{fe({type:N,token:C}),We(!0),nt("")},dr=async()=>{if(tt!=="divercity"){k.error("Incorrect admin password!");return}try{if(M.type==="delete"){const{error:N}=await S.from("meme_tokens").delete().eq("id",M.token.id);if(N)throw N;k.success(`Token ${M.token.token_name} deleted!`)}else if(M.type==="edit"){v({...M.token,is_featured:M.token.is_featured||!1,featured_order:M.token.featured_order||null}),x(null),H(null),We(!1);return}We(!1),nt(""),fe(null),Bt()}catch{k.error("Failed to execute action")}},ds=N=>{const C=N.target.files[0];if(C){x(C);const V=new FileReader;V.onloadend=()=>{H(V.result)},V.readAsDataURL(C)}},ca=async()=>{if(tt!=="divercity"){k.error("Incorrect admin password!");return}try{ae(!0);let N=K.image_url;p&&(k.loading("Uploading image to IPFS..."),N=await Oa(p),k.dismiss(),k.success("Image uploaded successfully!")),K.is_featured&&K.featured_order?await ni(K.id,K.featured_order):K.is_featured===!1&&await ni(K.id,null);const C={token_name:K.token_name,supply:parseFloat(K.supply),amm_xrp_amount:parseFloat(K.amm_xrp_amount),amm_asset_amount:parseFloat(K.amm_asset_amount),image_url:N,category:K.category||"Other",updated_at:new Date().toISOString()},{data:V,error:ce}=await S.from("meme_tokens").update(C).eq("id",K.id).select();if(ce)throw ce;const je=V[0];t(De=>De.map(Ee=>Ee.id===K.id?{...je}:Ee)),$0(K.id),v(null),nt(""),x(null),H(null),k.success("Token updated successfully!"),setTimeout(()=>{Bt()},1e3)}catch(N){k.error("Failed to update token: "+N.message)}finally{ae(!1)}},ur=r.filter(N=>{const C=N.token_name.toLowerCase().includes(ut.toLowerCase())||N.issuer_address.toLowerCase().includes(ut.toLowerCase()),V=pt==="all"||pt==="active"&&N.amm_pool_created||pt==="pending"&&!N.amm_pool_created,ce=j==="all"||N.category===j,je=Ye==="all"||Ye==="memeking"&&N.issuer_address===wn||Ye==="user"&&i&&N.issuer_address===i.address;return C&&V&&ce&&je}).sort((N,C)=>{let V=0;switch(Z){case"newest":V=new Date(C.created_at)-new Date(N.created_at);break;case"oldest":V=new Date(N.created_at)-new Date(C.created_at);break;case"name":V=N.token_name.localeCompare(C.token_name);break;case"name-asc":V=N.token_name.localeCompare(C.token_name);break;case"name-desc":V=C.token_name.localeCompare(N.token_name);break;case"category":V=(N.category||"").localeCompare(C.category||"");break;case"days":V=hs(C.created_at)-hs(N.created_at);break;case"supply":V=C.supply-N.supply;break;case"supply-high":V=C.supply-N.supply;break;case"supply-low":V=N.supply-C.supply;break;case"price":V=parseFloat(it(C))-parseFloat(it(N));break;case"price-high":V=parseFloat(it(C))-parseFloat(it(N));break;case"price-low":V=parseFloat(it(N))-parseFloat(it(C));break;case"volume":V=parseFloat(Et(C))-parseFloat(Et(N));break;case"lp":V=(parseFloat(n[C.id])||0)-(parseFloat(n[N.id])||0);break;case"marketcap":V=parseFloat(Ue(C))-parseFloat(Ue(N));break;case"xrplocked":V=(C.amm_xrp_amount||0)-(N.amm_xrp_amount||0);break;case"status":V=(C.amm_pool_created?1:0)-(N.amm_pool_created?1:0);break;default:V=0}return Ae==="asc"?-V:V}),ys=Math.ceil(ur.length/Ct),pr=ur.slice((Pe-1)*Ct,Pe*Ct),mr=r.filter(N=>N.issuer_address===wn),hr=r.filter(N=>N.issuer_address!==wn),Lr=[...r].filter(N=>N.is_featured===!0).sort((N,C)=>(N.featured_order||999)-(C.featured_order||999)).slice(0,3),Dr=({token:N,featured:C=!1})=>e.jsxs("div",{className:`glass rounded-lg p-6 space-y-4 hover:scale-105 transition-transform cursor-pointer ${C?"border-2 border-purple-500/50":""}`,onClick:()=>ye(N),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ft,{token:N,size:"3xl"}),e.jsxs("div",{children:[e.jsx("h3",{className:`${C?"text-2xl":"text-xl"} font-bold text-purple-200`,children:N.token_name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:[e.jsx("p",{className:"text-purple-400 text-sm",children:N.currency_code}),N.category&&e.jsx(ir,{category:N.category,size:"xs"}),e.jsxs("span",{className:"px-2 py-0.5 bg-purple-500/20 text-purple-300 text-xs rounded-full font-medium",children:["📅 ",hs(N.created_at),"d"]})]})]})]}),N.amm_pool_created&&e.jsxs("div",{className:`px-3 py-1 rounded-full text-xs font-bold ${parseFloat(ss(N))>=0?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:[parseFloat(ss(N))>=0?"+":"",ss(N),"%"]}),!N.amm_pool_created&&e.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-medium bg-yellow-500/20 text-yellow-400",children:"○ Pending"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-400 text-xs",children:"Live Price"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-purple-200 text-sm font-bold",children:[it(N)," XRP"]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(parseFloat(it(N))*u).toFixed(6)]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-400 text-xs",children:"Volume 24h"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[e.jsx("span",{className:"text-purple-200 text-sm font-bold",children:N.amm_pool_created?`${Et(N)} XRP`:"-"}),N.amm_pool_created&&ot[N.id]&&e.jsxs("span",{className:`text-xs font-medium px-1.5 py-0.5 rounded ${parseFloat(rs(N))>=0?"text-green-300 bg-green-500/10":"text-red-300 bg-red-500/10"}`,children:[parseFloat(rs(N))>=0?"+":"",rs(N),"%"]})]}),N.amm_pool_created&&e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(parseFloat(Et(N))*u).toFixed(2)]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-400 text-xs",children:"Your LP"}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-green-400 text-sm font-bold",children:n[N.id]?parseFloat(n[N.id]).toFixed(4):"-"}),n[N.id]&&s[N.id]&&e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(parseFloat(n[N.id])*s[N.id].price*2*u).toFixed(2)]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-400 text-xs",children:"Market Cap (Live)"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-purple-200 text-sm font-bold font-mono",children:[Ue(N)," XRP"]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(parseFloat(Ue(N))*u).toFixed(2)]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-400 text-xs",children:"XRP Locked (Live)"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-purple-200 text-sm font-bold font-mono",children:[N.amm_xrp_amount?N.amm_xrp_amount.toFixed(2):"0.00"," XRP"]}),N.amm_xrp_amount&&e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(N.amm_xrp_amount*u).toFixed(2)]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-400 text-xs",children:"Total Supply"}),e.jsx("span",{className:"text-purple-200 text-sm font-bold",children:N.supply.toLocaleString()})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-3 border-t border-purple-500/20",children:[e.jsx("div",{onClick:V=>{V.stopPropagation()},children:e.jsx(Xa,{token:N,connectedWallet:i,tokenBalance:0,onTrustlineUpdate:()=>{Qt()},size:"sm",className:"w-full",showDropdown:!0,isDropdownOpen:Xe===N.id,onDropdownToggle:V=>st(Xe===V?null:V)})}),e.jsxs("div",{className:"relative swap-dropdown",onClick:V=>{V.stopPropagation()},children:[e.jsxs("button",{onClick:()=>Fe(ne===N.id?null:N.id),className:"w-full bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white font-bold text-xs px-3 py-2 rounded-lg text-center shadow-lg transition-all duration-300 flex items-center justify-center gap-1.5",children:[e.jsx("span",{children:"💱 Swap"}),e.jsx("svg",{className:`w-3.5 h-3.5 transition-transform ${ne===N.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),ne===N.id&&e.jsxs("div",{className:"absolute top-full left-0 mt-2 w-64 glass bg-gradient-to-br from-purple-900/95 to-purple-800/95 border border-purple-500/30 rounded-lg shadow-xl z-[9999] overflow-hidden",children:[e.jsxs("button",{onClick:()=>{Fe(null),localStorage.setItem("selectedTradeToken",JSON.stringify(N)),window.dispatchEvent(new CustomEvent("navigateToTrade",{detail:N}))},className:"w-full px-4 py-3 text-left hover:bg-purple-600/30 transition-colors flex items-center gap-3 border-b border-purple-500/30",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center text-purple-300",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-purple-100 font-medium",children:"Trade Page"}),e.jsx("div",{className:"text-purple-300 text-xs",children:"Swap on MEMEKINGS"})]})]}),e.jsxs("a",{href:`https://xmagnetic.org/dex/${encodeURIComponent(N.currency_code)}+${encodeURIComponent(N.issuer_address)}_XRP+XRP?network=mainnet`,target:"_blank",rel:"noopener noreferrer",className:"w-full px-4 py-3 text-left hover:bg-purple-600/30 transition-colors flex items-center gap-3",onClick:()=>Fe(null),children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center text-purple-300",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-purple-100 font-medium",children:"Magnetic Link"}),e.jsx("div",{className:"text-purple-300 text-xs",children:"Trade on xMagnetic"})]})]})]})]}),e.jsx("button",{className:"bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white font-bold text-xs px-3 py-2 rounded-lg shadow-lg shadow-purple-500/50 hover:shadow-purple-500/70",onClick:V=>{V.stopPropagation(),Bs(N)},children:"𝕏 Post on X"}),e.jsx("button",{className:"bg-gradient-to-r from-indigo-600 to-indigo-700 hover:from-indigo-700 hover:to-indigo-800 text-white font-bold text-xs px-3 py-2 rounded-lg shadow-lg shadow-indigo-500/50 hover:shadow-indigo-500/70",onClick:V=>{V.stopPropagation(),window.dispatchEvent(new CustomEvent("navigateToToken",{detail:N.token_name}))},children:"👁️ View Profile"})]})]}),Zt=({token:N})=>e.jsxs("tr",{className:"border-t border-purple-500/20 hover:bg-purple-900/20 cursor-pointer",onClick:()=>ye(N),children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ft,{token:N,size:"3xl"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-purple-200 hover:text-purple-100 cursor-pointer",onClick:C=>{C.stopPropagation(),window.dispatchEvent(new CustomEvent("navigateToToken",{detail:N.token_name}))},children:N.token_name}),e.jsx("div",{className:"text-purple-400 text-xs",children:N.currency_code})]})]})}),e.jsx("td",{className:"px-4 py-3",children:N.category?e.jsx(ir,{category:N.category,size:"xs"}):e.jsx("span",{className:"text-purple-400 text-xs",children:"-"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:"px-2 py-0.5 bg-purple-500/20 text-purple-300 text-xs rounded-full font-medium inline-block",children:["📅 ",hs(N.created_at),"d"]})}),e.jsx("td",{className:"px-4 py-3 text-purple-300 text-xs",children:N.supply.toLocaleString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-purple-200 font-mono text-xs",children:it(N)}),N.amm_pool_created&&e.jsxs("span",{className:`text-xs font-medium px-1.5 py-0.5 rounded whitespace-nowrap ${parseFloat(ss(N))>=0?"text-green-300 bg-green-500/10":"text-red-300 bg-red-500/10"}`,children:[parseFloat(ss(N))>=0?"+":"",ss(N),"%"]})]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(parseFloat(it(N))*u).toFixed(6)]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-purple-200 text-xs",children:N.amm_pool_created?`${Et(N)} XRP`:"-"}),N.amm_pool_created&&ot[N.id]&&e.jsxs("span",{className:`text-xs font-medium px-1.5 py-0.5 rounded whitespace-nowrap ${parseFloat(rs(N))>=0?"text-green-300 bg-green-500/10":"text-red-300 bg-red-500/10"}`,children:[parseFloat(rs(N))>=0?"+":"",rs(N),"%"]})]}),N.amm_pool_created&&e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(parseFloat(Et(N))*u).toFixed(2)]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-green-400 text-xs font-bold",children:n[N.id]?parseFloat(n[N.id]).toFixed(4):"-"}),n[N.id]&&s[N.id]&&e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(parseFloat(n[N.id])*s[N.id].price*2*u).toFixed(2)]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"text-purple-200 text-xs font-mono",children:[Ue(N)," XRP"]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(parseFloat(Ue(N))*u).toFixed(2)]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"text-purple-300 text-xs font-mono",children:[N.amm_xrp_amount?N.amm_xrp_amount.toFixed(2):"0.00"," XRP"]}),N.amm_xrp_amount&&e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(N.amm_xrp_amount*u).toFixed(2)]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${N.amm_pool_created?"bg-green-500/20 text-green-400":"bg-yellow-500/20 text-yellow-400"}`,children:N.amm_pool_created?"✓":"○"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-1 flex-wrap",children:[e.jsx("div",{onClick:C=>{C.stopPropagation()},children:e.jsx(Xa,{token:N,connectedWallet:i,tokenBalance:0,onTrustlineUpdate:()=>{Qt()},size:"sm",showDropdown:!0,isDropdownOpen:Xe===N.id,onDropdownToggle:C=>st(Xe===C?null:C)})}),e.jsxs("div",{className:"relative swap-dropdown",onClick:C=>{C.stopPropagation()},children:[e.jsxs("button",{onClick:()=>Fe(ne===N.id?null:N.id),className:"bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white font-bold text-xs px-3 py-2 rounded-lg shadow-lg transition-all duration-300 flex items-center gap-1.5",title:"Swap options",children:[e.jsx("span",{children:"💱 Swap"}),e.jsx("svg",{className:`w-3.5 h-3.5 transition-transform ${ne===N.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),ne===N.id&&e.jsxs("div",{className:"absolute top-full left-0 mt-2 w-64 glass bg-gradient-to-br from-purple-900/95 to-purple-800/95 border border-purple-500/30 rounded-lg shadow-xl z-[9999] overflow-hidden",children:[e.jsxs("button",{onClick:()=>{Fe(null),localStorage.setItem("selectedTradeToken",JSON.stringify(N)),window.dispatchEvent(new CustomEvent("navigateToTrade",{detail:N}))},className:"w-full px-4 py-3 text-left hover:bg-purple-600/30 transition-colors flex items-center gap-3 border-b border-purple-500/30",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center text-purple-300",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-purple-100 font-medium",children:"Trade Page"}),e.jsx("div",{className:"text-purple-300 text-xs",children:"Swap on MEMEKINGS"})]})]}),e.jsxs("a",{href:`https://xmagnetic.org/dex/${encodeURIComponent(N.currency_code)}+${encodeURIComponent(N.issuer_address)}_XRP+XRP?network=mainnet`,target:"_blank",rel:"noopener noreferrer",className:"w-full px-4 py-3 text-left hover:bg-purple-600/30 transition-colors flex items-center gap-3",onClick:()=>Fe(null),children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center text-purple-300",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-purple-100 font-medium",children:"Magnetic Link"}),e.jsx("div",{className:"text-purple-300 text-xs",children:"Trade on xMagnetic"})]})]})]})]}),e.jsx("button",{className:"bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white font-bold text-xs px-3 py-2 rounded-lg shadow-lg shadow-purple-500/50 hover:shadow-purple-500/70",onClick:C=>{C.stopPropagation(),Bs(N)},title:"Post on X",children:"𝕏 Post"})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white text-xs px-2 py-1 rounded",onClick:C=>{C.stopPropagation(),oa("edit",N)},title:"Edit Token",children:"✏️"}),e.jsx("button",{className:"bg-red-600 hover:bg-red-700 text-white text-xs px-2 py-1 rounded",onClick:C=>{C.stopPropagation(),oa("delete",N)},title:"Delete Token",children:"🗑️"})]})})]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-purple-200",children:"Dashboard"}),e.jsx("p",{className:"text-purple-400 mt-1 text-sm sm:text-base",children:"Meme token factory control center"})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 w-full sm:w-auto",children:[e.jsx("button",{onClick:async()=>{Qe(!0);try{await Bt(),await bs(!0),k.success("Dashboard refreshed!")}catch{k.error("Failed to refresh")}finally{Qe(!1)}},disabled:gt,className:"btn text-purple-300 px-3 sm:px-4 py-2 sm:py-3 rounded-lg font-medium flex items-center gap-1 sm:gap-2 text-sm sm:text-base flex-1 sm:flex-initial justify-center disabled:opacity-50",title:"Refresh Dashboard",children:e.jsx("span",{className:gt?"animate-spin":"",children:gt?"⟳":"🔄"})}),e.jsxs("button",{onClick:async()=>{if(!i){k.error("Please connect a wallet first");return}U(!0),$(!0);try{const{data:N,error:C}=await S.from("activity_logs").select("*").eq("user_address",i.address).order("created_at",{ascending:!1}).limit(50);if(C)throw C;he(N||[])}catch{k.error("Failed to load activities")}finally{$(!1)}},className:"btn text-purple-300 px-3 sm:px-4 py-2 sm:py-3 rounded-lg font-medium flex items-center gap-1 sm:gap-2 text-sm sm:text-base flex-1 sm:flex-initial justify-center",children:[e.jsx("span",{children:"📜"})," ",e.jsx("span",{className:"hidden xs:inline",children:"Activity"})]}),e.jsxs("a",{href:"https://x.com/MEMEKINGSXRPL",target:"_blank",rel:"noopener noreferrer",className:"btn text-white px-3 sm:px-4 py-2 sm:py-3 rounded-lg font-medium flex items-center gap-1 sm:gap-2 relative overflow-hidden group animate-glow text-sm sm:text-base flex-1 sm:flex-initial justify-center",style:{background:"linear-gradient(135deg, #9333ea 0%, #7e22ce 100%)",boxShadow:"0 0 20px rgba(147, 51, 234, 0.5)"},children:[e.jsx("span",{className:"text-xl",children:"𝕏"})," ",e.jsx("span",{className:"hidden xs:inline",children:"Twitter"})]})]})]}),i&&e.jsx(K0,{wallet:i,xrpPrice:u}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"glass rounded-lg p-4 sm:p-6",children:[e.jsx("div",{className:"text-purple-400 text-xs sm:text-sm mb-2",children:"Total Tokens"}),e.jsxs("div",{className:"flex items-baseline gap-2 flex-wrap",children:[e.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-green-400",children:c.totalTokens}),A>0&&e.jsxs("div",{className:"text-green-300 text-sm sm:text-base font-medium",children:["+",A," (+",(A/c.totalTokens*100).toFixed(1),"%)"]})]}),e.jsx("div",{className:"text-green-300 text-xs sm:text-sm mt-1",children:"MEMEKINGS Tokens"}),e.jsx("div",{className:"text-purple-500 text-xs mt-1",children:"Last 24h"})]}),e.jsxs("div",{className:"glass rounded-lg p-4 sm:p-6",children:[e.jsx("div",{className:"text-purple-400 text-xs sm:text-sm mb-2",children:"Total XRP Locked"}),e.jsxs("div",{className:"flex items-baseline gap-2 flex-wrap",children:[e.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-green-400",children:g.totalXrpLocked.toFixed(2)}),f.totalXrpLocked>0&&e.jsxs("div",{className:`text-sm sm:text-base font-medium ${g.totalXrpLocked>f.totalXrpLocked?"text-green-300":g.totalXrpLocked<f.totalXrpLocked?"text-red-300":"text-purple-400"}`,children:[g.totalXrpLocked>f.totalXrpLocked?"+":"",(g.totalXrpLocked-f.totalXrpLocked).toFixed(2),"(",((g.totalXrpLocked-f.totalXrpLocked)/f.totalXrpLocked*100).toFixed(1),"%)"]})]}),e.jsxs("div",{className:"text-green-300 text-xs sm:text-sm mt-1",children:["$",(g.totalXrpLocked*u).toFixed(2)," USD"]}),e.jsx("div",{className:"text-purple-500 text-xs mt-1",children:"Last 24h"})]}),e.jsxs("div",{className:"glass rounded-lg p-4 sm:p-6",children:[e.jsx("div",{className:"text-purple-400 text-xs sm:text-sm mb-2",children:"Total Market Cap"}),e.jsxs("div",{className:"flex items-baseline gap-2 flex-wrap",children:[e.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-green-400",children:g.totalMarketCap.toFixed(2)}),f.totalMarketCap>0&&e.jsxs("div",{className:`text-sm sm:text-base font-medium ${g.totalMarketCap>f.totalMarketCap?"text-green-300":g.totalMarketCap<f.totalMarketCap?"text-red-300":"text-purple-400"}`,children:[g.totalMarketCap>f.totalMarketCap?"+":"",(g.totalMarketCap-f.totalMarketCap).toFixed(2),"(",((g.totalMarketCap-f.totalMarketCap)/f.totalMarketCap*100).toFixed(1),"%)"]})]}),e.jsxs("div",{className:"text-green-300 text-xs sm:text-sm mt-1",children:["$",(g.totalMarketCap*u).toFixed(2)," USD"]}),e.jsx("div",{className:"text-purple-500 text-xs mt-1",children:"Last 24h"})]}),e.jsxs("div",{className:"glass rounded-lg p-4 sm:p-6",children:[e.jsx("div",{className:"text-purple-400 text-xs sm:text-sm mb-2",children:"Total Holders"}),e.jsxs("div",{className:"flex items-baseline gap-2 flex-wrap",children:[e.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-green-400",children:b.totalHolders.toLocaleString()}),b.holders24hAgo>0&&e.jsxs("div",{className:`text-sm sm:text-base font-medium ${b.totalHolders>b.holders24hAgo?"text-green-300":b.totalHolders<b.holders24hAgo?"text-red-300":"text-purple-400"}`,children:[b.totalHolders>b.holders24hAgo?"+":"",(b.totalHolders-b.holders24hAgo).toLocaleString(),"(",((b.totalHolders-b.holders24hAgo)/b.holders24hAgo*100).toFixed(1),"%)"]})]}),e.jsxs("div",{className:"text-green-300 text-xs sm:text-sm mt-1",children:[b.totalTrustlines.toLocaleString()," trustlines"]}),e.jsx("div",{className:"text-purple-500 text-xs mt-1",children:"Last 24h"})]})]}),Lr.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-purple-200",children:"🔥 Top 3 Featured"}),e.jsx("button",{onClick:()=>{if(!i){k.error("Please connect your wallet first");return}xt(!0)},className:"bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-700 hover:to-orange-700 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-all shadow-lg hover:shadow-xl flex items-center gap-2",children:"⭐ Get Featured"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>oe("grid"),className:`px-4 py-2 rounded-lg transition-all text-sm ${Y==="grid"?"bg-purple-600 text-white":"glass text-purple-300"}`,children:"▦ Grid"}),e.jsx("button",{onClick:()=>oe("list"),className:`px-4 py-2 rounded-lg transition-all text-sm ${Y==="list"?"bg-purple-600 text-white":"glass text-purple-300"}`,children:"☰ List"})]})]}),Y==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Lr.map(N=>e.jsx(Dr,{token:N,featured:!0},N.id))}):e.jsx("div",{className:"overflow-x-auto glass rounded-lg p-4",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-purple-900/30",children:e.jsxs("tr",{children:[e.jsxs("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>vs("name"),title:"Double-click to sort",children:["Token ",Z==="name"&&(Ae==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>vs("category"),title:"Double-click to sort",children:["Category ",Z==="category"&&(Ae==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>vs("days"),title:"Double-click to sort",children:["Days ",Z==="days"&&(Ae==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>vs("supply"),title:"Double-click to sort",children:["Supply ",Z==="supply"&&(Ae==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>vs("price"),title:"Double-click to sort",children:["Live Price ",Z==="price"&&(Ae==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>vs("volume"),title:"Double-click to sort",children:["Volume 24h ",Z==="volume"&&(Ae==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>vs("lp"),title:"Double-click to sort",children:["Your LP ",Z==="lp"&&(Ae==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>vs("marketcap"),title:"Double-click to sort",children:["Market Cap (Live) ",Z==="marketcap"&&(Ae==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>vs("xrplocked"),title:"Double-click to sort",children:["XRP Locked (Live) ",Z==="xrplocked"&&(Ae==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>vs("status"),title:"Double-click to sort",children:["Status ",Z==="status"&&(Ae==="asc"?"↑":"↓")]}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:Lr.map(N=>e.jsx(Zt,{token:N},N.id))})]})})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 mb-6 overflow-x-auto",children:[e.jsx("button",{onClick:()=>T("all"),className:`px-4 sm:px-6 py-2 sm:py-3 rounded-lg transition-all font-medium text-sm sm:text-lg whitespace-nowrap ${at==="all"?"bg-purple-600 text-white shadow-lg":"glass text-purple-300 hover:bg-purple-900/30"}`,children:"All Tokens"}),e.jsx("button",{onClick:()=>T("user"),className:`px-4 sm:px-6 py-2 sm:py-3 rounded-lg transition-all font-medium text-sm sm:text-lg whitespace-nowrap ${at==="user"?"bg-purple-600 text-white shadow-lg":"glass text-purple-300 hover:bg-purple-900/30"}`,children:"User Tokens"})]}),at==="all"&&e.jsxs("div",{className:"glass rounded-lg p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 mb-4",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-purple-200",children:"All Tokens"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>B("list"),className:`px-3 sm:px-4 py-2 rounded-lg transition-all text-sm sm:text-base ${re==="list"?"bg-purple-600 text-white":"glass text-purple-300"}`,children:["☰ ",e.jsx("span",{className:"hidden sm:inline",children:"List"})]}),e.jsxs("button",{onClick:()=>B("grid"),className:`px-3 sm:px-4 py-2 rounded-lg transition-all text-sm sm:text-base ${re==="grid"?"bg-purple-600 text-white":"glass text-purple-300"}`,children:["▦ ",e.jsx("span",{className:"hidden sm:inline",children:"Grid"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-2 sm:gap-3 mb-6",children:[e.jsx("input",{type:"text",placeholder:"🔍 Search...",value:ut,onChange:N=>jt(N.target.value),className:"input text-purple-200 sm:col-span-2 lg:col-span-2 text-sm sm:text-base"}),e.jsxs("select",{value:pt,onChange:N=>lt(N.target.value),className:"input text-purple-200 text-sm sm:text-base",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"pending",children:"Pending"})]}),e.jsxs("select",{value:j,onChange:N=>Q(N.target.value),className:"input text-purple-200 text-sm sm:text-base",children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"Meme",children:"😂 Meme"}),e.jsx("option",{value:"Gaming",children:"🎮 Gaming"}),e.jsx("option",{value:"DeFi",children:"💰 DeFi"}),e.jsx("option",{value:"Utility",children:"🔧 Utility"}),e.jsx("option",{value:"Community",children:"👥 Community"}),e.jsx("option",{value:"NFT",children:"🎨 NFT"}),e.jsx("option",{value:"AI",children:"🤖 AI"}),e.jsx("option",{value:"Other",children:"📦 Other"})]}),e.jsxs("select",{value:Z,onChange:N=>Se(N.target.value),className:"input text-purple-200 text-sm sm:text-base",children:[e.jsx("option",{value:"newest",children:"Newest"}),e.jsx("option",{value:"oldest",children:"Oldest"}),e.jsx("option",{value:"name-asc",children:"Name (A-Z)"}),e.jsx("option",{value:"name-desc",children:"Name (Z-A)"}),e.jsx("option",{value:"marketcap",children:"Market Cap"}),e.jsx("option",{value:"supply-high",children:"Supply ↓"}),e.jsx("option",{value:"supply-low",children:"Supply ↑"}),e.jsx("option",{value:"price-high",children:"Price ↓"}),e.jsx("option",{value:"price-low",children:"Price ↑"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-0 mb-3",children:[e.jsxs("div",{className:"text-purple-400 text-xs sm:text-sm",children:["Showing ",(Pe-1)*Ct+1,"-",Math.min(Pe*Ct,ur.length)," of ",ur.length," tokens"]}),ys>1&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>Ve(N=>Math.max(1,N-1)),disabled:Pe===1,className:"px-2 sm:px-3 py-1 btn text-purple-300 rounded disabled:opacity-50 text-xs sm:text-sm",children:[e.jsx("span",{className:"hidden sm:inline",children:"Previous"}),e.jsx("span",{className:"sm:hidden",children:"Prev"})]}),e.jsxs("span",{className:"text-purple-300 text-xs sm:text-sm whitespace-nowrap",children:[Pe,"/",ys]}),e.jsx("button",{onClick:()=>Ve(N=>Math.min(ys,N+1)),disabled:Pe===ys,className:"px-2 sm:px-3 py-1 btn text-purple-300 rounded disabled:opacity-50 text-xs sm:text-sm",children:"Next"})]})]}),re==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:pr.map(N=>e.jsx(Dr,{token:N},N.id))}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-purple-900/30",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Token"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Category"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Days"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Supply"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Live Price"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Volume 24h"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Your LP"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Market Cap (Live)"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"XRP Locked (Live)"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Status"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Actions"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Admin"})]})}),e.jsx("tbody",{children:pr.map(N=>e.jsx(Zt,{token:N},N.id))})]})})]}),at==="memeking_disabled"&&e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200",children:"MemeKing Tokens"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>B("list"),className:`px-4 py-2 rounded-lg transition-all ${re==="list"?"bg-purple-600 text-white":"glass text-purple-300"}`,children:"☰ List"}),e.jsx("button",{onClick:()=>B("grid"),className:`px-4 py-2 rounded-lg transition-all ${re==="grid"?"bg-purple-600 text-white":"glass text-purple-300"}`,children:"▦ Grid"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-6",children:[e.jsx("input",{type:"text",placeholder:"🔍 Search tokens...",value:ut,onChange:N=>jt(N.target.value),className:"input text-purple-200 md:col-span-2"}),e.jsxs("select",{value:pt,onChange:N=>lt(N.target.value),className:"input text-purple-200",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active Only"}),e.jsx("option",{value:"pending",children:"Pending Only"})]}),e.jsxs("select",{value:Z,onChange:N=>Se(N.target.value),className:"input text-purple-200",children:[e.jsx("option",{value:"newest",children:"Newest First"}),e.jsx("option",{value:"oldest",children:"Oldest First"}),e.jsx("option",{value:"marketcap",children:"Market Cap"}),e.jsx("option",{value:"supply",children:"Supply"})]})]}),e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"text-purple-400 text-sm",children:["Showing ",mr.filter(N=>{const C=N.token_name.toLowerCase().includes(ut.toLowerCase())||N.issuer_address.toLowerCase().includes(ut.toLowerCase()),V=pt==="all"||pt==="active"&&N.amm_pool_created||pt==="pending"&&!N.amm_pool_created;return C&&V}).length," of ",mr.length," MemeKing tokens"]})}),re==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:mr.filter(N=>{const C=N.token_name.toLowerCase().includes(ut.toLowerCase())||N.issuer_address.toLowerCase().includes(ut.toLowerCase()),V=pt==="all"||pt==="active"&&N.amm_pool_created||pt==="pending"&&!N.amm_pool_created;return C&&V}).sort((N,C)=>{var V,ce;switch(Z){case"oldest":return new Date(N.created_at)-new Date(C.created_at);case"marketcap":return(((V=s[C.id])==null?void 0:V.marketCap)||0)-(((ce=s[N.id])==null?void 0:ce.marketCap)||0);case"supply":return C.supply-N.supply;default:return new Date(C.created_at)-new Date(N.created_at)}}).map(N=>renderTokenCard(N))}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-purple-500/20",children:[e.jsx("th",{className:"text-left py-3 px-4 text-purple-300",children:"Token"}),e.jsx("th",{className:"text-left py-3 px-4 text-purple-300",children:"Supply"}),e.jsx("th",{className:"text-left py-3 px-4 text-purple-300",children:"XRP Locked (Live)"}),e.jsx("th",{className:"text-left py-3 px-4 text-purple-300",children:"Price"}),e.jsx("th",{className:"text-left py-3 px-4 text-purple-300",children:"Market Cap (Live)"}),e.jsx("th",{className:"text-left py-3 px-4 text-purple-300",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 text-purple-300",children:"Actions"})]})}),e.jsx("tbody",{children:mr.filter(N=>{const C=N.token_name.toLowerCase().includes(ut.toLowerCase())||N.issuer_address.toLowerCase().includes(ut.toLowerCase()),V=pt==="all"||pt==="active"&&N.amm_pool_created||pt==="pending"&&!N.amm_pool_created;return C&&V}).sort((N,C)=>{var V,ce;switch(Z){case"oldest":return new Date(N.created_at)-new Date(C.created_at);case"marketcap":return(((V=s[C.id])==null?void 0:V.marketCap)||0)-(((ce=s[N.id])==null?void 0:ce.marketCap)||0);case"supply":return C.supply-N.supply;default:return new Date(C.created_at)-new Date(N.created_at)}}).map(N=>e.jsx(Zt,{token:N},N.id))})]})})]}),at==="user"&&e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200",children:"User Created Tokens"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>B("list"),className:`px-4 py-2 rounded-lg transition-all ${re==="list"?"bg-purple-600 text-white":"glass text-purple-300"}`,children:"☰ List"}),e.jsx("button",{onClick:()=>B("grid"),className:`px-4 py-2 rounded-lg transition-all ${re==="grid"?"bg-purple-600 text-white":"glass text-purple-300"}`,children:"▦ Grid"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-6",children:[e.jsx("input",{type:"text",placeholder:"🔍 Search tokens...",value:ut,onChange:N=>jt(N.target.value),className:"input text-purple-200 md:col-span-2"}),e.jsxs("select",{value:pt,onChange:N=>lt(N.target.value),className:"input text-purple-200",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active Only"}),e.jsx("option",{value:"pending",children:"Pending Only"})]}),e.jsxs("select",{value:Z,onChange:N=>Se(N.target.value),className:"input text-purple-200",children:[e.jsx("option",{value:"newest",children:"Newest First"}),e.jsx("option",{value:"oldest",children:"Oldest First"}),e.jsx("option",{value:"marketcap",children:"Market Cap"}),e.jsx("option",{value:"supply",children:"Supply"})]})]}),e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"text-purple-400 text-sm",children:["Showing ",hr.filter(N=>{const C=N.token_name.toLowerCase().includes(ut.toLowerCase())||N.issuer_address.toLowerCase().includes(ut.toLowerCase()),V=pt==="all"||pt==="active"&&N.amm_pool_created||pt==="pending"&&!N.amm_pool_created;return C&&V}).length," of ",hr.length," user tokens"]})}),re==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:hr.filter(N=>{const C=N.token_name.toLowerCase().includes(ut.toLowerCase())||N.issuer_address.toLowerCase().includes(ut.toLowerCase()),V=pt==="all"||pt==="active"&&N.amm_pool_created||pt==="pending"&&!N.amm_pool_created;return C&&V}).sort((N,C)=>{switch(Z){case"newest":return new Date(C.created_at)-new Date(N.created_at);case"oldest":return new Date(N.created_at)-new Date(C.created_at);case"marketcap":return parseFloat(Ue(C))-parseFloat(Ue(N));case"supply":return C.supply-N.supply;default:return 0}}).map(N=>e.jsx(Dr,{token:N},N.id))}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-purple-900/30",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Token"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Supply"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Starting Price"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Live Price"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Volume 24h"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Your LP"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Starting Cap"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Starting XRP"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Status"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Actions"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Admin"})]})}),e.jsx("tbody",{children:hr.filter(N=>{const C=N.token_name.toLowerCase().includes(ut.toLowerCase())||N.issuer_address.toLowerCase().includes(ut.toLowerCase()),V=pt==="all"||pt==="active"&&N.amm_pool_created||pt==="pending"&&!N.amm_pool_created;return C&&V}).sort((N,C)=>{switch(Z){case"newest":return new Date(C.created_at)-new Date(N.created_at);case"oldest":return new Date(N.created_at)-new Date(C.created_at);case"marketcap":return parseFloat(Ue(C))-parseFloat(Ue(N));case"supply":return C.supply-N.supply;default:return 0}}).map(N=>e.jsx(Zt,{token:N},N.id))})]})})]}),X&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-lg p-8 max-w-md w-full",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-4",children:"Password Required"}),e.jsx("p",{className:"text-purple-300 mb-6",children:"Enter password to add a token manually to the dashboard."}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Password"}),e.jsx("input",{type:"password",value:ve,onChange:N=>He(N.target.value),onKeyPress:N=>N.key==="Enter"&&Ut(),className:"input w-full text-purple-200",placeholder:"Enter password",autoFocus:!0})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:Ut,className:"btn-primary text-white px-6 py-2 rounded-lg font-medium flex-1",children:"Continue"}),e.jsx("button",{onClick:()=>{me(!1),He("")},className:"btn text-purple-300 px-6 py-2 rounded-lg font-medium",children:"Cancel"})]})]})}),I&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-lg p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-6",children:"Add Token Manually"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Token Name *"}),e.jsx("input",{type:"text",value:pe.name,onChange:N=>xe({...pe,name:N.target.value}),className:"input w-full text-purple-200",placeholder:"KOOL"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Issuer Address *"}),e.jsx("input",{type:"text",value:pe.issuer,onChange:N=>xe({...pe,issuer:N.target.value}),className:"input w-full text-purple-200 font-mono",placeholder:"rXXXXXXXXXXXXXXXXXXXXXXXXXXXX"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Total Supply"}),e.jsx("input",{type:"number",value:pe.supply,onChange:N=>xe({...pe,supply:N.target.value}),className:"input w-full text-purple-200",placeholder:"1000000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"XRP Locked (for market cap calc)"}),e.jsx("input",{type:"number",step:"0.01",value:pe.xrpLocked,onChange:N=>xe({...pe,xrpLocked:N.target.value}),className:"input w-full text-purple-200",placeholder:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Token Image (Optional)"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:Ts,className:"input w-full text-purple-200"}),e.jsx("p",{className:"text-purple-400 text-xs mt-1",children:"Upload an image for the token icon"})]}),Ne&&e.jsx("div",{className:"w-20 h-20 rounded-lg border-2 border-purple-500/30 overflow-hidden",children:e.jsx("img",{src:Ne,alt:"Preview",className:"w-full h-full object-cover"})})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:O,disabled:ee,className:"btn-primary text-white px-6 py-2 rounded-lg font-medium flex-1 disabled:opacity-50",children:ee?"Uploading...":"Add Token"}),e.jsx("button",{onClick:()=>{E(!1),xe({name:"",issuer:"",supply:"1000000",xrpLocked:"1"}),$e(null),q(null)},className:"btn text-purple-300 px-6 py-2 rounded-lg font-medium",children:"Cancel"})]})]})}),ie&&e.jsx(an,{token:ie,onClose:()=>ye(null)}),be&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-lg p-8 max-w-md w-full",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-4",children:"Admin Access Required"}),e.jsx("p",{className:"text-purple-300 mb-6",children:(M==null?void 0:M.type)==="delete"?`Delete token "${(Wt=M==null?void 0:M.token)==null?void 0:Wt.token_name}"?`:`Edit token "${(da=M==null?void 0:M.token)==null?void 0:da.token_name}"?`}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Admin Password"}),e.jsx("input",{type:"password",value:tt,onChange:N=>nt(N.target.value),onKeyPress:N=>N.key==="Enter"&&dr(),className:"input w-full text-purple-200",placeholder:"Enter admin password",autoFocus:!0})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:dr,className:"btn-primary text-white px-6 py-2 rounded-lg font-medium flex-1",children:"Confirm"}),e.jsx("button",{onClick:()=>{We(!1),nt(""),fe(null)},className:"btn text-purple-300 px-6 py-2 rounded-lg font-medium",children:"Cancel"})]})]})}),G&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-lg p-8 max-w-md w-full",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-4",children:"Create Random Meme Token"}),e.jsx("p",{className:"text-purple-300 mb-6",children:"This will generate a random meme token with a 3-5 letter name, issue 1M tokens, and create an AMM pool with 1 XRP."}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Password Required"}),e.jsx("input",{type:"password",value:ge,onChange:N=>Ce(N.target.value),onKeyPress:N=>N.key==="Enter"&&Te(),className:"input w-full text-purple-200",placeholder:"Enter password to create token",autoFocus:!0})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:Te,className:"btn-primary text-white px-6 py-2 rounded-lg font-medium flex-1",children:"Create Token"}),e.jsx("button",{onClick:()=>{_e(!1),Ce("")},className:"btn text-purple-300 px-6 py-2 rounded-lg font-medium",children:"Cancel"})]})]})}),se&&ue&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-lg p-8 max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🎉"}),e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-2",children:"Token Created Successfully!"}),e.jsx("p",{className:"text-purple-300 text-lg font-bold",children:ue.token_name}),e.jsx("p",{className:"text-purple-400 text-sm mt-2",children:"Your meme token is now live on the XRPL!"})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsx("a",{href:`https://testnet.xrpl.org/transactions/${ue.tx_hash}`,target:"_blank",rel:"noopener noreferrer",className:"btn-primary text-white w-full px-6 py-3 rounded-lg font-medium text-center block",children:"View on XRPL Explorer"}),e.jsx("a",{href:`https://xmagnetic.org/amm/${ue.currency_code}+${ue.issuer_address}_XRP+XRP?network=testnet`,target:"_blank",rel:"noopener noreferrer",className:"btn text-purple-300 w-full px-6 py-3 rounded-lg font-medium text-center block",children:"AMM Pool"}),e.jsx("a",{href:`https://xmagnetic.org/dex/${ue.currency_code}+${ue.issuer_address}_XRP+XRP?network=testnet`,target:"_blank",rel:"noopener noreferrer",className:"btn text-purple-300 w-full px-6 py-3 rounded-lg font-medium text-center block",children:"Trade on Magnetic DEX"}),e.jsx("button",{onClick:()=>{ye(ue),F(!1),J(null)},className:"btn text-purple-300 w-full px-6 py-3 rounded-lg font-medium",children:"View Token Details"})]}),e.jsx("button",{onClick:()=>{F(!1),J(null)},className:"btn text-purple-400 w-full px-6 py-2 rounded-lg font-medium",children:"Close"})]})}),K&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-lg p-8 max-w-2xl w-full",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-6",children:"Edit Token"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Token Name"}),e.jsx("input",{type:"text",value:K.token_name,onChange:N=>v({...K,token_name:N.target.value}),className:"input w-full text-purple-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Total Supply"}),e.jsx("input",{type:"number",value:K.supply,onChange:N=>v({...K,supply:N.target.value}),className:"input w-full text-purple-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"XRP Locked"}),e.jsx("input",{type:"number",step:"0.01",value:K.amm_xrp_amount||0,onChange:N=>v({...K,amm_xrp_amount:N.target.value}),className:"input w-full text-purple-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Asset Amount in Pool"}),e.jsx("input",{type:"number",value:K.amm_asset_amount||0,onChange:N=>v({...K,amm_asset_amount:N.target.value}),className:"input w-full text-purple-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-3",children:"Category"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:[{value:"Meme",color:"from-pink-500 to-rose-500",emoji:"😂"},{value:"Gaming",color:"from-violet-500 to-purple-500",emoji:"🎮"},{value:"DeFi",color:"from-blue-500 to-cyan-500",emoji:"💰"},{value:"Utility",color:"from-green-500 to-emerald-500",emoji:"🔧"},{value:"Community",color:"from-orange-500 to-amber-500",emoji:"👥"},{value:"NFT",color:"from-indigo-500 to-blue-500",emoji:"🎨"},{value:"AI",color:"from-teal-500 to-cyan-500",emoji:"🤖"},{value:"Other",color:"from-gray-500 to-slate-500",emoji:"📦"}].map(N=>e.jsxs("button",{type:"button",onClick:()=>v({...K,category:N.value}),className:`px-3 py-2 rounded-lg transition-all text-sm font-medium ${K.category===N.value?`bg-gradient-to-r ${N.color} text-white shadow-lg`:"glass text-purple-300 hover:bg-purple-500/20"}`,children:[e.jsx("span",{className:"mr-1",children:N.emoji}),N.value]},N.value))}),e.jsxs("p",{className:"text-purple-400 text-xs mt-2",children:["Current category: ",K.category||"Other"]})]}),e.jsxs("div",{className:"border-t border-purple-500/20 pt-4",children:[e.jsx("label",{className:"block text-purple-300 mb-3",children:"Featured Token Position"}),e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{v(N=>({...N,is_featured:!1,featured_order:null}))},className:`px-4 py-2 rounded-lg transition-colors ${!K.is_featured||K.is_featured===!1?"bg-purple-600 text-white":"glass text-purple-300 hover:bg-purple-500/20"}`,children:"None"}),[1,2,3].map(N=>e.jsxs("button",{type:"button",onClick:()=>{v(C=>({...C,is_featured:!0,featured_order:N}))},className:`px-4 py-2 rounded-lg transition-colors ${K.is_featured===!0&&K.featured_order===N?"bg-purple-600 text-white":"glass text-purple-300 hover:bg-purple-500/20"}`,children:["Top ",N]},N))]}),e.jsxs("p",{className:"text-purple-400 text-xs mt-2",children:["Current: is_featured=",String(K.is_featured),", order=",K.featured_order||"null"," -",K.is_featured===!0&&K.featured_order?` This token will appear in position ${K.featured_order} on the featured list`:" This token will not be featured"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Token Icon"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:ds,className:"input w-full text-purple-200"},K.id),e.jsx("p",{className:"text-purple-400 text-xs mt-1",children:"Upload new image or leave blank to keep current"})]}),(R||K.image_url)&&e.jsxs("div",{className:"w-20 h-20 rounded-lg border-2 border-purple-500/30 overflow-hidden bg-gradient-to-br from-purple-900 to-purple-800 flex items-center justify-center",children:[e.jsx("img",{src:R||K.image_url,alt:"Preview",className:"w-full h-full object-cover",onError:N=>{N.target.style.display="none"}}),!R&&!K.image_url&&e.jsx("span",{className:"text-3xl",children:K.token_name[0]})]})]})]}),e.jsxs("div",{className:"border-t border-purple-500/20 pt-4",children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Confirm Admin Password"}),e.jsx("input",{type:"password",value:tt,onChange:N=>nt(N.target.value),onKeyPress:N=>N.key==="Enter"&&ca(),className:"input w-full text-purple-200",placeholder:"Enter admin password to save"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:ca,className:"btn-primary text-white px-6 py-2 rounded-lg font-medium flex-1",children:"Save Changes"}),e.jsx("button",{onClick:()=>{v(null),nt("")},className:"btn text-purple-300 px-6 py-2 rounded-lg font-medium",children:"Cancel"})]})]})},K.id),qe&&e.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-lg max-w-2xl w-full p-8",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-6",children:Rt?"✅ Token Created Successfully!":"🚀 Creating Random Meme Token"}),e.jsx("div",{className:"space-y-4 mb-6",children:Je.map((N,C)=>e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold",children:N.status==="complete"?e.jsx("div",{className:"text-green-400 text-2xl",children:"✓"}):N.status==="active"?e.jsx("div",{className:"w-6 h-6 border-2 border-purple-500 border-t-transparent rounded-full animate-spin"}):N.status==="error"?e.jsx("div",{className:"text-red-400 text-2xl",children:"✗"}):e.jsx("div",{className:"w-6 h-6 border-2 border-purple-900 rounded-full"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`font-medium ${N.status==="complete"?"text-green-400":N.status==="active"?"text-purple-200":N.status==="error"?"text-red-400":"text-purple-500"}`,children:N.title}),N.data&&e.jsx("div",{className:"text-sm text-purple-400 mt-1",children:N.data}),N.txHash&&e.jsx("a",{href:`https://testnet.xrpl.org/transactions/${N.txHash}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-400 hover:text-blue-300 mt-1 inline-block",children:"View Transaction →"}),N.error&&e.jsxs("div",{className:"text-sm text-red-400 mt-1",children:["Error: ",N.error]})]})]},C))}),Rt&&wt&&e.jsx("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-6 mb-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-green-400 mb-1",children:"Token Name"}),e.jsx("div",{className:"text-green-200 font-bold text-lg",children:wt.name})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-green-400 mb-1",children:"Supply"}),e.jsx("div",{className:"text-green-200 font-mono",children:wt.supply.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-green-400 mb-1",children:"Issuer"}),e.jsxs("div",{className:"text-green-200 font-mono text-xs",children:[wt.issuer.substring(0,20),"..."]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-green-400 mb-1",children:"Status"}),e.jsx("div",{className:"text-green-200",children:"✓ AMM Pool Created"})]})]})}),Rt&&e.jsx("button",{onClick:()=>{Ie(!1),et([]),Mt(null)},className:"btn-primary text-white px-6 py-3 rounded-lg font-medium w-full",children:"Close"}),!Rt&&e.jsx("div",{className:"text-center text-purple-400 text-sm",children:"Please wait while we create your token..."})]})}),te&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-lg max-w-4xl w-full max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-purple-500/20",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200",children:"My App Activity"}),e.jsx("button",{onClick:()=>U(!1),className:"text-purple-400 hover:text-purple-200 text-2xl",children:"×"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:Oe?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-4xl mb-4 animate-pulse",children:"⏳"}),e.jsx("div",{className:"text-purple-200",children:"Loading activities..."})]}):ke.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"📭"}),e.jsx("h4",{className:"text-xl font-bold text-purple-200 mb-2",children:"No Activity Yet"}),e.jsx("p",{className:"text-purple-400",children:"Your app activity will appear here"})]}):e.jsx("div",{className:"space-y-3",children:ke.map(N=>e.jsx("div",{className:"glass rounded-lg p-4 border-l-4 border-green-500",children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-purple-200 font-medium mb-1",children:N.action_type.replace(/_/g," ").replace(/\b\w/g,C=>C.toUpperCase())}),e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:N.description}),N.details&&Object.keys(N.details).length>0&&e.jsxs("div",{className:"flex flex-wrap gap-3 text-xs",children:[N.details.amount&&e.jsxs("span",{className:"text-purple-300",children:["Amount: ",N.details.amount]}),N.details.xrpCost&&e.jsxs("span",{className:"text-purple-300",children:["XRP: ",N.details.xrpCost]}),N.details.tradeType&&e.jsx("span",{className:`px-2 py-1 rounded ${N.details.tradeType==="BUY"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:N.details.tradeType})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-3 text-xs text-purple-500",children:[e.jsx("span",{children:new Date(N.created_at).toLocaleString()}),N.tx_hash&&e.jsx("a",{href:`https://testnet.xrpl.org/transactions/${N.tx_hash}`,target:"_blank",rel:"noopener noreferrer",className:"text-purple-400 hover:text-purple-300",children:"View TX"})]})]})})},N.id))})})]})}),e.jsx(V0,{isOpen:Nt,onClose:()=>xt(!1),tokens:r,onSelectToken:N=>{St(N),xt(!1),kt(!0)}}),e.jsx(H0,{isOpen:Ge,onClose:()=>{kt(!1),St(null)},token:bt,walletSeed:i==null?void 0:i.seed,walletAddress:i==null?void 0:i.address})]})}function To({isOpen:r,steps:t,currentStep:s,onClose:a,canClose:n,title:l,successTitle:i,failTitle:o}){if(!r)return null;const c=w=>w<s?"completed":w===s?"active":"pending",d=w=>w==="completed"?"✓":w==="active"?"⏳":"○",u=t.filter((w,b)=>b<=s).length,h=Math.min(100,u/t.length*100),g=l||"🚀 Creating Token on XRPL",y=i||"🎉 Token Created Successfully!",f=o||"❌ Token Creation Failed";return e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-lg p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto relative",children:[e.jsx("button",{onClick:a,className:"absolute top-4 right-4 w-10 h-10 rounded-lg glass hover:bg-red-500/20 text-purple-300 hover:text-red-300 flex items-center justify-center transition-all z-10 text-2xl font-bold","aria-label":"Close",children:"×"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-3xl font-bold text-purple-200 mb-2",children:t.some(w=>w.error)?f:s>=t.length?y:g}),e.jsx("p",{className:"text-purple-400",children:t.some(w=>w.error)?"An error occurred during the transaction. Please review the details below.":s>=t.length?"Your transaction has been completed successfully":"Please wait while we process your transaction..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm text-purple-300 mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[Math.round(h),"%"]})]}),e.jsx("div",{className:"w-full bg-purple-900/30 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-purple-500 to-pink-500 transition-all duration-500 ease-out rounded-full",style:{width:`${h}%`}})})]}),e.jsx("div",{className:"space-y-3",children:t.map((w,b)=>{const P=c(b),A=d(P);return e.jsxs("div",{className:`flex items-start gap-4 p-4 rounded-lg transition-all ${w.error?"bg-red-500/10 border border-red-500/30":P==="completed"?"bg-green-500/10 border border-green-500/30":P==="active"?"bg-purple-500/20 border border-purple-500/50 animate-pulse":"bg-purple-900/20 border border-purple-500/20"}`,children:[e.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center font-bold ${w.error?"bg-red-500 text-white":P==="completed"?"bg-green-500 text-white":P==="active"?"bg-purple-500 text-white":"bg-purple-900/50 text-purple-400"}`,children:w.error?"✕":A}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`font-semibold mb-1 ${w.error?"text-red-300":P==="completed"?"text-green-300":P==="active"?"text-purple-200":"text-purple-400"}`,children:w.title}),e.jsx("div",{className:`text-sm ${w.error?"text-red-300":P==="completed"||P==="active"?"text-purple-300":"text-purple-500"}`,children:w.description}),w.txHash&&e.jsxs("a",{href:`https://testnet.xrpl.org/transactions/${w.txHash}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-purple-400 hover:text-purple-300 mt-2 inline-block",children:["View Transaction: ",w.txHash.slice(0,20),"..."]})]})]},b)})}),n&&e.jsx("div",{className:"flex gap-3 pt-4",children:e.jsx("button",{onClick:a,className:"btn-primary text-white px-6 py-3 rounded-lg font-medium flex-1",children:t.some(w=>w.error)?"Close":"Close & View Token"})}),!n&&s<t.length&&!t.some(w=>w.error)&&e.jsx("div",{className:"text-center text-purple-400 text-sm animate-pulse",children:"Processing transaction..."})]})]})})}function Qn(r){if(!r||typeof r!="string")throw new Error("Invalid currency code");const t=r.toUpperCase().trim();if(t.length<3||t.length>20)throw new Error("Currency code must be between 3 and 20 characters");return t==="XRP"?null:t.length===3&&/^[A-Z0-9]{3}$/.test(t)?t:Buffer.from(t,"utf8").toString("hex").toUpperCase().padEnd(40,"0")}const jn=1,jr=[{days:1,price:10,label:"1 Day"},{days:3,price:25,label:"3 Days"},{days:7,price:50,label:"7 Days"},{days:30,price:150,label:"30 Days"}],oi="rphatRpwXc8wk6PdmR5SDt6kLMqb2M3Ckj";function Eo({isOpen:r,onClose:t,wallet:s}){var ge,Ce,ue;const[a,n]=m.useState(1),[l,i]=m.useState(!1),[o,c]=m.useState(null),[d,u]=m.useState(null),[h,g]=m.useState(!1),y=(s==null?void 0:s.address)===oi,[f,w]=m.useState({tokenName:"",currencyCode:"",issuerAddress:"",supply:"",description:"",category:"Meme",twitterHandle:"",websiteUrl:"",imageUrl:"",hasAmmPool:!1,ammAssetAmount:"",ammXrpAmount:"",ammAccountId:"",ammLpTokenBalance:"",ammTradingFee:"",addFeatured:!1,featuredDuration:0}),[b,P]=m.useState(!1);m.useEffect(()=>{r&&(n(1),c(null),u(null),w({tokenName:"",currencyCode:"",issuerAddress:"",supply:"",description:"",category:"Meme",twitterHandle:"",websiteUrl:"",imageUrl:"",hasAmmPool:!1,ammAssetAmount:"",ammXrpAmount:"",ammAccountId:"",ammLpTokenBalance:"",ammTradingFee:"",addFeatured:!1,featuredDuration:0}))},[r]);const A=()=>{if(y)return 0;let J=jn;if(f.addFeatured&&f.featuredDuration){const se=jr.find(F=>F.days===f.featuredDuration);J+=se.price}return J},_=J=>{const se=J.target.files[0];if(se){if(se.size>5*1024*1024){k.error("Image must be less than 5MB");return}if(!se.type.startsWith("image/")){k.error("Please select an image file");return}c(se);const F=new FileReader;F.onloadend=()=>{u(F.result)},F.readAsDataURL(se)}},W=()=>f.tokenName.trim()?!f.currencyCode.trim()||f.currencyCode.length<3||f.currencyCode.length>10?(k.error("Currency code must be 3-10 characters"),!1):!f.issuerAddress.trim()||!f.issuerAddress.startsWith("r")?(k.error("Valid issuer address is required"),!1):!f.supply||parseFloat(f.supply)<=0?(k.error("Valid supply amount is required"),!1):!0:(k.error("Token name is required"),!1),D=()=>{if(f.hasAmmPool){if(!f.ammAssetAmount||parseFloat(f.ammAssetAmount)<=0)return k.error("AMM asset amount is required when pool is enabled"),!1;if(!f.ammXrpAmount||parseFloat(f.ammXrpAmount)<=0)return k.error("AMM XRP amount is required when pool is enabled"),!1;if(!f.ammAccountId)return k.error("AMM account ID is required. Please fetch AMM info."),!1}return!0},I=async()=>{var J,se;if(!f.currencyCode||!f.issuerAddress){k.error("Please enter currency code and issuer address first");return}P(!0);try{const F=await Zr(),X=f.currencyCode.length>3?Buffer.from(f.currencyCode,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):f.currencyCode.toUpperCase(),me=await F.request({command:"amm_info",asset:{currency:"XRP"},asset2:{currency:X,issuer:f.issuerAddress},ledger_index:"validated"});if(await F.disconnect(),(J=me==null?void 0:me.result)!=null&&J.amm){const ve=me.result.amm,He=parseFloat(ve.amount)/1e6,pe=parseFloat(ve.amount2.value),xe=parseFloat(ve.lp_token.value),le=ve.trading_fee||0;w({...f,hasAmmPool:!0,ammAssetAmount:pe.toString(),ammXrpAmount:He.toString(),ammAccountId:ve.account,ammLpTokenBalance:xe.toString(),ammTradingFee:le.toString()}),k.success("AMM pool found and data loaded!")}else k.error("No AMM pool found for this token pair")}catch(F){((se=F.data)==null?void 0:se.error)==="actNotFound"?k.error("No AMM pool exists for this token"):k.error("Failed to fetch AMM info. Please check the token details.")}finally{P(!1)}},E=()=>{a===1&&!W()||a===2&&!D()||n(a+1)},G=()=>{n(a-1)},_e=async()=>{if(!s){k.error("Please connect a wallet first");return}const J=A();i(!0);try{let se=f.imageUrl;if(o){g(!0);try{se=await Oa(o),k.success("Image uploaded successfully!")}catch{k.error("Failed to upload image. Continuing without image.")}finally{g(!1)}}let F=null;if(!y&&J>0){const He=Re.Wallet.fromSeed(s.seed),pe=await Zr(),xe={TransactionType:"Payment",Account:He.address,Amount:String(J*1e6),Destination:oi,Memos:[{Memo:{MemoData:Buffer.from(`Token Listing: ${f.tokenName}`).toString("hex").toUpperCase(),MemoType:Buffer.from("token-listing").toString("hex").toUpperCase()}}]},le=await il(xe,He);if(le.result.meta.TransactionResult!=="tesSUCCESS")throw new Error("Payment transaction failed");F=le.result.hash}const X=Qn(f.currencyCode),{data:me,error:ve}=await S.from("meme_tokens").insert({token_name:f.tokenName,currency_code:f.currencyCode.toUpperCase(),currency_hex:X,issuer_address:f.issuerAddress,receiver_address:s.address,supply:parseFloat(f.supply),description:f.description||null,category:f.category,twitter_handle:f.twitterHandle||null,website_url:f.websiteUrl||null,image_url:se||null,amm_pool_created:f.hasAmmPool,amm_asset_amount:f.hasAmmPool?parseFloat(f.ammAssetAmount):null,amm_xrp_amount:f.hasAmmPool?parseFloat(f.ammXrpAmount):null,amm_account_id:f.hasAmmPool?f.ammAccountId:null,amm_lp_token_balance:f.hasAmmPool?parseFloat(f.ammLpTokenBalance):null,amm_trading_fee:f.hasAmmPool?parseInt(f.ammTradingFee):null,status:"listed",tx_hash:F}).select().single();if(ve)throw ve;if(f.addFeatured&&f.featuredDuration){const He=jr.find(xe=>xe.days===f.featuredDuration),pe=new Date;pe.setDate(pe.getDate()+He.days),await S.from("featured_spot_payments").insert({token_id:me.id,wallet_address:s.address,spot_number:null,duration_days:He.days,amount_xrp:He.price,status:"active",tx_hash:F,expires_at:pe.toISOString()}),await S.from("meme_tokens").update({is_featured:!0}).eq("id",me.id)}y?k.success("Token added successfully! (Admin - No Fee)"):k.success(`Token added successfully! Fee: ${J} XRP`),t(),window.location.reload()}catch(se){k.error(se.message||"Failed to add token")}finally{i(!1)}};return r?e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-purple-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Add Token to Platform"}),e.jsx("button",{onClick:t,className:"text-purple-300 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"mb-6 flex items-center gap-2",children:[1,2,3,4].map(J=>e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${a>=J?"bg-purple-600 text-white":"bg-purple-900/30 text-purple-500"}`,children:J}),J<4&&e.jsx("div",{className:`flex-1 h-1 mx-2 ${a>J?"bg-purple-600":"bg-purple-900/30"}`})]},J))}),a===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsxs("h3",{className:"text-blue-300 font-semibold mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ℹ️"}),"Token Listing Process"]}),e.jsxs("ul",{className:"text-blue-200 text-sm space-y-1",children:[e.jsx("li",{children:"• Submit token information and metadata"}),e.jsx("li",{children:"• Pay listing fee to add your token to the platform"}),e.jsx("li",{children:"• Optional: Purchase featured spot for increased visibility"}),e.jsx("li",{children:"• Token appears immediately after payment confirmation"})]})]}),e.jsx("h3",{className:"text-white font-semibold",children:"Basic Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 text-sm mb-2",children:"Token Name *"}),e.jsx("input",{type:"text",value:f.tokenName,onChange:J=>w({...f,tokenName:J.target.value}),placeholder:"My Awesome Token",className:"w-full px-4 py-3 bg-purple-900/20 border border-purple-500/30 rounded-lg text-white placeholder-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 text-sm mb-2",children:"Currency Code * (3-10 chars)"}),e.jsx("input",{type:"text",value:f.currencyCode,onChange:J=>w({...f,currencyCode:J.target.value.toUpperCase()}),placeholder:"TOKEN",maxLength:10,className:"w-full px-4 py-3 bg-purple-900/20 border border-purple-500/30 rounded-lg text-white placeholder-purple-500"}),f.currencyCode&&f.currencyCode.length>=3&&e.jsx("div",{className:"mt-2 p-2 bg-purple-900/30 border border-purple-500/20 rounded text-xs",children:e.jsx("p",{className:"text-purple-300",children:f.currencyCode.length===3?`Standard code: ${f.currencyCode.toUpperCase()}`:`Hex encoded: ${Qn(f.currencyCode)}`})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 text-sm mb-2",children:"Issuer Address *"}),e.jsx("input",{type:"text",value:f.issuerAddress,onChange:J=>w({...f,issuerAddress:J.target.value}),placeholder:"rXXXXXXXXXXXXXXXXXXXXXXXXXXXX",className:"w-full px-4 py-3 bg-purple-900/20 border border-purple-500/30 rounded-lg text-white placeholder-purple-500 font-mono text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 text-sm mb-2",children:"Total Supply *"}),e.jsx("input",{type:"number",value:f.supply,onChange:J=>w({...f,supply:J.target.value}),placeholder:"1000000",className:"w-full px-4 py-3 bg-purple-900/20 border border-purple-500/30 rounded-lg text-white placeholder-purple-500"})]})]}),a===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-white font-semibold",children:"Additional Details"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 text-sm mb-2",children:"Description"}),e.jsx("textarea",{value:f.description,onChange:J=>w({...f,description:J.target.value}),placeholder:"Describe your token...",rows:3,className:"w-full px-4 py-3 bg-purple-900/20 border border-purple-500/30 rounded-lg text-white placeholder-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 text-sm mb-2",children:"Category"}),e.jsxs("select",{value:f.category,onChange:J=>w({...f,category:J.target.value}),className:"w-full px-4 py-3 bg-purple-900/20 border border-purple-500/30 rounded-lg text-white",children:[e.jsx("option",{value:"Meme",children:"Meme"}),e.jsx("option",{value:"DeFi",children:"DeFi"}),e.jsx("option",{value:"Gaming",children:"Gaming"}),e.jsx("option",{value:"NFT",children:"NFT"}),e.jsx("option",{value:"Utility",children:"Utility"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 text-sm mb-2",children:"Twitter Handle"}),e.jsx("input",{type:"text",value:f.twitterHandle,onChange:J=>w({...f,twitterHandle:J.target.value}),placeholder:"@mytoken",className:"w-full px-4 py-3 bg-purple-900/20 border border-purple-500/30 rounded-lg text-white placeholder-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 text-sm mb-2",children:"Website URL"}),e.jsx("input",{type:"url",value:f.websiteUrl,onChange:J=>w({...f,websiteUrl:J.target.value}),placeholder:"https://mytoken.com",className:"w-full px-4 py-3 bg-purple-900/20 border border-purple-500/30 rounded-lg text-white placeholder-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 text-sm mb-2",children:"Token Image"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex gap-3",children:e.jsxs("label",{className:"flex-1 cursor-pointer",children:[e.jsxs("div",{className:"w-full px-4 py-3 bg-purple-900/20 border border-purple-500/30 rounded-lg text-white hover:border-purple-500/50 transition-colors flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("span",{children:o?o.name:"Upload Image (Max 5MB)"})]}),e.jsx("input",{type:"file",accept:"image/*",onChange:_,className:"hidden"})]})}),d&&e.jsxs("div",{className:"relative w-32 h-32 mx-auto",children:[e.jsx("img",{src:d,alt:"Preview",className:"w-full h-full object-cover rounded-lg border-2 border-purple-500/30"}),e.jsx("button",{type:"button",onClick:()=>{c(null),u(null)},className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 hover:bg-red-600 rounded-full flex items-center justify-center text-white text-sm",children:"×"})]}),e.jsx("div",{className:"text-center text-purple-400 text-xs",children:"OR"}),e.jsx("input",{type:"url",value:f.imageUrl,onChange:J=>w({...f,imageUrl:J.target.value}),placeholder:"https://example.com/token-image.png",disabled:!!o,className:"w-full px-4 py-3 bg-purple-900/20 border border-purple-500/30 rounded-lg text-white placeholder-purple-500 disabled:opacity-50"})]})]})]}),a===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-white font-semibold",children:"AMM Pool Information"}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-blue-300 font-semibold mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ℹ️"}),"Receiver Wallet Configuration"]}),e.jsx("p",{className:"text-blue-200 text-sm mb-2",children:"Your connected wallet address will be set as the receiver for this token listing:"}),e.jsx("p",{className:"text-blue-100 text-xs font-mono bg-blue-900/30 p-2 rounded break-all",children:(s==null?void 0:s.address)||"No wallet connected"})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsx("p",{className:"text-yellow-200 text-sm",children:"If your token already has an AMM pool on XRPL, provide the pool details below. Otherwise, leave this section disabled."})}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:f.hasAmmPool,onChange:J=>w({...f,hasAmmPool:J.target.checked}),className:"w-5 h-5"}),e.jsx("span",{className:"text-purple-200",children:"This token has an existing AMM pool"})]}),f.hasAmmPool&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:I,disabled:b,className:"w-full px-4 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-800/50 text-white rounded-lg font-semibold transition-colors flex items-center justify-center gap-2",children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Fetching AMM Info..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"🔍"}),"Fetch AMM Pool Data from XRPL"]})}),f.ammAccountId&&e.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-green-300 font-semibold mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"✅"}),"AMM Pool Verified"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-200",children:"AMM Account:"}),e.jsxs("span",{className:"text-white font-mono text-xs",children:[f.ammAccountId.slice(0,10),"...",f.ammAccountId.slice(-8)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-200",children:"Token Amount:"}),e.jsxs("span",{className:"text-white",children:[parseFloat(f.ammAssetAmount).toLocaleString()," ",f.currencyCode]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-200",children:"XRP Amount:"}),e.jsxs("span",{className:"text-white",children:[parseFloat(f.ammXrpAmount).toLocaleString()," XRP"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-200",children:"LP Token Balance:"}),e.jsx("span",{className:"text-white",children:parseFloat(f.ammLpTokenBalance).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-200",children:"Trading Fee:"}),e.jsxs("span",{className:"text-white",children:[f.ammTradingFee," basis points"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-200",children:"Current Price:"}),e.jsxs("span",{className:"text-white",children:[(parseFloat(f.ammXrpAmount)/parseFloat(f.ammAssetAmount)).toFixed(8)," XRP"]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 text-sm mb-2",children:"AMM Token Amount *"}),e.jsx("input",{type:"number",value:f.ammAssetAmount,onChange:J=>w({...f,ammAssetAmount:J.target.value}),placeholder:"900000",readOnly:!!f.ammAccountId,className:"w-full px-4 py-3 bg-purple-900/20 border border-purple-500/30 rounded-lg text-white placeholder-purple-500 read-only:opacity-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 text-sm mb-2",children:"AMM XRP Amount *"}),e.jsx("input",{type:"number",value:f.ammXrpAmount,onChange:J=>w({...f,ammXrpAmount:J.target.value}),placeholder:"100",readOnly:!!f.ammAccountId,className:"w-full px-4 py-3 bg-purple-900/20 border border-purple-500/30 rounded-lg text-white placeholder-purple-500 read-only:opacity-50"})]})]})]}),a===4&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-white font-semibold",children:"Featured Listing (Optional)"}),y&&e.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-green-300 font-semibold mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"👑"}),"Admin Wallet Detected"]}),e.jsx("p",{className:"text-green-200 text-sm",children:"You are using the platform admin wallet. All listing fees are waived for admin submissions."})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-500/10 to-blue-500/10 border border-purple-500/30 rounded-lg p-4",children:[e.jsx("h4",{className:"text-purple-200 font-semibold mb-2",children:"Get Featured Spotlight"}),e.jsx("p",{className:"text-purple-300 text-sm mb-3",children:"Boost your token visibility with a featured spot on the main page. Featured tokens appear at the top with special highlighting."})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:f.addFeatured,onChange:J=>w({...f,addFeatured:J.target.checked,featuredDuration:J.target.checked?1:0}),className:"w-5 h-5"}),e.jsx("span",{className:"text-purple-200 font-semibold",children:"Add Featured Spot"})]}),f.addFeatured&&e.jsx("div",{className:"grid grid-cols-2 gap-3",children:jr.map(J=>e.jsxs("button",{onClick:()=>w({...f,featuredDuration:J.days}),className:`p-4 rounded-lg border-2 transition-all ${f.featuredDuration===J.days?"border-purple-500 bg-purple-500/20":"border-purple-500/30 bg-purple-900/20 hover:border-purple-500/50"}`,children:[e.jsx("div",{className:"text-white font-bold text-lg",children:J.label}),e.jsxs("div",{className:"text-purple-300 text-sm mt-1",children:[J.price," XRP"]})]},J.days))}),e.jsxs("div",{className:`rounded-lg p-4 border ${y?"bg-green-500/10 border-green-500/30":"bg-gray-800/50 border-purple-500/20"}`,children:[e.jsxs("div",{className:"flex items-center justify-between text-lg font-bold",children:[e.jsx("span",{className:y?"text-green-200":"text-purple-200",children:"Total Fee:"}),e.jsx("span",{className:"text-white",children:y?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"line-through text-gray-500",children:[jn+(f.addFeatured&&f.featuredDuration&&((ge=jr.find(J=>J.days===f.featuredDuration))==null?void 0:ge.price)||0)," XRP"]}),e.jsx("span",{className:"text-green-400",children:"FREE"})]}):`${A()} XRP`})]}),!y&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-purple-500/20 space-y-1 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-purple-300",children:"Listing Fee"}),e.jsxs("span",{className:"text-purple-200",children:[jn," XRP"]})]}),f.addFeatured&&f.featuredDuration>0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-purple-300",children:["Featured (",(Ce=jr.find(J=>J.days===f.featuredDuration))==null?void 0:Ce.label,")"]}),e.jsxs("span",{className:"text-purple-200",children:[(ue=jr.find(J=>J.days===f.featuredDuration))==null?void 0:ue.price," XRP"]})]})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[a>1&&e.jsx("button",{onClick:G,className:"px-6 py-3 bg-purple-900/30 text-purple-300 rounded-lg hover:bg-purple-900/50 transition-all",children:"Back"}),a<4?e.jsx("button",{onClick:E,className:"flex-1 px-6 py-3 bg-gradient-to-r from-purple-600 to-purple-500 text-white rounded-lg hover:from-purple-500 hover:to-purple-400 transition-all font-semibold",children:"Continue"}):e.jsx("button",{onClick:_e,disabled:l||h||!s,className:"flex-1 px-6 py-3 bg-gradient-to-r from-green-600 to-green-500 text-white rounded-lg hover:from-green-500 hover:to-green-400 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Uploading Image...":l?"Processing...":y?"Submit (Admin - No Fee)":`Submit & Pay ${A()} XRP`})]})]})}):null}const ci="sEd7bAfzqZWKxaatJpoWzTvENyaTg1Y",Nn="rKxBBMmY969Ph1y63ddVfYyN7xmxwDfVq6",Y0="sEd7W72aANTbLTG98XDhU1yfotPJdhu",Us="rphatRpwXcPAo7CVm46dC78JAQ6kLMqb2M";function Q0(){const[r,t]=m.useState([]),[s,a]=m.useState("all"),[n,l]=m.useState("all"),[i,o]=m.useState(""),[c,d]=m.useState(()=>window.innerWidth<768?"grid":"list"),[u,h]=m.useState("newest"),[g,y]=m.useState("desc"),[f,w]=m.useState([]),[b,P]=m.useState(null),[A,_]=m.useState({}),[W,D]=m.useState({}),[I,E]=m.useState(0),[G,_e]=m.useState({}),[ge,Ce]=m.useState({}),[ue,J]=m.useState({}),[se,F]=m.useState({}),[X,me]=m.useState({}),[ve,He]=m.useState(!1),[pe,xe]=m.useState(!1),[le,$e]=m.useState("manual"),[Ne,q]=m.useState("admin"),[ee,L]=m.useState([]),[re,B]=m.useState(null),[Y,oe]=m.useState(null),[ie,ye]=m.useState(!1),[te,U]=m.useState({name:"",issuer:"",supply:"1000000",xrpLocked:"1",image:null,imageUrl:"",tfTransferable:!1,requireDestTag:!1,description:"",twitterHandle:"",websiteUrl:""}),[ke,he]=m.useState(null),[Oe,$]=m.useState(!1),[be,We]=m.useState(null),[tt,nt]=m.useState(!1),[M,fe]=m.useState(!1),[K,v]=m.useState([]),[p,x]=m.useState(0),[R,H]=m.useState(!1);m.useEffect(()=>{(async()=>{await Je(),await et(),z(),ae()})();const ne=la(()=>{Je()});return()=>ne()},[]),m.useEffect(()=>{r.length>0&&Object.keys(A).length===0&&dt()},[r]),m.useEffect(()=>{const T=setInterval(()=>{r.length>0&&dt(!1)},3e5);return()=>clearInterval(T)},[r]),m.useEffect(()=>{b&&Object.keys(A).length>0&&Rt()},[b,A]),m.useEffect(()=>{b&&qe()},[b]),m.useEffect(()=>{const T=async()=>{try{const Xe=await(await fetch("https://api.coingecko.com/api/v3/simple/price?ids=ripple&vs_currencies=usd")).json();E(Xe.ripple.usd)}catch{}};T();const ne=setInterval(T,6e4);return()=>clearInterval(ne)},[]),m.useEffect(()=>{if(r.length>0&&Object.keys(A).length>0){const T={},ne={},Fe={},Xe={},st={};r.forEach(Qe=>{if(Qe.amm_pool_created&&A[Qe.id]){const ot=parseFloat(lt(Qe)),yt=parseFloat(jt(Qe)),Nt=parseFloat(W[Qe.id])||0,xt=parseFloat(ut(Qe)),Ge=Qe.amm_xrp_amount||0;G[Qe.id]||(T[Qe.id]=ot),ge[Qe.id]||(ne[Qe.id]=yt),ue[Qe.id]||(Fe[Qe.id]=Nt),se[Qe.id]||(Xe[Qe.id]=xt),X[Qe.id]||(st[Qe.id]=Ge)}}),Object.keys(T).length>0&&(_e(Qe=>({...Qe,...T})),Ce(Qe=>({...Qe,...ne})),J(Qe=>({...Qe,...Fe})),F(Qe=>({...Qe,...Xe})),me(Qe=>({...Qe,...st})));const gt=setInterval(()=>{const Qe={},ot={},yt={},Nt={},xt={};r.forEach(Ge=>{Ge.amm_pool_created&&A[Ge.id]&&(Qe[Ge.id]=parseFloat(lt(Ge)),ot[Ge.id]=parseFloat(jt(Ge)),yt[Ge.id]=parseFloat(W[Ge.id])||0,Nt[Ge.id]=parseFloat(ut(Ge)),xt[Ge.id]=Ge.amm_xrp_amount||0)}),_e(Qe),Ce(ot),J(yt),F(Nt),me(xt)},6e4);return()=>clearInterval(gt)}},[r,A,W]);const z=()=>{const T=localStorage.getItem("connectedWallet");T&&P(JSON.parse(T))},ae=async()=>{try{const{data:T,error:ne}=await S.from("wallets").select("*").order("created_at",{ascending:!1});if(ne)throw ne;L(T||[]),T&&T.length>=2?(B(T[0]),oe(T[1])):T&&T.length>=1&&B(T[0])}catch{}},qe=async()=>{if(b)try{const{data:T,error:ne}=await S.from("token_favorites").select("token_id").eq("user_address",b.address);if(ne)throw ne;w((T==null?void 0:T.map(Fe=>Fe.token_id))||[])}catch{}},Ie=async(T,ne)=>{if(ne&&ne.stopPropagation(),!b){k.error("Connect wallet to favorite tokens");return}try{if(f.includes(T)){const{error:Xe}=await S.from("token_favorites").delete().eq("user_address",b.address).eq("token_id",T);if(Xe)throw Xe;w(f.filter(st=>st!==T)),k.success("Removed from favorites")}else{const{error:Xe}=await S.from("token_favorites").insert({user_address:b.address,token_id:T});if(Xe)throw Xe;w([...f,T]),k.success("Added to favorites")}}catch{k.error("Failed to update favorite")}},Je=async()=>{try{const{data:T,error:ne}=await S.from("meme_tokens").select("*").order("created_at",{ascending:!1});if(ne)throw ne;t(T||[])}catch{}},et=async()=>{try{const{data:T,error:ne}=await S.from("pool_data_cache").select("*");if(!ne&&T&&T.length>0){const Fe={};T.forEach(Xe=>{Fe[Xe.token_id]={xrpAmount:parseFloat(Xe.xrp_amount),tokenAmount:parseFloat(Xe.token_amount),lpTokens:parseFloat(Xe.lp_tokens),price:parseFloat(Xe.price),accountId:Xe.account_id,volume24h:parseFloat(Xe.volume_24h||0),priceChange24h:parseFloat(Xe.price_change_24h||0)}}),_(Fe)}}catch{}},ze=async T=>{try{const ne=new Date(Date.now()-864e5).toISOString(),{data:Fe,error:Xe}=await S.from("trade_history").select("token_id, xrp_amount").in("token_id",T).gte("created_at",ne);if(Xe)throw Xe;const st={};return T.forEach(gt=>st[gt]=0),Fe&&Fe.length>0&&Fe.forEach(gt=>{const Qe=parseFloat(gt.xrp_amount||0);st[gt.token_id]=(st[gt.token_id]||0)+Qe}),st}catch{return{}}},dt=async(T=!1)=>{var ne;try{const{data:Xe,error:st}=await S.from("pool_data_cache").select("*").gte("last_updated",new Date(Date.now()-3e5).toISOString());if(!T&&Xe&&Xe.length>0&&!st){const xt={};Xe.forEach(Ge=>{xt[Ge.token_id]={xrpAmount:parseFloat(Ge.xrp_amount),tokenAmount:parseFloat(Ge.token_amount),lpTokens:parseFloat(Ge.lp_tokens),price:parseFloat(Ge.price),accountId:Ge.account_id,volume24h:parseFloat(Ge.volume_24h||0),priceChange24h:parseFloat(Ge.price_change_24h||0)}}),_(xt);return}const{requestWithRetry:gt}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),Qe=r.filter(xt=>xt.amm_pool_created),ot=await ze(Qe.map(xt=>xt.id)),yt={};for(const xt of r)if(xt.amm_pool_created)try{const Ge=xt.currency_code.length>3?vt.Buffer.from(xt.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):xt.currency_code,kt=await gt({command:"amm_info",asset:{currency:"XRP"},asset2:{currency:Ge,issuer:xt.issuer_address},ledger_index:"validated"});if(kt.result.amm){const bt=kt.result.amm,St=parseFloat(bt.amount)/1e6,Ct=parseFloat(bt.amount2.value),_t=parseFloat(((ne=bt.lp_token)==null?void 0:ne.value)||0),Gt=ot[xt.id]||0;yt[xt.id]={xrpAmount:St,tokenAmount:Ct,lpTokens:_t,price:St/Ct,accountId:bt.account,volume24h:Gt}}}catch{}const Nt=Object.entries(yt).map(([xt,Ge])=>({token_id:xt,xrp_amount:Ge.xrpAmount,token_amount:Ge.tokenAmount,lp_tokens:Ge.lpTokens,price:Ge.price,account_id:Ge.accountId,volume_24h:Ge.volume24h||0,price_change_24h:0,last_updated:new Date().toISOString()}));if(Nt.length>0)for(const xt of Nt)await S.from("pool_data_cache").upsert(xt,{onConflict:"token_id"});_(yt)}catch{}},Rt=async()=>{if(!b)return;const T=new Re.Client("wss://xrplcluster.com");try{await T.connect();const ne=await T.request({command:"account_lines",account:b.address,ledger_index:"validated"}),Fe={};ne.result.lines.forEach(Xe=>{const st=Object.entries(A).find(([gt,Qe])=>Qe.accountId===Xe.account);if(st){const[gt,Qe]=st,ot=parseFloat(Xe.balance),yt=ot/Qe.lpTokens*100;Fe[gt]={balance:ot,share:yt}}}),D(Fe),await T.disconnect()}catch{}},Tt=async T=>{const ne=T.target.files[0];if(!ne)return;if(ne.size>5*1024*1024){k.error("Image must be less than 5MB");return}const Fe=new FileReader;Fe.onloadend=()=>{he(Fe.result)},Fe.readAsDataURL(ne),U({...te,image:ne})},wt=async T=>{if(!b)throw new Error("Connected wallet required to pay creation fee");if(b.address===Us&&Ne==="admin")return"FEE_WAIVED_ADMIN";const ne=Re.Wallet.fromSeed(b.seed),Fe=Ne==="simple"?"3":"5",Xe={TransactionType:"Payment",Account:b.address,Destination:Us,Amount:Re.xrpToDrops(Fe),Memos:[{Memo:{MemoData:vt.Buffer.from(`Token Creation Fee: ${te.name}`,"utf8").toString("hex").toUpperCase()}}]},st=await T.autofill(Xe),gt=ne.sign(st),Qe=await T.submitAndWait(gt.tx_blob);if(Qe.result.meta.TransactionResult!=="tesSUCCESS")throw new Error(`Payment failed: ${Qe.result.meta.TransactionResult}`);return Qe.result.hash},Mt=async()=>{var Fe,Xe,st;if(!te.name){k.error("Token name is required");return}ye(!0),He(!1),fe(!0),H(!1);const T=[{title:"Connecting to XRPL",description:"Establishing connection to XRP Ledger testnet"},{title:"Validating Wallets",description:"Checking issuer and receiver wallet balances"},{title:"Creating Trust Line",description:"Setting up trust line for the new token"},{title:"Issuing Tokens",description:"Minting tokens to receiver wallet"}];te.image&&T.push({title:"Uploading Image",description:"Uploading token image to IPFS"}),T.push({title:"Saving to Database",description:"Storing token information"}),parseFloat(te.xrpLocked)>0&&T.push({title:"Creating AMM Pool",description:"Setting up automated market maker pool"}),T.push({title:"Complete",description:"Token creation finished successfully"}),v(T),x(0);let ne;try{x(0);const{getClient:gt}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0);ne=await gt();const Qe=await wt(ne),ot=[...T];ot[0]={...ot[0],txHash:Qe},v(ot),x(1);let yt,Nt;if(Ne==="admin")yt=Re.Wallet.fromSeed(ci),Nt=Re.Wallet.fromSeed(Y0);else if(Ne==="simple")yt=Re.Wallet.fromSeed(ci),Nt=Re.Wallet.fromSeed(b.seed);else{if(!re||!Y)throw new Error("Please select both issuer and receiver wallets");yt=Re.Wallet.fromSeed(re.encrypted_seed),Nt=Re.Wallet.fromSeed(Y.encrypted_seed)}x(2);try{await ne.request({command:"account_info",account:yt.address})}catch(Xt){if(((Fe=Xt.data)==null?void 0:Fe.error)==="actNotFound"){const Ut=[...T];Ut[2]={...Ut[2],description:`Error: Issuer wallet not funded. Address: ${yt.address}`,error:!0},v(Ut),H(!0),ye(!1);return}}try{await ne.request({command:"account_info",account:Nt.address})}catch(Xt){if(((Xe=Xt.data)==null?void 0:Xe.error)==="actNotFound"){const Ut=[...T];Ut[2]={...Ut[2],description:`Error: Receiver wallet not funded. Address: ${Nt.address}`,error:!0},v(Ut),H(!0),ye(!1);return}}if(x(3),!te.tfTransferable){const Xt={TransactionType:"AccountSet",Account:yt.address,SetFlag:8},Ut=await ne.autofill(Xt),Ts=yt.sign(Ut),O=await ne.submitAndWait(Ts.tx_blob);if(O.result.meta.TransactionResult!=="tesSUCCESS")throw new Error("Failed to disable rippling on issuer: "+O.result.meta.TransactionResult)}const xt=te.name.length<=3?te.name.toUpperCase():vt.Buffer.from(te.name,"utf8").toString("hex").toUpperCase().padEnd(40,"0"),Ge={TransactionType:"TrustSet",Account:Nt.address,LimitAmount:{currency:xt,issuer:yt.address,value:te.supply.toString()}};te.tfTransferable||(Ge.Flags=Re.TrustSetFlags.tfSetNoRipple);const kt=await ne.autofill(Ge),bt=Nt.sign(kt),St=await ne.submitAndWait(bt.tx_blob);if(St.result.meta.TransactionResult!=="tesSUCCESS")throw new Error("Trust line creation failed: "+St.result.meta.TransactionResult);const Ct=[...T];Ct[3]={...Ct[2],txHash:St.result.hash},v(Ct),x(4);const _t={TransactionType:"Payment",Account:yt.address,Destination:Nt.address,Amount:{currency:xt,value:te.supply.toString(),issuer:yt.address}};te.requireDestTag&&(_t.DestinationTag=1);const Gt=await ne.autofill(_t),fs=yt.sign(Gt),$t=await ne.submitAndWait(fs.tx_blob);if($t.result.meta.TransactionResult!=="tesSUCCESS")throw new Error("Token issuance failed: "+$t.result.meta.TransactionResult);const Qt=[...Ct];Qt[3]={...Qt[3],txHash:$t.result.hash},v(Qt);let Bt=4,Cs=null;if(te.image){x(Bt);try{Cs=await Oa(te.image)}catch{}Bt++}x(Bt);const{data:gs,error:bs}=await S.from("meme_tokens").insert([{token_name:te.name,currency_code:te.name,issuer_address:yt.address,receiver_address:Nt.address,supply:parseFloat(te.supply),tx_hash:$t.result.hash,status:"issued",amm_pool_created:!1,image_url:Cs,description:te.description||null,twitter_handle:te.twitterHandle||null,website_url:te.websiteUrl||null}]).select().single();if(bs)throw bs;if(Bt++,parseFloat(te.xrpLocked)>0){x(Bt);try{const Xt=parseFloat(te.supply)*.9,Ut={TransactionType:"AMMCreate",Account:Nt.address,Amount:{currency:xt,value:Xt.toString(),issuer:yt.address},Amount2:Re.xrpToDrops(te.xrpLocked),TradingFee:500},Ts=await ne.autofill(Ut),O=Nt.sign(Ts),Te=await ne.submitAndWait(O.tx_blob);if(Te.result.meta.TransactionResult==="tesSUCCESS"){await S.from("meme_tokens").update({amm_pool_created:!0,amm_tx_hash:Te.result.hash,amm_asset_amount:Xt,amm_xrp_amount:parseFloat(te.xrpLocked),initial_asset_amount:Xt,initial_xrp_amount:parseFloat(te.xrpLocked),status:"amm_created"}).eq("id",gs.id);const Ue=[...Qt];Ue[Bt]={...Ue[Bt],txHash:Te.result.hash},v(Ue)}}catch{}Bt++}x(Bt),H(!0),await Yn(gs.id),await Jt({userAddress:Nn,actionType:Yt.TOKEN_CREATED,description:`Created token ${te.name} with supply of ${te.supply}`,details:{tokenName:te.name,supply:te.supply,xrpLocked:te.xrpLocked,hasAMM:parseFloat(te.xrpLocked)>0},txHash:(st=$t==null?void 0:$t.result)==null?void 0:st.hash,tokenId:gs==null?void 0:gs.id});try{await S.from("xrp_rewards").insert([{wallet_address:Nt.address,amount:.1,reward_type:"token_creation",description:`Created token: ${te.name}`,status:"pending"}])}catch{}U({name:"",issuer:"",supply:"1000000",xrpLocked:"1",image:null,imageUrl:"",tfTransferable:!1,requireDestTag:!1,description:"",twitterHandle:"",websiteUrl:""}),he(null),$e("manual"),xe(!1),await Je(),setTimeout(()=>{fe(!1),v([]),x(0),H(!1)},3e3)}catch(gt){const Qe=[...T],ot=p<T.length?p:T.length-1;Qe[ot]={...Qe[ot],description:`Error: ${gt.message||"Unknown error occurred"}`,error:!0},v(Qe),H(!0),ye(!1)}},ut=T=>{const ne=pt(T),Fe=parseFloat(T.total_supply)||parseFloat(T.supply)||0;return ne*Fe},jt=T=>!T.amm_pool_created||!T.amm_xrp_amount||!T.amm_asset_amount?0:T.amm_xrp_amount/T.amm_asset_amount,pt=T=>{const ne=A[T.id];return ne&&ne.price?ne.price:jt(T)},lt=T=>{const ne=A[T.id];return ne?(ne.xrpAmount*.15).toFixed(2):T.amm_pool_created?((T.amm_xrp_amount||0)*.15).toFixed(2):"0"},j=(T,ne)=>!T||!ne||ne===0?"0.00":((T-ne)/ne*100).toFixed(2),Q=T=>{const ne=parseFloat(lt(T));return j(ne,G[T.id])},Z=T=>{const ne=parseFloat(jt(T));return j(ne,ge[T.id])},Se=T=>{const ne=parseFloat(W[T.id])||0;return j(ne,ue[T.id])},Ae=T=>{const ne=parseFloat(ut(T));return j(ne,se[T.id])},de=T=>{const ne=T.amm_xrp_amount||0;return j(ne,X[T.id])},Pe=T=>{u===T?y(g==="asc"?"desc":"asc"):(h(T),y("desc"))},Ve=T=>{const ne=jt(T),Fe=ut(T),Xe=vt.Buffer.from(T.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"),st=`https://xrpl.services/?issuer=${T.issuer_address}&currency=${Xe}&limit=${T.supply}`,gt=`https://xmagnetic.org/dex/${T.currency_code}+${T.issuer_address}_XRP+XRP?network=mainnet`,Qe=`🚀 ${T.token_name} Token Info

💰 Supply: ${T.supply.toLocaleString()}
📊 Price: ${ne} XRP
💎 Market Cap: ${Fe} XRP
🔒 XRP Locked: ${T.amm_xrp_amount||0} XRP
✅ Status: ${T.amm_pool_created?"AMM Pool Active":"Pending"}

🔗 Trust Line:
${st}

💱 Trade on Magnetic:
${gt}

MORE #MEME COINS @ MEMEKINGS.ONLINE

#XRPL #Crypto #XRP`,ot=`https://twitter.com/intent/tweet?text=${encodeURIComponent(Qe)}`;window.open(ot,"_blank","width=550,height=420")},Ye=r.filter(T=>{const ne=T.token_name.toLowerCase().includes(i.toLowerCase()),Fe=s==="all"||s==="active"&&T.amm_pool_created||s==="pending"&&!T.amm_pool_created||s==="favorites"&&f.includes(T.id),Xe=n==="all"||T.category===n;return ne&&Fe&&Xe}).sort((T,ne)=>{var Xe,st,gt,Qe;let Fe=0;switch(u){case"newest":Fe=new Date(ne.created_at)-new Date(T.created_at);break;case"oldest":Fe=new Date(T.created_at)-new Date(ne.created_at);break;case"name":Fe=T.token_name.localeCompare(ne.token_name);break;case"name-asc":Fe=T.token_name.localeCompare(ne.token_name);break;case"name-desc":Fe=ne.token_name.localeCompare(T.token_name);break;case"category":Fe=(T.category||"").localeCompare(ne.category||"");break;case"days":Fe=hs(ne.created_at)-hs(T.created_at);break;case"supply-high":Fe=ne.supply-T.supply;break;case"supply-low":Fe=T.supply-ne.supply;break;case"price":Fe=jt(ne)-jt(T);break;case"price-high":Fe=jt(ne)-jt(T);break;case"price-low":Fe=jt(T)-jt(ne);break;case"volume":Fe=parseFloat(lt(ne))-parseFloat(lt(T));break;case"lp":Fe=(((Xe=W[ne.id])==null?void 0:Xe.balance)||0)-(((st=W[T.id])==null?void 0:st.balance)||0);break;case"marketcap":Fe=ut(ne)-ut(T);break;case"liquidity":Fe=(((gt=A[ne.id])==null?void 0:gt.xrpAmount)||ne.amm_xrp_amount||0)-(((Qe=A[T.id])==null?void 0:Qe.xrpAmount)||T.amm_xrp_amount||0);break;case"status":Fe=(ne.amm_pool_created?1:0)-(T.amm_pool_created?1:0);break;default:Fe=0}return g==="asc"?-Fe:Fe}),Le=({token:T})=>{var Fe,Xe;const ne=f.includes(T.id);return e.jsxs("div",{className:"glass rounded-lg p-6 space-y-4 hover:scale-105 transition-transform cursor-pointer relative",onClick:()=>{We(T),nt(!0)},children:[e.jsx("button",{onClick:st=>Ie(T.id,st),className:"absolute top-4 right-4 text-2xl hover:scale-110 transition-transform z-10",title:ne?"Remove from favorites":"Add to favorites",children:ne?"⭐":"☆"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ft,{token:T,size:"3xl"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200",children:T.token_name}),e.jsx("button",{onClick:st=>Ie(T.id,st),className:"text-xl hover:scale-110 transition-transform",children:f.includes(T.id)?"⭐":"☆"})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:[e.jsx("p",{className:"text-purple-400 text-sm",children:"Meme Token"}),T.category&&e.jsx(ir,{category:T.category,size:"xs"}),e.jsxs("span",{className:"px-2 py-0.5 bg-purple-500/20 text-purple-300 text-xs rounded-full font-medium",children:["📅 ",hs(T.created_at),"d"]})]})]})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-medium ${T.amm_pool_created?"bg-green-500/20 text-green-400":"bg-yellow-500/20 text-yellow-400"}`,children:T.amm_pool_created?"🟢 Live":"🟡 Pending"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-400 text-xs",children:"Total Supply"}),e.jsx("span",{className:"text-purple-200 text-sm font-bold",children:T.supply.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-400 text-xs",children:"Currency Code"}),e.jsx("span",{className:"text-purple-200 font-mono text-xs",children:T.currency_code})]}),T.amm_pool_created&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-400 text-xs",children:"Live Price"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[e.jsxs("span",{className:"text-green-400 text-sm font-bold",children:[pt(T).toFixed(8)," XRP"]}),ge[T.id]&&e.jsxs("span",{className:`text-xs font-medium px-2 py-0.5 rounded ${parseFloat(Z(T))>=0?"text-green-300 bg-green-500/10":"text-red-300 bg-red-500/10"}`,children:[parseFloat(Z(T))>=0?"+":"",Z(T),"%"]})]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(pt(T)*I).toFixed(6)]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-400 text-xs",children:"Market Cap (Live)"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[e.jsxs("span",{className:"text-purple-200 text-sm font-bold",children:[ut(T).toFixed(2)," XRP"]}),se[T.id]&&e.jsxs("span",{className:`text-xs font-medium px-1.5 py-0.5 rounded ${parseFloat(Ae(T))>=0?"text-green-300 bg-green-500/10":"text-red-300 bg-red-500/10"}`,children:[parseFloat(Ae(T))>=0?"+":"",Ae(T),"%"]})]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(ut(T)*I).toFixed(2)]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-400 text-xs",children:"Liquidity (XRP)"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[e.jsxs("span",{className:"text-purple-200 text-sm font-bold",children:[(Fe=A[T.id])!=null&&Fe.xrpAmount?A[T.id].xrpAmount.toFixed(2):(T.amm_xrp_amount||0).toFixed(2)," XRP"]}),X[T.id]&&e.jsxs("span",{className:`text-xs font-medium px-1.5 py-0.5 rounded ${parseFloat(de(T))>=0?"text-green-300 bg-green-500/10":"text-red-300 bg-red-500/10"}`,children:[parseFloat(de(T))>=0?"+":"",de(T),"%"]})]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",((((Xe=A[T.id])==null?void 0:Xe.xrpAmount)||T.amm_xrp_amount||0)*I).toFixed(2)]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-400 text-xs",children:"Volume 24h"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[e.jsx("span",{className:"text-purple-200 text-sm font-bold",children:T.amm_pool_created?`${lt(T)} XRP`:"-"}),T.amm_pool_created&&G[T.id]&&e.jsxs("span",{className:`text-xs font-medium px-1.5 py-0.5 rounded ${parseFloat(Q(T))>=0?"text-green-300 bg-green-500/10":"text-red-300 bg-red-500/10"}`,children:[parseFloat(Q(T))>=0?"+":"",Q(T),"%"]})]}),T.amm_pool_created&&e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(parseFloat(lt(T))*I).toFixed(2)]})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-purple-500/20",children:[e.jsx("span",{className:"text-purple-400 text-xs",children:"Your LP"}),W[T.id]?e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-green-400 text-sm font-bold",children:W[T.id].balance.toFixed(4)}),e.jsxs("div",{className:"text-green-500 text-xs",children:[W[T.id].share.toFixed(2),"%"]})]}),ue[T.id]&&ue[T.id]>0&&e.jsxs("span",{className:`text-xs font-medium px-1.5 py-0.5 rounded ${parseFloat(Se(T))>=0?"text-green-300 bg-green-500/10":"text-red-300 bg-red-500/10"}`,children:[parseFloat(Se(T))>=0?"+":"",Se(T),"%"]})]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(W[T.id].balance*pt(T)*2*I).toFixed(2)]})]}):e.jsx("span",{className:"text-purple-500 text-sm font-bold",children:"-"})]})]}),e.jsxs("div",{className:"pt-2 border-t border-purple-500/20",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"Issuer Address"}),e.jsx("div",{className:"text-purple-300 text-xs font-mono bg-black/30 p-2 rounded break-all",children:T.issuer_address})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-purple-500/20",children:[e.jsx("span",{className:"text-purple-500 text-xs",children:"Created"}),e.jsx("span",{className:"text-purple-400 text-xs",children:new Date(T.created_at).toLocaleString()})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("a",{href:`https://xmagnetic.org/dex/${T.currency_code}+${T.issuer_address}_XRP+XRP?network=mainnet`,target:"_blank",rel:"noopener noreferrer",className:"btn-primary text-white text-xs px-2 py-2 rounded-lg text-center",onClick:st=>{st.stopPropagation()},title:"Trade on xMagnetic DEX",children:"💱 Trade"}),e.jsx("button",{className:"bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white font-bold text-xs px-2 py-2 rounded-lg shadow-lg shadow-purple-500/50 hover:shadow-purple-500/70",onClick:st=>{st.stopPropagation(),Ve(T)},title:"Post on X",children:"𝕏 Post"}),e.jsx("a",{href:`https://xmagnetic.org/amm/${T.currency_code}+${T.issuer_address}_XRP+XRP?network=mainnet`,target:"_blank",rel:"noopener noreferrer",className:"btn text-purple-300 text-xs px-2 py-2 rounded-lg text-center",onClick:st=>{st.stopPropagation()},title:"AMM Pool",children:"🔗 AMM Pool"}),e.jsx("a",{href:`https://xrpl.services/?issuer=${T.issuer_address}&currency=${T.currency_code.length>3?vt.Buffer.from(T.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):T.currency_code}&limit=${T.supply}`,target:"_blank",rel:"noopener noreferrer",className:"btn text-purple-300 text-xs px-2 py-2 rounded-lg text-center",onClick:st=>{st.stopPropagation()},title:"Set up Trustline",children:"✅ Trustline"})]})]})},at=({token:T})=>{var ne,Fe;return e.jsxs("tr",{className:"border-t border-purple-500/20 hover:bg-purple-900/20 cursor-pointer",onClick:()=>{We(T),nt(!0)},children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ft,{token:T,size:"3xl"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-purple-200",children:T.token_name}),e.jsx("div",{className:"text-purple-400 text-xs",children:T.currency_code})]}),e.jsx("button",{onClick:Xe=>Ie(T.id,Xe),className:"text-lg hover:scale-110 transition-transform",children:f.includes(T.id)?"⭐":"☆"})]})]})}),e.jsx("td",{className:"px-4 py-3",children:T.category?e.jsx(ir,{category:T.category,size:"xs"}):e.jsx("span",{className:"text-purple-400 text-xs",children:"-"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:"px-2 py-0.5 bg-purple-500/20 text-purple-300 text-xs rounded-full font-medium inline-block",children:["📅 ",hs(T.created_at),"d"]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-200 font-bold",children:pt(T).toFixed(8)}),e.jsx("div",{className:"text-purple-400 text-xs",children:"XRP"})]}),T.amm_pool_created&&ge[T.id]&&e.jsxs("span",{className:`text-xs font-medium px-1.5 py-0.5 rounded whitespace-nowrap ${parseFloat(Z(T))>=0?"text-green-300 bg-green-500/10":"text-red-300 bg-red-500/10"}`,children:[parseFloat(Z(T))>=0?"+":"",Z(T),"%"]})]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(pt(T)*I).toFixed(6)]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-purple-300",children:T.amm_pool_created?`${lt(T)} XRP`:"-"}),T.amm_pool_created&&G[T.id]&&e.jsxs("span",{className:`text-xs font-medium px-1.5 py-0.5 rounded whitespace-nowrap ${parseFloat(Q(T))>=0?"text-green-300 bg-green-500/10":"text-red-300 bg-red-500/10"}`,children:[parseFloat(Q(T))>=0?"+":"",Q(T),"%"]})]}),T.amm_pool_created&&e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(parseFloat(lt(T))*I).toFixed(2)]})]})}),e.jsx("td",{className:"px-4 py-3",children:W[T.id]?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-green-200 font-medium",children:W[T.id].balance.toFixed(4)}),e.jsxs("div",{className:"text-green-400 text-xs",children:[W[T.id].share.toFixed(2),"%"]})]}),ue[T.id]&&ue[T.id]>0&&e.jsxs("span",{className:`text-xs font-medium px-1.5 py-0.5 rounded whitespace-nowrap ${parseFloat(Se(T))>=0?"text-green-300 bg-green-500/10":"text-red-300 bg-red-500/10"}`,children:[parseFloat(Se(T))>=0?"+":"",Se(T),"%"]})]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(W[T.id].balance*pt(T)*2*I).toFixed(2)]})]}):e.jsx("span",{className:"text-purple-500",children:"-"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-purple-200",children:[ut(T).toFixed(2)," XRP"]}),se[T.id]&&e.jsxs("span",{className:`text-xs font-medium px-1.5 py-0.5 rounded whitespace-nowrap ${parseFloat(Ae(T))>=0?"text-green-300 bg-green-500/10":"text-red-300 bg-red-500/10"}`,children:[parseFloat(Ae(T))>=0?"+":"",Ae(T),"%"]})]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(ut(T)*I).toFixed(2)]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-purple-200 font-bold",children:(ne=A[T.id])!=null&&ne.xrpAmount?`${A[T.id].xrpAmount.toFixed(2)} XRP`:`${(T.amm_xrp_amount||0).toFixed(2)} XRP`}),X[T.id]&&e.jsxs("span",{className:`text-xs font-medium px-1.5 py-0.5 rounded whitespace-nowrap ${parseFloat(de(T))>=0?"text-green-300 bg-green-500/10":"text-red-300 bg-red-500/10"}`,children:[parseFloat(de(T))>=0?"+":"",de(T),"%"]})]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",((((Fe=A[T.id])==null?void 0:Fe.xrpAmount)||T.amm_xrp_amount||0)*I).toFixed(2)]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${T.amm_pool_created?"bg-green-500/20 text-green-400":"bg-yellow-500/20 text-yellow-400"}`,children:T.amm_pool_created?"🟢":"🟡"})}),e.jsx("td",{className:"px-4 py-3",onClick:Xe=>Xe.stopPropagation(),children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx("a",{href:`https://xmagnetic.org/dex/${T.currency_code}+${T.issuer_address}_XRP+XRP?network=mainnet`,target:"_blank",rel:"noopener noreferrer",className:"btn-primary text-white text-xs px-2 py-1 rounded",title:"Trade",children:"💱"}),e.jsx("button",{className:"bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white font-bold text-xs px-2 py-1 rounded shadow-md shadow-purple-500/50 hover:shadow-purple-500/70",onClick:Xe=>{Xe.stopPropagation(),Ve(T)},title:"Post on X",children:"𝕏"}),e.jsx("a",{href:`https://xmagnetic.org/amm/${T.currency_code}+${T.issuer_address}_XRP+XRP?network=mainnet`,target:"_blank",rel:"noopener noreferrer",className:"btn text-purple-300 text-xs px-2 py-1 rounded",title:"AMM",children:"🔗"}),e.jsx("a",{href:`https://xrpl.services/?issuer=${T.issuer_address}&currency=${T.currency_code.length>3?vt.Buffer.from(T.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):T.currency_code}&limit=${T.supply}`,target:"_blank",rel:"noopener noreferrer",className:"btn text-purple-300 text-xs px-2 py-1 rounded",title:"Trustline",onClick:Xe=>Xe.stopPropagation(),children:"✅"})]})})]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-purple-200",children:"Memes"}),e.jsx("p",{className:"text-purple-400 mt-1",children:"All minted tokens from the factory"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>He(!0),className:"btn text-purple-300 px-6 py-3 rounded-lg font-medium",children:"+ Add Token"}),e.jsx("button",{onClick:()=>xe(!0),className:"btn-primary text-white px-6 py-3 rounded-lg font-medium",children:"🚀 Create Token"})]})]}),e.jsx("div",{className:"glass rounded-lg p-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-4",children:[e.jsx("input",{type:"text",value:i,onChange:T=>o(T.target.value),placeholder:"🔍 Search tokens...",className:"input flex-1 text-purple-200"}),e.jsxs("select",{value:n,onChange:T=>l(T.target.value),className:"input text-purple-200 w-full md:w-auto",children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"Meme",children:"😂 Meme"}),e.jsx("option",{value:"Gaming",children:"🎮 Gaming"}),e.jsx("option",{value:"DeFi",children:"💰 DeFi"}),e.jsx("option",{value:"Utility",children:"🔧 Utility"}),e.jsx("option",{value:"Community",children:"👥 Community"}),e.jsx("option",{value:"NFT",children:"🎨 NFT"}),e.jsx("option",{value:"AI",children:"🤖 AI"}),e.jsx("option",{value:"Other",children:"📦 Other"})]}),e.jsxs("select",{value:u,onChange:T=>h(T.target.value),className:"input text-purple-200 w-full md:w-auto",children:[e.jsx("option",{value:"newest",children:"Newest First"}),e.jsx("option",{value:"oldest",children:"Oldest First"}),e.jsx("option",{value:"name-asc",children:"Name (A-Z)"}),e.jsx("option",{value:"name-desc",children:"Name (Z-A)"}),e.jsx("option",{value:"marketcap",children:"Market Cap"}),e.jsx("option",{value:"supply-high",children:"Supply (High-Low)"}),e.jsx("option",{value:"supply-low",children:"Supply (Low-High)"}),e.jsx("option",{value:"price-high",children:"Price (High-Low)"}),e.jsx("option",{value:"price-low",children:"Price (Low-High)"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center justify-between",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("button",{onClick:()=>a("all"),className:`px-4 py-2 rounded-lg transition-all ${s==="all"?"bg-purple-600 text-white":"glass text-purple-300"}`,children:["All (",r.length,")"]}),e.jsxs("button",{onClick:()=>a("active"),className:`px-4 py-2 rounded-lg transition-all ${s==="active"?"bg-purple-600 text-white":"glass text-purple-300"}`,children:["🟢 Active (",r.filter(T=>T.amm_pool_created).length,")"]}),e.jsxs("button",{onClick:()=>a("pending"),className:`px-4 py-2 rounded-lg transition-all ${s==="pending"?"bg-purple-600 text-white":"glass text-purple-300"}`,children:["🟡 Pending (",r.filter(T=>!T.amm_pool_created).length,")"]}),e.jsxs("button",{onClick:()=>a("favorites"),className:`px-4 py-2 rounded-lg transition-all ${s==="favorites"?"bg-purple-600 text-white":"glass text-purple-300"}`,disabled:!b,title:b?"":"Connect wallet to view favorites",children:["⭐ Favorites (",f.length,")"]}),e.jsxs("button",{disabled:!0,className:"px-4 py-2 rounded-lg transition-all font-medium text-purple-500/50 cursor-not-allowed relative group",children:["👤 User",e.jsx("span",{className:"ml-2 text-xs bg-purple-900/50 px-2 py-0.5 rounded",children:"Coming Soon"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>d("grid"),className:`px-4 py-2 rounded-lg transition-all ${c==="grid"?"bg-purple-600 text-white":"glass text-purple-300"}`,children:"▦ Grid"}),e.jsx("button",{onClick:()=>d("list"),className:`px-4 py-2 rounded-lg transition-all ${c==="list"?"bg-purple-600 text-white":"glass text-purple-300"}`,children:"☰ List"})]})]})]})}),c==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Ye.map(T=>e.jsx(Le,{token:T},T.id))}):e.jsx("div",{className:"glass rounded-lg p-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-purple-900/30",children:e.jsxs("tr",{children:[e.jsxs("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>Pe("name"),title:"Double-click to sort",children:["Token ",u==="name"&&(g==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>Pe("category"),title:"Double-click to sort",children:["Category ",u==="category"&&(g==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>Pe("days"),title:"Double-click to sort",children:["Days ",u==="days"&&(g==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>Pe("price"),title:"Double-click to sort",children:["Live Price ",u==="price"&&(g==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>Pe("volume"),title:"Double-click to sort",children:["Volume 24h ",u==="volume"&&(g==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>Pe("lp"),title:"Double-click to sort",children:["Your LP ",u==="lp"&&(g==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>Pe("marketcap"),title:"Double-click to sort",children:["Market Cap ",u==="marketcap"&&(g==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>Pe("liquidity"),title:"Double-click to sort",children:["Liquidity (XRP) ",u==="liquidity"&&(g==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>Pe("status"),title:"Double-click to sort",children:["Status ",u==="status"&&(g==="asc"?"↑":"↓")]}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:Ye.map(T=>e.jsx(at,{token:T},T.id))})]})})}),Ye.length===0&&e.jsxs("div",{className:"glass rounded-lg p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🚀"}),e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-2",children:"No Tokens Found"}),e.jsx("p",{className:"text-purple-400",children:i?"Try a different search term":"Create your first token from the dashboard"})]}),e.jsx(Eo,{isOpen:ve,onClose:()=>He(!1),wallet:b}),pe&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-lg p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-2",children:"Create Token"}),e.jsx("p",{className:"text-purple-400 text-sm mb-6",children:"Create a new token on the XRP Ledger. The token will be minted and automatically added to a liquidity pool with the XRP you lock."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2 text-sm font-medium",children:"Token Name *"}),e.jsx("input",{type:"text",placeholder:"e.g., MemeKing",value:te.name,onChange:T=>U({...te,name:T.target.value}),className:"w-full px-4 py-2 bg-purple-900/20 border border-purple-500/30 rounded-lg text-purple-200 placeholder-purple-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2 text-sm font-medium",children:"Total Supply *"}),e.jsx("input",{type:"number",placeholder:"1000000",value:te.supply,onChange:T=>U({...te,supply:T.target.value}),className:"w-full px-4 py-2 bg-purple-900/20 border border-purple-500/30 rounded-lg text-purple-200 placeholder-purple-400"}),e.jsx("p",{className:"text-xs text-purple-400 mt-1",children:"Maximum number of tokens that will exist"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2 text-sm font-medium",children:"XRP to Lock in Initial Pool *"}),e.jsx("input",{type:"number",placeholder:"1",value:te.xrpLocked,onChange:T=>U({...te,xrpLocked:T.target.value}),className:"w-full px-4 py-2 bg-purple-900/20 border border-purple-500/30 rounded-lg text-purple-200 placeholder-purple-400"}),e.jsx("p",{className:"text-xs text-purple-400 mt-1",children:"Amount of XRP to add as initial liquidity (determines starting price)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2 text-sm font-medium",children:"Description"}),e.jsx("textarea",{placeholder:"Tell the community about your token...",value:te.description,onChange:T=>U({...te,description:T.target.value}),className:"w-full px-4 py-2 bg-purple-900/20 border border-purple-500/30 rounded-lg text-purple-200 placeholder-purple-400 min-h-[80px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2 text-sm font-medium",children:"Twitter Handle"}),e.jsx("input",{type:"text",placeholder:"e.g., @mytoken",value:te.twitterHandle,onChange:T=>U({...te,twitterHandle:T.target.value}),className:"w-full px-4 py-2 bg-purple-900/20 border border-purple-500/30 rounded-lg text-purple-200 placeholder-purple-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2 text-sm font-medium",children:"Website URL"}),e.jsx("input",{type:"url",placeholder:"https://yourtoken.com",value:te.websiteUrl,onChange:T=>U({...te,websiteUrl:T.target.value}),className:"w-full px-4 py-2 bg-purple-900/20 border border-purple-500/30 rounded-lg text-purple-200 placeholder-purple-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2 text-sm",children:"Token Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:Tt,className:"w-full px-4 py-2 bg-purple-900/20 border border-purple-500/30 rounded-lg text-purple-200 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-purple-600 file:text-white hover:file:bg-purple-700"}),ke&&e.jsx("div",{className:"mt-3",children:e.jsx("img",{src:ke,alt:"Preview",className:"w-24 h-24 rounded-lg object-cover"})})]}),e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsx("h4",{className:"text-purple-200 font-medium mb-3",children:"Token Settings"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:te.tfTransferable,onChange:T=>U({...te,tfTransferable:T.target.checked}),className:"w-4 h-4 rounded border-purple-500/30"}),e.jsx("span",{className:"text-purple-300 text-sm",children:"Transferable"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:te.requireDestTag,onChange:T=>U({...te,requireDestTag:T.target.checked}),className:"w-4 h-4 rounded border-purple-500/30"}),e.jsx("span",{className:"text-purple-300 text-sm",children:"Require Destination Tag"})]})]})]}),e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsx("h4",{className:"text-purple-200 font-medium mb-3",children:"Wallet Configuration"}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("button",{onClick:()=>q("admin"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${Ne==="admin"?"bg-purple-600 text-white":"bg-purple-900/20 text-purple-300 hover:bg-purple-900/40"}`,children:"Admin Token"}),e.jsx("button",{onClick:()=>q("simple"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${Ne==="simple"?"bg-purple-600 text-white":"bg-purple-900/20 text-purple-300 hover:bg-purple-900/40"}`,children:"No Issuer Access"}),e.jsx("button",{onClick:()=>q("custom"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${Ne==="custom"?"bg-purple-600 text-white":"bg-purple-900/20 text-purple-300 hover:bg-purple-900/40"}`,children:"Custom Wallet"})]}),Ne==="admin"?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2 text-sm text-purple-300",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Issuer:"})," ",Nn]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Receiver:"})," ",Us]}),e.jsx("p",{className:"text-xs text-purple-400 mt-2",children:"Using MEMEKINGS managed wallets for token creation"})]}),!b&&e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-3",children:[e.jsx("p",{className:"text-yellow-300 text-xs font-medium",children:"⚠️ Connected wallet required"}),e.jsx("p",{className:"text-yellow-300/80 text-xs mt-1",children:"You must connect your wallet to pay the 5 XRP creation fee when using Admin Token mode."})]}),(b==null?void 0:b.address)===Us&&e.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-3",children:[e.jsx("p",{className:"text-green-300 text-xs font-medium",children:"✓ Admin Wallet Connected"}),e.jsx("p",{className:"text-green-300/80 text-xs mt-1",children:"Creation fee waived for admin wallet"})]}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-3",children:[e.jsx("p",{className:"text-blue-300 text-xs font-medium",children:"ℹ️ What happens during creation:"}),e.jsxs("ul",{className:"text-blue-300/80 text-xs mt-2 space-y-1 list-disc list-inside",children:[(b==null?void 0:b.address)===Us?e.jsx("li",{children:"5 XRP creation fee waived (admin wallet)"}):e.jsx("li",{children:"5 XRP fee is paid from your connected wallet"}),e.jsx("li",{children:"Token is issued by MEMEKINGS managed issuer"}),e.jsx("li",{children:"Tokens are sent to platform receiver wallet"}),e.jsx("li",{children:"Automatic trustline setup and liquidity pool creation"})]})]})]}):Ne==="simple"?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2 text-sm text-purple-300",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Issuer:"})," ",Nn]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Receiver:"})," ",(b==null?void 0:b.address)||"Connect your wallet"]}),e.jsx("p",{className:"text-xs text-purple-400 mt-2",children:"Tokens will be sent directly to your connected wallet"})]}),!b&&e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-3",children:[e.jsx("p",{className:"text-yellow-300 text-xs font-medium",children:"⚠️ Connected wallet required"}),e.jsx("p",{className:"text-yellow-300/80 text-xs mt-1",children:"Connect your wallet to receive tokens and pay the 3 XRP creation fee."})]}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-3",children:[e.jsx("p",{className:"text-blue-300 text-xs font-medium",children:"ℹ️ Simple Token Creation:"}),e.jsxs("ul",{className:"text-blue-300/80 text-xs mt-2 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"3 XRP creation fee (lower cost for simple minting)"}),e.jsx("li",{children:"Token issued by MEMEKINGS issuer (no issuer wallet access)"}),e.jsx("li",{children:"Tokens sent directly to your connected wallet"}),e.jsx("li",{children:"Cannot mint additional tokens later"}),e.jsx("li",{children:"Perfect for one-time token launches"}),e.jsx("li",{children:"Automatic trustline setup and liquidity pool creation"})]})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-3 mb-3",children:[e.jsx("p",{className:"text-yellow-300 text-xs font-medium",children:"⚠️ Important Requirements"}),e.jsx("p",{className:"text-yellow-300/80 text-xs mt-1 mb-2",children:"You need TWO activated wallets (2 XRP reserve each) before proceeding. Ensure you have enough XRP for transaction fees and liquidity pool creation."}),e.jsx("button",{onClick:()=>{window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"wallets"}))},className:"text-purple-300 hover:text-purple-200 underline text-xs font-medium",children:"→ Go to Wallets page to generate wallets"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2 text-sm",children:"Issuer Wallet"}),e.jsxs("select",{value:(re==null?void 0:re.id)||"",onChange:T=>{if(T.target.value==="connected")B({id:"connected",address:b.address,encrypted_seed:b.seed});else{const ne=ee.find(Fe=>Fe.id===T.target.value);B(ne||null)}},className:"w-full px-3 py-2 bg-purple-900/20 border border-purple-500/30 rounded-lg text-purple-200 text-sm",children:[e.jsx("option",{value:"",children:"Select issuer wallet..."}),b&&e.jsxs("option",{value:"connected",children:[b.address," (Connected)"]}),ee.map(T=>e.jsxs("option",{value:T.id,children:[T.name," - ",T.address.substring(0,10),"..."]},T.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2 text-sm",children:"Receiver Wallet"}),e.jsxs("select",{value:(Y==null?void 0:Y.id)||"",onChange:T=>{if(T.target.value==="connected")oe({id:"connected",address:b.address,encrypted_seed:b.seed});else if(T.target.value==="default")oe({id:"default",address:Us,encrypted_seed:"sEd7W72aANTbLTG98XDhU1yfotPJdhu"});else{const ne=ee.find(Fe=>Fe.id===T.target.value);oe(ne||null)}},className:"w-full px-3 py-2 bg-purple-900/20 border border-purple-500/30 rounded-lg text-purple-200 text-sm",children:[e.jsx("option",{value:"",children:"Select receiver wallet..."}),b&&e.jsxs("option",{value:"connected",children:[b.address," (Connected)"]}),e.jsxs("option",{value:"default",children:[Us," (Platform Default)"]}),ee.map(T=>e.jsxs("option",{value:T.id,children:[T.name," - ",T.address.substring(0,10),"..."]},T.id))]})]}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-3",children:[e.jsx("p",{className:"text-blue-300 text-xs font-medium",children:"ℹ️ What happens during creation:"}),e.jsxs("ul",{className:"text-blue-300/80 text-xs mt-2 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"5 XRP fee is paid from your connected wallet"}),e.jsx("li",{children:"Token is issued by your selected issuer wallet"}),e.jsx("li",{children:"Tokens are sent to your selected receiver wallet"}),e.jsx("li",{children:"You retain full control and can mint more tokens later"}),e.jsx("li",{children:"Automatic trustline setup and liquidity pool creation"})]})]})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:Mt,disabled:ie||Oe||Ne==="admin"&&!b||Ne==="simple"&&!b||Ne==="custom"&&(!re||!Y),className:"btn-primary text-white px-6 py-2 rounded-lg font-medium flex-1 disabled:opacity-50",children:Oe?e.jsx("span",{children:"⬆️ Uploading Image..."}):ie?e.jsx("span",{children:"🔄 Creating..."}):e.jsxs("span",{children:["🚀 Create Token",(b==null?void 0:b.address)===Us&&Ne==="admin"?" (Admin - Free)":Ne==="simple"?" (3 XRP)":" (5 XRP)"]})}),e.jsx("button",{onClick:()=>{xe(!1),U({name:"",issuer:"",supply:"1000000",xrpLocked:"1",image:null,imageUrl:"",tfTransferable:!1,requireDestTag:!1,description:"",twitterHandle:"",websiteUrl:""}),he(null)},disabled:ie||Oe,className:"btn text-purple-300 px-6 py-2 rounded-lg font-medium disabled:opacity-50",children:"Cancel"})]})]})}),tt&&be&&e.jsx(an,{token:be,onClose:()=>{nt(!1),We(null)}}),e.jsx(To,{isOpen:M,steps:K,currentStep:p,canClose:R,onClose:()=>{fe(!1),v([]),x(0)}})]})}const Nr=.1;function Z0({isOpen:r,onClose:t,wallet:s}){var G,_e,ge,Ce,ue,J,se,F;const[a,n]=m.useState(1),[l,i]=m.useState(!1),[o,c]=m.useState([]),[d,u]=m.useState({selectedToken:null,tokenAmount:"",xrpAmount:"",tradingFee:0}),[h,g]=m.useState(""),[y,f]=m.useState(!1),[w,b]=m.useState([]);m.useEffect(()=>{r&&(P(),n(1),u({selectedToken:null,tokenAmount:"",xrpAmount:"",tradingFee:0}))},[r]);const P=async()=>{try{const{data:X,error:me}=await S.from("meme_tokens").select("*").eq("amm_pool_created",!1).neq("status","active").order("created_at",{ascending:!1});if(me)throw me;c(X||[])}catch{k.error("Failed to load available tokens")}},A=()=>d.selectedToken?!0:(k.error("Please select a token"),!1),_=()=>!d.tokenAmount||parseFloat(d.tokenAmount)<=0?(k.error("Token amount must be greater than 0"),!1):!d.xrpAmount||parseFloat(d.xrpAmount)<=0?(k.error("XRP amount must be greater than 0"),!1):parseFloat(d.xrpAmount)<10?(k.error("XRP amount must be at least 10 XRP"),!1):!0,W=()=>{a===1&&!A()||a===2&&!_()||n(a+1)},D=()=>{n(a-1)},I=async()=>{var me,ve,He,pe;if(!s){k.error("Please connect a wallet first");return}i(!0),f(!0);const X=[];try{g("Initializing wallet..."),X.push({text:"Initialize wallet",status:"in_progress"}),b([...X]);const xe=Re.Wallet.fromSeed(s.seed),le=await Zr(),$e=d.selectedToken,Ne=$e.currency_hex||Qn($e.currency_code);X[0].status="completed",b([...X]);const q="rKxBBMmY969Ph1y63ddVfYyN7xmxwDfVq6",ee=s.address===q||$e.receiver_address&&s.address===$e.receiver_address;if($e.receiver_address&&$e.receiver_address!==s.address&&!ee){g(`Paying ${Nr} XRP creation fee...`),X.push({text:`Pay ${Nr} XRP creation fee`,status:"in_progress"}),b([...X]);const ye={TransactionType:"Payment",Account:xe.address,Amount:String(Nr*1e6),Destination:$e.receiver_address,Memos:[{Memo:{MemoData:Buffer.from(`AMM Pool Creation Fee: ${$e.currency_code}`).toString("hex").toUpperCase(),MemoType:Buffer.from("amm-creation-fee").toString("hex").toUpperCase()}}]};if((await il(ye,xe)).result.meta.TransactionResult!=="tesSUCCESS")throw new Error("Fee payment failed");X[X.length-1].status="completed",b([...X]),k.success(`${Nr} XRP fee paid to token receiver`)}else ee&&(X.push({text:"Skip fee (admin/receiver wallet)",status:"completed"}),b([...X]));g("Creating AMM pool on XRPL..."),X.push({text:"Create AMM pool on XRPL",status:"in_progress"}),b([...X]);const L={currency:Ne,issuer:$e.issuer_address,value:d.tokenAmount},re=d.xrpAmount,B={TransactionType:"AMMCreate",Account:xe.address,Amount:L,Amount2:String(parseFloat(re)*1e6),TradingFee:d.tradingFee},Y=await le.autofill(B),oe=xe.sign(Y),ie=await le.submitAndWait(oe.tx_blob);if(ie.result.meta.TransactionResult!=="tesSUCCESS")throw new Error(`Transaction failed: ${ie.result.meta.TransactionResult}`);X[X.length-1].status="completed",b([...X]),g("Updating database..."),X.push({text:"Update token status in database",status:"in_progress"}),b([...X]),await S.from("meme_tokens").update({amm_pool_created:!0,amm_asset_amount:parseFloat(d.tokenAmount),amm_xrp_amount:parseFloat(d.xrpAmount),amm_tx_hash:ie.result.hash,status:"active"}).eq("id",$e.id),X[X.length-1].status="completed",b([...X]),g("Adding to pool tracking..."),X.push({text:"Add to pool tracking",status:"in_progress"}),b([...X]),await S.from("user_pools").insert({user_address:s.address,token_id:$e.id,token_amount:parseFloat(d.tokenAmount),xrp_amount:parseFloat(d.xrpAmount),created_at:new Date().toISOString()}),X[X.length-1].status="completed",b([...X]),g("Complete!"),k.success("AMM Pool created successfully!"),setTimeout(()=>{t(),window.location.reload()},1500)}catch(xe){const le=w.map((Ne,q)=>q===w.length-1&&Ne.status==="in_progress"?{...Ne,status:"error"}:Ne);b(le);let $e="Failed to create AMM pool";(me=xe.message)!=null&&me.includes("tecNO_AUTH")?$e="Insufficient authorization. Make sure you have a trustline for this token.":(ve=xe.message)!=null&&ve.includes("tecUNFUNDED")?$e="Insufficient funds. You need more XRP in your wallet.":(He=xe.message)!=null&&He.includes("tecINSUF_RESERVE_LINE")?$e="Insufficient reserve. You need to maintain the minimum XRP reserve.":(pe=xe.message)!=null&&pe.includes("tecAMM_EXISTS")?$e="AMM pool already exists for this token pair.":xe.message&&($e=xe.message),g(`Error: ${$e}`),k.error($e)}finally{i(!1)}};if(!r)return null;const E=d.tokenAmount&&d.xrpAmount?(parseFloat(d.xrpAmount)/parseFloat(d.tokenAmount)).toFixed(8):"0";return e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-purple-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Create AMM LP Pool"}),e.jsx("button",{onClick:t,className:"text-purple-300 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"mb-6 flex items-center gap-2",children:[1,2,3].map(X=>e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${a>=X?"bg-purple-600 text-white":"bg-purple-900/30 text-purple-500"}`,children:X}),X<3&&e.jsx("div",{className:`flex-1 h-1 mx-2 ${a>X?"bg-purple-600":"bg-purple-900/30"}`})]},X))}),a===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsxs("h3",{className:"text-blue-300 font-semibold mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ℹ️"}),"AMM Pool Creation"]}),e.jsxs("ul",{className:"text-blue-200 text-sm space-y-1",children:[e.jsx("li",{children:"• Select a token that doesn't have an AMM pool yet"}),e.jsx("li",{children:"• Provide initial liquidity (Token + XRP)"}),e.jsx("li",{children:"• The pool will be created on the XRPL blockchain"}),e.jsx("li",{children:"• You'll receive LP tokens representing your share"}),e.jsxs("li",{children:["• Fee: ",Nr," XRP (FREE for admin issuer and token receiver wallets)"]})]})]}),e.jsx("h3",{className:"text-white font-semibold",children:"Select Token"}),o.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-purple-300",children:"No tokens available for pool creation"}),e.jsx("p",{className:"text-purple-500 text-sm mt-2",children:"All tokens already have AMM pools"})]}):e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:o.map(X=>{var me,ve;return e.jsx("button",{onClick:()=>u({...d,selectedToken:X}),className:`w-full p-4 rounded-lg border-2 transition-all text-left ${((me=d.selectedToken)==null?void 0:me.id)===X.id?"border-purple-500 bg-purple-500/20":"border-purple-500/30 bg-purple-900/20 hover:border-purple-500/50"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-purple-500/20 to-purple-600/20 flex items-center justify-center",children:e.jsx("span",{className:"text-lg font-bold text-purple-400",children:((ve=X.token_name)==null?void 0:ve.charAt(0))||"?"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-white",children:X.token_name}),e.jsx("div",{className:"text-sm text-purple-400",children:X.currency_code})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-purple-300",children:"Supply"}),e.jsx("div",{className:"text-white font-medium",children:parseFloat(X.supply).toLocaleString()})]})]})},X.id)})})]}),a===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-white font-semibold",children:"Set Initial Liquidity"}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsx("p",{className:"text-yellow-200 text-sm",children:"The amounts you provide will determine the initial price. Make sure you have enough of both assets in your wallet."})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-purple-300 text-sm mb-2",children:[(G=d.selectedToken)==null?void 0:G.currency_code," Amount *"]}),e.jsx("input",{type:"number",value:d.tokenAmount,onChange:X=>u({...d,tokenAmount:X.target.value}),placeholder:"100000",step:"any",className:"w-full px-4 py-3 bg-purple-900/20 border border-purple-500/30 rounded-lg text-white placeholder-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 text-sm mb-2",children:"XRP Amount * (min 10 XRP)"}),e.jsx("input",{type:"number",value:d.xrpAmount,onChange:X=>u({...d,xrpAmount:X.target.value}),placeholder:"1000",step:"any",min:"10",className:"w-full px-4 py-3 bg-purple-900/20 border border-purple-500/30 rounded-lg text-white placeholder-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 text-sm mb-2",children:"Trading Fee (basis points, 0-1000)"}),e.jsx("input",{type:"number",value:d.tradingFee,onChange:X=>u({...d,tradingFee:Math.min(1e3,Math.max(0,parseInt(X.target.value)||0))}),placeholder:"0",min:"0",max:"1000",className:"w-full px-4 py-3 bg-purple-900/20 border border-purple-500/30 rounded-lg text-white placeholder-purple-500"}),e.jsxs("p",{className:"text-purple-500 text-xs mt-1",children:[d.tradingFee/100,"% fee per trade. Default is 0 (no fee)."]})]}),d.tokenAmount&&d.xrpAmount&&e.jsx("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:e.jsxs("p",{className:"text-green-300 text-sm",children:["Initial Price: 1 ",(_e=d.selectedToken)==null?void 0:_e.currency_code," = ",E," XRP"]})})]}),a===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-white font-semibold",children:"Review & Confirm"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"Token"}),e.jsxs("div",{className:"text-white font-semibold",children:[(ge=d.selectedToken)==null?void 0:ge.token_name," (",(Ce=d.selectedToken)==null?void 0:Ce.currency_code,")"]})]}),e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"Initial Liquidity"}),e.jsxs("div",{className:"text-white",children:[e.jsxs("div",{children:[parseFloat(d.tokenAmount).toLocaleString()," ",(ue=d.selectedToken)==null?void 0:ue.currency_code]}),e.jsxs("div",{children:[parseFloat(d.xrpAmount).toLocaleString()," XRP"]})]})]}),e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"Initial Price"}),e.jsxs("div",{className:"text-white",children:["1 ",(J=d.selectedToken)==null?void 0:J.currency_code," = ",E," XRP"]})]}),e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"Trading Fee"}),e.jsxs("div",{className:"text-white",children:[d.tradingFee/100,"%"]})]}),((se=d.selectedToken)==null?void 0:se.receiver_address)&&d.selectedToken.receiver_address!==(s==null?void 0:s.address)&&e.jsxs("div",{className:"glass rounded-lg p-4 bg-blue-500/10 border-blue-500/30",children:[e.jsx("div",{className:"text-blue-400 text-sm mb-1",children:"AMM Creation Fee"}),e.jsxs("div",{className:"text-white font-semibold",children:[Nr," XRP"]}),e.jsxs("div",{className:"text-blue-300 text-xs mt-1",children:["Paid to token receiver: ",d.selectedToken.receiver_address.slice(0,8),"...",d.selectedToken.receiver_address.slice(-6)]})]}),(!((F=d.selectedToken)!=null&&F.receiver_address)||d.selectedToken.receiver_address===(s==null?void 0:s.address)||(s==null?void 0:s.address)==="rKxBBMmY969Ph1y63ddVfYyN7xmxwDfVq6")&&e.jsxs("div",{className:"glass rounded-lg p-4 bg-green-500/10 border-green-500/30",children:[e.jsx("div",{className:"text-green-400 text-sm mb-1",children:"AMM Creation Fee"}),e.jsx("div",{className:"text-green-200 font-semibold",children:"FREE"}),e.jsx("div",{className:"text-green-300 text-xs mt-1",children:"No fee for admin issuer and token receiver wallets"})]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsx("p",{className:"text-yellow-200 text-sm",children:"⚠️ Make sure you have a trustline for this token and sufficient balance before proceeding."})})]}),e.jsxs("div",{className:"mt-6 flex gap-3",children:[a>1&&e.jsx("button",{onClick:D,disabled:l,className:"px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50",children:"Back"}),a<3?e.jsx("button",{onClick:W,disabled:l||a===1&&!d.selectedToken,className:"flex-1 px-6 py-3 bg-gradient-to-r from-purple-600 to-purple-500 hover:from-purple-500 hover:to-purple-400 text-white rounded-lg font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"}):e.jsx("button",{onClick:I,disabled:l,className:"flex-1 px-6 py-3 bg-gradient-to-r from-green-600 to-green-500 hover:from-green-500 hover:to-green-400 text-white rounded-lg font-medium transition-all disabled:opacity-50",children:l?"Creating Pool...":"Create AMM Pool"})]}),y&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[60]",children:e.jsxs("div",{className:"glass rounded-xl p-6 max-w-md w-full mx-4 border border-purple-500/30",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Creating AMM Pool"}),e.jsx("div",{className:"space-y-3",children:w.map((X,me)=>e.jsxs("div",{className:"flex items-center gap-3",children:[X.status==="completed"&&e.jsx("div",{className:"w-6 h-6 rounded-full bg-green-500 flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),X.status==="in_progress"&&e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-purple-500 border-t-transparent animate-spin flex-shrink-0"}),X.status==="error"&&e.jsx("div",{className:"w-6 h-6 rounded-full bg-red-500 flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("span",{className:`text-sm ${X.status==="completed"?"text-green-300":X.status==="in_progress"?"text-purple-300 font-semibold":X.status==="error"?"text-red-300":"text-gray-400"}`,children:X.text})]},me))}),h&&e.jsx("div",{className:"mt-4 pt-4 border-t border-purple-500/20",children:e.jsx("p",{className:"text-purple-300 text-sm",children:h})})]})})]})})}function eh(){const[r,t]=m.useState([]),[s,a]=m.useState({}),[n,l]=m.useState(!1),[i,o]=m.useState(null),[c,d]=m.useState({}),[u,h]=m.useState(()=>window.innerWidth<768?"grid":"list"),[g,y]=m.useState(""),[f,w]=m.useState("liquidity"),[b,P]=m.useState("all"),[A,_]=m.useState([]),[W,D]=m.useState(2.5),[I,E]=m.useState(null),[G,_e]=m.useState(!1);m.useEffect(()=>{(async()=>{await se(),await F(),ge(),Ce()})();const ee=la(()=>{se()}),L=()=>{ge()};return window.addEventListener("walletConnected",L),window.addEventListener("walletDisconnected",L),()=>{ee(),window.removeEventListener("walletConnected",L),window.removeEventListener("walletDisconnected",L)}},[]),m.useEffect(()=>{r.length>0&&Object.keys(s).length===0&&me()},[r]),m.useEffect(()=>{const q=setInterval(()=>{r.length>0&&me(!1)},3e5);return()=>clearInterval(q)},[r]),m.useEffect(()=>{i&&Object.keys(s).length>0&&Object.keys(c).length===0&&ve()},[i,s]),m.useEffect(()=>{i&&ue()},[i]),m.useEffect(()=>{const q=ee=>{I&&!ee.target.closest(".swap-dropdown")&&E(null)};return document.addEventListener("mousedown",q),()=>document.removeEventListener("mousedown",q)},[I]);const ge=()=>{const q=localStorage.getItem("connectedWallet");o(q?JSON.parse(q):null)},Ce=async()=>{var q;try{const L=await(await fetch("https://api.coingecko.com/api/v3/simple/price?ids=ripple&vs_currencies=usd")).json();D(((q=L.ripple)==null?void 0:q.usd)||2.5)}catch{D(2.5)}},ue=async()=>{if(i)try{const{data:q,error:ee}=await S.from("token_favorites").select("token_id").eq("user_address",i.address);if(ee)throw ee;_((q==null?void 0:q.map(L=>L.token_id))||[])}catch{}},J=async(q,ee)=>{if(ee&&ee.stopPropagation(),!i){k.error("Connect wallet to favorite pools");return}try{if(A.includes(q)){const{error:re}=await S.from("token_favorites").delete().eq("user_address",i.address).eq("token_id",q);if(re)throw re;_(A.filter(B=>B!==q)),k.success("Removed from favorites")}else{const{error:re}=await S.from("token_favorites").insert([{user_address:i.address,token_id:q}]);if(re)throw re;_([...A,q]),k.success("Added to favorites")}}catch{k.error("Failed to update favorite")}},se=async()=>{try{const{data:q,error:ee}=await S.from("meme_tokens").select("*").eq("amm_pool_created",!0).order("created_at",{ascending:!1});if(ee)throw ee;t(q||[])}catch{}},F=async()=>{try{const{data:q,error:ee}=await S.from("pool_data_cache").select("*");if(!ee&&q&&q.length>0){const L={};q.forEach(re=>{L[re.token_id]={xrpAmount:parseFloat(re.xrp_amount),tokenAmount:parseFloat(re.token_amount),lpTokens:parseFloat(re.lp_tokens),price:parseFloat(re.price),accountId:re.account_id,volume24h:parseFloat(re.volume_24h||0),priceChange24h:parseFloat(re.price_change_24h||0)}}),a(L)}}catch{}},X=async q=>{try{const ee=new Date(Date.now()-864e5).toISOString(),{data:L,error:re}=await S.from("trade_history").select("token_id, xrp_amount").in("token_id",q).gte("created_at",ee);if(re)throw re;const B={};return q.forEach(Y=>B[Y]=0),L&&L.length>0&&L.forEach(Y=>{const oe=parseFloat(Y.xrp_amount||0);B[Y.token_id]=(B[Y.token_id]||0)+oe}),B}catch{return{}}},me=async(q=!1)=>{var ee;l(!0);try{const{data:re,error:B}=await S.from("pool_data_cache").select("*").gte("last_updated",new Date(Date.now()-3e5).toISOString());if(!q&&re&&re.length>0&&!B){const te={};re.forEach(U=>{te[U.token_id]={xrpAmount:parseFloat(U.xrp_amount),tokenAmount:parseFloat(U.token_amount),lpTokens:parseFloat(U.lp_tokens),price:parseFloat(U.price),accountId:U.account_id,volume24h:parseFloat(U.volume_24h||0),priceChange24h:parseFloat(U.price_change_24h||0)}}),a(te),l(!1);return}const{requestWithRetry:Y}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),oe={},ie=await X(r.map(te=>te.id));for(const te of r)try{const U=te.currency_code.length>3?vt.Buffer.from(te.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):te.currency_code,ke=await Y({command:"amm_info",asset:{currency:"XRP"},asset2:{currency:U,issuer:te.issuer_address},ledger_index:"validated"});if(ke.result.amm){const he=ke.result.amm,Oe=parseFloat(he.amount)/1e6,$=parseFloat(he.amount2.value),be=parseFloat(((ee=he.lp_token)==null?void 0:ee.value)||0),We=parseFloat(he.trading_fee||0)/1e3,tt=he.auction_slot||null,nt=ie[te.id]||0,M=nt*(We/100),fe=Oe>0?M*365/Oe*100:0;oe[te.id]={xrpAmount:Oe,tokenAmount:$,lpTokens:be,price:Oe/$,accountId:he.account,tradingFee:We,volume24h:nt,fees24h:M,apr:fe,auctionSlot:tt}}}catch{oe[te.id]=null}const ye=Object.entries(oe).filter(([te,U])=>U!==null).map(([te,U])=>({token_id:te,xrp_amount:U.xrpAmount,token_amount:U.tokenAmount,lp_tokens:U.lpTokens,price:U.price,account_id:U.accountId,volume_24h:U.volume24h||0,price_change_24h:0,last_updated:new Date().toISOString()}));if(ye.length>0)for(const te of ye)await S.from("pool_data_cache").upsert(te,{onConflict:"token_id"});a(oe)}catch(L){k.error(`Failed to fetch pool data: ${L.message}`)}finally{l(!1)}},ve=async()=>{if(i)try{const{data:q}=await S.from("lp_balance_cache").select("*").eq("wallet_address",i.address).gte("last_updated",new Date(Date.now()-3e5).toISOString());if(q&&q.length>0){const Y={};q.forEach(oe=>{Y[oe.token_id]={balance:parseFloat(oe.lp_balance),share:parseFloat(oe.lp_share_percentage)}}),d(Y);return}const{requestWithRetry:ee}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),L=await ee({command:"account_lines",account:i.address,ledger_index:"validated"}),re={},B=[];if(L.result.lines&&L.result.lines.forEach(Y=>{const oe=Object.entries(s).find(([ie,ye])=>ye&&ye.accountId===Y.account);if(oe){const[ie,ye]=oe,te=parseFloat(Y.balance),U=ye.lpTokens>0?te/ye.lpTokens*100:0;re[ie]={balance:te,share:U},B.push({wallet_address:i.address,token_id:ie,amm_account_id:Y.account,lp_balance:te,lp_share_percentage:U,last_updated:new Date().toISOString()})}}),B.length>0)for(const Y of B)await S.from("lp_balance_cache").upsert(Y,{onConflict:"wallet_address,token_id"});d(re)}catch{}},He=q=>!q.amm_pool_created||!q.amm_xrp_amount||!q.amm_asset_amount?0:q.amm_xrp_amount/q.amm_asset_amount,pe=q=>{const ee=s[q.id];return ee&&ee.price?ee.price:He(q)},xe=q=>{const ee=pe(q),L=parseFloat(q.total_supply)||0;return ee*L},le=q=>{const ee=s[q.id];if(!ee||!ee.price||!q.amm_xrp_amount||!q.amm_asset_amount)return"0.00";const L=ee.price,re=q.amm_xrp_amount/q.amm_asset_amount;return!re||re===0?"0.00":((L-re)/re*100).toFixed(2)},$e=({token:q})=>{const ee=s[q.id],L=c[q.id],re=pe(q),B=xe(q);return e.jsxs("div",{className:"glass rounded-lg p-3 sm:p-6 space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[e.jsx(Ft,{token:q,size:"lg",className:"flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsxs("h3",{className:"text-sm sm:text-lg md:text-xl font-bold text-purple-200 truncate",children:[q.token_name,"/XRP"]}),e.jsx("button",{onClick:Y=>J(q.id,Y),className:"text-base sm:text-lg hover:scale-110 transition-transform flex-shrink-0",children:A.includes(q.id)?"⭐":"☆"})]}),e.jsx("p",{className:"text-purple-400 text-xs sm:text-sm",children:"AMM Pool"})]})]}),e.jsxs("div",{className:"text-left sm:text-right w-full sm:w-auto",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-base sm:text-xl md:text-2xl font-bold text-purple-200 font-mono truncate",children:re.toFixed(8)}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(re*W).toFixed(6)]})]}),q.amm_pool_created&&e.jsxs("span",{className:`text-xs font-medium px-1.5 sm:px-2 py-1 rounded whitespace-nowrap flex-shrink-0 ${parseFloat(le(q))>=0?"text-green-300 bg-green-500/10":"text-red-300 bg-red-500/10"}`,children:[parseFloat(le(q))>=0?"+":"",le(q),"%"]})]}),e.jsx("div",{className:"text-purple-400 text-xs",children:"XRP per token"})]})]}),ee?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-4",children:[e.jsxs("div",{className:"glass rounded-lg p-2 sm:p-4",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-0.5 sm:mb-1",children:"XRP Liquidity"}),e.jsx("div",{className:"text-sm sm:text-lg font-bold text-purple-200 truncate",children:ee.xrpAmount.toFixed(2)}),e.jsxs("div",{className:"text-green-400 text-xs truncate",children:["$",(ee.xrpAmount*W).toFixed(2)]})]}),e.jsxs("div",{className:"glass rounded-lg p-2 sm:p-4",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-0.5 sm:mb-1",children:"24h Volume"}),e.jsxs("div",{className:"text-sm sm:text-lg font-bold text-purple-200 truncate",children:[ee.volume24h?ee.volume24h.toFixed(2):"0"," XRP"]}),e.jsxs("div",{className:"text-green-400 text-xs truncate",children:["$",((ee.volume24h||0)*W).toFixed(2)]})]}),e.jsxs("div",{className:"glass rounded-lg p-2 sm:p-4",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-0.5 sm:mb-1",children:"LP Tokens"}),e.jsx("div",{className:"text-sm sm:text-lg font-bold text-purple-200 truncate",children:ee.lpTokens.toFixed(2)})]}),e.jsxs("div",{className:"glass rounded-lg p-2 sm:p-4",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-0.5 sm:mb-1",children:"Market Cap"}),e.jsxs("div",{className:"text-sm sm:text-lg font-bold text-purple-200 truncate",children:[B.toFixed(2)," XRP"]})]})]}),L&&e.jsx("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-2 sm:p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-green-300 text-xs sm:text-sm font-medium mb-0.5 sm:mb-1",children:"Your LP Position"}),e.jsxs("div",{className:"text-green-200 text-xs truncate",children:[L.balance.toFixed(4)," LP Tokens (",L.share.toFixed(4),"% of pool)"]})]}),e.jsxs("div",{className:"text-left sm:text-right flex-shrink-0",children:[e.jsxs("div",{className:"text-green-200 text-sm sm:text-base font-bold truncate",children:["~",(ee.xrpAmount*L.share/100).toFixed(4)," XRP"]}),e.jsxs("div",{className:"text-green-400 text-xs truncate",children:["$",(ee.xrpAmount*L.share/100*W).toFixed(2)]}),e.jsx("div",{className:"text-green-300 text-xs",children:"Your Share Value"})]})]})}),e.jsxs("div",{className:"relative swap-dropdown",children:[e.jsxs("button",{onClick:Y=>{Y.stopPropagation(),E(I===q.id?null:q.id)},className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold py-2.5 sm:py-3 rounded-lg shadow-md shadow-blue-500/50 hover:shadow-blue-500/70 flex items-center justify-center gap-2 text-sm sm:text-base",children:["💱 Swap",e.jsx("svg",{className:`w-4 h-4 transition-transform ${I===q.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),I===q.id&&e.jsxs("div",{className:"absolute bottom-full left-0 right-0 mb-2 glass bg-gradient-to-br from-purple-900/95 to-purple-800/95 border border-purple-500/30 rounded-lg shadow-xl z-[9999] overflow-hidden",children:[e.jsxs("button",{onClick:()=>{E(null),localStorage.setItem("selectedTradeToken",JSON.stringify(q)),window.dispatchEvent(new CustomEvent("navigateToTrade",{detail:q}))},className:"w-full px-4 py-3 text-left hover:bg-purple-600/30 transition-colors flex items-center gap-3 border-b border-purple-500/30",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center text-purple-300",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-purple-100 font-medium",children:"Trade Page"}),e.jsx("div",{className:"text-purple-300 text-xs",children:"Swap on MEMEKINGS"})]})]}),e.jsxs("a",{href:`https://xmagnetic.org/amm/${q.currency_code}+${q.issuer_address}_XRP+XRP?network=mainnet`,target:"_blank",rel:"noopener noreferrer",className:"w-full px-4 py-3 text-left hover:bg-purple-600/30 transition-colors flex items-center gap-3",onClick:()=>E(null),children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center text-purple-300",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-purple-100 font-medium",children:"Magnetic Link"}),e.jsx("div",{className:"text-purple-300 text-xs",children:"Trade on xMagnetic"})]})]})]})]})]}):e.jsx("div",{className:"text-center text-purple-400 py-8",children:e.jsx("div",{className:"animate-pulse",children:"Loading pool data..."})})]})},Ne=({token:q})=>{const ee=s[q.id],L=c[q.id],re=pe(q);return ee?e.jsxs("tr",{className:"border-t border-purple-500/20 hover:bg-purple-900/20",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ft,{token:q,size:"md"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-purple-200",children:[q.token_name,"/XRP"]}),e.jsx("div",{className:"text-purple-400 text-xs",children:q.currency_code})]}),e.jsx("button",{onClick:B=>J(q.id,B),className:"text-lg hover:scale-110 transition-transform",children:A.includes(q.id)?"⭐":"☆"})]})]})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsxs("div",{className:"text-purple-200 font-bold",children:[re.toFixed(8)," XRP"]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(re*W).toFixed(6)]})]}),e.jsx("td",{className:"px-4 py-3",children:q.amm_pool_created&&e.jsxs("span",{className:`text-sm font-bold px-2 py-1 rounded ${parseFloat(le(q))>=0?"text-green-300 bg-green-500/10":"text-red-300 bg-red-500/10"}`,children:[parseFloat(le(q))>=0?"+":"",le(q),"%"]})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-purple-200 font-bold",children:ee?`${ee.xrpAmount.toFixed(2)} XRP`:"Loading..."}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(ee?ee.xrpAmount*W:0).toFixed(2)]})]}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-purple-200 font-bold",children:ee&&ee.volume24h>0?`${ee.volume24h.toFixed(2)} XRP`:"0 XRP"}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(((ee==null?void 0:ee.volume24h)||0)*W).toFixed(2)]})]}),e.jsx("td",{className:"px-4 py-3",children:ee&&ee.apr>0?e.jsxs("span",{className:"text-green-400 font-bold",children:[ee.apr.toFixed(2),"%"]}):e.jsx("span",{className:"text-purple-500",children:"0%"})}),e.jsx("td",{className:"px-4 py-3 text-purple-300",children:ee&&ee.fees24h>0?`${ee.fees24h.toFixed(4)} XRP`:"0 XRP"}),e.jsx("td",{className:"px-4 py-3 text-purple-300",children:ee&&ee.lpTokens>0?e.jsxs("span",{className:"font-medium",children:[(ee.lpTokens/1e3).toFixed(0),"K"]}):e.jsx("span",{className:"text-purple-500",children:"-"})}),e.jsx("td",{className:"px-4 py-3 text-purple-200 font-medium",children:ee&&ee.contributors>0?ee.contributors:"0"}),e.jsx("td",{className:"px-4 py-3",children:L?e.jsxs("div",{children:[e.jsxs("div",{className:"text-green-200 font-bold",children:[(ee.xrpAmount*L.share/100).toFixed(4)," XRP"]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(ee&&ee.xrpAmount?ee.xrpAmount*L.share/100*W:0).toFixed(2)]}),e.jsxs("div",{className:"text-green-300 text-xs",children:[L.share.toFixed(2),"% share"]})]}):e.jsx("span",{className:"text-purple-500",children:"-"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"relative swap-dropdown",children:[e.jsxs("button",{onClick:B=>{B.stopPropagation(),E(I===q.id?null:q.id)},className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold text-xs px-3 py-2 rounded shadow-md shadow-blue-500/50 hover:shadow-blue-500/70 flex items-center gap-1",children:["💱 Swap",e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),I===q.id&&e.jsxs("div",{className:"absolute top-full left-0 mt-2 w-64 glass bg-gradient-to-br from-purple-900/95 to-purple-800/95 border border-purple-500/30 rounded-lg shadow-xl z-[9999] overflow-hidden",children:[e.jsxs("button",{onClick:()=>{E(null),localStorage.setItem("selectedTradeToken",JSON.stringify(q)),window.dispatchEvent(new CustomEvent("navigateToTrade",{detail:q}))},className:"w-full px-4 py-3 text-left hover:bg-purple-600/30 transition-colors flex items-center gap-3 border-b border-purple-500/30",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center text-purple-300",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-purple-100 font-medium",children:"Trade Page"}),e.jsx("div",{className:"text-purple-300 text-xs",children:"Swap on MEMEKINGS"})]})]}),e.jsxs("a",{href:`https://xmagnetic.org/amm/${q.currency_code}+${q.issuer_address}_XRP+XRP?network=mainnet`,target:"_blank",rel:"noopener noreferrer",className:"w-full px-4 py-3 text-left hover:bg-purple-600/30 transition-colors flex items-center gap-3",onClick:()=>E(null),children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center text-purple-300",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-purple-100 font-medium",children:"Magnetic Link"}),e.jsx("div",{className:"text-purple-300 text-xs",children:"Trade on xMagnetic"})]})]})]})]})})]}):null};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-purple-200",children:"AMM Pools"}),e.jsx("p",{className:"text-purple-400 mt-1",children:"Liquidity pools for all platform tokens"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>_e(!0),className:"bg-gradient-to-r from-green-600 to-green-500 hover:from-green-500 hover:to-green-400 text-white px-6 py-2 rounded-lg font-medium transition-all shadow-lg",children:"➕ Create AMM LP Pool"}),e.jsx("button",{onClick:me,disabled:n,className:"btn text-purple-300 px-6 py-2 rounded-lg font-medium disabled:opacity-50",children:n?"🔄 Refreshing...":"🔄 Refresh Pools"})]})]}),e.jsx(Z0,{isOpen:G,onClose:()=>_e(!1),wallet:i}),!i&&e.jsx("div",{className:"glass rounded-lg p-6 bg-yellow-500/10 border border-yellow-500/30",children:e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("div",{className:"text-2xl",children:"💡"}),e.jsx("div",{className:"text-yellow-200 font-medium",children:"Connect Wallet to See Your LP Positions"}),e.jsx("p",{className:"text-yellow-300 text-sm",children:"Connect your wallet from the Setup page to view your liquidity provider positions"})]})}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>P("all"),className:`px-6 py-2 rounded-lg font-medium transition-all ${b==="all"?"bg-purple-600 text-white":"glass text-purple-300"}`,children:"All AMM Pools"}),e.jsx("button",{onClick:()=>P("mine"),className:`px-6 py-2 rounded-lg font-medium transition-all ${b==="mine"?"bg-purple-600 text-white":"glass text-purple-300"}`,children:"My AMM Pools"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>h("list"),className:`px-4 py-2 rounded-lg transition-all ${u==="list"?"bg-purple-600 text-white":"glass text-purple-300"}`,children:"☰ List"}),e.jsx("button",{onClick:()=>h("grid"),className:`px-4 py-2 rounded-lg transition-all ${u==="grid"?"bg-purple-600 text-white":"glass text-purple-300"}`,children:"▦ Grid"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-6",children:[e.jsx("input",{type:"text",placeholder:"🔍 Search pools...",value:g,onChange:q=>y(q.target.value),className:"input text-purple-200 md:col-span-2"}),e.jsxs("select",{value:f,onChange:q=>w(q.target.value),className:"input text-purple-200",children:[e.jsx("option",{value:"liquidity",children:"Sort by Liquidity"}),e.jsx("option",{value:"volume",children:"Sort by Volume"}),e.jsx("option",{value:"change24h",children:"Sort by 24h %"}),e.jsx("option",{value:"price",children:"Sort by Price"}),e.jsx("option",{value:"apr",children:"Sort by APR"}),e.jsx("option",{value:"name",children:"Sort by Name"})]})]}),u==="grid"?e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:r.filter(q=>{if(!q.amm_pool_created)return!1;const ee=q.token_name.toLowerCase().includes(g.toLowerCase())||q.currency_code.toLowerCase().includes(g.toLowerCase()),L=c[q.id]&&c[q.id].balance>0;return ee&&(b==="all"||b==="mine"&&L)}).sort((q,ee)=>{var L,re,B,Y,oe,ie;return f==="liquidity"?(((L=s[ee.id])==null?void 0:L.xrpAmount)||0)-(((re=s[q.id])==null?void 0:re.xrpAmount)||0):f==="volume"?(((B=s[ee.id])==null?void 0:B.volume24h)||0)-(((Y=s[q.id])==null?void 0:Y.volume24h)||0):f==="change24h"?parseFloat(le(ee))-parseFloat(le(q)):f==="price"?pe(ee)-pe(q):f==="apr"?(((oe=s[ee.id])==null?void 0:oe.apr)||0)-(((ie=s[q.id])==null?void 0:ie.apr)||0):q.token_name.localeCompare(ee.token_name)}).map(q=>e.jsx($e,{token:q},q.id))}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-purple-900/30",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-100",onClick:()=>w("name"),children:"Pool"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-100",onClick:()=>w("price"),children:"Live Price"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-100",onClick:()=>w("change24h"),children:"24h %"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-100",onClick:()=>w("liquidity"),children:"Liquidity"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-100",onClick:()=>w("volume"),children:"24h Volume"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium cursor-pointer hover:text-purple-100",onClick:()=>w("apr"),children:"APR (1 year)"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"24h Fees"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"LP Tokens"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Contributors"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Your Share"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:r.filter(q=>{if(!q.amm_pool_created)return!1;const ee=q.token_name.toLowerCase().includes(g.toLowerCase())||q.currency_code.toLowerCase().includes(g.toLowerCase()),L=c[q.id]&&c[q.id].balance>0;return ee&&(b==="all"||b==="mine"&&L)}).sort((q,ee)=>{var L,re,B,Y,oe,ie;return f==="liquidity"?(((L=s[ee.id])==null?void 0:L.xrpAmount)||0)-(((re=s[q.id])==null?void 0:re.xrpAmount)||0):f==="volume"?(((B=s[ee.id])==null?void 0:B.volume24h)||0)-(((Y=s[q.id])==null?void 0:Y.volume24h)||0):f==="change24h"?parseFloat(le(ee))-parseFloat(le(q)):f==="price"?pe(ee)-pe(q):f==="apr"?(((oe=s[ee.id])==null?void 0:oe.apr)||0)-(((ie=s[q.id])==null?void 0:ie.apr)||0):q.token_name.localeCompare(ee.token_name)}).map(q=>e.jsx(Ne,{token:q},q.id))})]})})]}),r.length===0&&e.jsxs("div",{className:"glass rounded-lg p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🏊"}),e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-2",children:"No AMM Pools Yet"}),e.jsx("p",{className:"text-purple-400",children:"AMM pools will appear here once tokens are created with liquidity"})]})]})}function th({isOpen:r,currentSlippage:t,suggestedSlippage:s,tradeType:a,amount:n,tokenName:l,onRetry:i,onCancel:o,onClose:c,isRetrying:d=!1,retryComplete:u=!1,retrySuccess:h=!1,retryError:g=null}){const[y,f]=m.useState(3);return m.useEffect(()=>{if(u&&h){const w=setTimeout(()=>{c()},2e3);return()=>clearTimeout(w)}},[u,h,c]),m.useEffect(()=>{if(d){f(3);const w=setInterval(()=>{f(b=>b<=1?(clearInterval(w),0):b-1)},1e3);return()=>clearInterval(w)}},[d]),r?e.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center z-[100] p-4 animate-fadeIn",children:e.jsxs("div",{className:"glass rounded-lg p-8 max-w-md w-full shadow-2xl border border-purple-500/30 animate-slideUp relative",children:[e.jsx("button",{onClick:c,className:"absolute top-4 right-4 w-10 h-10 rounded-lg glass hover:bg-red-500/20 text-purple-300 hover:text-red-300 flex items-center justify-center transition-all z-10 text-2xl font-bold","aria-label":"Close",children:"×"}),u?e.jsx("div",{className:"text-center space-y-6",children:h?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-green-500/20 flex items-center justify-center mx-auto",children:e.jsx("span",{className:"text-5xl",children:"✓"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-green-400 mb-2",children:"Trade Successful!"}),e.jsxs("p",{className:"text-purple-300",children:["Your ",a.toLowerCase()," order completed with ",s,"% slippage."]})]}),e.jsx("div",{className:"text-purple-400 text-sm",children:"Closing automatically..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-red-500/20 flex items-center justify-center mx-auto",children:e.jsx("span",{className:"text-5xl",children:"✗"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-red-400 mb-2",children:"Retry Failed"}),e.jsx("p",{className:"text-purple-300 mb-4",children:g||"Trade could not be completed. Please try again manually."}),e.jsx("div",{className:"glass rounded-lg p-3",children:e.jsxs("p",{className:"text-purple-400 text-sm",children:[e.jsx("strong",{children:"Suggestions:"}),e.jsx("br",{}),"• Try a smaller amount",e.jsx("br",{}),"• Increase slippage further",e.jsx("br",{}),"• Wait for pool liquidity to improve"]})})]}),e.jsx("button",{onClick:c,className:"w-full btn-primary text-white py-3 rounded-lg font-medium",children:"Close"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-yellow-500/20 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl",children:"⚠️"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200",children:"Slippage Too Low"}),e.jsx("p",{className:"text-purple-400 text-sm",children:"Trade couldn't complete"})]})]}),e.jsxs("div",{className:"glass rounded-lg p-4 space-y-3 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-purple-400 text-sm",children:"Trade Type"}),e.jsx("span",{className:"text-purple-200 font-medium",children:a})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-purple-400 text-sm",children:"Amount"}),e.jsxs("span",{className:"text-purple-200 font-medium",children:[n," ",l]})]}),e.jsx("div",{className:"h-px bg-purple-500/20 my-2"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-purple-400 text-sm",children:"Current Slippage"}),e.jsxs("span",{className:"text-red-400 font-bold",children:[t,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-purple-400 text-sm",children:"Suggested Slippage"}),e.jsxs("span",{className:"text-green-400 font-bold",children:[s,"%"]})]})]}),e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4 mb-6",children:e.jsxs("p",{className:"text-blue-300 text-sm",children:[e.jsx("strong",{children:"Why did this happen?"}),e.jsx("br",{}),"The pool's price moved while your trade was processing. Increasing slippage tolerance allows for more price movement."]})}),d?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-purple-500/30 border-t-purple-500 rounded-full animate-spin"}),e.jsxs("span",{className:"text-purple-200 font-medium",children:["Retrying with ",s,"% slippage..."]})]}),y>0&&e.jsxs("div",{className:"text-center text-purple-400 text-sm",children:["Executing in ",y,"s"]})]}):e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:o,className:"flex-1 glass hover:bg-purple-500/10 text-purple-300 py-3 rounded-lg font-medium transition-all",children:"Cancel"}),e.jsxs("button",{onClick:i,className:"flex-1 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white py-3 rounded-lg font-medium transition-all shadow-lg",children:["Retry with ",s,"%"]})]})]})]})}):null}function sh({isOpen:r,onClose:t,token:s,transactions:a,loading:n}){if(m.useEffect(()=>{const d=u=>{u.key==="Escape"&&t()};if(r)return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)},[r,t]),!r)return null;const l=d=>{const u=new Date(d),g=new Date-u,y=Math.floor(g/6e4),f=Math.floor(y/60);return y<1?"Just now":y<60?`${y}m ago`:f<24?`${f}h ago`:u.toLocaleString()},i=d=>{const u=parseFloat(d);return u>=1e6?`${(u/1e6).toFixed(2)}M`:u>=1e3?`${(u/1e3).toFixed(2)}K`:u.toFixed(2)},o=d=>{var u;return d.TransactionType==="AMMDeposit"?"Deposit":d.TransactionType==="AMMWithdraw"?"Withdraw":d.TransactionType==="Payment"?(u=d.meta)!=null&&u.delivered_amount&&typeof d.meta.delivered_amount=="string"?"Buy":"Sell":d.TransactionType},c=d=>{switch(d){case"Buy":return"bg-green-500/20 text-green-300 border-green-500/30";case"Sell":return"bg-red-500/20 text-red-300 border-red-500/30";case"Deposit":return"bg-blue-500/20 text-blue-300 border-blue-500/30";case"Withdraw":return"bg-yellow-500/20 text-yellow-300 border-yellow-500/30";default:return"bg-purple-500/20 text-purple-300 border-purple-500/30"}};return e.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center z-[100] p-4 animate-fadeIn",onClick:t,children:e.jsxs("div",{className:"glass rounded-lg p-6 max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col animate-slideUp",onClick:d=>d.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200",children:"AMM Pool History"}),e.jsxs("p",{className:"text-purple-400 text-sm mt-1",children:[s==null?void 0:s.token_name," - Last 24 Hours"]})]}),e.jsx("button",{onClick:t,className:"w-10 h-10 rounded-lg glass hover:bg-purple-500/20 flex items-center justify-center text-purple-300 text-xl transition-all",children:"×"})]}),n?e.jsx("div",{className:"flex-1 flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-purple-500/30 border-t-purple-500 rounded-full animate-spin mx-auto"}),e.jsx("p",{className:"text-purple-300",children:"Loading transaction history..."})]})}):a.length===0?e.jsx("div",{className:"flex-1 flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"text-6xl",children:"📊"}),e.jsx("h4",{className:"text-xl font-bold text-purple-200",children:"No Transactions Found"}),e.jsx("p",{className:"text-purple-400",children:"No AMM pool activity in the last 24 hours"})]})}):e.jsxs("div",{className:"flex-1 overflow-y-auto space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4 px-4 text-sm font-semibold text-purple-400",children:[e.jsx("div",{children:"Type"}),e.jsx("div",{children:"Amount"}),e.jsx("div",{children:"Account"}),e.jsx("div",{className:"text-right",children:"Time"})]}),a.map((d,u)=>{const h=o(d),g=c(h);return e.jsx("div",{className:"glass rounded-lg p-4 hover:bg-purple-500/10 transition-all",children:e.jsxs("div",{className:"grid grid-cols-4 gap-4 items-center",children:[e.jsx("div",{children:e.jsx("div",{className:`inline-flex px-3 py-1 rounded-lg text-xs font-medium border ${g}`,children:h})}),e.jsx("div",{children:e.jsx("div",{className:"text-purple-200 font-medium text-sm",children:d.Amount?typeof d.Amount=="string"?`${i(parseInt(d.Amount)/1e6)} XRP`:`${i(d.Amount.value)} ${d.Amount.currency}`:"N/A"})}),e.jsx("div",{children:e.jsx("div",{className:"text-purple-300 text-xs font-mono",children:d.Account?`${d.Account.substring(0,8)}...${d.Account.substring(d.Account.length-6)}`:"Unknown"})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-purple-400 text-xs",children:l(d.date?(d.date+946684800)*1e3:Date.now())}),d.hash&&e.jsx("a",{href:`https://livenet.xrpl.org/transactions/${d.hash}`,target:"_blank",rel:"noopener noreferrer",className:"text-purple-500 hover:text-purple-400 text-xs mt-1 inline-block",children:"View →"})]})]})},d.hash||u)})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-purple-500/20 flex justify-between items-center",children:[e.jsxs("div",{className:"text-purple-400 text-sm",children:[a.length," transaction",a.length!==1?"s":""," found"]}),e.jsx("button",{onClick:t,className:"btn-primary text-white px-6 py-2 rounded-lg font-medium",children:"Close"})]})]})})}function Ls({type:r,value:t,network:s}){const a=`https://${s==="mainnet"?"":"test."}xrpscan.com`,n=r==="address"?"/account/":"/tx/";return e.jsxs("a",{href:`${a}${n}${t}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-600 hover:underline",children:[t.substring(0,12),"...",t.substring(t.length-8)]})}function Po({tokenId:r,connectedWallet:t}){const[s,a]=m.useState([]),[n,l]=m.useState(!0),[i,o]=m.useState(0),[c,d]=m.useState(3);m.useEffect(()=>{u(),h();const f=S.channel("trade_history_changes").on("postgres_changes",{event:"*",schema:"public",table:"trade_history",filter:`token_id=eq.${r}`},()=>{h()}).subscribe();return()=>{f.unsubscribe()}},[r,t]);const u=async()=>{var f;try{const b=await(await fetch("https://api.coingecko.com/api/v3/simple/price?ids=ripple&vs_currencies=usd")).json();o(((f=b.ripple)==null?void 0:f.usd)||0)}catch{}},h=async()=>{try{if(l(!0),t!=null&&t.address){const f=new Date(Date.now()-864e5).toISOString(),{data:w,error:b}=await S.from("trade_history").select("*").eq("token_id",r).eq("trader_address",t.address).gte("created_at",f).order("created_at",{ascending:!1}).limit(100);if(b)throw b;a(w||[])}else a([])}catch{}finally{l(!1)}},g=f=>{const w=new Date(f),P=Math.floor((new Date-w)/6e4);if(P<1)return"Just now";if(P<60)return`${P}m ago`;const A=Math.floor(P/60);return A<24?`${A}h ago`:w.toLocaleString()},y=f=>{if(f.length===0)return e.jsxs("div",{className:"text-center py-8 text-purple-400",children:[e.jsx("div",{className:"text-4xl mb-2",children:"📊"}),e.jsx("div",{children:"No recent trades"})]});const w=f.slice(0,c);return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"max-h-[300px] overflow-y-auto space-y-2 pr-2",children:w.map(b=>e.jsxs("div",{className:"glass rounded-lg p-3 hover:bg-purple-900/20 transition-all border border-purple-500/10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:`px-3 py-1 rounded-lg text-xs font-bold flex items-center gap-1 ${b.trade_type==="buy"?"bg-green-500/20 text-green-300 border border-green-500/30":"bg-red-500/20 text-red-300 border border-red-500/30"}`,children:b.trade_type==="buy"?"🟢 BUY":"🔴 SELL"}),e.jsx("span",{className:"text-xs text-purple-400 font-medium",children:g(b.created_at)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"Token Amount"}),e.jsx("div",{className:"text-purple-200 font-bold",children:parseFloat(b.token_amount).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:4})})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"XRP Amount"}),e.jsxs("div",{className:"text-purple-200 font-bold",children:[parseFloat(b.xrp_amount).toFixed(4)," XRP"]}),i>0&&e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(parseFloat(b.xrp_amount)*i).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"Price"}),e.jsxs("div",{className:"text-purple-300 text-xs font-mono",children:[parseFloat(b.price).toFixed(8)," XRP"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"Transaction"}),b.tx_hash?e.jsx(Ls,{type:"tx",value:b.tx_hash,network:"mainnet",className:"text-xs"}):e.jsx("span",{className:"text-purple-500 text-xs",children:"Pending"})]})]})]},b.id))}),f.length>c&&e.jsxs("button",{onClick:()=>d(b=>b+5),className:"w-full py-2 rounded-lg glass hover:bg-purple-500/20 text-purple-300 text-sm font-medium transition-all",children:["Load More (",f.length-c," remaining)"]}),c>3&&e.jsx("button",{onClick:()=>d(3),className:"w-full py-2 rounded-lg glass hover:bg-purple-500/20 text-purple-400 text-xs transition-all",children:"Show Less"})]})};return n?e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-bold text-purple-200 mb-4",children:"Trade History"}),e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-purple-500 border-t-transparent"})})]}):e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-purple-200",children:"My Trades"}),s.length>0&&e.jsxs("span",{className:"text-sm text-purple-400",children:[s.length," in 24h"]})]}),t?y(s):e.jsxs("div",{className:"text-center py-8 text-purple-400",children:[e.jsx("div",{className:"text-4xl mb-2",children:"🔒"}),e.jsx("div",{children:"Connect wallet to view your trades"})]})]})}function rh({isOpen:r,onClose:t,onSelectAddress:s,walletAddress:a}){const[n,l]=m.useState([]),[i,o]=m.useState(!0),[c,d]=m.useState(null),[u,h]=m.useState(!1),[g,y]=m.useState(""),[f,w]=m.useState({name:"",address:"",notes:"",is_favorite:!1});m.useEffect(()=>{r&&a&&b()},[r,a]);const b=async()=>{try{o(!0);const{data:I,error:E}=await S.from("address_book").select("*").eq("wallet_address",a).order("is_favorite",{ascending:!1}).order("name",{ascending:!0});if(E)throw E;l(I||[])}catch{k.error("Failed to load address book")}finally{o(!1)}},P=async()=>{try{if(!f.name||!f.address){k.error("Name and address are required");return}if(c){const{error:I}=await S.from("address_book").update({name:f.name,address:f.address,notes:f.notes,is_favorite:f.is_favorite}).eq("id",c.id);if(I)throw I;k.success("Contact updated successfully")}else{const{error:I}=await S.from("address_book").insert({wallet_address:a,name:f.name,address:f.address,notes:f.notes,is_favorite:f.is_favorite});if(I)throw I;k.success("Contact added successfully")}h(!1),d(null),w({name:"",address:"",notes:"",is_favorite:!1}),b()}catch{k.error("Failed to save contact")}},A=async I=>{if(confirm("Are you sure you want to delete this contact?"))try{const{error:E}=await S.from("address_book").delete().eq("id",I);if(E)throw E;k.success("Contact deleted"),b()}catch{k.error("Failed to delete contact")}},_=I=>{d(I),w({name:I.name,address:I.address,notes:I.notes||"",is_favorite:I.is_favorite}),h(!0)},W=async I=>{try{const{error:E}=await S.from("address_book").update({is_favorite:!I.is_favorite}).eq("id",I.id);if(E)throw E;b()}catch{k.error("Failed to update favorite")}},D=n.filter(I=>I.name.toLowerCase().includes(g.toLowerCase())||I.address.toLowerCase().includes(g.toLowerCase()));return r?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",children:e.jsxs("div",{className:"w-full max-w-2xl max-h-[90vh] rounded-xl overflow-hidden border border-purple-500/40",style:{background:"linear-gradient(135deg, rgba(88, 28, 135, 0.98), rgba(59, 7, 100, 0.98))",backdropFilter:"blur(20px)"},children:[e.jsxs("div",{className:"p-6 border-b border-purple-500/30 bg-purple-900/40",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"📇 Address Book"}),e.jsx("button",{onClick:t,className:"text-purple-300 hover:text-white transition-colors",children:"✕"})]}),e.jsx("input",{type:"text",value:g,onChange:I=>y(I.target.value),placeholder:"Search contacts...",className:"w-full bg-purple-950/60 border border-purple-500/40 rounded-lg px-4 py-2 text-white placeholder-purple-400/60 focus:outline-none focus:border-purple-400/60 focus:ring-2 focus:ring-purple-500/30"})]}),e.jsxs("div",{className:"p-6 overflow-y-auto",style:{maxHeight:"calc(90vh - 200px)"},children:[u?e.jsxs("div",{className:"space-y-4 mb-6 p-4 bg-purple-900/30 rounded-lg border border-purple-500/30",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:c?"Edit Contact":"Add New Contact"}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-purple-200 mb-1",children:["Name ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:f.name,onChange:I=>w({...f,name:I.target.value}),placeholder:"John Doe",className:"w-full bg-purple-950/60 border border-purple-500/40 rounded-lg px-3 py-2 text-white placeholder-purple-400/50 focus:outline-none focus:border-purple-400/60 focus:ring-2 focus:ring-purple-500/30"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-purple-200 mb-1",children:["XRPL Address ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:f.address,onChange:I=>w({...f,address:I.target.value}),placeholder:"rXXXXXXXXXXXXXXXXXXXXXXXXXXXX",className:"w-full bg-purple-950/60 border border-purple-500/40 rounded-lg px-3 py-2 text-white placeholder-purple-400/50 focus:outline-none focus:border-purple-400/60 focus:ring-2 focus:ring-purple-500/30"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-purple-200 mb-1",children:"Notes"}),e.jsx("textarea",{value:f.notes,onChange:I=>w({...f,notes:I.target.value}),placeholder:"Optional notes about this contact",className:"w-full bg-purple-950/60 border border-purple-500/40 rounded-lg px-3 py-2 text-white placeholder-purple-400/50 focus:outline-none focus:border-purple-400/60 focus:ring-2 focus:ring-purple-500/30 resize-none",rows:"2"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"is_favorite",checked:f.is_favorite,onChange:I=>w({...f,is_favorite:I.target.checked}),className:"w-4 h-4 text-purple-600 bg-purple-950/60 border-purple-500/40 rounded focus:ring-purple-500/30"}),e.jsx("label",{htmlFor:"is_favorite",className:"text-sm text-purple-200",children:"Mark as favorite"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:P,className:"flex-1 px-4 py-2 bg-gradient-to-r from-purple-600 to-blue-600 hover:shadow-lg hover:shadow-purple-500/50 text-white rounded-lg font-medium transition-all duration-200",children:c?"Update Contact":"Add Contact"}),e.jsx("button",{onClick:()=>{h(!1),d(null),w({name:"",address:"",notes:"",is_favorite:!1})},className:"px-4 py-2 bg-purple-800/40 hover:bg-purple-800/60 text-purple-200 rounded-lg font-medium transition-all duration-200 border border-purple-500/30",children:"Cancel"})]})]}):e.jsxs("button",{onClick:()=>h(!0),className:"w-full mb-4 px-4 py-3 bg-gradient-to-r from-purple-600 to-blue-600 hover:shadow-lg hover:shadow-purple-500/50 text-white rounded-lg font-medium transition-all duration-200 flex items-center justify-center gap-2",children:[e.jsx("span",{children:"➕"}),"Add New Contact"]}),i?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-2 border-purple-400 border-t-transparent rounded-full animate-spin"})}):D.length===0?e.jsx("div",{className:"text-center py-12 text-purple-300/60",children:g?"No contacts found":"No contacts yet. Add your first contact!"}):e.jsx("div",{className:"space-y-2",children:D.map(I=>e.jsx("div",{className:"p-4 bg-purple-900/30 rounded-lg border border-purple-500/20 hover:border-purple-500/40 transition-all duration-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>W(I),className:"text-xl hover:scale-110 transition-transform",children:I.is_favorite?"⭐":"☆"}),e.jsx("h3",{className:"text-lg font-bold text-white",children:I.name})]}),e.jsx("p",{className:"text-sm text-purple-300/80 mt-1 font-mono break-all",children:I.address}),I.notes&&e.jsx("p",{className:"text-sm text-purple-400/60 mt-2",children:I.notes})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[s&&e.jsx("button",{onClick:()=>s(I),className:"px-3 py-1.5 bg-green-600/30 hover:bg-green-600/50 text-green-200 rounded-lg text-sm font-medium transition-all duration-200 border border-green-500/30",children:"Select"}),e.jsx("button",{onClick:()=>_(I),className:"px-3 py-1.5 bg-blue-600/30 hover:bg-blue-600/50 text-blue-200 rounded-lg text-sm font-medium transition-all duration-200 border border-blue-500/30",children:"Edit"}),e.jsx("button",{onClick:()=>A(I.id),className:"px-3 py-1.5 bg-red-600/30 hover:bg-red-600/50 text-red-200 rounded-lg text-sm font-medium transition-all duration-200 border border-red-500/30",children:"Delete"})]})]})},I.id))})]}),e.jsx("div",{className:"p-4 border-t border-purple-500/30 bg-purple-900/40",children:e.jsx("button",{onClick:t,className:"w-full px-4 py-2 bg-purple-800/40 hover:bg-purple-800/60 text-purple-200 rounded-lg font-medium transition-all duration-200 border border-purple-500/30",children:"Close"})})]})}):null}function ah({execution:r,onExecute:t,onCancel:s}){var w;const[a,n]=m.useState(r.defaultValues||{}),[l,i]=m.useState(!1),[o,c]=m.useState(0),[d,u]=m.useState(!1),h=JSON.parse(localStorage.getItem("connectedWallet")||"{}").address,g=b=>{y("destinationAddress",b.address),u(!1)},y=(b,P)=>{n(A=>({...A,[b]:P}))},f=async()=>{i(!0),c(0);try{for(let b=0;b<r.steps.length;b++)c(b),await new Promise(P=>setTimeout(P,800));await t(a),c(r.steps.length)}catch{}finally{i(!1)}};return e.jsxs("div",{className:"mt-4 rounded-xl overflow-hidden border border-purple-500/40",style:{background:"linear-gradient(135deg, rgba(88, 28, 135, 0.95), rgba(59, 7, 100, 0.95))",backdropFilter:"blur(20px)"},children:[e.jsx("div",{className:"p-4 border-b border-purple-500/30 bg-purple-900/40",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-3xl",children:r.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:r.title}),e.jsx("p",{className:"text-purple-300/80 text-sm",children:r.description})]}),r.badge&&e.jsx("span",{className:"px-3 py-1 bg-purple-600/40 text-purple-200 text-xs font-medium rounded-full border border-purple-500/30",children:r.badge})]})}),r.fields&&r.fields.length>0&&e.jsx("div",{className:"p-4 space-y-3 bg-purple-900/20",children:r.fields.map(b=>{var P;return e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-purple-200 mb-1",children:[b.label,b.required&&e.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),b.type==="select"?e.jsxs("select",{value:a[b.name]||"",onChange:A=>y(b.name,A.target.value),className:"w-full bg-purple-950/60 border border-purple-500/40 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-purple-400/60 focus:ring-2 focus:ring-purple-500/30",disabled:l,children:[e.jsxs("option",{value:"",children:["Select ",b.label]}),(P=b.options)==null?void 0:P.map(A=>e.jsx("option",{value:A.value,children:A.label},A.value))]}):b.type==="textarea"?e.jsx("textarea",{value:a[b.name]||"",onChange:A=>y(b.name,A.target.value),placeholder:b.placeholder,className:"w-full bg-purple-950/60 border border-purple-500/40 rounded-lg px-3 py-2 text-white placeholder-purple-400/50 focus:outline-none focus:border-purple-400/60 focus:ring-2 focus:ring-purple-500/30 resize-none",rows:"3",disabled:l}):e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:b.type||"text",value:a[b.name]||"",onChange:A=>y(b.name,A.target.value),placeholder:b.placeholder,className:"w-full bg-purple-950/60 border border-purple-500/40 rounded-lg px-3 py-2 text-white placeholder-purple-400/50 focus:outline-none focus:border-purple-400/60 focus:ring-2 focus:ring-purple-500/30",disabled:l}),b.name==="destinationAddress"&&!l&&e.jsx("button",{type:"button",onClick:()=>u(!0),className:"absolute right-2 top-1/2 -translate-y-1/2 px-3 py-1 bg-purple-700/40 hover:bg-purple-700/60 text-purple-200 rounded text-xs font-medium transition-all duration-200 border border-purple-500/30",children:"📇 Address Book"})]}),b.hint&&e.jsx("p",{className:"text-xs text-purple-400/60 mt-1",children:b.hint})]},b.name)})}),r.steps&&r.steps.length>0&&e.jsxs("div",{className:"p-4 space-y-2 bg-purple-900/10 border-t border-purple-500/20",children:[e.jsx("div",{className:"text-xs font-medium text-purple-300 mb-2",children:"Execution Steps:"}),r.steps.map((b,P)=>e.jsxs("div",{className:`flex items-center gap-3 p-2 rounded-lg transition-all duration-300 ${l&&P===o?"bg-purple-600/30 border border-purple-500/40 animate-pulse":l&&P<o?"bg-green-600/20 border border-green-500/30":"bg-purple-900/20 border border-purple-500/10"}`,children:[e.jsx("div",{className:"flex-shrink-0",children:l&&P<o?e.jsx("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs",children:"✓"})}):l&&P===o?e.jsx("div",{className:"w-5 h-5 border-2 border-purple-400 border-t-transparent rounded-full animate-spin"}):e.jsx("div",{className:"w-5 h-5 bg-purple-700/30 rounded-full flex items-center justify-center text-purple-400 text-xs font-bold",children:P+1})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`text-sm ${l&&P===o?"text-white font-medium":l&&P<o?"text-green-300":"text-purple-300/80"}`,children:b.label}),b.description&&e.jsx("div",{className:"text-xs text-purple-400/60 mt-0.5",children:b.description})]})]},P))]}),e.jsxs("div",{className:"p-4 bg-purple-900/30 border-t border-purple-500/20 flex gap-2",children:[e.jsx("button",{onClick:f,disabled:l||!((w=r.fields)!=null&&w.every(b=>!b.required||a[b.name])),className:"flex-1 px-4 py-2.5 bg-gradient-to-r from-purple-600 to-blue-600 hover:shadow-lg hover:shadow-purple-500/50 text-white rounded-lg font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:shadow-none flex items-center justify-center gap-2",children:l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Executing..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Execute"}),e.jsx("span",{children:"➤"})]})}),s&&!l&&e.jsx("button",{onClick:s,className:"px-4 py-2.5 bg-purple-800/40 hover:bg-purple-800/60 text-purple-200 rounded-lg font-medium transition-all duration-200 border border-purple-500/30",children:"Cancel"})]}),e.jsx(rh,{isOpen:d,onClose:()=>u(!1),onSelectAddress:g,walletAddress:h})]})}function nh({result:r}){return e.jsxs("div",{className:"mt-4 rounded-xl overflow-hidden border border-purple-500/40 animate-fadeInUp",style:{background:"linear-gradient(135deg, rgba(88, 28, 135, 0.95), rgba(59, 7, 100, 0.95))",backdropFilter:"blur(20px)"},children:[e.jsx("div",{className:`p-4 border-b ${r.status==="success"?"bg-green-900/30 border-green-500/30":r.status==="error"?"bg-red-900/30 border-red-500/30":"bg-purple-900/30 border-purple-500/30"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-3xl",children:r.status==="success"?"✅":r.status==="error"?"❌":"ℹ️"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:r.title}),e.jsx("p",{className:`text-sm ${r.status==="success"?"text-green-300":r.status==="error"?"text-red-300":"text-purple-300"}`,children:r.message})]})]})}),r.data&&e.jsx("div",{className:"p-4 space-y-3 bg-purple-900/20",children:Object.entries(r.data).map(([t,s])=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-purple-950/40 rounded-lg border border-purple-500/20",children:[e.jsxs("span",{className:"text-sm text-purple-300 capitalize",children:[t.replace(/_/g," "),":"]}),e.jsx("span",{className:"text-sm text-white font-medium",children:s})]},t))}),r.transactionHash&&e.jsxs("div",{className:"p-4 bg-purple-900/30 border-t border-purple-500/20",children:[e.jsx("div",{className:"text-xs text-purple-300 mb-2",children:"Transaction Hash:"}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-purple-950/60 rounded-lg border border-purple-500/30",children:[e.jsx("code",{className:"flex-1 text-xs text-purple-200 break-all",children:r.transactionHash}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(r.transactionHash)},className:"px-2 py-1 bg-purple-700/40 hover:bg-purple-700/60 text-purple-200 rounded text-xs transition-colors",children:"Copy"}),e.jsx("button",{onClick:()=>{window.open(`https://xrpscan.com/tx/${r.transactionHash}`,"_blank")},className:"px-2 py-1 bg-purple-700/40 hover:bg-purple-700/60 text-purple-200 rounded text-xs transition-colors",children:"View"})]})]}),r.actions&&r.actions.length>0&&e.jsx("div",{className:"p-4 bg-purple-900/30 border-t border-purple-500/20 flex gap-2",children:r.actions.map((t,s)=>e.jsxs("button",{onClick:t.onClick,className:`px-4 py-2 rounded-lg font-medium text-sm transition-all duration-200 ${t.style==="primary"?"bg-gradient-to-r from-purple-600 to-blue-600 hover:shadow-lg hover:shadow-purple-500/50 text-white":"bg-purple-800/40 hover:bg-purple-800/60 text-purple-200 border border-purple-500/30"}`,children:[t.icon&&e.jsx("span",{className:"mr-1",children:t.icon}),t.label]},s))})]})}const ia="wss://s.altnet.rippletest.net:51233";async function lh(r){const{destinationAddress:t,amount:s,memo:a}=r,n=JSON.parse(localStorage.getItem("connectedWallet"));if(!n||!n.seed)throw new Error("No wallet connected or seed not available");const l=new Re.Client(ia);await l.connect();try{const i=Re.Wallet.fromSeed(n.seed),o={TransactionType:"Payment",Account:i.address,Destination:t,Amount:Re.xrpToDrops(s)};a&&(o.Memos=[{Memo:{MemoData:Buffer.from(a,"utf8").toString("hex").toUpperCase()}}]);const c=await l.autofill(o),d=i.sign(c),u=await l.submitAndWait(d.tx_blob);return await S.from("activity_logs").insert({wallet_address:i.address,action_type:"send_xrp",details:{destination:t,amount:s,memo:a,txHash:u.result.hash}}),{status:"success",title:"XRP Sent Successfully",message:`Successfully sent ${s} XRP to ${t.slice(0,12)}...`,transactionHash:u.result.hash,data:{amount:`${s} XRP`,destination:`${t.slice(0,12)}...`,fee:`${parseFloat(u.result.Fee)/1e6} XRP`,ledger:u.result.ledger_index,timestamp:new Date().toLocaleString()},actions:[{label:"Send More XRP",icon:"📤",style:"secondary",onClick:()=>window.dispatchEvent(new CustomEvent("sendAIMessage",{detail:"send XRP"}))},{label:"Check Balance",icon:"💰",style:"secondary",onClick:()=>window.dispatchEvent(new CustomEvent("sendAIMessage",{detail:"check my balance"}))}]}}catch(i){throw new Error(i.message||"Failed to send XRP")}finally{await l.disconnect()}}async function ih(r){let{destinationAddress:t,currencyCode:s,issuerAddress:a,amount:n,memo:l,tokenId:i}=r;if(i)try{const d=JSON.parse(i);s=d.code,a=d.issuer}catch{}const o=JSON.parse(localStorage.getItem("connectedWallet"));if(!o||!o.seed)throw new Error("No wallet connected or seed not available");const c=new Re.Client(ia);await c.connect();try{const d=Re.Wallet.fromSeed(o.seed),u={TransactionType:"Payment",Account:d.address,Destination:t,Amount:{currency:s,value:n,issuer:a}};l&&(u.Memos=[{Memo:{MemoData:Buffer.from(l,"utf8").toString("hex").toUpperCase()}}]);const h=await c.autofill(u),g=d.sign(h),y=await c.submitAndWait(g.tx_blob);return await S.from("activity_logs").insert({wallet_address:d.address,action_type:"send_token",details:{destination:t,currency:s,amount:n,issuer:a,txHash:y.result.hash}}),{status:"success",title:"Token Sent Successfully",message:`Successfully sent ${n} ${s} to ${t.slice(0,12)}...`,transactionHash:y.result.hash,data:{token:s,amount:`${n} ${s}`,destination:`${t.slice(0,12)}...`,fee:`${parseFloat(y.result.Fee)/1e6} XRP`,ledger:y.result.ledger_index},actions:[{label:"Send More",icon:"📤",style:"secondary",onClick:()=>window.dispatchEvent(new CustomEvent("sendAIMessage",{detail:"send tokens"}))}]}}catch(d){throw new Error(d.message||"Failed to send token")}finally{await c.disconnect()}}async function oh(r){const{currencyCode:t,issuerAddress:s,limit:a}=r,n=JSON.parse(localStorage.getItem("connectedWallet"));if(!n||!n.seed)throw new Error("No wallet connected or seed not available");const l=new Re.Client(ia);await l.connect();try{const i=Re.Wallet.fromSeed(n.seed),o={TransactionType:"TrustSet",Account:i.address,LimitAmount:{currency:t,issuer:s,value:a||"1000000000"}},c=await l.autofill(o),d=i.sign(c),u=await l.submitAndWait(d.tx_blob);return await S.from("activity_logs").insert({wallet_address:i.address,action_type:"setup_trustline",details:{currency:t,issuer:s,limit:a,txHash:u.result.hash}}),{status:"success",title:"Trustline Created Successfully",message:`Trustline for ${t} has been set up`,transactionHash:u.result.hash,data:{currency:t,issuer:s.slice(0,12)+"...",limit:a||"Unlimited"}}}catch(i){throw new Error(i.message||"Failed to setup trustline")}finally{await l.disconnect()}}async function ch(r){const{tokenId:t,amountXRP:s,slippage:a}=r,n=JSON.parse(localStorage.getItem("connectedWallet"));if(!n||!n.seed)throw new Error("No wallet connected");const{data:l,error:i}=await S.from("meme_tokens").select("*").eq("id",t).single();if(i||!l)throw new Error("Token not found");const o=new Re.Client(ia);await o.connect();try{const c=Re.Wallet.fromSeed(n.seed);if(!(await o.request({command:"account_lines",account:c.address,ledger_index:"validated"})).result.lines.some(w=>w.currency===l.currency_code&&w.account===l.issuer_address)){const w={TransactionType:"TrustSet",Account:c.address,LimitAmount:{currency:l.currency_code,issuer:l.issuer_address,value:"999999999"}},b=await o.autofill(w),P=c.sign(b);await o.submitAndWait(P.tx_blob)}const h={TransactionType:"OfferCreate",Account:c.address,TakerPays:{currency:l.currency_code,value:"1000",issuer:l.issuer_address},TakerGets:Re.xrpToDrops(s)},g=await o.autofill(h),y=c.sign(g),f=await o.submitAndWait(y.tx_blob);return await S.from("activity_logs").insert({wallet_address:c.address,action_type:"buy_token",details:{token:l.token_name,amountXRP:s,txHash:f.result.hash}}),{status:"success",title:"Buy Order Placed",message:`Successfully placed buy order for ${l.token_name}`,transactionHash:f.result.hash,data:{token:l.token_name,spent:`${s} XRP`,slippage:`${a}%`},actions:[{label:"View Token",icon:"👁️",style:"secondary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"trade"}))}]}}catch(c){throw new Error(c.message||"Failed to buy token")}finally{await o.disconnect()}}async function dh(r){const{tokenId:t,amountToken:s,minXRP:a}=r,n=JSON.parse(localStorage.getItem("connectedWallet"));if(!n||!n.seed)throw new Error("No wallet connected");const{data:l,error:i}=await S.from("meme_tokens").select("*").eq("id",t).single();if(i||!l)throw new Error("Token not found");const o=new Re.Client(ia);await o.connect();try{const c=Re.Wallet.fromSeed(n.seed);if(!(await o.request({command:"account_lines",account:c.address,ledger_index:"validated"})).result.lines.some(w=>w.currency===l.currency_code&&w.account===l.issuer_address)){const w={TransactionType:"TrustSet",Account:c.address,LimitAmount:{currency:l.currency_code,issuer:l.issuer_address,value:"999999999"}},b=await o.autofill(w),P=c.sign(b);await o.submitAndWait(P.tx_blob)}const h={TransactionType:"OfferCreate",Account:c.address,TakerPays:Re.xrpToDrops(a),TakerGets:{currency:l.currency_code,value:s,issuer:l.issuer_address}},g=await o.autofill(h),y=c.sign(g),f=await o.submitAndWait(y.tx_blob);return await S.from("activity_logs").insert({wallet_address:c.address,action_type:"sell_token",details:{token:l.token_name,amount:s,minXRP:a,txHash:f.result.hash}}),{status:"success",title:"Sell Order Placed",message:`Successfully placed sell order for ${s} ${l.token_name}`,transactionHash:f.result.hash,data:{token:l.token_name,amount:`${s} ${l.currency_code}`,minReceive:`${a} XRP`},actions:[{label:"View Orders",icon:"📊",style:"secondary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"trade"}))}]}}catch(c){throw new Error(c.message||"Failed to sell token")}finally{await o.disconnect()}}async function uh(r){const{name:t,strategy:s,tokenId:a,buyAmount:n,sellThreshold:l,buyThreshold:i}=r,o=JSON.parse(localStorage.getItem("connectedWallet"));if(!o)throw new Error("No wallet connected");try{const{data:c,error:d}=await S.from("trading_bots").insert({wallet_address:o.address,name:t,strategy:s,token_id:a,buy_amount:parseFloat(n),sell_threshold:parseFloat(l),buy_threshold:parseFloat(i),status:"active",last_check:new Date().toISOString()}).select().single();if(d)throw d;return{status:"success",title:"Trading Bot Created",message:`Bot "${t}" has been created and activated`,data:{name:t,strategy:s,status:"Active",buyAmount:`${n} XRP`},actions:[{label:"Manage Bots",icon:"⚙️",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"bottrader"}))}]}}catch(c){throw new Error(c.message||"Failed to create bot")}}function Ao({message:r,onAddResult:t}){const s=r.role==="user",[a,n]=m.useState(null),[l,i]=m.useState(null),o=(w,b)=>{navigator.clipboard.writeText(w),n(b),setTimeout(()=>n(null),2e3)},c=()=>{var w;return(w=r.data)!=null&&w.actions?e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:r.data.actions.map((b,P)=>e.jsxs("button",{onClick:()=>b.onClick(),className:`px-4 py-2 rounded-lg font-medium transition-all duration-200 ${b.style==="primary"?"bg-gradient-to-r from-purple-600 to-blue-600 text-white hover:shadow-lg hover:shadow-purple-500/50":b.style==="danger"?"bg-red-600/20 text-red-300 border border-red-500/30 hover:bg-red-600/30":"bg-purple-600/20 text-purple-300 border border-purple-500/30 hover:bg-purple-600/30"}`,children:[b.icon&&e.jsx("span",{className:"mr-2",children:b.icon}),b.label]},P))}):null},d=()=>{var b;if(!((b=r.data)!=null&&b.card))return null;const{card:w}=r.data;return e.jsxs("div",{className:"mt-4 glass rounded-lg p-4 border border-purple-500/20",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[w.icon&&e.jsx("span",{className:"text-2xl",children:w.icon}),e.jsx("h3",{className:"text-lg font-bold text-white",children:w.title})]}),w.badge&&e.jsx("span",{className:"px-2 py-1 bg-purple-600/30 text-purple-200 rounded text-xs font-medium",children:w.badge})]}),w.items&&e.jsx("div",{className:"space-y-2",children:w.items.map((P,A)=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-300/80 text-sm",children:P.label}),e.jsx("span",{className:"text-white font-medium",children:P.value})]},A))}),w.description&&e.jsx("p",{className:"text-purple-300/70 text-sm mt-3",children:w.description}),w.link&&e.jsx("div",{className:"mt-3",children:e.jsx(Ls,{type:w.link.type,value:w.link.value,network:"mainnet"})})]})},u=()=>{var b;if(!((b=r.data)!=null&&b.table))return null;const{table:w}=r.data;return e.jsx("div",{className:"mt-4 glass rounded-lg overflow-hidden border border-purple-500/20",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsx("tr",{className:"bg-purple-900/30 border-b border-purple-500/20",children:w.headers.map((P,A)=>e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-purple-300 uppercase tracking-wider",children:P},A))})}),e.jsx("tbody",{children:w.rows.map((P,A)=>e.jsx("tr",{className:"border-b border-purple-500/10 hover:bg-purple-900/20 transition-colors",children:P.map((_,W)=>e.jsx("td",{className:"px-4 py-3 text-sm text-white",children:_},W))},A))})]})})})},h=()=>{var w;return(w=r.data)!=null&&w.quickActions?e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:r.data.quickActions.map((b,P)=>e.jsx("button",{onClick:()=>b.onClick(),className:"px-3 py-1.5 bg-purple-900/30 hover:bg-purple-900/50 text-purple-200 rounded-full text-xs font-medium transition-all duration-200 border border-purple-500/20",children:b.label},P))}):null},g=async w=>{const b=r.data.execution;try{let P;switch(b.type){case"send_xrp":P=await lh(w);break;case"send_token":P=await ih(w);break;case"setup_trustline":P=await oh(w);break;case"buy_token":P=await ch(w);break;case"sell_token":P=await dh(w);break;case"create_bot":P=await uh(w);break;default:throw new Error("Unknown execution type")}i(P),k.success(P.message),t&&t(P)}catch(P){const A={status:"error",title:"Execution Failed",message:P.message||"An error occurred during execution",data:null};i(A),k.error(P.message)}},y=()=>{var w;return(w=r.data)!=null&&w.execution?e.jsxs(e.Fragment,{children:[e.jsx(ah,{execution:r.data.execution,onExecute:g}),l&&e.jsx(nh,{result:l})]}):null},f=w=>w.split(`
`).map((b,P)=>b.startsWith("•")?e.jsx("li",{className:"ml-4",children:b.substring(1).trim()},P):b?e.jsx("p",{children:b},P):e.jsx("br",{},P));return e.jsxs("div",{className:`flex items-start gap-3 ${s?"flex-row-reverse":""}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${s?"bg-gradient-to-br from-green-500 to-emerald-600":"bg-gradient-to-br from-purple-500 to-blue-600"}`,children:e.jsx("span",{className:"text-sm",children:s?"👤":"🤖"})}),e.jsx("div",{className:`flex-1 max-w-3xl ${s?"flex justify-end":""}`,children:e.jsxs("div",{className:`rounded-lg p-4 ${s?"bg-gradient-to-br from-green-600/20 to-emerald-600/20 border border-green-500/20":"bg-purple-900/30 border border-purple-500/20"}`,children:[e.jsx("div",{className:`text-sm ${s?"text-white":"text-purple-100"} space-y-2`,children:f(r.content)}),!s&&e.jsxs(e.Fragment,{children:[d(),u(),y(),c(),h()]}),e.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-purple-500/10",children:[e.jsx("span",{className:"text-xs text-purple-400/60",children:r.timestamp.toLocaleTimeString()}),e.jsx("button",{onClick:()=>o(r.content,r.id),className:"text-xs text-purple-400/60 hover:text-purple-300 transition-colors",children:a===r.id?"✓ Copied":"📋 Copy"})]})]})})]})}const ph="rphatRpwXcPAo7CVm46dC78JAQ6kLMqb2M",mh="rphatRpwXcPAo7CVm46dC78JAQ6kLMqb2M",Ta=.01,Jr=async(r,t)=>{if(t.address===mh)return{success:!0,hash:null,fee:0,waived:!0};try{const s={TransactionType:"Payment",Account:t.address,Destination:ph,Amount:(Ta*1e6).toString()},a=await r.autofill(s),n=t.sign(a),l=await r.submitAndWait(n.tx_blob);return{success:l.result.meta.TransactionResult==="tesSUCCESS",hash:l.result.hash,fee:Ta,waived:!1}}catch(s){return{success:!1,error:s.message,fee:Ta,waived:!1}}};class hh{constructor(){this.wallet=null,this.client=null}setWallet(t){this.wallet=t}async connect(){return(!this.client||!this.client.isConnected())&&(this.client=new Re.Client("wss://xrplcluster.com"),await this.client.connect()),this.client}async disconnect(){this.client&&this.client.isConnected()&&await this.client.disconnect()}parseCommand(t){const s=t.toLowerCase().trim(),a=s.match(/send\s+([rR][a-zA-Z0-9]{24,34})\s+(\d+(?:\.\d+)?)\s+xrp/);if(a)return{type:"SEND_XRP",destination:a[1],amount:parseFloat(a[2])};const n=s.match(/send\s+(\d+(?:\.\d+)?)\s+([a-z]+)\s+(?:to\s+)?([rR][a-zA-Z0-9]{24,34})/);if(n)return{type:"SEND_TOKEN",amount:parseFloat(n[1]),token:n[2].toUpperCase(),destination:n[3]};const l=s.match(/buy\s+(\d+(?:\.\d+)?)\s+([a-z]+)/);if(l)return{type:"BUY_TOKEN",amount:parseFloat(l[1]),token:l[2].toUpperCase()};const i=s.match(/sell\s+(\d+(?:\.\d+)?)\s+([a-z]+)/);if(i)return{type:"SELL_TOKEN",amount:parseFloat(i[1]),token:i[2].toUpperCase()};if(s.match(/(?:check|show|what(?:'s| is)?|get)\s+(?:my\s+)?balance/))return{type:"CHECK_BALANCE"};const c=s.match(/(?:info|information|details|about)\s+(?:about\s+)?([a-z]+)/);if(c)return{type:"TOKEN_INFO",token:c[1].toUpperCase()};if(s.match(/(?:price|cost|value)\s+(?:of\s+)?xrp(?:\s+(?:in\s+)?(?:usd|dollars?))?/))return{type:"XRP_PRICE"};const u=s.match(/(?:price|cost)\s+(?:of\s+)?([a-z]+)/);if(u&&u[1].toLowerCase()!=="xrp")return{type:"TOKEN_PRICE",token:u[1].toUpperCase()};const h=s.match(/(?:setup|create|add)\s+trustline\s+(?:for\s+)?([a-z]+)/);return h?{type:"SETUP_TRUSTLINE",token:h[1].toUpperCase()}:{type:"UNKNOWN",input:t}}async executeCommand(t){if(!this.wallet)return{success:!1,message:"Please connect your wallet first to execute commands.",requiresWallet:!0};try{switch(await this.connect(),t.type){case"SEND_XRP":return await this.executeSendXRP(t);case"SEND_TOKEN":return await this.executeSendToken(t);case"BUY_TOKEN":return await this.executeBuyToken(t);case"SELL_TOKEN":return await this.executeSellToken(t);case"CHECK_BALANCE":return await this.executeCheckBalance();case"TOKEN_INFO":return await this.executeTokenInfo(t);case"TOKEN_PRICE":return await this.executeTokenPrice(t);case"XRP_PRICE":return await this.executeXRPPrice();case"SETUP_TRUSTLINE":return await this.executeSetupTrustline(t);default:return{success:!1,message:`I couldn't understand that command. Try:
• "SEND Rxxx... 15 XRP"
• "BUY 1000 ORANGE"
• "SELL 500 BANANA"
• "CHECK BALANCE"
• "PRICE OF BANANA"`}}}catch(s){return{success:!1,message:`Error: ${s.message}`,error:s.message}}}async executeSendXRP({destination:t,amount:s}){try{const a={TransactionType:"Payment",Account:this.wallet.address,Destination:t,Amount:Re.xrpToDrops(s.toString())},n=await this.client.autofill(a),i=Re.Wallet.fromSeed(this.wallet.seed).sign(n),o=await this.client.submitAndWait(i.tx_blob);return o.result.meta.TransactionResult==="tesSUCCESS"?(await Jt({userAddress:this.wallet.address,actionType:Yt.XRP_SENT,description:`Sent ${s} XRP to ${t}`,txHash:o.result.hash}),{success:!0,message:`Successfully sent ${s} XRP to ${t}!`,txHash:o.result.hash,data:{amount:s,destination:t,fee:(parseFloat(o.result.Fee)/1e6).toFixed(6)}}):{success:!1,message:`Transaction failed: ${o.result.meta.TransactionResult}`}}catch(a){return{success:!1,message:`Failed to send XRP: ${a.message}`}}}async executeSendToken({amount:t,token:s,destination:a}){try{const{data:n}=await S.from("meme_tokens").select("*").ilike("currency_code",s).single();if(!n)return{success:!1,message:`Token "${s}" not found. Please check the token name.`};const l=vt.Buffer.from(n.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"),i={TransactionType:"Payment",Account:this.wallet.address,Destination:a,Amount:{currency:l,issuer:n.issuer_address,value:t.toString()}},o=await this.client.autofill(i),d=Re.Wallet.fromSeed(this.wallet.seed).sign(o),u=await this.client.submitAndWait(d.tx_blob);return u.result.meta.TransactionResult==="tesSUCCESS"?(await Jt({userAddress:this.wallet.address,actionType:Yt.TOKEN_SENT,description:`Sent ${t} ${s} to ${a}`,txHash:u.result.hash,tokenId:n.id}),{success:!0,message:`Successfully sent ${t} ${s} to ${a}!`,txHash:u.result.hash,data:{amount:t,token:s,destination:a}}):{success:!1,message:`Transaction failed: ${u.result.meta.TransactionResult}`}}catch(n){return{success:!1,message:`Failed to send token: ${n.message}`}}}async executeBuyToken({amount:t,token:s}){var a;try{const{data:n}=await S.from("meme_tokens").select("*").ilike("currency_code",s).eq("amm_pool_created",!0).single();if(!n)return{success:!1,message:`Token "${s}" not found or doesn't have an AMM pool yet.`};const l=n.amm_xrp_amount/n.amm_asset_amount,i=t*l,c=i*1.02,d=vt.Buffer.from(n.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"),u={TransactionType:"Payment",Account:this.wallet.address,Destination:this.wallet.address,Amount:{currency:d,issuer:n.issuer_address,value:t.toString()},SendMax:Re.xrpToDrops(c.toFixed(6)),Flags:131072},h=await this.client.autofill(u),g=Re.Wallet.fromSeed(this.wallet.seed),y=g.sign(h),f=await Promise.race([this.client.submitAndWait(y.tx_blob),new Promise((w,b)=>setTimeout(()=>b(new Error("Transaction timed out after 20 seconds")),2e4))]);if(f.result.meta.TransactionResult==="tesSUCCESS"){const w=(a=f.result.meta.delivered_amount)!=null&&a.value?parseFloat(f.result.meta.delivered_amount.value):t;await Jr(this.client,g);const{data:b}=await S.from("trade_history").insert({token_id:n.id,trader_address:this.wallet.address,trade_type:"buy",token_amount:w,xrp_amount:i,price:l,tx_hash:f.result.hash,slippage:2}).select().single();return await Jt({userAddress:this.wallet.address,actionType:Yt.SWAP_EXECUTED,description:`Bought ${w.toFixed(4)} ${s}`,txHash:f.result.hash,tokenId:n.id}),{success:!0,message:`Successfully bought ${w.toFixed(4)} ${s} for approximately ${i.toFixed(4)} XRP!`,txHash:f.result.hash,data:{token:s,amount:w,xrpSpent:i,price:l}}}else return{success:!1,message:`Buy transaction failed: ${f.result.meta.TransactionResult}`}}catch(n){return{success:!1,message:`Failed to buy token: ${n.message}. ${n.message.includes("timeout")?"The network may be slow, try again with fewer tokens.":"Check your balance and try again."}`}}}async executeSellToken({amount:t,token:s}){try{const{data:a}=await S.from("meme_tokens").select("*").ilike("currency_code",s).eq("amm_pool_created",!0).single();if(!a)return{success:!1,message:`Token "${s}" not found or doesn't have an AMM pool yet.`};const n=a.amm_xrp_amount/a.amm_asset_amount,l=t*n,o=l*.98,c=vt.Buffer.from(a.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"),d={TransactionType:"Payment",Account:this.wallet.address,Destination:this.wallet.address,Amount:Re.xrpToDrops(l.toFixed(6)),SendMax:{currency:c,issuer:a.issuer_address,value:(t*1.02).toString()},DeliverMin:Re.xrpToDrops(o.toFixed(6)),Flags:131072},u=await this.client.autofill(d),h=Re.Wallet.fromSeed(this.wallet.seed),g=h.sign(u),y=await Promise.race([this.client.submitAndWait(g.tx_blob),new Promise((f,w)=>setTimeout(()=>w(new Error("Transaction timed out after 20 seconds")),2e4))]);return y.result.meta.TransactionResult==="tesSUCCESS"?(await Jr(this.client,h),await S.from("trade_history").insert({token_id:a.id,trader_address:this.wallet.address,trade_type:"sell",token_amount:t,xrp_amount:l,price:n,tx_hash:y.result.hash,slippage:2}),await Jt({userAddress:this.wallet.address,actionType:Yt.SWAP_EXECUTED,description:`Sold ${t.toFixed(4)} ${s}`,txHash:y.result.hash,tokenId:a.id}),{success:!0,message:`Successfully sold ${t.toFixed(4)} ${s} for approximately ${l.toFixed(4)} XRP!`,txHash:y.result.hash,data:{token:s,amount:t,xrpReceived:l,price:n}}):{success:!1,message:`Sell transaction failed: ${y.result.meta.TransactionResult}`}}catch(a){return{success:!1,message:`Failed to sell token: ${a.message}. ${a.message.includes("timeout")?"The network may be slow, try again with fewer tokens.":"Check your token balance and try again."}`}}}async executeCheckBalance(){try{const t=await this.client.request({command:"account_info",account:this.wallet.address,ledger_index:"validated"}),s=parseFloat(Re.dropsToXrp(t.result.account_data.Balance)),a=10+t.result.account_data.OwnerCount*2,l=(await this.client.request({command:"account_lines",account:this.wallet.address,ledger_index:"validated"})).result.lines.map(i=>({currency:i.currency.length>3?vt.Buffer.from(i.currency,"hex").toString("utf8").replace(/\0/g,""):i.currency,balance:parseFloat(i.balance),issuer:i.account})).filter(i=>i.balance>0);return{success:!0,message:`Your XRP balance is ${s.toFixed(6)} XRP (${(s-a).toFixed(6)} available)`,data:{xrpBalance:s,xrpAvailable:s-a,reserve:a,tokenBalances:l}}}catch(t){return{success:!1,message:`Failed to check balance: ${t.message}`}}}async executeTokenInfo({token:t}){try{const{data:s}=await S.from("meme_tokens").select("*").ilike("currency_code",t).single();if(!s)return{success:!1,message:`Token "${t}" not found.`};const a=s.amm_pool_created?s.amm_xrp_amount/s.amm_asset_amount:0,n=s.supply*a;return{success:!0,message:`${s.token_name} (${s.currency_code})

Price: ${a.toFixed(8)} XRP
Supply: ${s.supply.toLocaleString()}
Market Cap: ${n.toFixed(2)} XRP
Liquidity: ${(s.amm_xrp_amount||0).toFixed(2)} XRP
Pool: ${s.amm_pool_created?"Active":"Not created"}`,data:{...s,price:a,marketCap:n}}}catch(s){return{success:!1,message:`Failed to get token info: ${s.message}`}}}async executeXRPPrice(){try{const s=await(await fetch("https://api.coingecko.com/api/v3/simple/price?ids=ripple&vs_currencies=usd&include_market_cap=true&include_24hr_vol=true&include_24hr_change=true")).json();if(!s.ripple)return{success:!1,message:"Unable to fetch XRP price data at this time. Please try again."};const a=s.ripple,n=a.usd,l=a.usd_24h_change||0,i=a.usd_market_cap,o=a.usd_24h_vol,c=l>0?"📈":l<0?"📉":"➡️",d=l>=0?"+":"";return{success:!0,message:`**XRP Price Information**

💰 **Current Price:** $${n.toFixed(4)} USD
${c} **24h Change:** ${d}${l.toFixed(2)}%
📊 **Market Cap:** $${(i/1e9).toFixed(2)}B USD
💱 **24h Volume:** $${(o/1e9).toFixed(2)}B USD

*Data updated in real-time from CoinGecko*`,data:{price:n,change24h:l,marketCap:i,volume24h:o,source:"CoinGecko",timestamp:new Date().toISOString()}}}catch{return{success:!1,message:"I apologize, but I'm unable to retrieve XRP price data at the moment. Please check your internet connection and try again."}}}async executeTokenPrice({token:t}){var s;try{const{data:a}=await S.from("token_price_cache").select("*").eq("currency_code",t).gte("last_updated",new Date(Date.now()-6e4).toISOString()).maybeSingle(),{data:n}=await S.from("meme_tokens").select("*").ilike("currency_code",t).eq("amm_pool_created",!0).maybeSingle();if(!n)return{success:!1,message:`I couldn't find a token with the symbol "${t}" that has an active trading pool. Please verify the token symbol and try again.`};let l,i=0;if(a&&a.price)l=parseFloat(a.price),i=parseFloat(a.change_24h||0);else if(l=n.amm_xrp_amount/n.amm_asset_amount,n.initial_xrp_amount&&n.initial_asset_amount){const A=n.initial_xrp_amount/n.initial_asset_amount;i=(l-A)/A*100}const d=((s=(await(await fetch("https://api.coingecko.com/api/v3/simple/price?ids=ripple&vs_currencies=usd")).json()).ripple)==null?void 0:s.usd)||2.5,u=l*d,h=parseFloat(n.supply)*l,g=h*d,y=parseFloat(n.amm_xrp_amount||0),f=y*d,w=i>0?"📈":i<0?"📉":"➡️",b=i>=0?"+":"";return{success:!0,message:`**${n.token_name} (${n.currency_code}) Price**

💰 **Current Price:**
   • ${l.toFixed(8)} XRP
   • $${u.toFixed(6)} USD

${w} **24h Change:** ${b}${i.toFixed(2)}%

📊 **Market Stats:**
   • Market Cap: ${h.toFixed(2)} XRP ($${(g/1e6).toFixed(2)}M)
   • Liquidity: ${y.toFixed(2)} XRP ($${f.toFixed(2)})
   • Total Supply: ${parseFloat(n.supply).toLocaleString()}

*Real-time data from ${a?"cache":"live"} pool*`,data:{token:n.currency_code,tokenName:n.token_name,price:l,priceUSD:u,change24h:i,marketCap:h,marketCapUSD:g,liquidity:y,supply:n.supply,cached:!!a}}}catch{return{success:!1,message:`I apologize, but I encountered an error while fetching the price for ${t}. Please try again in a moment.`}}}async executeSetupTrustline({token:t}){try{const{data:s}=await S.from("meme_tokens").select("*").ilike("currency_code",t).single();if(!s)return{success:!1,message:`Token "${t}" not found.`};const a=vt.Buffer.from(s.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"),n={TransactionType:"TrustSet",Account:this.wallet.address,LimitAmount:{currency:a,issuer:s.issuer_address,value:"10000000000"}},l=await this.client.autofill(n),o=Re.Wallet.fromSeed(this.wallet.seed).sign(l),c=await this.client.submitAndWait(o.tx_blob);return c.result.meta.TransactionResult==="tesSUCCESS"?(await Jt({userAddress:this.wallet.address,actionType:Yt.TRUSTLINE_ADDED,description:`Setup trustline for ${t}`,txHash:c.result.hash,tokenId:s.id}),{success:!0,message:`Successfully setup trustline for ${t}! You can now receive and trade this token.`,txHash:c.result.hash}):{success:!1,message:`Trustline setup failed: ${c.result.meta.TransactionResult}`}}catch(s){return{success:!1,message:`Failed to setup trustline: ${s.message}`}}}}const _n=new hh;class Hs{static async getTokenWithCache(t){var s;try{const{data:a,error:n}=await S.from("meme_tokens").select("*, pool_data_cache(*)").ilike("currency_code",t).single();if(n||!a)return null;const l=(s=a.pool_data_cache)==null?void 0:s[0],i=l&&Date.now()-new Date(l.last_updated).getTime()<this.CACHE_EXPIRY,o=i&&l.price>0?l.price:a.amm_xrp_amount&&a.amm_asset_amount?parseFloat(a.amm_xrp_amount)/parseFloat(a.amm_asset_amount):0,c=o*parseFloat(a.supply||0),d=i?l.xrp_amount:a.amm_xrp_amount||0,u=i&&l.volume_24h||0,h=i&&l.price_change_24h||0;return{...a,currentPrice:o,marketCap:c,liquidity:d,volume24h:u,priceChange24h:h,cacheStatus:i?"valid":"stale"}}catch{return null}}static async getAllTokensWithCache(t=20){try{const{data:s,error:a}=await S.from("meme_tokens").select("*, pool_data_cache(*)").eq("amm_pool_created",!0).order("created_at",{ascending:!1}).limit(t);if(a)throw a;return s.map(n=>{var d;const l=(d=n.pool_data_cache)==null?void 0:d[0],i=l&&Date.now()-new Date(l.last_updated).getTime()<this.CACHE_EXPIRY,o=i&&l.price>0?l.price:n.amm_xrp_amount&&n.amm_asset_amount?parseFloat(n.amm_xrp_amount)/parseFloat(n.amm_asset_amount):0,c=o*parseFloat(n.supply||0);return{...n,currentPrice:o,marketCap:c,liquidity:i?l.xrp_amount:n.amm_xrp_amount||0,volume24h:i&&l.volume_24h||0,priceChange24h:i&&l.price_change_24h||0,cacheStatus:i?"valid":"stale"}})}catch{return[]}}static async getMarketCapRankings(t=10){try{return(await this.getAllTokensWithCache(50)).filter(a=>a.marketCap>0).sort((a,n)=>n.marketCap-a.marketCap).slice(0,t)}catch{return[]}}static async getVolumeLeaders(t=10){try{return(await this.getAllTokensWithCache(50)).filter(a=>a.volume24h>0).sort((a,n)=>n.volume24h-a.volume24h).slice(0,t)}catch{return[]}}static async getTopGainers(t=10){try{return(await this.getAllTokensWithCache(50)).filter(a=>a.priceChange24h>0).sort((a,n)=>n.priceChange24h-a.priceChange24h).slice(0,t)}catch{return[]}}static async getTopLosers(t=10){try{return(await this.getAllTokensWithCache(50)).filter(a=>a.priceChange24h<0).sort((a,n)=>a.priceChange24h-n.priceChange24h).slice(0,t)}catch{return[]}}static async getTokenHolders(t,s=10){try{const{data:a}=await S.from("meme_tokens").select("id, token_name, supply").ilike("currency_code",t).single();if(!a)return null;const{data:n,error:l}=await S.from("token_holdings_cache").select("*").eq("token_id",a.id).order("balance",{ascending:!1}).limit(s);if(l)return null;const i=(n==null?void 0:n.length)>0&&n[0].last_updated&&Date.now()-new Date(n[0].last_updated).getTime()<this.CACHE_EXPIRY*10;return{token:a,holders:n||[],totalHolders:(n==null?void 0:n.length)||0,totalBalance:(n==null?void 0:n.reduce((o,c)=>o+parseFloat(c.balance||0),0))||0,cacheStatus:i?"valid":"stale"}}catch{return null}}static async getWalletHoldings(t){try{const{data:s,error:a}=await S.from("token_holdings_cache").select("*, meme_tokens(*)").eq("wallet_address",t).gt("balance",0).order("value",{ascending:!1});if(a)throw a;const n=(s==null?void 0:s.length)>0&&s[0].last_updated&&Date.now()-new Date(s[0].last_updated).getTime()<this.CACHE_EXPIRY,l=(s==null?void 0:s.reduce((i,o)=>i+parseFloat(o.value||0),0))||0;return{holdings:s||[],totalValue:l,totalAssets:(s==null?void 0:s.length)||0,cacheStatus:n?"valid":"stale"}}catch{return{holdings:[],totalValue:0,totalAssets:0,cacheStatus:"error"}}}static async getPoolData(t){try{const{data:s,error:a}=await S.from("pool_data_cache").select("*").eq("token_id",t).single();if(a)return null;const n=s&&Date.now()-new Date(s.last_updated).getTime()<this.CACHE_EXPIRY;return{...s,cacheStatus:n?"valid":"stale"}}catch{return null}}static async getXRPPrice(){try{const{data:t,error:s}=await S.from("xrp_price_cache").select("*").order("updated_at",{ascending:!1}).limit(1).single();if(s||!t)return null;const a=Date.now()-new Date(t.updated_at).getTime()<6e4;return{priceUsd:parseFloat(t.price_usd||0),updatedAt:t.updated_at,cacheStatus:a?"valid":"stale"}}catch{return null}}static formatTokenData(t){const s=Math.floor((Date.now()-new Date(t.created_at).getTime())/864e5);return{name:t.token_name||"Unknown",symbol:t.currency_code||"N/A",supply:t.supply?parseFloat(t.supply).toLocaleString():"N/A",price:t.currentPrice>0?`${t.currentPrice.toFixed(8)} XRP`:"N/A",marketCap:t.marketCap>0?`${t.marketCap.toFixed(4)} XRP`:"N/A",liquidity:t.liquidity>0?`${parseFloat(t.liquidity).toFixed(4)} XRP`:"N/A",volume24h:t.volume24h>0?`${t.volume24h.toFixed(2)} XRP`:"N/A",priceChange24h:t.priceChange24h?`${t.priceChange24h>0?"+":""}${t.priceChange24h.toFixed(2)}%`:"N/A",daysOld:`${s} days`,category:t.category||"Other",status:t.status||"Unknown",issuer:t.issuer_address?`${t.issuer_address.slice(0,8)}...${t.issuer_address.slice(-6)}`:"N/A",created:new Date(t.created_at).toLocaleString(),description:t.description||null,twitter:t.twitter_handle||null,website:t.website_url||null,cacheStatus:t.cacheStatus||"unknown"}}}gl(Hs,"CACHE_EXPIRY",3e4);class Ro{constructor(){this.xrplClient=null,this.context={connectedWallet:null,lastQuery:null,sessionData:{}},this.initializeContext()}initializeContext(){const t=localStorage.getItem("connectedWallet");t&&(this.context.connectedWallet=JSON.parse(t),_n.setWallet(this.context.connectedWallet))}async processMessage(t){const s=t.toLowerCase(),a=_n.parseCommand(t);if(a.type!=="UNKNOWN"){const n=await _n.executeCommand(a);return n.success?{content:n.message,data:n.data?{card:{icon:"✅",title:"Command Executed Successfully",badge:"Success",items:Object.entries(n.data).map(([l,i])=>({label:l.charAt(0).toUpperCase()+l.slice(1),value:String(i)}))},txHash:n.txHash,actions:n.txHash?[{label:"View on XRPScan",icon:"🔍",style:"primary",onClick:()=>window.open(`https://xrpscan.com/tx/${n.txHash}`,"_blank")}]:[]}:null}:n.requiresWallet?{content:n.message,data:{actions:[{label:"Connect Wallet",icon:"🔗",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"setup"}))}]}}:{content:n.message,data:null}}return this.isAddressBookQuery(s)?await this.handleAddressBook():this.isBuyTokenQuery(s)?await this.handleBuyToken():this.isSellTokenQuery(s)?await this.handleSellToken():this.isCreateBotQuery(s)?await this.handleCreateBot():this.isSendXRPQuery(s)?await this.handleSendXRP():this.isSendCustomTokenQuery(s)?await this.handleSendCustomToken():this.isSendTokenQuery(s)?await this.handleSendToken(t):this.isReceiveTokenQuery(s)?this.handleReceiveToken():this.isWalletAssetsQuery(s)?await this.handleWalletAssets():this.isBalanceQuery(s)?await this.handleBalanceQuery():this.isTokenQuery(s)?await this.handleTokenQuery(t):this.isTradeQuery(s)?await this.handleTradeQuery():this.isPriceQuery(s)?await this.handlePriceQuery(t):this.isMarketQuery(s)?await this.handleMarketQuery():this.isWalletQuery(s)?await this.handleWalletInfo():this.isNavigationQuery(s)?this.handleNavigation(s):this.isTokenStatsQuery(s)?await this.handleTokenStats():this.isMarketCapQuery(s)?await this.handleMarketCapQuery(t):this.isVolumeQuery(s)?await this.handleVolumeQuery():this.isHoldersQuery(s)?await this.handleHoldersQuery(t):this.isBotQuery(s)?await this.handleBotQuery():this.isHelpQuery(s)?this.handleHelp():this.handleGeneral(t)}isBalanceQuery(t){return t.includes("balance")||t.includes("how much")||t.includes("my xrp")}isTokenQuery(t){return(t.includes("token")||t.includes("coin"))&&(t.includes("info")||t.includes("about")||t.includes("details")||t.includes("show")||t.includes("tell me")||t.includes("what is")||t.includes("stats")||t.includes("statistics")||t.includes("market cap")||t.includes("supply")||t.includes("price")||t.includes("liquidity")||t.includes("days")||/\b[A-Z]{3,10}\b/.test(t))}isTradeQuery(t){return t.includes("trade")||t.includes("swap")||t.includes("recent")&&t.includes("history")}isPriceQuery(t){return t.includes("price")||t.includes("cost")||t.includes("worth")}isMarketQuery(t){return t.includes("market")||t.includes("top")||t.includes("trending")||t.includes("overview")}isWalletQuery(t){return t.includes("wallet")&&(t.includes("info")||t.includes("detail")||t.includes("address"))}isNavigationQuery(t){return t.includes("go to")||t.includes("open")||t.includes("show me")||t.includes("navigate")}isHelpQuery(t){return t.includes("help")||t.includes("what can you")||t.includes("how do i")}isSendTokenQuery(t){return t.includes("send")&&(t.includes("token")||t.includes("xrp"))||t.includes("transfer")||t.includes("payment")}isSendXRPQuery(t){return t.includes("send")&&t.includes("xrp")&&!t.includes("custom")&&!t.includes("token")}isSendCustomTokenQuery(t){return t.includes("send")&&(t.includes("custom")||t.includes("specific"))||t.includes("send")&&t.includes("token")&&!t.includes("xrp")}isReceiveTokenQuery(t){return t.includes("receive")||t.includes("get token")||t.includes("my address")}isWalletAssetsQuery(t){return t.includes("wallet")&&t.includes("asset")||t.includes("what tokens")||t.includes("my holdings")}isTokenStatsQuery(t){return t.includes("token")&&(t.includes("stat")||t.includes("analytic")||t.includes("performance"))}isBotQuery(t){return t.includes("bot")&&(t.includes("status")||t.includes("trading")||t.includes("performance"))}isMarketCapQuery(t){return t.includes("market cap")||t.includes("marketcap")||t.includes("mcap")}isVolumeQuery(t){return t.includes("volume")||t.includes("trading volume")}isHoldersQuery(t){return t.includes("holder")||t.includes("who holds")||t.includes("ownership")}isBuyTokenQuery(t){return t.includes("buy")&&t.includes("token")||t.includes("purchase token")}isSellTokenQuery(t){return t.includes("sell")&&t.includes("token")||t.includes("sell my")}isCreateBotQuery(t){return t.includes("create")&&t.includes("bot")||t.includes("new bot")||t.includes("setup bot")}isAddressBookQuery(t){return t.includes("address book")||t.includes("contacts")||t.includes("saved addresses")}async handleBalanceQuery(){if(!this.context.connectedWallet)return{content:"No wallet is currently connected. Please connect a wallet first to check your balance.",data:{actions:[{label:"Go to Wallets",icon:"💼",style:"primary",onClick:()=>{window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"wallets"}))}}]}};try{const t=await Ia(this.context.connectedWallet.address,!1);return{content:"Here is your current wallet balance:",data:{card:{icon:"💰",title:"Wallet Balance",badge:"Live",items:[{label:"Address",value:`${this.context.connectedWallet.address.slice(0,10)}...${this.context.connectedWallet.address.slice(-8)}`},{label:"XRP Balance",value:`${t.toFixed(6)} XRP`},{label:"Wallet Name",value:this.context.connectedWallet.name}]},quickActions:[{label:"Send XRP",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"wallets"}))},{label:"View on XRPScan",onClick:()=>window.open(`https://xrpscan.com/account/${this.context.connectedWallet.address}`,"_blank")}]}}}catch(t){return{content:`I encountered an error connecting to the XRPL network: ${t.message||"Unknown error"}

This could be due to:
• Network connectivity issues
• XRPL node temporarily unavailable
• Wallet address not activated on the ledger

Please try again in a moment or check your wallet on XRPScan.`,data:{actions:[{label:"Try Again",icon:"🔄",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("sendAIMessage",{detail:"check my wallet balance"}))},{label:"View on XRPScan",icon:"🔍",style:"secondary",onClick:()=>window.open(`https://xrpscan.com/account/${this.context.connectedWallet.address}`,"_blank")}]}}}}async handleTokenQuery(t){try{const s=t.match(/(?:about|info|details|for|show)\s+([A-Z]{3,10})/i);if(s){const i=s[1].toUpperCase();return await this.getDetailedTokenInfo(i)}const{data:a,error:n}=await S.from("meme_tokens").select("*").eq("amm_pool_created",!0).order("created_at",{ascending:!1}).limit(10);if(n)throw n;if(!a||a.length===0)return{content:"No tokens found in the database. Create your first token to get started!",data:{actions:[{label:"Create Token",icon:"✨",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"memes"}))}]}};const l=a.reduce((i,o)=>i+(parseFloat(o.supply)||0),0);return{content:`I found ${a.length} active tokens:`,data:{card:{icon:"💎",title:"Token Overview",badge:`${a.length} Tokens`,items:[{label:"Total Tokens",value:`${a.length}`},{label:"Total Supply",value:l.toLocaleString()}]},table:{headers:["Token","Symbol","Supply","Created"],rows:a.slice(0,5).map(i=>[i.token_name||"Unknown",i.currency_code||"N/A",i.supply?parseFloat(i.supply).toLocaleString():"N/A",new Date(i.created_at).toLocaleDateString()])},actions:[{label:"View All Tokens",icon:"📋",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"mytokens"}))},{label:"Trade Tokens",icon:"💱",style:"secondary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"trade"}))}]}}}catch{return{content:"I had trouble fetching token information. Please try again.",data:null}}}async getDetailedTokenInfo(t){try{const s=await Hs.getTokenWithCache(t);if(!s)return{content:`Token "${t}" not found. Make sure the token code is correct.`,data:{actions:[{label:"View All Tokens",icon:"📋",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"mytokens"}))}]}};const a=Hs.formatTokenData(s),n=[{label:"Token Name",value:a.name},{label:"Symbol",value:a.symbol},{label:"Total Supply",value:a.supply},{label:"Current Price",value:a.price},{label:"Market Cap",value:a.marketCap},{label:"Liquidity",value:a.liquidity},{label:"24h Volume",value:a.volume24h},{label:"24h Change",value:a.priceChange24h},{label:"Days Old",value:a.daysOld},{label:"Category",value:a.category},{label:"AMM Pool",value:s.amm_pool_created?"Yes ✅":"No ❌"},{label:"Status",value:a.status},{label:"Issuer",value:a.issuer},{label:"Created",value:a.created}];return a.description&&n.splice(2,0,{label:"Description",value:a.description}),a.twitter&&n.push({label:"Twitter",value:`@${a.twitter}`}),a.website&&n.push({label:"Website",value:a.website}),{content:`Here are the complete details for ${s.token_name||t}:`,data:{card:{icon:"💎",title:`${s.token_name||t} (${s.currency_code})`,badge:s.category||"Token",items:n},actions:[{label:"Trade This Token",icon:"💱",style:"primary",onClick:()=>{window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"trade"})),setTimeout(()=>{window.dispatchEvent(new CustomEvent("selectToken",{detail:s}))},100)}},{label:"View on XRPScan",icon:"🔍",style:"secondary",onClick:()=>window.open(`https://xrpscan.com/account/${s.issuer_address}`,"_blank")}]}}}catch{return{content:`I had trouble fetching details for "${t}". Please try again.`,data:null}}}async handleTradeQuery(){try{const{data:t,error:s}=await S.from("bot_trades").select("*").order("created_at",{ascending:!1}).limit(5);if(s)throw s;if(!t||t.length===0)return{content:"No recent trades found. Start trading to see your history here!",data:{actions:[{label:"Start Trading",icon:"💱",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"trade"}))}]}};const a=t.filter(i=>i.status==="success").length,n=t.reduce((i,o)=>i+(o.amount_bought||0),0),l=t.length>0?(a/t.length*100).toFixed(1):0;return{content:"Here is your trading activity from the platform:",data:{card:{icon:"📊",title:"Trading Summary",badge:`${t.length} Trades`,items:[{label:"Total Trades",value:`${t.length}`},{label:"Successful",value:`${a}`},{label:"Success Rate",value:`${l}%`},{label:"Total Volume",value:`${n.toFixed(2)} tokens`}]},table:{headers:["Type","Amount","Status","Date"],rows:t.map(i=>[i.trade_type||"Unknown",`${(i.amount_bought||0).toFixed(2)}`,i.status||"N/A",new Date(i.created_at).toLocaleString()])},actions:[{label:"View All Trades",icon:"📊",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"bottrader"}))},{label:"Start Trading",icon:"💱",style:"secondary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"trade"}))}]}}}catch{return{content:"I had trouble fetching your trade history. Please try again.",data:null}}}async handlePriceQuery(t){try{const s=t.match(/(?:price|cost|worth|market cap|marketcap|mcap|liquidity|volume).*?(?:for|of|on)\s+([A-Z]{2,10})/i);if(s){const l=s[1].toUpperCase();return await this.getDetailedTokenInfo(l)}const a=t.match(/\b([A-Z]{3,10})\b/);if(a){const l=a[1];return await this.getDetailedTokenInfo(l)}const n=await Hs.getTopTokens(5);return!n||n.length===0?{content:"No token data available yet. Try asking about a specific token!",data:{actions:[{label:"View All Tokens",icon:"💰",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"memes"}))}]}}:{content:"Here are the top tokens by volume (from cache):",data:{table:{headers:["Token","Symbol","Price","Market Cap","24h Volume"],rows:n.map(l=>{const i=Hs.formatTokenData(l);return[i.name,i.symbol,i.price,i.marketCap,i.volume24h]})},actions:[{label:"View All Prices",icon:"💰",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"trade"}))},{label:"Top 10 Tokens",icon:"👑",style:"secondary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"top10"}))}]}}}catch{return{content:"I can help you check token prices! Visit the Trade page for real-time prices.",data:{actions:[{label:"View Prices",icon:"💰",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"trade"}))}]}}}}async handleMarketQuery(){try{const{data:t,error:s}=await S.from("meme_tokens").select("*").eq("status","active").order("price_change_24h",{ascending:!1,nullsFirst:!1}).limit(10);if(s)throw s;const{count:a}=await S.from("meme_tokens").select("*",{count:"exact",head:!0}).eq("status","active"),{count:n}=await S.from("liquidity_pools").select("*",{count:"exact",head:!0}),{count:l}=await S.from("trading_bots").select("*",{count:"exact",head:!0}).eq("status","active"),i=(t==null?void 0:t.reduce((h,g)=>h+parseFloat(g.total_supply||0),0))||0,o=(t==null?void 0:t.reduce((h,g)=>h+(g.volume_24h||0),0))||0,c=(t==null?void 0:t.length)>0?i/t.length:0,d=t&&t.length>0?t[0]:null,u=(t==null?void 0:t.filter(h=>{const g=new Date(h.created_at);return new Date-g<24*60*60*1e3}).length)||0;return{content:"Here is comprehensive market analytics with data from the Analytics page:",data:{card:{icon:"📊",title:"Market Analytics",badge:"Live Data",items:[{label:"Total Tokens",value:`${a||0}`},{label:"Active Pools",value:`${n||0}`},{label:"Active Bots",value:`${l||0}`},{label:"24h New Tokens",value:`${u}`},{label:"Total Supply",value:`${i.toFixed(0)}`},{label:"24h Volume",value:`${o.toFixed(2)}`},{label:"Avg Market Cap",value:`${c.toFixed(2)}`},{label:"Top Gainer",value:d?`${d.name}`:"N/A"}]},table:{headers:["Token","Symbol","24h Change","24h Volume","Created"],rows:(t==null?void 0:t.slice(0,5).map(h=>[h.token_name||"Unknown",h.currency_code||"N/A",h.price_change_24h?`${h.price_change_24h>0?"+":""}${h.price_change_24h.toFixed(2)}%`:"N/A",h.volume_24h?h.volume_24h.toFixed(2):"N/A",new Date(h.created_at).toLocaleDateString()]))||[]},actions:[{label:"View Top 10",icon:"👑",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"top10"}))},{label:"Full Analytics",icon:"📈",style:"secondary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"analytics"}))}]}}}catch{return{content:"I had trouble fetching market data. Please try again.",data:null}}}async handleWalletInfo(){return this.context.connectedWallet?{content:"Here is your connected wallet information:",data:{card:{icon:"💼",title:"Wallet Information",badge:"Active",items:[{label:"Name",value:this.context.connectedWallet.name},{label:"Address",value:this.context.connectedWallet.address},{label:"Network",value:"XRPL Mainnet"}],description:"Your wallet is securely connected to the XRPL network."},actions:[{label:"Manage Wallet",icon:"⚙️",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"wallets"}))}]}}:{content:"No wallet is currently connected. Connect a wallet to see detailed information.",data:{actions:[{label:"Connect Wallet",icon:"🔗",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"wallets"}))}]}}}handleNavigation(t){const s={dashboard:["dashboard","home"],trade:["trade","swap","trading"],memes:["meme","create token"],pools:["pool","liquidity"],bottrader:["bot","automated trading"],vault:["vault","collect","fees"],mytokens:["my token","tokens"],analytics:["analytic","stats","chart"],top10:["top 10","top ten","leaderboard"],wallets:["wallet","manage wallet"],about:["about","info"]};for(const[a,n]of Object.entries(s))if(n.some(l=>t.includes(l)))return setTimeout(()=>{window.dispatchEvent(new CustomEvent("navigateToPage",{detail:a}))},500),{content:`Taking you to ${a.charAt(0).toUpperCase()+a.slice(1)}...`,data:null};return{content:"I can help you navigate to different sections. Which page would you like to visit?",data:{quickActions:[{label:"Dashboard",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"dashboard"}))},{label:"Trade",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"trade"}))},{label:"Create Token",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"memes"}))},{label:"Bot Trader",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"bottrader"}))}]}}}handleHelp(){return{content:"I'm your advanced XRPL AI assistant. Here's what I can help you with:",data:{card:{icon:"🤖",title:"Available Commands",items:[{label:"Balance Queries",value:"Check wallet balances and XRP amounts"},{label:"Token Information",value:"Get details about any token"},{label:"Trade History",value:"View your recent trades and swaps"},{label:"Market Data",value:"Get market overview and analytics"},{label:"Navigation",value:"Navigate to any page on the platform"},{label:"Price Checking",value:"Check token prices and values"}]},quickActions:[{label:"Check Balance",onClick:()=>{}},{label:"View Tokens",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"mytokens"}))},{label:"Market Overview",onClick:()=>{}},{label:"Trade History",onClick:()=>{}}]}}}async handleSendXRP(){return this.context.connectedWallet?{content:"Ready to send XRP! Fill in the details below and I'll execute the transaction for you.",data:{execution:{type:"send_xrp",icon:"📤",title:"Send XRP",description:"Direct XRP transfer to any XRPL address",badge:"Ready to Execute",fields:[{name:"destinationAddress",label:"Destination Address",type:"text",placeholder:"rXXXXXXXXXXXXXXXXXXXXXXXXXXXX",required:!0,hint:"Enter recipient XRPL address or use Address Book"},{name:"amount",label:"Amount (XRP)",type:"number",placeholder:"10",required:!0,hint:"Amount of XRP to send"},{name:"memo",label:"Memo (Optional)",type:"text",placeholder:"Payment for services",hint:"Optional memo for this transaction"}],steps:[{label:"Validate destination",description:"Verifying XRPL address format"},{label:"Check balance",description:"Ensuring sufficient XRP balance"},{label:"Prepare payment",description:"Creating XRP payment transaction"},{label:"Sign with wallet",description:"Cryptographically signing transaction"},{label:"Broadcast to network",description:"Submitting to XRPL"},{label:"Wait for confirmation",description:"Transaction being validated"}],defaultValues:{amount:"10"}}}}:{content:"Please connect a wallet first to send XRP.",data:{actions:[{label:"Connect Wallet",icon:"🔗",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"wallets"}))}]}}}async handleSendCustomToken(){if(!this.context.connectedWallet)return{content:"Please connect a wallet first to send custom tokens.",data:{actions:[{label:"Connect Wallet",icon:"🔗",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"wallets"}))}]}};const{data:t}=await S.from("meme_tokens").select("*").not("status","is",null).order("token_name",{ascending:!0}).limit(200);return!t||t.length===0?{content:"No custom tokens found in the platform. You can only send tokens that exist in the system.",data:{actions:[{label:"View Available Tokens",icon:"🪙",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"trade"}))}]}}:{content:`I can help you send any of the ${t.length} available tokens. Select the token and provide details:`,data:{execution:{type:"send_token",icon:"🪙",title:"Send Custom Token",description:"Transfer tokens to any XRPL address with trustline",badge:`${t.length} Tokens Available`,fields:[{name:"tokenId",label:"Select Token",type:"select",required:!0,options:t.map(s=>({value:JSON.stringify({code:s.currency_code,issuer:s.issuer_address,name:s.name}),label:`${s.name} (${s.currency_code})`})),hint:"Choose which token to send"},{name:"destinationAddress",label:"Destination Address",type:"text",placeholder:"rXXXXXXXXXXXXXXXXXXXXXXXXXXXX",required:!0,hint:"Recipient must have trustline for this token"},{name:"amount",label:"Amount",type:"number",placeholder:"100",required:!0,hint:"Amount of tokens to send"},{name:"memo",label:"Memo (Optional)",type:"text",placeholder:"Payment note",hint:"Optional transaction memo"}],steps:[{label:"Parse token selection",description:"Extracting token details"},{label:"Validate addresses",description:"Checking destination and issuer"},{label:"Verify trustline",description:"Ensuring recipient can receive"},{label:"Prepare payment",description:"Creating token payment transaction"},{label:"Sign transaction",description:"Signing with your wallet"},{label:"Submit to XRPL",description:"Broadcasting transaction"},{label:"Confirm delivery",description:"Waiting for ledger confirmation"}],defaultValues:{amount:"100"}}}}}async handleSendToken(t){if(!this.context.connectedWallet)return{content:"Please connect a wallet first to send tokens.",data:{actions:[{label:"Connect Wallet",icon:"🔗",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"wallets"}))}]}};const{data:s}=await S.from("meme_tokens").select("id, token_name, currency_code, issuer_address").eq("status","active").limit(50),a=(t==null?void 0:t.toLowerCase())||"";if(a.includes("send")&&(s==null?void 0:s.some(l=>a.includes(l.token_name.toLowerCase())||a.includes(l.currency_code.toLowerCase())))){const l=s.find(i=>a.includes(i.token_name.toLowerCase())||a.includes(i.currency_code.toLowerCase()));return{content:`I'll help you send ${l.token_name} (${l.currency_code}). Please provide the details:`,data:{execution:{type:"send_token",icon:"📤",title:`Send ${l.token_name}`,description:`Send ${l.currency_code} tokens to any XRPL address`,badge:"Token Transfer",fields:[{name:"destinationAddress",label:"Destination Address",type:"text",placeholder:"rXXXXXXXXXXXXXXXXXXXXXXXXXXXX",required:!0,hint:"Enter recipient address or use Address Book"},{name:"amount",label:`Amount (${l.currency_code})`,type:"number",placeholder:"100",required:!0,hint:`Amount of ${l.currency_code} to send`},{name:"currencyCode",label:"Currency Code",type:"text",placeholder:l.currency_code,required:!0,hint:"Token currency code"},{name:"issuerAddress",label:"Issuer Address",type:"text",placeholder:l.issuer_address,required:!0,hint:"Token issuer address"},{name:"memo",label:"Memo (Optional)",type:"text",placeholder:"Payment for services",hint:"Optional memo to include"}],steps:[{label:"Validate addresses",description:"Checking destination and issuer addresses"},{label:"Check trustline",description:"Verifying recipient has trustline"},{label:"Prepare transaction",description:"Creating token payment"},{label:"Sign transaction",description:"Signing with your wallet"},{label:"Submit to XRPL",description:"Broadcasting to network"},{label:"Confirm transaction",description:"Waiting for confirmation"}],defaultValues:{amount:"100",currencyCode:l.currency_code,issuerAddress:l.issuer_address}}}}}return{content:"I can help you send XRP or custom tokens directly from chat! What would you like to send?",data:{card:{icon:"💱",title:"Send Options",badge:"Choose Type",items:[{label:"XRP",value:"Native XRPL currency"},{label:"Custom Tokens",value:`${(s==null?void 0:s.length)||0} available`}]},quickActions:[{label:"Send XRP",onClick:()=>window.dispatchEvent(new CustomEvent("sendAIMessage",{detail:"send XRP"}))},{label:"Send Custom Token",onClick:()=>window.dispatchEvent(new CustomEvent("sendAIMessage",{detail:"send custom token"}))}]}}}handleReceiveToken(){return this.context.connectedWallet?{content:"Here is your wallet address for receiving tokens:",data:{card:{icon:"📥",title:"Receive Tokens",badge:"Your Address",items:[{label:"Wallet Name",value:this.context.connectedWallet.name},{label:"Address",value:this.context.connectedWallet.address},{label:"Network",value:"XRPL Mainnet"}],description:"Share this address with others to receive XRP and tokens. Make sure senders are using the XRPL network."},quickActions:[{label:"Copy Address",onClick:()=>navigator.clipboard.writeText(this.context.connectedWallet.address)},{label:"View on Explorer",onClick:()=>window.open(`https://xrpscan.com/account/${this.context.connectedWallet.address}`,"_blank")}]}}:{content:"Please connect a wallet first to receive tokens.",data:{actions:[{label:"Connect Wallet",icon:"🔗",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"wallets"}))}]}}}async handleWalletAssets(){if(!this.context.connectedWallet)return{content:"Please connect a wallet to view your assets.",data:{actions:[{label:"Connect Wallet",icon:"🔗",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"wallets"}))}]}};try{return{content:"Here are your wallet assets:",data:{card:{icon:"💎",title:"Wallet Assets",badge:"Live",items:[{label:"XRP Balance",value:`${(await Ia(this.context.connectedWallet.address,!1)).toFixed(6)} XRP`},{label:"Wallet",value:this.context.connectedWallet.name},{label:"Address",value:`${this.context.connectedWallet.address.slice(0,12)}...`}],description:"View all your assets including tokens and XRP holdings in the Wallets page."},actions:[{label:"View All Assets",icon:"💼",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"wallets"}))},{label:"Send Tokens",icon:"📤",style:"secondary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"wallets"}))}]}}}catch(t){return{content:`I had trouble connecting to the XRPL network to fetch your wallet assets. ${t.message||"Unknown error"}

Please try again in a moment or visit the Wallets page directly.`,data:{actions:[{label:"Go to Wallets",icon:"💼",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"wallets"}))},{label:"Try Again",icon:"🔄",style:"secondary",onClick:()=>window.dispatchEvent(new CustomEvent("sendAIMessage",{detail:"show my wallet assets"}))}]}}}}async handleTokenStats(){try{const{data:t,error:s}=await S.from("meme_tokens").select("*").eq("status","active").order("created_at",{ascending:!1}).limit(5);if(s)throw s;const{count:a}=await S.from("meme_tokens").select("*",{count:"exact",head:!0}).eq("status","active");return{content:"Here are the latest token statistics:",data:{card:{icon:"📊",title:"Token Statistics",badge:"Real-time",items:[{label:"Total Tokens",value:`${a||0}`},{label:"Recent Tokens",value:`${(t==null?void 0:t.length)||0} new`},{label:"Network",value:"XRPL Mainnet"}]},table:{headers:["Token","Symbol","Created"],rows:(t==null?void 0:t.slice(0,5).map(n=>[n.token_name||"Unknown",n.currency_code||"N/A",new Date(n.created_at).toLocaleDateString()]))||[]},actions:[{label:"View All Tokens",icon:"📋",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"mytokens"}))},{label:"Create Token",icon:"✨",style:"secondary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"memes"}))}]}}}catch{return{content:"I had trouble fetching token statistics. Please try again.",data:null}}}async handleMarketCapQuery(t){try{const s=t.match(/(?:market cap|marketcap|mcap).*?(?:for|of|on)\s+([A-Z]{2,10})/i);if(s){const i=s[1].toUpperCase();return await this.getDetailedTokenInfo(i)}const a=t.match(/\b([A-Z]{3,10})\b/);if(a){const i=a[1];return await this.getDetailedTokenInfo(i)}const n=await Hs.getMarketCapRankings(10);if(!n||n.length===0)return{content:"No market cap data available yet.",data:null};const l=n.reduce((i,o)=>i+o.marketCap,0);return{content:"Here are tokens ranked by market cap (from cache):",data:{card:{icon:"💰",title:"Market Cap Rankings",badge:"Top Tokens",items:[{label:"Total Tokens",value:`${n.length}`},{label:"Total Market Cap",value:`${l.toFixed(2)} XRP`},{label:"Cache Status",value:n[0].cacheStatus==="valid"?"✅ Fresh":"⚠️ Updating"}]},table:{headers:["Rank","Token","Market Cap","Price","24h Change"],rows:n.map((i,o)=>[`#${o+1}`,`${i.token_name} (${i.currency_code})`,`${i.marketCap.toFixed(2)} XRP`,`${i.currentPrice.toFixed(8)} XRP`,i.priceChange24h?`${i.priceChange24h>0?"+":""}${i.priceChange24h.toFixed(2)}%`:"N/A"])},actions:[{label:"View Top 10",icon:"👑",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"top10"}))}]}}}catch{return{content:"I had trouble fetching market cap data. Please try again.",data:null}}}async handleVolumeQuery(){try{const t=await Hs.getVolumeLeaders(10);return!t||t.length===0?{content:"No volume data available yet.",data:null}:{content:"Here are the top tokens by 24h trading volume (from cache):",data:{card:{icon:"📊",title:"24h Trading Volume",badge:"Last 24 Hours",items:[{label:"Total Volume",value:`${t.reduce((a,n)=>a+n.volume24h,0).toFixed(2)} XRP`},{label:"Top Tokens",value:`${t.length}`},{label:"Cache Status",value:t[0].cacheStatus==="valid"?"✅ Fresh":"⚠️ Updating"}]},table:{headers:["Token","24h Volume","Price","24h Change"],rows:t.map(a=>[`${a.token_name} (${a.currency_code})`,`${a.volume24h.toFixed(2)} XRP`,`${a.currentPrice.toFixed(8)} XRP`,a.priceChange24h?`${a.priceChange24h>0?"+":""}${a.priceChange24h.toFixed(2)}%`:"N/A"])},actions:[{label:"View Trade History",icon:"📈",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"activity"}))}]}}}catch{return{content:"I had trouble fetching volume data. Please try again.",data:null}}}async handleHoldersQuery(t){try{const s=t.match(/(?:holder|holds|ownership).*?([A-Z]{3,10})/i),a=s?s[1].toUpperCase():null;if(!a)return{content:'Please specify which token you want to check holders for. Example: "Who holds ORANGE?" or "Show holders for KOOL"',data:null};const n=await Hs.getTokenHolders(a,10);return n?!n.holders||n.holders.length===0?{content:`No holder data available yet for ${n.token.token_name} (${a}). Holder data is updated periodically.`,data:{card:{icon:"👥",title:`${n.token.token_name} (${a})`,badge:"No Data",items:[{label:"Status",value:"Holder data not yet available"},{label:"Total Supply",value:n.token.supply?parseFloat(n.token.supply).toLocaleString():"N/A"}]}}}:{content:`Here are the top holders of ${n.token.token_name} (${a}) (from cache):`,data:{card:{icon:"👥",title:`${n.token.token_name} Holders`,badge:`${n.totalHolders} Holders`,items:[{label:"Total Holders",value:`${n.totalHolders}`},{label:"Total Balance",value:n.totalBalance.toLocaleString()},{label:"Total Supply",value:n.token.supply?parseFloat(n.token.supply).toLocaleString():"N/A"},{label:"Cache Status",value:n.cacheStatus==="valid"?"✅ Fresh":"⚠️ Updating"}]},table:{headers:["Rank","Address","Balance","% of Supply"],rows:n.holders.map((l,i)=>{var o,c;return[`#${i+1}`,`${(o=l.wallet_address)==null?void 0:o.slice(0,8)}...${(c=l.wallet_address)==null?void 0:c.slice(-6)}`,parseFloat(l.balance).toLocaleString(),`${(parseFloat(l.balance)/parseFloat(n.token.supply)*100).toFixed(2)}%`]})},actions:[{label:"Trade This Token",icon:"💱",style:"primary",onClick:()=>{window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"trade"})),setTimeout(()=>{window.dispatchEvent(new CustomEvent("selectToken",{detail:n.token}))},100)}}]}}:{content:`Token "${a}" not found.`,data:null}}catch{return{content:"I had trouble fetching holder data. Please try again.",data:null}}}async handleBotQuery(){try{const{data:t,error:s}=await S.from("trading_bots").select("*").order("created_at",{ascending:!1}).limit(5);if(s)throw s;if(!t||t.length===0)return{content:"You don't have any trading bots yet. Create your first bot to automate your trading!",data:{actions:[{label:"Create Trading Bot",icon:"🤖",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"bottrader"}))}]}};const a=t.filter(l=>l.status==="active").length,n=t.reduce((l,i)=>l+(i.total_trades||0),0);return{content:"Here is your trading bot overview:",data:{card:{icon:"🤖",title:"Trading Bots",badge:`${a} Active`,items:[{label:"Total Bots",value:`${t.length}`},{label:"Active Bots",value:`${a}`},{label:"Total Trades",value:`${n}`}]},table:{headers:["Bot","Status","Strategy","Trades"],rows:t.slice(0,5).map(l=>[l.name||"Unnamed Bot",l.status||"Unknown",l.strategy||"N/A",`${l.total_trades||0}`])},actions:[{label:"Manage Bots",icon:"⚙️",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"bottrader"}))}]}}}catch{return{content:"I had trouble fetching bot information. Please try again.",data:null}}}async handleBuyToken(){if(!this.context.connectedWallet)return{content:"Please connect a wallet to buy tokens.",data:{actions:[{label:"Connect Wallet",icon:"🔗",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"wallets"}))}]}};const{data:t}=await S.from("meme_tokens").select("id, token_name, currency_code, issuer_address").eq("amm_pool_created",!0).order("token_name",{ascending:!0}).limit(200);return{content:"Let's buy some tokens! I'll guide you through the process step by step.",data:{execution:{type:"buy_token",icon:"🛒",title:"Buy Token",description:"Purchase tokens using XRP",badge:"Trade",fields:[{name:"tokenId",label:"Select Token",type:"select",required:!0,options:(t==null?void 0:t.map(s=>({value:s.id,label:`${s.token_name} (${s.currency_code})`})))||[],hint:"Choose which token to buy"},{name:"amountXRP",label:"Amount to Spend (XRP)",type:"number",placeholder:"100",required:!0,hint:"Amount of XRP to spend"},{name:"slippage",label:"Slippage Tolerance (%)",type:"number",placeholder:"2",required:!0,hint:"Maximum price slippage allowed"}],steps:[{label:"Select token",description:"Choose token to purchase"},{label:"Create offer",description:"Preparing buy order on XRPL"},{label:"Sign transaction",description:"Signing with wallet"},{label:"Submit order",description:"Submitting to ledger"},{label:"Confirm purchase",description:"Waiting for confirmation"}],defaultValues:{amountXRP:"100",slippage:"2"}}}}}async handleSellToken(){if(!this.context.connectedWallet)return{content:"Please connect a wallet to sell tokens.",data:{actions:[{label:"Connect Wallet",icon:"🔗",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"wallets"}))}]}};const{data:t}=await S.from("meme_tokens").select("id, token_name, currency_code, issuer_address").eq("amm_pool_created",!0).order("token_name",{ascending:!0}).limit(200);return{content:"Ready to sell tokens! I'll help you create a sell order.",data:{execution:{type:"sell_token",icon:"💸",title:"Sell Token",description:"Sell tokens for XRP",badge:"Trade",fields:[{name:"tokenId",label:"Select Token",type:"select",required:!0,options:(t==null?void 0:t.map(s=>({value:s.id,label:`${s.token_name} (${s.currency_code})`})))||[],hint:"Choose which token to sell"},{name:"amountToken",label:"Amount to Sell",type:"number",placeholder:"1000",required:!0,hint:"Amount of tokens to sell"},{name:"minXRP",label:"Minimum XRP to Receive",type:"number",placeholder:"50",required:!0,hint:"Minimum XRP you want to receive"}],steps:[{label:"Validate holdings",description:"Checking token balance"},{label:"Create sell order",description:"Preparing sell order"},{label:"Sign transaction",description:"Signing with wallet"},{label:"Submit order",description:"Submitting to ledger"},{label:"Confirm sale",description:"Waiting for confirmation"}],defaultValues:{amountToken:"1000",minXRP:"50"}}}}}async handleCreateBot(){if(!this.context.connectedWallet)return{content:"Please connect a wallet to create a trading bot.",data:{actions:[{label:"Connect Wallet",icon:"🔗",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"wallets"}))}]}};const{data:t}=await S.from("meme_tokens").select("id, token_name, currency_code").eq("status","active").limit(50);return{content:"Let's create an automated trading bot! I'll set it up for you.",data:{execution:{type:"create_bot",icon:"🤖",title:"Create Trading Bot",description:"Automate your token trading",badge:"Automation",fields:[{name:"name",label:"Bot Name",type:"text",placeholder:"My Trading Bot",required:!0,hint:"Give your bot a name"},{name:"tokenId",label:"Token to Trade",type:"select",required:!0,options:(t==null?void 0:t.map(s=>({value:s.id,label:`${s.token_name} (${s.currency_code})`})))||[],hint:"Which token should the bot trade"},{name:"strategy",label:"Trading Strategy",type:"select",required:!0,options:[{value:"dca",label:"Dollar Cost Averaging (DCA)"},{value:"momentum",label:"Momentum Trading"},{value:"scalping",label:"Scalping"}],hint:"Choose trading strategy"},{name:"buyAmount",label:"Buy Amount (XRP)",type:"number",placeholder:"50",required:!0,hint:"Amount to spend per trade"},{name:"buyThreshold",label:"Buy Threshold (%)",type:"number",placeholder:"-5",required:!0,hint:"Buy when price drops by this %"},{name:"sellThreshold",label:"Sell Threshold (%)",type:"number",placeholder:"10",required:!0,hint:"Sell when price rises by this %"}],steps:[{label:"Validate settings",description:"Checking bot configuration"},{label:"Create bot",description:"Setting up trading bot"},{label:"Configure strategy",description:"Applying trading rules"},{label:"Activate bot",description:"Starting automated trading"}],defaultValues:{name:"Trading Bot",strategy:"dca",buyAmount:"50",buyThreshold:"-5",sellThreshold:"10"}}}}}async handleAddressBook(){if(!this.context.connectedWallet)return{content:"Please connect a wallet to view your address book.",data:{actions:[{label:"Connect Wallet",icon:"🔗",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"wallets"}))}]}};try{const{data:t,error:s}=await S.from("address_book").select("*").eq("wallet_address",this.context.connectedWallet.address).order("is_favorite",{ascending:!1}).order("name",{ascending:!0});if(s)throw s;const a=(t==null?void 0:t.filter(n=>n.is_favorite).length)||0;return{content:`Here is your address book with ${(t==null?void 0:t.length)||0} saved contacts:`,data:{card:{icon:"📇",title:"Address Book",badge:`${(t==null?void 0:t.length)||0} Contacts`,items:[{label:"Total Contacts",value:`${(t==null?void 0:t.length)||0}`},{label:"Favorites",value:`${a}`}]},table:{headers:["Name","Address","Notes"],rows:(t==null?void 0:t.slice(0,10).map(n=>[n.is_favorite?`⭐ ${n.name}`:n.name,`${n.address.slice(0,20)}...`,n.notes||"No notes"]))||[]},actions:[{label:"Send to Contact",icon:"📤",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("sendAIMessage",{detail:"send tokens"}))}]}}}catch{return{content:"I had trouble loading your address book. You can add contacts when sending tokens!",data:null}}}handleGeneral(t){const s=t.toLowerCase();return s.includes("create")&&s.includes("token")?{content:"I cannot create tokens through the chat. Token creation requires admin access and must be done through the Memes page of the platform.",data:{actions:[{label:"Go to Memes Page",icon:"🎨",style:"primary",onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"memes"}))}]}}:s.includes("admin")||s.includes("settings")||s.includes("configure")?{content:`I don't have access to administrative functions or platform settings. I can only help with:

• Wallet operations (balance, send, receive)
• Token trading (buy/sell)
• Market information
• Address book management
• Trading bot creation

What would you like help with?`,data:null}:!t||t.length<3?{content:`I'm not sure I understand. Could you please provide more details about what you'd like to do?

For example, you can ask me to:
• "Send 10 XRP to an address"
• "Buy some tokens"
• "Check my balance"
• "Show my address book"
• "What are the top tokens?"

What would you like help with?`,data:null}:{content:`I'm not sure what you're asking for. I can help you with:

• Wallet Operations: Check balance, send/receive XRP and tokens
• Trading: Buy and sell tokens from the platform
• Address Book: Manage saved contacts for easy sending
• Market Data: View prices, volumes, and analytics
• Trading Bots: Create automated trading strategies

Note: I cannot create tokens or access admin functions.

Try one of these:`,data:{quickActions:["Check my balance","Send XRP","Send custom token","Buy token","Sell token","Show address book"].map(n=>({label:n,onClick:()=>{const l=new CustomEvent("sendAIMessage",{detail:n});window.dispatchEvent(l)}}))}}}}function xh({isOpen:r,onClose:t}){const[s,a]=m.useState([]),[n,l]=m.useState(""),[i,o]=m.useState(!1),[c,d]=m.useState(null),u=m.useRef(null),h=m.useRef(new Ro),g=m.useRef(null);m.useEffect(()=>{r&&(f(),w())},[r]),m.useEffect(()=>{y()},[s,i]);const y=()=>{setTimeout(()=>{var E;(E=u.current)==null||E.scrollIntoView({behavior:"smooth",block:"end"})},100)},f=()=>{const E=localStorage.getItem("ai_chat_session");if(E)d(E);else{const G=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;d(G),localStorage.setItem("ai_chat_session",G)}},w=async()=>{try{const{data:E,error:G}=await S.from("ai_chat_messages").select("*").order("created_at",{ascending:!0}).limit(20);if(G)throw G;E&&E.length>0?a(E.map(_e=>({id:_e.id,role:_e.role,content:_e.content,timestamp:new Date(_e.created_at),data:_e.metadata}))):b()}catch{b()}},b=()=>{const E={id:`welcome_${Date.now()}`,role:"assistant",content:`👋 Quick AI Assistant ready! Try:
• "BUY 1000 ORANGE"
• "SELL 500 BANANA"
• "CHECK BALANCE"
• "PRICE OF APPLE"`,timestamp:new Date,data:null};a([E])},P=async E=>{try{await S.from("ai_chat_messages").insert({session_id:c,role:E.role,content:E.content,metadata:E.data||null})}catch{}},A=async E=>{if(!E.trim())return;const G={id:`user_${Date.now()}`,role:"user",content:E,timestamp:new Date,data:null};a(_e=>[..._e,G]),await P(G),l(""),o(!0),g.current&&(g.current.style.height="auto");try{const _e=new Promise((ue,J)=>setTimeout(()=>J(new Error("Request timed out after 30 seconds")),3e4)),ge=await Promise.race([h.current.processMessage(E),_e]),Ce={id:`assistant_${Date.now()}`,role:"assistant",content:ge.content,timestamp:new Date,data:ge.data||null};a(ue=>[...ue,Ce]),await P(Ce)}catch(_e){const ge={id:`error_${Date.now()}`,role:"assistant",content:`Error: ${_e.message||"Something went wrong"}. Please try again or check your wallet connection.`,timestamp:new Date,data:null};a(Ce=>[...Ce,ge]),await P(ge)}finally{o(!1)}},_=E=>{E.preventDefault(),A(n.trim())},W=E=>{E.key==="Enter"&&!E.shiftKey&&(E.preventDefault(),_(E))},D=E=>{l(E.target.value),E.target.style.height="auto",E.target.style.height=Math.min(E.target.scrollHeight,100)+"px"},I=[{label:"💰 Balance",command:"CHECK BALANCE"},{label:"💱 Buy",command:"I want to buy tokens"},{label:"💸 Sell",command:"I want to sell tokens"}];return r?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fadeIn",children:e.jsxs("div",{className:"relative w-full max-w-2xl bg-gradient-to-br from-purple-900/95 to-purple-800/95 rounded-xl border border-purple-500/50 shadow-2xl shadow-purple-500/30 flex flex-col animate-slideUp",style:{maxHeight:"90vh"},children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-purple-500/30 bg-purple-900/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-blue-600 rounded-lg flex items-center justify-center animate-pulse",children:e.jsx("span",{className:"text-2xl",children:"🤖"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:"AI Trading Assistant"}),e.jsx("p",{className:"text-purple-300/80 text-xs",children:"Execute commands instantly"})]})]}),e.jsx("button",{onClick:t,className:"w-8 h-8 flex items-center justify-center rounded-lg bg-purple-800/40 hover:bg-purple-800/60 text-purple-200 hover:text-white transition-all duration-200 border border-purple-500/30",children:"✕"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",style:{minHeight:0,maxHeight:"60vh"},children:[s.map((E,G)=>e.jsx("div",{className:"animate-fadeInUp",style:{animationDelay:`${G*30}ms`},children:e.jsx(Ao,{message:E})},E.id)),i&&e.jsxs("div",{className:"flex items-start gap-3 animate-fadeInUp",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-purple-500 to-blue-600 rounded-full flex items-center justify-center flex-shrink-0 animate-pulse",children:e.jsx("span",{className:"text-sm",children:"🤖"})}),e.jsx("div",{className:"flex-1 bg-purple-900/30 rounded-lg p-3 border border-purple-500/20",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})]}),e.jsx("div",{ref:u})]}),e.jsxs("div",{className:"p-4 border-t border-purple-500/30 bg-purple-900/50 space-y-3",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:I.map((E,G)=>e.jsx("button",{onClick:()=>A(E.command),disabled:i,className:"px-3 py-1.5 bg-purple-800/40 hover:bg-purple-800/60 text-purple-200 hover:text-white rounded-full text-xs font-medium transition-all duration-200 border border-purple-500/30 disabled:opacity-50 disabled:cursor-not-allowed hover:scale-105",children:E.label},G))}),e.jsxs("form",{onSubmit:_,className:"flex gap-2",children:[e.jsx("textarea",{ref:g,value:n,onChange:D,onKeyDown:W,placeholder:"Type command: BUY 1000 ORANGE, CHECK BALANCE...",disabled:i,rows:"1",className:"flex-1 bg-purple-900/40 border border-purple-500/40 rounded-lg px-4 py-2.5 text-white placeholder-purple-400/60 focus:outline-none focus:border-purple-500/60 focus:ring-2 focus:ring-purple-500/30 disabled:opacity-50 disabled:cursor-not-allowed resize-none overflow-hidden transition-all duration-200 text-sm",style:{minHeight:"42px",maxHeight:"100px"}}),e.jsxs("button",{type:"submit",disabled:i||!n.trim(),className:"px-5 bg-gradient-to-r from-purple-600 to-blue-600 hover:shadow-lg hover:shadow-purple-500/50 text-white rounded-lg font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:shadow-none hover:scale-105",children:[e.jsx("span",{className:"hidden sm:inline",children:"Send"}),e.jsx("span",{className:"sm:hidden",children:"➤"})]})]}),e.jsx("div",{className:"text-center text-xs text-purple-400/60",children:"Press Enter to send • Shift+Enter for new line"})]})]})}):null}const _r=Ta,ba=r=>{const t=parseFloat(r);if(isNaN(t)||t<=0)throw new Error("Invalid XRP amount");if(t>1e11)throw new Error("XRP amount too large");if(t<1e-6)throw new Error("XRP amount too small (minimum 0.000001)");const s=Math.floor(t*1e6)/1e6;return parseFloat(s.toFixed(6))},kn=r=>{const t=parseFloat(r);if(isNaN(t)||t<=0)throw new Error("Invalid token amount");return t.toFixed(6)};function fh({preselectedToken:r=null}){const[t,s]=m.useState([]),[a,n]=m.useState(null),[l,i]=m.useState("buy"),[o,c]=m.useState(""),[d,u]=m.useState(""),[h,g]=m.useState(null),[y,f]=m.useState(!1),[w,b]=m.useState(!1),[P,A]=m.useState(!1),[_,W]=m.useState(!1),[D,I]=m.useState("0"),[E,G]=m.useState(0),[_e,ge]=m.useState(!1),[Ce,ue]=m.useState("area"),[J,se]=m.useState("15m"),[F,X]=m.useState(null),[me,ve]=m.useState(0),[He,pe]=m.useState(0),[xe,le]=m.useState(!1),[$e,Ne]=m.useState("0.5"),[q,ee]=m.useState("amm"),[L,re]=m.useState([]),[B,Y]=m.useState(0),[oe,ie]=m.useState(!1),[ye,te]=m.useState(""),[U,ke]=m.useState(!1),[he,Oe]=m.useState(null),[$,be]=m.useState(!1),[We,tt]=m.useState(!1),[nt,M]=m.useState(!1),[fe,K]=m.useState(null),[v,p]=m.useState(!1),[x,R]=m.useState([]),[H,z]=m.useState(!1),[ae,qe]=m.useState(.5),[Ie,Je]=m.useState(0),[et,ze]=m.useState(null),[dt,Rt]=m.useState(null),[Tt,wt]=m.useState(!1),[Mt,ut]=m.useState(0),[jt,pt]=m.useState("select"),[lt,j]=m.useState(null),[Q,Z]=m.useState(!1),[Se,Ae]=m.useState(!1),de=m.useRef(null),[Pe,Ve]=m.useState("both"),[Ye,Le]=m.useState(""),[at,T]=m.useState(!1),[ne,Fe]=m.useState(""),[Xe,st]=m.useState(""),[gt,Qe]=m.useState(!1);m.useState(!1);const[ot,yt]=m.useState("both"),[Nt,xt]=m.useState(!1),[Ge,kt]=m.useState(null),bt=m.useRef(null),St=m.useRef(null),Ct=m.useRef(null),_t=m.useRef(null),Gt=m.useRef(null),fs=m.useRef(null),$t=m.useRef([]),Qt=m.useRef(null);m.useEffect(()=>{bs(),Bt(),Cs();const C=la(()=>{bs()}),V=()=>{Bt()};return window.addEventListener("walletConnected",V),window.addEventListener("walletDisconnected",V),()=>{C(),window.removeEventListener("walletConnected",V),window.removeEventListener("walletDisconnected",V)}},[]),m.useEffect(()=>{if(r&&t.length>0&&!a){const C=t.find(V=>V.id===r.id);C&&n(C)}},[r,t,a]),m.useEffect(()=>{a&&gs()},[a,ae]),m.useEffect(()=>(a&&bt.current&&St.current&&it(),a&&h&&(Bs(),dr()),a&&(de.current&&clearTimeout(de.current),de.current=setTimeout(()=>{rs()},300)),()=>{Te(),de.current&&clearTimeout(de.current)}),[a,h]),m.useEffect(()=>(a&&bt.current&&St.current&&it(),()=>{Te()}),[Ce]),m.useEffect(()=>(a&&bt.current&&St.current&&it(),()=>{Te()}),[J]),m.useEffect(()=>{ss()},[o,d,$e,l,F]),m.useEffect(()=>{if(!a)return;let C=!0;const V=async()=>{var je;if(C)try{const De=new Re.Client("wss://xrplcluster.com");if(await De.connect(),!C){await De.disconnect();return}const Ee=a.currency_code.length>3?vt.Buffer.from(a.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):a.currency_code,Me=await De.request({command:"amm_info",asset:{currency:"XRP"},asset2:{currency:Ee,issuer:a.issuer_address},ledger_index:"validated"});if(await De.disconnect(),C&&((je=Me==null?void 0:Me.result)!=null&&je.amm)){const Ze=Me.result.amm,Be=parseFloat(Ze.amount)/1e6,Ke=parseFloat(Ze.amount2.value),rt=Be/Ke;if(ve(rt),a.amm_xrp_amount&&a.amm_asset_amount){const mt=a.amm_xrp_amount/a.amm_asset_amount,It=(rt-mt)/mt*100;pe(It)}}}catch{}};V();const ce=setInterval(()=>{C&&V()},15e3);return()=>{C=!1,clearInterval(ce)}},[a]);const Bt=async()=>{const C=localStorage.getItem("connectedWallet");if(C){const V=JSON.parse(C);if(!V.seed&&V.id)try{const{data:ce,error:je}=await S.from("wallets").select("*").eq("id",V.id).maybeSingle();if(ce){const De={...ce,seed:ce.encrypted_seed||ce.seed};localStorage.setItem("connectedWallet",JSON.stringify(De)),g(De);return}}catch{}g(V)}else g(null)},Cs=async()=>{var C;try{const ce=await(await fetch("https://api.coingecko.com/api/v3/simple/price?ids=ripple&vs_currencies=usd")).json();qe(((C=ce.ripple)==null?void 0:C.usd)||.5)}catch{qe(.5)}},gs=()=>{if(!a||!a.total_supply){Je(0);return}const C=Xt(a),V=parseFloat(a.total_supply),je=C*V*ae;Je(je)},bs=async()=>{try{const{data:C,error:V}=await S.from("meme_tokens").select("*").eq("amm_pool_created",!0).order("created_at",{ascending:!1});if(V)throw V;s(C||[]);const ce=localStorage.getItem("selectedTradeToken");if(ce)try{const je=JSON.parse(ce),De=C==null?void 0:C.find(Ee=>Ee.id===je.id||Ee.currency_code===je.currency_code&&Ee.issuer_address===je.issuer_address);if(De){n(De),localStorage.removeItem("selectedTradeToken");return}}catch{}C&&C.length>0&&!a&&n(C[0])}catch{}},Xt=C=>!C||!C.amm_xrp_amount||!C.amm_asset_amount?0:C.amm_xrp_amount/C.amm_asset_amount,Ut=C=>{if(!C||!C.amm_xrp_amount||!C.amm_asset_amount)return 0;const V=C.amm_xrp_amount/C.amm_asset_amount;return C.supply*V},Ts=()=>{if(!a)return[];try{const C=me>0?me:Xt(a);if(!C||isNaN(C)||C<=0)return[];const V=[],ce=Math.floor(Date.now()/1e3),je=48;for(let De=je;De>=0;De--){const Ee=ce-De*3600,Me=(Math.random()-.5)*.3,Ze=(je-De)/je*.15,Be=C*(1+Me+Ze);V.push({time:Ee,value:Be,open:Be*.98,high:Be*1.03,low:Be*.97,close:Be,volume:Math.random()*1e4+1e3})}return $t.current=V,V}catch{return[]}},O=()=>{Te(),!(!a||!Gt.current)&&(Qt.current=setInterval(()=>{Ue()},5e3))},Te=()=>{Qt.current&&(clearInterval(Qt.current),Qt.current=null)},Ue=async()=>{var C;if(!(!a||!Gt.current||$t.current.length===0))try{const{requestWithRetry:V}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),ce=await V({command:"amm_info",asset:{currency:"XRP"},asset2:{currency:a.currency_code,issuer:a.issuer_address},ledger_index:"validated"});if(!ce.result.amm)return;const je=ce.result.amm,De=parseFloat(je.amount)/1e6,Ee=parseFloat(je.amount2.value),Me=De/Ee;if(ve(Me),kt(Date.now()),!Gt.current||$t.current.length===0)return;const Ze=$t.current[$t.current.length-1],Be=Math.floor(Date.now()/1e3);if(Be-Ze.time>=60){const Ke={time:Be,value:Me,open:Ze.close||Me,high:Math.max(Me,Ze.close||Me),low:Math.min(Me,Ze.close||Me),close:Me,volume:Math.abs(De-(((C=$t.current[$t.current.length-2])==null?void 0:C.volume)||0))};$t.current.push(Ke),$t.current.length>500&&$t.current.shift();try{Ce==="area"||Ce==="line"||Ce==="baseline"?Gt.current.update({time:Ke.time,value:Ke.value}):Gt.current.update({time:Ke.time,open:Ke.open,high:Ke.high,low:Ke.low,close:Ke.close}),fs.current&&fs.current.update({time:Ke.time,value:Ke.volume,color:Ke.close>=Ke.open?"rgba(34, 197, 94, 0.5)":"rgba(239, 68, 68, 0.5)"})}catch{}}else{const Ke={...Ze,value:Me,close:Me,high:Math.max(Ze.high,Me),low:Math.min(Ze.low,Me)};$t.current[$t.current.length-1]=Ke;try{Ce==="area"||Ce==="line"||Ce==="baseline"?Gt.current.update({time:Ke.time,value:Ke.value}):Gt.current.update({time:Ke.time,open:Ke.open,high:Ke.high,low:Ke.low,close:Ke.close})}catch{}}}catch{}},it=()=>{if(!(!bt.current||!St.current||!a))try{if(Ct.current){try{Ct.current.remove()}catch{}Ct.current=null}if(_t.current){try{_t.current.remove()}catch{}_t.current=null}bt.current&&(bt.current.innerHTML=""),St.current&&(St.current.innerHTML="");const C=Er(bt.current,{width:bt.current.clientWidth,height:500,layout:{background:{color:"transparent"},textColor:"#a78bfa"},grid:{vertLines:{color:"rgba(139, 92, 246, 0.1)"},horzLines:{color:"rgba(139, 92, 246, 0.1)"}},rightPriceScale:{borderColor:"rgba(139, 92, 246, 0.3)",scaleMargins:{top:.1,bottom:.1},minimumWidth:window.innerWidth<640?70:80},timeScale:{borderColor:"rgba(139, 92, 246, 0.3)",timeVisible:!0,secondsVisible:!1,visible:!1},handleScale:{axisPressedMouseMove:{time:!0,price:!0}}});Ct.current=C;const V=Ts();if(!V||V.length===0)throw new Error("Unable to generate chart data. Please check token configuration.");let ce;const je={type:"price",precision:8,minMove:1e-8};switch(Ce){case"bars":ce=C.addBarSeries({upColor:"#22c55e",downColor:"#ef4444",priceFormat:je}),ce.setData(V.map(Be=>({time:Be.time,open:Be.open,high:Be.high,low:Be.low,close:Be.close})));break;case"candlestick":ce=C.addCandlestickSeries({upColor:"#22c55e",downColor:"#ef4444",borderVisible:!1,wickUpColor:"#22c55e",wickDownColor:"#ef4444",priceFormat:je}),ce.setData(V.map(Be=>({time:Be.time,open:Be.open,high:Be.high,low:Be.low,close:Be.close})));break;case"hollow":ce=C.addCandlestickSeries({upColor:"transparent",downColor:"#ef4444",borderUpColor:"#22c55e",borderDownColor:"#ef4444",wickUpColor:"#22c55e",wickDownColor:"#ef4444",priceFormat:je}),ce.setData(V.map(Be=>({time:Be.time,open:Be.open,high:Be.high,low:Be.low,close:Be.close})));break;case"line":ce=C.addLineSeries({color:"#8b5cf6",lineWidth:2,priceFormat:je}),ce.setData(V.map(Be=>({time:Be.time,value:Be.close})));break;case"area":ce=C.addAreaSeries({topColor:"rgba(139, 92, 246, 0.4)",bottomColor:"rgba(139, 92, 246, 0.0)",lineColor:"#8b5cf6",lineWidth:2,priceFormat:je}),ce.setData(V.map(Be=>({time:Be.time,value:Be.close})));break;case"baseline":ce=C.addBaselineSeries({topLineColor:"#22c55e",topFillColor1:"rgba(34, 197, 94, 0.4)",topFillColor2:"rgba(34, 197, 94, 0.0)",bottomLineColor:"#ef4444",bottomFillColor1:"rgba(239, 68, 68, 0.0)",bottomFillColor2:"rgba(239, 68, 68, 0.4)",priceFormat:je}),ce.setData(V.map(Be=>({time:Be.time,value:Be.close})));break;case"heikin":ce=C.addCandlestickSeries({upColor:"#22c55e",downColor:"#ef4444",borderVisible:!1,wickUpColor:"#22c55e",wickDownColor:"#ef4444",priceFormat:je});const Ze=V.map((Be,Ke)=>{if(Ke===0)return Be;const rt=V[Ke-1],mt=(Be.open+Be.high+Be.low+Be.close)/4,It=(rt.open+rt.close)/2,Ot=Math.max(Be.high,It,mt),At=Math.min(Be.low,It,mt);return{time:Be.time,open:It,high:Ot,low:At,close:mt}});ce.setData(Ze);break;default:ce=C.addCandlestickSeries({upColor:"#22c55e",downColor:"#ef4444",borderVisible:!1,wickUpColor:"#22c55e",wickDownColor:"#ef4444",priceFormat:je}),ce.setData(V.map(Be=>({time:Be.time,open:Be.open,high:Be.high,low:Be.low,close:Be.close})))}Gt.current=ce;const De=Er(St.current,{width:St.current.clientWidth,height:120,layout:{background:{color:"transparent"},textColor:"#a78bfa"},grid:{vertLines:{color:"rgba(139, 92, 246, 0.1)"},horzLines:{color:"rgba(139, 92, 246, 0.1)"}},rightPriceScale:{borderColor:"rgba(139, 92, 246, 0.3)",scaleMargins:{top:.1,bottom:.1},minimumWidth:window.innerWidth<640?70:80},timeScale:{borderColor:"rgba(139, 92, 246, 0.3)",timeVisible:!0,secondsVisible:!1}});_t.current=De;const Ee=De.addHistogramSeries({color:"#8b5cf6",priceFormat:{type:"volume"}});Ee.setData(V.map(Ze=>({time:Ze.time,value:Ze.volume,color:Ze.close>=Ze.open?"rgba(34, 197, 94, 0.5)":"rgba(239, 68, 68, 0.5)"}))),fs.current=Ee,C.timeScale().fitContent(),De.timeScale().fitContent(),C.timeScale().subscribeVisibleTimeRangeChange(()=>{const Ze=C.timeScale().getVisibleRange();Ze&&De.timeScale().setVisibleRange(Ze)});const Me=()=>{Ct.current&&bt.current&&Ct.current.applyOptions({width:bt.current.clientWidth}),_t.current&&St.current&&_t.current.applyOptions({width:St.current.clientWidth})};window.addEventListener("resize",Me),setTimeout(()=>{O()},100)}catch{if(k.error("Failed to render chart. Please refresh the page."),Ct.current){try{Ct.current.remove()}catch{}Ct.current=null}if(_t.current){try{_t.current.remove()}catch{}_t.current=null}}},Et=()=>{if(!a||!o||isNaN(o))return{tokenAmount:0,xrpAmount:0,priceImpact:0,fee:0};const C=me>0?me:Xt(a);if(!C||C===0)return{tokenAmount:0,xrpAmount:0,priceImpact:0,fee:0};if(l==="buy"){const V=parseFloat(o),ce=V/C,je=a.amm_xrp_amount>0?V/a.amm_xrp_amount*100:0;return{tokenAmount:ce.toFixed(4),xrpAmount:V.toFixed(4),priceImpact:je.toFixed(2),fee:_r.toFixed(2)}}else{const V=parseFloat(o),ce=V*C,je=a.amm_asset_amount>0?V/a.amm_asset_amount*100:0;return{tokenAmount:V.toFixed(4),xrpAmount:ce.toFixed(4),priceImpact:je.toFixed(2),fee:_r.toFixed(2)}}},ss=()=>{if(!F||!o||!d){te("");return}const C=Et();if(!C){te("");return}F.liquidity;const V=parseFloat(C.priceImpact),ce=parseFloat($e);let je=.5;V>10?je=Math.max(15,V*1.5):V>5?je=Math.max(10,V*1.3):V>2?je=Math.max(5,V*1.2):V>1?je=3:V>.5&&(je=1),ce<je?te(`⚠️ Low slippage detected. Recommended: ${je.toFixed(1)}% (Price Impact: ${V}%)`):te("")},rs=async(C=!1)=>{var V;if(a)try{le(!0);const{data:ce}=await S.from("pool_data_cache").select("*").eq("token_id",a.id).gte("last_updated",new Date(Date.now()-Gr.POOL_DATA).toISOString()).maybeSingle();if(!C&&ce){const Me=parseFloat(ce.xrp_amount),Ze=parseFloat(ce.token_amount),Be=parseFloat(ce.price),Ke=Be*a.supply;X({price:Be,liquidity:Me,marketCap:Ke,volume24h:parseFloat(ce.volume_24h||0)}),ve(Be),Je(Ke*ae),le(!1);return}const{requestWithRetry:je}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),De=await je({command:"amm_info",asset:{currency:"XRP"},asset2:{currency:a.currency_code,issuer:a.issuer_address},ledger_index:"validated"});let Ee=0;if(De.result.amm){const Me=De.result.amm,Ze=Me.account,Be=parseFloat(Me.amount)/1e6,Ke=parseFloat(Me.amount2.value),rt=Be/Ke,mt=rt*a.supply;Ee=Be*.15,X({marketCap:mt,liquidity:Be,volume24h:Ee,poolSize:Ke,price:rt}),ve(rt),Je(mt*ae),await S.from("pool_data_cache").upsert({token_id:a.id,xrp_amount:Be,token_amount:Ke,lp_tokens:parseFloat(((V=Me.lp_token)==null?void 0:V.value)||0),price:rt,account_id:Ze,volume_24h:Ee,price_change_24h:0,last_updated:new Date().toISOString()},{onConflict:"token_id"})}}catch{X(null)}finally{le(!1)}},Bs=async()=>{var C;if(h)try{ge(!0);const V=await Ia(h.address);if(G(V),a){const ce=await S.from("token_holdings_cache").select("*").eq("wallet_address",h.address).eq("token_id",a.id).gte("last_updated",new Date(Date.now()-Gr.BALANCE).toISOString()).maybeSingle();if(ce.data){I(ce.data.balance.toString()),f(!0),ge(!1);return}const{getClient:je,requestWithRetry:De}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),Ee=await je(),Me=await De({command:"account_lines",account:h.address,ledger_index:"validated"}),Ze=a.currency_code.length>3?vt.Buffer.from(a.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):a.currency_code,Be=(C=Me.result.lines)==null?void 0:C.find(mt=>{const It=mt.account===a.issuer_address,Ot=mt.currency===a.currency_code||mt.currency===Ze||mt.currency.toUpperCase()===Ze.toUpperCase();return It&&Ot}),Ke=Be?Be.balance:"0";I(Ke),f(Be!==void 0),await S.from("token_holdings_cache").upsert({wallet_address:h.address,token_id:a.id,balance:parseFloat(Ke),price:me||0,value:parseFloat(Ke)*(me||0),is_lp_token:!1,last_updated:new Date().toISOString(),updated_at:new Date().toISOString()},{onConflict:"wallet_address,token_id"})}else I("0"),f(!1)}catch{I("0"),f(!1)}finally{ge(!1)}},oa=async()=>{if(!a||!h||!h.seed){k.error("Wallet seed required for trustline setup");return}try{A(!0);const C=new Re.Client("wss://xrplcluster.com");await C.connect();const V=Re.Wallet.fromSeed(h.seed),ce={TransactionType:"TrustSet",Account:h.address,LimitAmount:{currency:a.currency_code,issuer:a.issuer_address,value:"1000000000"}},je=await C.autofill(ce),De=V.sign(je);(await C.submitAndWait(De.tx_blob)).result.meta.TransactionResult==="tesSUCCESS"?(k.success("Trustline established successfully!"),f(!0),Bs()):k.error("Failed to establish trustline"),await C.disconnect()}catch(C){k.error("Failed to setup trustline: "+C.message)}finally{A(!1)}},dr=async()=>{var C,V,ce;if(!a||!h){j(null);return}try{Z(!0);const je=await S.from("lp_balance_cache").select("*").eq("wallet_address",h.address).eq("token_id",a.id).gte("last_updated",new Date(Date.now()-Gr.LP_POSITION).toISOString()).maybeSingle();if(je.data&&je.data.lp_balance>0){const{getClient:At,requestWithRetry:qt}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),us=await At(),is=a.currency_code.length>3?vt.Buffer.from(a.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):a.currency_code,Es=await qt({command:"amm_info",asset:{currency:"XRP"},asset2:{currency:is,issuer:a.issuer_address},ledger_index:"validated"});if((C=Es==null?void 0:Es.result)!=null&&C.amm){const Ps=Es.result.amm,Ds=parseFloat(Ps.lp_token.value),Mr=parseFloat(je.data.lp_balance)/Ds*100,Fo=parseFloat(Ps.amount)/1e6,Io=parseFloat(Ps.amount2.value),fl=Fo*Mr/100,Lo=Io*Mr/100,Do=fl*2;j({xrp:fl.toFixed(6),tokens:Lo.toFixed(6),lpTokens:je.data.lp_balance.toString(),sharePercentage:Mr.toFixed(6),estimatedValue:Do.toFixed(6),lpTokenCurrency:Ps.lp_token.currency,lpTokenIssuer:Ps.lp_token.issuer}),Z(!1);return}}const{getClient:De,requestWithRetry:Ee}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),Me=await De(),Ze=a.currency_code.length>3?vt.Buffer.from(a.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):a.currency_code,Be=await Ee({command:"amm_info",asset:{currency:"XRP"},asset2:{currency:Ze,issuer:a.issuer_address},ledger_index:"validated"});if(!((V=Be==null?void 0:Be.result)!=null&&V.amm)){j(null),Z(!1);return}const Ke=Be.result.amm,rt=Ke.lp_token.currency,mt=Ke.lp_token.issuer,Ot=(ce=(await Ee({command:"account_lines",account:h.address,ledger_index:"validated"})).result.lines)==null?void 0:ce.find(At=>At.currency===rt&&At.account===mt);if(Ot){const At=parseFloat(Ot.balance),qt=parseFloat(Ke.lp_token.value),us=At/qt*100,is=parseFloat(Ke.amount)/1e6,Es=parseFloat(Ke.amount2.value),Ps=is*us/100,Ds=Es*us/100,Mr=Ps*2;j({xrp:Ps.toFixed(6),tokens:Ds.toFixed(6),lpTokens:At.toFixed(6),sharePercentage:us.toFixed(6),estimatedValue:Mr.toFixed(6),lpTokenCurrency:rt,lpTokenIssuer:mt}),await S.from("lp_balance_cache").upsert({wallet_address:h.address,token_id:a.id,amm_account_id:Ke.account,lp_balance:At,lp_share_percentage:us,last_updated:new Date().toISOString()},{onConflict:"wallet_address,token_id"})}else j(null),await S.from("lp_balance_cache").delete().eq("wallet_address",h.address).eq("token_id",a.id)}catch{j(null)}finally{Z(!1)}},ds=()=>{if(!lt||!Ye||isNaN(Ye))return null;const C=parseFloat(Ye),V=parseFloat(lt.lpTokens),ce=C/V,je=parseFloat(lt.xrp)*ce,De=parseFloat(lt.tokens)*ce,Ee=De*Wt,Me=je+Ee,Ze=Me*ae;return{xrpToReceive:je.toFixed(6),tokensToReceive:De.toFixed(6),tokenValueInXrp:Ee.toFixed(6),totalValueInXrp:Me.toFixed(6),totalValueInUsd:Ze.toFixed(2),networkFee:"0.00001",platformFee:_r.toFixed(2),netXrp:(je-_r).toFixed(6),estimatedTotal:Me.toFixed(6)}},ca=async()=>{if(!h||!h.seed){k.error("Wallet seed required for deposit");return}if(ot==="both"){if(!ne||!Xe||parseFloat(ne)<=0||parseFloat(Xe)<=0){k.error("Enter valid amounts for both XRP and tokens");return}}else if(ot==="xrp"){if(!ne||parseFloat(ne)<=0){k.error("Enter valid XRP amount");return}}else if(ot==="token"&&(!Xe||parseFloat(Xe)<=0)){k.error("Enter valid token amount");return}try{Qe(!0);const C=new Re.Client("wss://xrplcluster.com");await C.connect();const V=Re.Wallet.fromSeed(h.seed),ce=a.currency_code.length>3?vt.Buffer.from(a.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):a.currency_code,je={TransactionType:"AMMDeposit",Account:h.address,Asset:{currency:"XRP"},Asset2:{currency:ce,issuer:a.issuer_address}};ot==="both"?(je.Amount=Re.xrpToDrops(ne),je.Amount2={currency:ce,issuer:a.issuer_address,value:Xe},je.Flags=1048576):ot==="xrp"?(je.Amount=Re.xrpToDrops(ne),je.Flags=65536):ot==="token"&&(je.Amount2={currency:ce,issuer:a.issuer_address,value:Xe},je.Flags=131072);const De=await C.autofill(je),Ee=V.sign(De),Me=await C.submitAndWait(Ee.tx_blob,{timeout:45e3});if(Me.result.meta.TransactionResult==="tesSUCCESS"){const Ze=await Jr(C,V);k.success(Be=>e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"font-semibold",children:"Deposit Successful!"}),e.jsxs("div",{className:"text-sm",children:["Deposited ",ne," XRP and ",Xe," ",a.token_name," to pool"]}),e.jsxs("div",{className:"text-xs opacity-75",children:["Platform fee: ",_r," XRP"]}),e.jsx("div",{className:"text-xs",children:e.jsx(Ls,{type:"tx",value:Me.result.hash,network:"mainnet"})})]}),{duration:8e3,style:{background:"#065f46",color:"#d1fae5",border:"1px solid #10b981"}}),Fe(""),st(""),await dr(),await Bs()}else throw new Error(`Deposit failed: ${Me.result.meta.TransactionResult}`);await C.disconnect()}catch(C){k.error("Deposit failed: "+C.message)}finally{Qe(!1)}},ur=async()=>{if(!h||!h.seed){k.error("Wallet seed required for withdrawal");return}if(!lt){k.error("No LP position found");return}const C=ds();if(!C){k.error("Invalid withdraw amount");return}try{T(!0);const V=new Re.Client("wss://xrplcluster.com");await V.connect();const ce=Re.Wallet.fromSeed(h.seed),je=a.currency_code.length>3?vt.Buffer.from(a.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):a.currency_code,De=Math.floor(parseFloat(Ye)*1e6),Ee={TransactionType:"AMMWithdraw",Account:h.address,Asset:{currency:"XRP"},Asset2:{currency:je,issuer:a.issuer_address},LPTokenIn:{currency:lt.lpTokenCurrency,issuer:lt.lpTokenIssuer,value:Ye}};Pe==="both"?Ee.Flags=1048576:Pe==="xrp"?Ee.Flags=65536:Pe==="token"&&(Ee.Flags=131072);const Me=await V.autofill(Ee),Ze=ce.sign(Me),Be=await V.submitAndWait(Ze.tx_blob,{timeout:45e3});if(Be.result.meta.TransactionResult==="tesSUCCESS"){const Ke=await Jr(V,ce);k.success(rt=>e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"font-semibold",children:"Withdrawal Successful!"}),e.jsxs("div",{className:"text-sm",children:["Received ",C.xrpToReceive," XRP and ",C.tokensToReceive," ",a.token_name]}),e.jsxs("div",{className:"text-xs opacity-75",children:["Platform fee: ",_r," XRP"]}),e.jsx("div",{className:"text-xs",children:e.jsx(Ls,{type:"tx",value:Be.result.hash,network:"mainnet"})})]}),{duration:8e3,style:{background:"#065f46",color:"#d1fae5",border:"1px solid #10b981"}}),Le(""),await dr(),await Bs()}else throw new Error(`Withdrawal failed: ${Be.result.meta.TransactionResult}`);await V.disconnect()}catch(V){k.error("Withdrawal failed: "+V.message)}finally{T(!1)}},ys=(C,V,ce={})=>{re(je=>{const De=[...je];return V==="error"?De[C]={...De[C],error:!0,description:ce.error||De[C].description}:V==="success"&&(De[C]={...De[C],description:ce.description||De[C].description,txHash:ce.txHash}),De}),V!=="error"&&Y(C+1)},pr=async()=>{if(!h||!h.seed){k.error("Wallet seed required for trading");return}if(!y){k.error("Please setup trustline first");return}if(_&&!Tt){k.error("Trade already in progress");return}const C=Et(),ce=[{title:"Connecting to XRPL",description:"Establishing connection to the XRP Ledger network"},{title:`${l==="buy"?"Buying":"Selling"} ${a.token_name}`,description:`${l==="buy"?"Buying":"Selling"} ${C.tokenAmount} ${a.token_name} ${l==="buy"?"with":"for"} ${C.xrpAmount} XRP`},{title:"Trade Complete",description:`${l==="buy"?"Bought":"Sold"} ${a.token_name} successfully`}];re(ce),Y(0),ie(!0),W(!0);let je=null;try{ys(0,"loading"),je=new Re.Client("wss://xrplcluster.com"),await je.connect(),ys(0,"success",{description:"Connected to XRPL successfully"});const De=Re.Wallet.fromSeed(h.seed),Ee=a.currency_code.length>3?vt.Buffer.from(a.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):a.currency_code,Me=1+parseFloat($e)/100;ys(1,"loading");let Ze;if(l==="buy"){const mt=parseFloat(C.tokenAmount),It=parseFloat(C.xrpAmount)*Me;Ze={TransactionType:"Payment",Account:h.address,Destination:h.address,Amount:{currency:Ee,issuer:a.issuer_address,value:kn(mt)},SendMax:Re.xrpToDrops(ba(It).toString()),Flags:131072};try{const Ot={command:"ripple_path_find",source_account:h.address,destination_account:h.address,destination_amount:{currency:Ee,issuer:a.issuer_address,value:kn(mt)},source_currencies:[{currency:"XRP"}]},At=await je.request(Ot);if(At.result.alternatives&&At.result.alternatives.length>0){const qt=At.result.alternatives[0];qt.paths_computed&&qt.paths_computed.length>0&&(Ze.Paths=qt.paths_computed)}}catch{}}else{const mt=parseFloat(C.tokenAmount),It=parseFloat(C.xrpAmount)*(1-parseFloat($e)/100);Ze={TransactionType:"Payment",Account:h.address,Destination:h.address,Amount:Re.xrpToDrops(ba(parseFloat(C.xrpAmount)).toString()),SendMax:{currency:Ee,issuer:a.issuer_address,value:kn(mt*Me)},DeliverMin:Re.xrpToDrops(ba(It).toString()),Flags:131072};try{const Ot={command:"ripple_path_find",source_account:h.address,destination_account:h.address,destination_amount:Re.xrpToDrops(ba(parseFloat(C.xrpAmount)).toString()),source_currencies:[{currency:Ee,issuer:a.issuer_address}]},At=await je.request(Ot);if(At.result.alternatives&&At.result.alternatives.length>0){const qt=At.result.alternatives[0];qt.paths_computed&&qt.paths_computed.length>0&&(Ze.Paths=qt.paths_computed)}}catch{}}const Be=await je.autofill(Ze),Ke=De.sign(Be),rt=await je.submitAndWait(Ke.tx_blob,{timeout:45e3});if(rt.result.meta.TransactionResult==="tesSUCCESS"){let mt;l==="buy"&&rt.result.meta.delivered_amount&&typeof rt.result.meta.delivered_amount=="object"&&rt.result.meta.delivered_amount.value?mt=parseFloat(rt.result.meta.delivered_amount.value):mt=parseFloat(C.tokenAmount);const It=rt.result.hash;ze(It),ut(0);const Ot=await Jr(je,De),At={hash:It,type:l,tokenAmount:mt.toFixed(4),xrpAmount:C.xrpAmount,tokenName:a.token_name,timestamp:new Date().toISOString(),fee:(parseFloat(rt.result.Fee)/1e6).toFixed(6),platformFee:Ot.fee,platformFeeTx:Ot.hash};Rt(At),ys(1,"success",{description:`${l==="buy"?"Bought":"Sold"} ${mt.toFixed(4)} ${a.token_name}`,txHash:It}),await Jt({userAddress:h.address,actionType:Yt.SWAP_EXECUTED,description:`${l==="buy"?"Bought":"Sold"} ${mt.toFixed(4)} ${a.token_name}`,details:{tradeType:l,tokenAmount:mt.toFixed(4),xrpAmount:C.xrpAmount,txDetails:At},txHash:It,tokenId:a.id});const qt={token_id:a.id,trader_address:h.address,trade_type:l,token_amount:mt,xrp_amount:parseFloat(C.xrpAmount),price:me,tx_hash:It,slippage:parseFloat($e),platform_fee:Ot.waived?0:Ot.fee},{data:us,error:is}=await S.from("trade_history").insert([qt]).select();ys(2,"success",{description:"Trade completed successfully"}),Y(3),await Bs(),setTimeout(async()=>{try{await rs(!0),await loadChartData()}catch{}},1e3),setTimeout(()=>{ie(!1),c(""),u(""),W(!1)},2500),k.success(Es=>e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"font-semibold",children:"Trade Successful!"}),e.jsxs("div",{className:"text-sm",children:[l==="buy"?"Bought":"Sold"," ",mt.toFixed(4)," ",a.token_name]}),e.jsx("div",{className:"text-xs",children:e.jsx(Ls,{type:"tx",value:It,network:"mainnet"})})]}),{duration:8e3,style:{background:"#065f46",color:"#d1fae5",border:"1px solid #10b981"}})}else throw new Error(`Transaction failed: ${rt.result.meta.TransactionResult}`);je&&je.isConnected()&&await je.disconnect()}catch(De){let Ee=De.message||"Unknown error occurred";if(Ee.includes("xrpToDrops")||Ee.includes("decimal")||Ee.includes("precision")||Ee.includes("Decimal precision out of range"))Ee="Amount precision error. Use round numbers (e.g., 1.50 instead of 1.5678).";else if(Ee.includes("too small")||Ee.includes("too large"))Ee=Ee;else if(Ee.includes("Invalid XRP amount")||Ee.includes("Invalid token amount"))Ee="Invalid amount entered. Please check your trade amounts.";else if(Ee.includes("tecPATH_DRY"))Ee="Insufficient liquidity in the pool. Try a smaller amount or increase slippage.";else if(Ee.includes("tecUNFUNDED_PAYMENT"))Ee="Insufficient funds for this transaction. Check your balance.";else if(Ee.includes("tecUNFUNDED"))Ee="Insufficient XRP balance for this transaction and fees.";else if(Ee.includes("tecNO_LINE"))Ee="Trustline not found. Please set up trustline first.";else if(Ee.includes("tecPATH_PARTIAL")){const Ze=parseFloat($e),Be=Et(),Ke=parseFloat(Be.priceImpact);let rt=Math.min(Ze*2.5,50);if(Ke>10?rt=Math.min(Math.max(20,Ke*2),50):Ke>5?rt=Math.min(Math.max(15,Ke*1.8),50):Ke>2&&(rt=Math.min(Math.max(10,Ke*1.5),50)),Mt<2){wt(!0),ut(mt=>mt+1),Ne(rt.toFixed(1)),k.info(mt=>e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"font-semibold",children:"Slippage Too Low"}),e.jsxs("div",{className:"text-sm",children:["Automatically retrying with ",rt.toFixed(1),"% slippage..."]}),e.jsxs("div",{className:"text-xs opacity-75",children:["Attempt ",Mt+1," of 2"]})]}),{duration:3e3}),setTimeout(()=>{wt(!1),pr()},1500);return}else Oe({currentSlippage:Ze,suggestedSlippage:rt,tradeType:l.charAt(0).toUpperCase()+l.slice(1),amount:o,tokenName:a.token_name}),ke(!0),tt(!1),M(!1),K(null),be(!1),ut(0),Ee=`Slippage too low. Suggested: ${rt.toFixed(1)}%. Click retry to try again.`}else Ee.includes("tecNO_AUTH")?Ee="Token issuer requires authorization. Cannot trade this token.":Ee.includes("temREDUNDANT")?Ee="Transaction expired. Please try again.":Ee.includes("LastLedgerSequence")?Ee="Transaction took too long to process. Please try again.":Ee.includes("timeout")||Ee.includes("Connection timeout")?Ee="Connection timeout. Please check your internet and try again.":Ee.includes("Failed to fetch")?Ee="Network error. Please check your connection and try again.":Ee.includes("WebSocket")&&(Ee="Connection to XRPL failed. Please try again.");const Me=Math.min(B,L.length-1);ys(Me,"error",{error:Ee}),Tt||k.error(Ze=>e.jsxs("div",{className:"flex items-start gap-3 max-w-md",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold mb-1",children:"Trade Failed"}),e.jsx("div",{className:"text-sm opacity-90",children:Ee}),De.stack&&e.jsx("div",{className:"text-xs opacity-70 mt-2 font-mono",children:De.message})]}),e.jsx("button",{onClick:()=>k.dismiss(Ze.id),className:"flex-shrink-0 ml-2 text-white/70 hover:text-white transition-colors",children:"✕"})]}),{duration:1e4,style:{background:"#991b1b",color:"#fef2f2",border:"1px solid #dc2626",maxWidth:"500px"}})}finally{if(W(!1),je&&je.isConnected())try{await je.disconnect()}catch{}}},mr=async()=>{he&&(be(!0),Ne(he.suggestedSlippage.toString()),setTimeout(async()=>{try{await pr(),tt(!0),M(!0)}catch(C){tt(!0),M(!1),K(C.message||"Trade failed. Please try again.")}finally{be(!1)}},3e3))},hr=()=>{ke(!1),Oe(null),be(!1),tt(!1),M(!1),K(null)},Lr=()=>{ke(!1),Oe(null),be(!1),tt(!1),M(!1),K(null),ie(!1),c(""),u("")},Dr=async()=>{if(a){z(!0),p(!0);try{const C=new Re.Client("wss://s1.ripple.com");await C.connect();const ce=Date.now()-24*60*60*1e3,je=Math.floor(ce/1e3)-946684800,Ee=(await C.request({command:"account_tx",account:a.issuer_address,ledger_index_min:-1,ledger_index_max:-1,limit:200})).result.transactions.filter(Me=>Me.tx.date>=je).filter(Me=>{const Ze=Me.tx.TransactionType;return["Payment","AMMDeposit","AMMWithdraw"].includes(Ze)}).map(Me=>({...Me.tx,meta:Me.meta,hash:Me.tx.hash})).sort((Me,Ze)=>Ze.date-Me.date);R(Ee),await C.disconnect()}catch{k.error("Failed to load transaction history"),R([])}finally{z(!1)}}};m.useEffect(()=>{v&&a&&x.length===0&&Dr()},[v]);const Zt=Et(),Wt=me>0?me:a?Xt(a):0,da=a?Ut(a):0,N=He||(a&&a.amm_xrp_amount?((Wt-a.amm_xrp_amount/a.amm_asset_amount*.95)/(a.amm_xrp_amount/a.amm_asset_amount*.95)*100).toFixed(2):"0.00");return a&&vt.Buffer.from(a.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-200",children:"Trade"}),e.jsx("p",{className:"text-purple-400 text-sm",children:"Buy and sell meme tokens"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>xt(!0),className:"btn-primary text-white px-4 py-2 rounded-lg font-medium text-sm flex items-center gap-2 hover:scale-105 transition-transform",children:"🤖 AI Chat"}),a&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>p(!0),className:"btn-primary text-white px-4 py-2 rounded-lg font-medium text-sm",children:"📊 History"}),e.jsx("a",{href:`https://xmagnetic.org/dex/${a.currency_code}+${a.issuer_address}_XRP+XRP?network=mainnet`,target:"_blank",rel:"noopener noreferrer",className:"btn-primary text-white px-4 py-2 rounded-lg font-medium text-sm",children:"Magnetic DEX →"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 lg:h-[calc(100vh-12rem)]",children:[e.jsxs("div",{className:"lg:col-span-2 flex flex-col space-y-4",children:[e.jsxs("div",{className:"glass rounded-lg p-4 overflow-hidden",children:[a&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ft,{token:a,size:"3xl"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("h3",{className:"text-base font-bold text-purple-200",children:[a.token_name,"/XRP"]}),e.jsxs("span",{className:"flex items-center gap-1 text-xs text-green-400",title:Ge?`Last updated: ${new Date(Ge).toLocaleTimeString()}`:"Loading...",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-green-400 animate-pulse"}),"Live"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-base sm:text-lg font-bold text-purple-200 font-mono",children:[me>0?me.toFixed(8):Wt.toFixed(8)," XRP"]}),e.jsxs("span",{className:`text-xs font-medium px-1.5 py-0.5 rounded whitespace-nowrap ${parseFloat(N)>=0?"text-green-300 bg-green-500/10":"text-red-300 bg-red-500/10"}`,children:[parseFloat(N)>=0?"+":"",N,"%"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("select",{value:J,onChange:C=>se(C.target.value),className:"input px-2 py-1 text-xs text-purple-200",children:[e.jsx("option",{value:"5m",children:"5m"}),e.jsx("option",{value:"15m",children:"15m"}),e.jsx("option",{value:"30m",children:"30m"}),e.jsx("option",{value:"1h",children:"1h"}),e.jsx("option",{value:"4h",children:"4h"}),e.jsx("option",{value:"1d",children:"1D"})]}),e.jsxs("select",{value:Ce,onChange:C=>ue(C.target.value),className:"input px-2 py-1 text-xs text-purple-200",children:[e.jsx("option",{value:"candlestick",children:"🕯 Candles"}),e.jsx("option",{value:"bars",children:"📊 Bars"}),e.jsx("option",{value:"hollow",children:"⬜ Hollow"}),e.jsx("option",{value:"heikin",children:"🎴 Heikin Ashi"}),e.jsx("option",{value:"line",children:"📈 Line"}),e.jsx("option",{value:"area",children:"📉 Area"}),e.jsx("option",{value:"baseline",children:"📏 Baseline"})]}),e.jsx("button",{onClick:async()=>{await rs(!0),a&&await loadChartData()},disabled:xe,className:"btn-secondary px-2 py-1 text-xs disabled:opacity-50",title:"Refresh price and chart",children:xe?"⏳":"🔄"})]})]}),a?e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:bt,className:"w-full h-[300px] sm:h-[400px] lg:h-[500px] overflow-hidden bg-purple-900/20 rounded"}),e.jsx("div",{ref:St,className:"w-full h-[80px] sm:h-[100px] lg:h-[120px] overflow-hidden bg-purple-900/20 rounded mt-1"})]}):e.jsx("div",{className:"w-full h-[380px] sm:h-[500px] lg:h-[620px] flex items-center justify-center bg-purple-900/20 rounded",children:e.jsxs("div",{className:"text-center text-purple-400",children:[e.jsx("div",{className:"text-4xl mb-2",children:"📊"}),e.jsx("p",{children:"Select a token to view chart"})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:[e.jsxs("div",{className:"glass rounded-lg p-2",children:[e.jsx("div",{className:"text-purple-400 text-xs",children:"Market Cap"}),e.jsxs("div",{className:"text-sm font-bold text-purple-200",children:[F?F.marketCap.toFixed(2):da.toFixed(2)," XRP"]}),Ie>0&&e.jsxs("div",{className:"text-xs text-purple-400",children:["$",Ie>=1e6?`${(Ie/1e6).toFixed(2)}M`:Ie>=1e3?`${(Ie/1e3).toFixed(2)}K`:Ie.toFixed(2)]})]}),e.jsxs("div",{className:"glass rounded-lg p-2",children:[e.jsx("div",{className:"text-purple-400 text-xs",children:"Liquidity"}),e.jsxs("div",{className:"text-sm font-bold text-purple-200",children:[F?F.liquidity.toFixed(2):a?a.amm_xrp_amount.toFixed(2):0," XRP"]})]}),e.jsxs("div",{className:"glass rounded-lg p-2",children:[e.jsx("div",{className:"text-purple-400 text-xs",children:"Volume 24h"}),e.jsxs("div",{className:"text-sm font-bold text-purple-200",children:[F?F.volume24h.toFixed(2):a?(a.amm_xrp_amount*.15).toFixed(2):0," XRP"]})]}),e.jsxs("div",{className:"glass rounded-lg p-2",children:[e.jsx("div",{className:"text-purple-400 text-xs",children:"Pool Size"}),e.jsxs("div",{className:"text-sm font-bold text-purple-200",children:[F?(F.poolSize/1e3).toFixed(0):a?(a.amm_asset_amount/1e3).toFixed(0):0,"K"]})]})]}),e.jsxs("div",{className:"glass rounded-lg p-2",children:[e.jsx("h3",{className:"text-sm font-bold text-purple-200 mb-2",children:"Token Info"}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-purple-400 text-[10px]",children:"Supply"}),e.jsxs("span",{className:"text-purple-200 font-bold text-[11px]",children:[a?(a.supply/1e9).toFixed(1):0,"B"]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-purple-400 text-[10px]",children:"Circulating"}),e.jsxs("span",{className:"text-purple-200 font-bold text-[11px]",children:[a?(a.supply*.9/1e9).toFixed(1):0,"B"]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-purple-400 text-[10px]",children:"Price"}),e.jsx("span",{className:"text-purple-200 font-bold text-[11px]",children:a?Wt.toFixed(8):0})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-purple-400 text-[10px]",children:"Liquidity"}),e.jsx("span",{className:"text-purple-200 font-bold text-[11px]",children:F?F.liquidity.toFixed(0):a?a.amm_xrp_amount.toFixed(0):0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2 pt-2 border-t border-purple-500/20",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-400 text-[10px]",children:"Currency Code"}),e.jsx("div",{className:"text-purple-300 text-[10px] font-mono bg-black/30 px-1 py-0.5 rounded",children:a?a.currency_code:""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-400 text-[10px]",children:"Issuer"}),e.jsx("div",{className:"text-purple-300 text-[10px] font-mono bg-black/30 px-1 py-0.5 rounded truncate",children:a?`${a.issuer_address.slice(0,8)}...`:""})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[!h&&e.jsx("div",{className:"glass rounded-lg p-4 bg-yellow-500/10 border border-yellow-500/30",children:e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("div",{className:"text-3xl",children:"⚠️"}),e.jsx("h3",{className:"text-sm font-bold text-yellow-200",children:"Wallet Not Connected"}),e.jsx("p",{className:"text-yellow-300 text-xs",children:"Connect wallet from Setup"})]})}),e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{onClick:()=>pt("select"),className:`flex-1 py-2 px-4 rounded-lg font-medium transition-all ${jt==="select"?"bg-purple-600 text-white":"bg-purple-900/30 text-purple-300 hover:bg-purple-900/50"}`,children:"Select Token"}),e.jsx("button",{onClick:()=>pt("history"),className:`flex-1 py-2 px-4 rounded-lg font-medium transition-all ${jt==="history"?"bg-purple-600 text-white":"bg-purple-900/30 text-purple-300 hover:bg-purple-900/50"}`,children:"Trade History"})]}),jt==="select"?e.jsx(e.Fragment,{children:e.jsxs("select",{value:(a==null?void 0:a.id)||"",onChange:C=>{const V=t.find(ce=>ce.id===C.target.value);n(V)},className:"input w-full mb-3 text-purple-200",children:[e.jsx("option",{value:"",children:"Choose a token..."}),t.map(C=>e.jsxs("option",{value:C.id,children:[C.token_name," - ",Xt(C).toFixed(8)," XRP"]},C.id))]})}):e.jsx("div",{className:"min-h-[200px]",children:a?e.jsx(Po,{tokenId:a.id,connectedWallet:h}):e.jsxs("div",{className:"text-center py-8 text-purple-400",children:[e.jsx("div",{className:"text-4xl mb-2",children:"📊"}),e.jsx("div",{children:"Select a token to view trade history"})]})}),a&&e.jsx("div",{className:"glass rounded-lg p-3 bg-blue-500/10 border border-blue-500/30 mb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-blue-400 text-xs",children:"Trading Pair"}),e.jsxs("div",{className:"text-blue-200 font-bold",children:[a.currency_code,"/XRP"]})]})}),a&&h&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsxs("div",{className:"glass rounded-lg p-3 bg-purple-500/10 border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-300 text-xs mb-1",children:"Your Balance"}),e.jsx("div",{className:"text-lg font-bold text-purple-200",children:_e?e.jsx("span",{className:"animate-pulse",children:"Loading..."}):`${parseFloat(D).toFixed(4)} ${a.token_name}`})]}),w?e.jsx("div",{className:"glass rounded-lg p-4 text-center",children:e.jsx("div",{className:"text-purple-300 animate-pulse",children:"Checking trustline..."})}):y?e.jsx("div",{className:"glass rounded-lg p-4 bg-green-500/10 border border-green-500/30",children:e.jsxs("div",{className:"flex items-center gap-2 justify-center text-green-300",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400"}),e.jsx("span",{className:"text-sm font-medium",children:"Trustline Active"})]})}):e.jsx("button",{onClick:oa,disabled:P,className:"w-full btn-primary text-white py-3 rounded-lg font-medium disabled:opacity-50",children:P?"Setting up Trustline...":"✓ Setup Trustline"})]})]}),e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Ae(!1),className:`px-4 py-2 rounded-lg font-medium transition-all ${Se?"glass text-purple-300 hover:bg-purple-900/50":"bg-purple-600 text-white"}`,children:"Trade"}),e.jsx("button",{onClick:()=>Ae(!0),className:`px-4 py-2 rounded-lg font-medium transition-all ${Se?"bg-purple-600 text-white":"glass text-purple-300 hover:bg-purple-900/50"}`,children:"My Position"})]}),!Se&&e.jsxs("select",{value:q,onChange:C=>ee(C.target.value),className:"input px-3 py-1.5 text-sm text-purple-200 bg-purple-900/50 border-purple-500/30",children:[e.jsx("option",{value:"amm",children:"AMM Pool"}),e.jsx("option",{value:"market",children:"Market"})]})]}),Se?e.jsx("div",{className:"space-y-4",children:Q?e.jsx("div",{className:"text-center py-8 text-purple-400",children:"Loading position..."}):h?lt?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-purple-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2 text-purple-400",children:[e.jsx("span",{className:"text-2xl",children:"✕"}),e.jsx("span",{children:"XRP"})]}),e.jsx("span",{className:"text-purple-200 font-bold text-lg",children:lt.xrp})]}),e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-purple-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2 text-purple-400",children:[e.jsx(Ft,{token:a,size:"sm"}),e.jsx("span",{children:a.token_name})]}),e.jsx("span",{className:"text-purple-200 font-bold text-lg",children:lt.tokens})]}),e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-purple-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2 text-purple-400",children:[e.jsx("span",{className:"text-2xl",children:"🔗"}),e.jsxs("span",{children:["LP_",a.currency_code,"_XRP"]})]}),e.jsx("span",{className:"text-purple-200 font-bold text-lg",children:lt.lpTokens})]})]}),e.jsxs("div",{className:"glass rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-purple-400",children:"Pool Share"}),e.jsxs("span",{className:"text-purple-200 font-bold",children:[lt.sharePercentage,"%"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-purple-400",children:"Position Value"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-purple-200 font-bold",children:[lt.estimatedValue," XRP"]}),e.jsxs("div",{className:"text-xs text-green-400",children:["$",(parseFloat(lt.estimatedValue)*ae).toFixed(2)]})]})]}),e.jsxs("div",{className:"pt-2 border-t border-purple-500/20",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-purple-400",children:"XRP Value"}),e.jsxs("span",{className:"text-purple-300",children:["$",(parseFloat(lt.xrp)*ae).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[e.jsxs("span",{className:"text-purple-400",children:[a.token_name," Value"]}),e.jsxs("span",{className:"text-purple-300",children:["$",(parseFloat(lt.tokens)*Wt*ae).toFixed(2)]})]})]})]}),e.jsxs("div",{className:"space-y-3 mt-6 pt-6 border-t border-purple-500/20",children:[e.jsx("h4",{className:"font-bold text-purple-200 mb-3",children:"Deposit to Pool"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Deposit Mode"}),e.jsxs("select",{value:ot,onChange:C=>{yt(C.target.value),C.target.value==="xrp"&&st(""),C.target.value==="token"&&Fe("")},className:"input w-full text-purple-200",children:[e.jsx("option",{value:"both",children:"Both Assets"}),e.jsx("option",{value:"xrp",children:"XRP Only"}),e.jsxs("option",{value:"token",children:[a.token_name," Only"]})]})]}),(ot==="both"||ot==="xrp")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"XRP Amount"}),e.jsx("input",{type:"number",value:ne,onChange:C=>{if(Fe(C.target.value),ot==="both"&&C.target.value&&Wt){const V=(parseFloat(C.target.value)/Wt).toFixed(6);st(V)}},placeholder:"0.00",step:"0.000001",className:"input w-full text-purple-200 text-lg"}),e.jsxs("div",{className:"flex justify-between text-xs text-purple-400 mt-1",children:[e.jsxs("div",{children:["Balance: ",E.toFixed(4)," XRP"]}),e.jsxs("div",{className:"text-green-400",children:["$",(E*ae).toFixed(2)," USD"]})]}),ot==="xrp"&&ne&&Wt&&e.jsxs("div",{className:"text-xs text-purple-300 mt-1",children:["≈ ",(parseFloat(ne)/Wt).toFixed(4)," ",a.token_name," equivalent"]})]}),(ot==="both"||ot==="token")&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-purple-300 mb-2",children:[a.token_name," Amount"]}),e.jsx("input",{type:"number",value:Xe,onChange:C=>{if(st(C.target.value),ot==="both"&&C.target.value&&Wt){const V=(parseFloat(C.target.value)*Wt).toFixed(6);Fe(V)}},placeholder:"0.00",step:"0.000001",className:"input w-full text-purple-200 text-lg"}),e.jsxs("div",{className:"flex justify-between text-xs text-purple-400 mt-1",children:[e.jsxs("div",{children:["Balance: ",parseFloat(D).toFixed(4)," ",a.token_name]}),e.jsxs("div",{className:"text-green-400",children:["≈ ",(parseFloat(D)*Wt).toFixed(4)," XRP"]})]}),ot==="token"&&Xe&&Wt&&e.jsxs("div",{className:"text-xs text-purple-300 mt-1",children:["≈ ",(parseFloat(Xe)*Wt).toFixed(4)," XRP equivalent"]})]}),e.jsx("button",{onClick:ca,disabled:gt||ot==="both"&&(!ne||!Xe||parseFloat(ne)<=0||parseFloat(Xe)<=0)||ot==="xrp"&&(!ne||parseFloat(ne)<=0)||ot==="token"&&(!Xe||parseFloat(Xe)<=0),className:"w-full py-4 rounded-lg font-bold text-lg bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:gt?"Depositing...":"💰 Deposit to Pool"})]}),e.jsxs("div",{className:"space-y-3 mt-6 pt-6 border-t border-purple-500/20",children:[e.jsx("h4",{className:"font-bold text-purple-200 mb-3",children:"Withdraw"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Amount to Withdraw"}),e.jsx("input",{type:"number",value:Ye,onChange:C=>Le(C.target.value),placeholder:"0.00",max:lt.lpTokens,step:"0.000001",className:"input w-full text-purple-200 text-lg"}),e.jsxs("div",{className:"flex justify-between text-xs text-purple-400 mt-1",children:[e.jsx("span",{children:"LP Tokens to withdraw"}),e.jsx("button",{onClick:()=>Le(lt.lpTokens),className:"text-purple-300 hover:text-purple-200 font-medium",children:"MAX"})]})]}),Ye&&parseFloat(Ye)>0&&ds()&&e.jsxs("div",{className:"glass rounded-lg p-4 space-y-3",children:[e.jsx("h5",{className:"font-medium text-purple-200 mb-2",children:"Withdraw Estimate"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-400",children:"XRP"}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-purple-200 font-bold",children:ds().xrpToReceive}),e.jsxs("div",{className:"text-xs text-purple-400",children:["$",(parseFloat(ds().xrpToReceive)*ae).toFixed(2)]})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-400",children:a.token_name}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-purple-200 font-bold",children:ds().tokensToReceive}),e.jsxs("div",{className:"text-xs text-purple-400",children:[ds().tokenValueInXrp," XRP"]})]})]})]}),e.jsxs("div",{className:"pt-2 border-t border-purple-500/20 space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-purple-400",children:"Total Value"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-purple-200 font-bold",children:[ds().totalValueInXrp," XRP"]}),e.jsxs("div",{className:"text-xs text-green-400",children:["$",ds().totalValueInUsd]})]})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-purple-400",children:"Platform Fee"}),e.jsxs("span",{className:"text-red-300",children:[ds().platformFee," XRP"]})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-purple-400",children:"Network Fee"}),e.jsxs("span",{className:"text-purple-300",children:[ds().networkFee," XRP"]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Withdrawn asset"}),e.jsxs("select",{value:Pe,onChange:C=>Ve(C.target.value),className:"input w-full text-purple-200",children:[e.jsx("option",{value:"both",children:"Both Assets"}),e.jsx("option",{value:"xrp",children:"XRP Only"}),e.jsxs("option",{value:"token",children:[a.token_name," Only"]})]}),e.jsxs("div",{className:"text-xs text-purple-400 mt-1",children:[Pe==="both"&&`Withdrawing both XRP and ${a.token_name}`,Pe==="xrp"&&"Withdrawing XRP only",Pe==="token"&&`Withdrawing ${a.token_name} only`]})]}),e.jsx("button",{onClick:ur,disabled:!Ye||parseFloat(Ye)<=0||at||parseFloat(Ye)>parseFloat(lt.lpTokens),className:"w-full py-4 rounded-lg font-bold text-lg bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:at?"Withdrawing...":"Withdraw from Pool"})]})]})}):e.jsx("div",{className:"text-center py-8 text-purple-400",children:"No LP position found for this pool"}):e.jsx("div",{className:"text-center py-8 text-purple-400",children:"Connect wallet to view your position"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("button",{onClick:()=>i("buy"),className:`flex-1 py-3 rounded-lg font-medium transition-all ${l==="buy"?"bg-green-600 text-white":"glass text-purple-300"}`,children:"Buy"}),e.jsx("button",{onClick:()=>i("sell"),className:`flex-1 py-3 rounded-lg font-medium transition-all ${l==="sell"?"bg-red-600 text-white":"glass text-purple-300"}`,children:"Sell"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:l==="buy"?"XRP Amount":"Token Amount"}),e.jsx("input",{type:"number",value:o,onChange:C=>{const V=C.target.value;c(V)},placeholder:"0.00",step:"0.000001",className:"input w-full text-purple-200 text-lg"}),e.jsx("div",{className:"flex items-center justify-between mt-2",children:e.jsx("div",{className:"text-purple-400 text-xs",children:l==="buy"?e.jsxs("div",{children:[e.jsxs("div",{children:["Balance: ",E.toFixed(4)," XRP"]}),e.jsxs("div",{className:"text-green-400",children:["$",(E*ae).toFixed(2)," USD"]})]}):e.jsxs("div",{children:[e.jsxs("div",{children:["Balance: ",parseFloat(D).toFixed(4)," ",(a==null?void 0:a.token_name)||""]}),e.jsxs("div",{className:"text-green-400",children:["≈ ",(parseFloat(D)*Wt).toFixed(4)," XRP ($",(parseFloat(D)*Wt*ae).toFixed(2)," USD)"]})]})})}),e.jsx("div",{className:"grid grid-cols-4 gap-2 mt-2",children:["25","50","75","100"].map(C=>e.jsx("button",{onClick:()=>{const V=l==="buy"?E:parseFloat(D),ce=parseFloat(C)/100;let je=V*ce;l==="buy"&&(je=Math.max(0,je-2)),c(je>0?je.toFixed(6):"0")},className:"py-1.5 rounded-lg text-xs font-medium glass text-purple-300 hover:bg-purple-600 hover:text-white transition-all",children:C==="100"?"MAX":`${C}%`},C))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Slippage Tolerance"}),e.jsxs("div",{className:"grid grid-cols-5 gap-2",children:[["0.1","0.5","1","3"].map(C=>e.jsxs("button",{onClick:()=>Ne(C),className:`py-2 rounded-lg text-sm font-medium transition-all ${$e===C?"bg-purple-600 text-white":"glass text-purple-300 hover:bg-purple-900/30"}`,children:[C,"%"]},C)),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:$e,onChange:C=>Ne(C.target.value),placeholder:"0.5",className:"input w-full px-2 py-2 text-sm text-purple-200 text-center",step:"0.1",min:"0.1",max:"50"}),e.jsx("div",{className:"absolute inset-y-0 right-2 flex items-center pointer-events-none text-purple-400 text-xs",children:"%"})]})]}),e.jsxs("div",{className:"text-purple-400 text-xs mt-1",children:["Trade will revert if price changes by more than ",$e,"%"]}),ye&&e.jsxs("div",{className:"mt-2 p-3 bg-yellow-500/10 border border-yellow-500/30 rounded-lg",children:[e.jsx("p",{className:"text-yellow-400 text-sm",children:ye}),e.jsx("button",{onClick:()=>{const C=Et();if(C){const V=parseFloat(C.priceImpact);let ce=.5;V>10?ce=Math.max(15,V*1.5):V>5?ce=Math.max(10,V*1.3):V>2?ce=Math.max(5,V*1.2):V>1?ce=3:V>.5&&(ce=1),Ne(ce.toFixed(1))}},className:"mt-2 text-xs px-3 py-1 bg-yellow-500/20 hover:bg-yellow-500/30 text-yellow-300 rounded-lg transition-colors",children:"Use Recommended Slippage"})]})]}),o&&!isNaN(o)&&parseFloat(o)>0&&e.jsxs("div",{className:"glass rounded-lg p-4 space-y-3",children:[e.jsx("h4",{className:"font-bold text-purple-200",children:"Estimate"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-purple-400 text-sm",children:["You ",l==="buy"?"Receive":"Get"]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-purple-200 font-bold",children:l==="buy"?`${Zt.tokenAmount} ${(a==null?void 0:a.token_name)||""}`:`${Zt.xrpAmount} XRP`}),l==="sell"&&e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(parseFloat(Zt.xrpAmount)*ae).toFixed(2)," USD"]})]})]}),l==="buy"&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-400 text-sm",children:"You Spend"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-purple-200 font-bold",children:[Zt.xrpAmount," XRP"]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(parseFloat(Zt.xrpAmount)*ae).toFixed(2)," USD"]})]})]}),l==="sell"&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-400 text-sm",children:"You Sell"}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-purple-200 font-bold",children:[Zt.tokenAmount," ",(a==null?void 0:a.token_name)||""]})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-400 text-sm",children:"Price"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-purple-200",children:[Wt.toFixed(8)," XRP"]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(Wt*ae).toFixed(8)," USD"]})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-400 text-sm",children:"Price Impact"}),e.jsxs("span",{className:`font-medium ${parseFloat(Zt.priceImpact)>5?"text-red-400":"text-green-400"}`,children:[Zt.priceImpact,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-400 text-sm",children:"Trading Fee"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-purple-200",children:[Zt.fee," XRP"]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(parseFloat(Zt.fee)*ae).toFixed(2)," USD"]})]})]}),parseFloat(Zt.priceImpact)>10&&e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded p-3 text-yellow-200 text-xs",children:"⚠️ High price impact! Consider reducing trade size."})]}),e.jsx("button",{onClick:pr,disabled:!h||!y||!o||isNaN(o)||parseFloat(o)<=0||_,className:`w-full py-4 rounded-lg font-bold text-lg transition-all ${l==="buy"?"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800":"bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800"} text-white shadow-lg disabled:opacity-50 disabled:cursor-not-allowed`,children:_?"Processing...":h?y?`${l==="buy"?"💚 Buy":"❤️ Sell"} ${(a==null?void 0:a.currency_code)||"Token"}`:"Setup Trustline First":"Connect Wallet First"}),dt&&e.jsxs("div",{className:"glass rounded-lg p-4 space-y-3 mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-bold text-purple-200",children:"Last Transaction"}),e.jsx("span",{className:"text-xs text-purple-400",children:new Date(dt.timestamp).toLocaleTimeString()})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-400",children:"Type"}),e.jsx("span",{className:`font-medium ${dt.type==="buy"?"text-green-400":"text-red-400"}`,children:dt.type==="buy"?"📈 Buy":"📉 Sell"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-400",children:"Amount"}),e.jsxs("span",{className:"text-purple-200 font-medium",children:[dt.tokenAmount," ",dt.tokenName]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-400",children:"Cost"}),e.jsxs("span",{className:"text-purple-200 font-medium",children:[dt.xrpAmount," XRP"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-400",children:"Network Fee"}),e.jsxs("span",{className:"text-purple-200 font-medium",children:[dt.fee," XRP"]})]}),e.jsx("div",{className:"pt-2 border-t border-purple-500/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-purple-400",children:"Transaction"}),e.jsx(Ls,{type:"tx",value:dt.hash,network:"mainnet"})]})})]})]})]})]})]})]})]}),e.jsx(To,{isOpen:oe,steps:L,currentStep:B,onClose:()=>ie(!1),canClose:B>=L.length||L.some(C=>C.error),title:l==="buy"?"💰 Buying Token on XRPL":"💸 Selling Token on XRPL",successTitle:l==="buy"?"🎉 Purchase Successful!":"🎉 Sale Successful!",failTitle:l==="buy"?"❌ Purchase Failed":"❌ Sale Failed"}),he&&e.jsx(th,{isOpen:U,currentSlippage:he.currentSlippage,suggestedSlippage:he.suggestedSlippage,tradeType:he.tradeType,amount:he.amount,tokenName:he.tokenName,onRetry:mr,onCancel:hr,onClose:Lr,isRetrying:$,retryComplete:We,retrySuccess:nt,retryError:fe}),e.jsx(sh,{isOpen:v,onClose:()=>p(!1),token:a,transactions:x,loading:H}),e.jsx(xh,{isOpen:Nt,onClose:()=>xt(!1)})]})}function gh({bot:r,onClose:t}){const[s,a]=m.useState([]),[n,l]=m.useState(!0);m.useEffect(()=>{i()},[r.id]);const i=async()=>{try{l(!0);const{data:d,error:u}=await S.from("bot_trades").select("*").eq("bot_id",r.id).order("created_at",{ascending:!1}).limit(100);if(u)throw u;a(d||[])}catch{}finally{l(!1)}},o=d=>d.status==="failed"?"text-red-400":d.trade_type==="BUY"?"text-green-400":d.trade_type==="SELL"?"text-yellow-400":"text-gray-400",c=d=>d.status==="failed"?"❌":d.trade_type==="BUY"?"📈":d.trade_type==="SELL"?"📉":"⚠️";return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-lg p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-2xl font-bold text-purple-200",children:["Trade History: ",r.name]}),e.jsx("button",{onClick:t,className:"text-purple-400 hover:text-purple-200 text-2xl",children:"✕"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"glass rounded-lg p-4 bg-purple-500/10",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"Total Trades"}),e.jsx("div",{className:"text-2xl font-bold text-purple-200",children:r.total_trades||0})]}),e.jsxs("div",{className:"glass rounded-lg p-4 bg-green-500/10",children:[e.jsx("div",{className:"text-green-400 text-xs mb-1",children:"Successful"}),e.jsx("div",{className:"text-2xl font-bold text-green-400",children:r.successful_trades||0})]}),e.jsxs("div",{className:"glass rounded-lg p-4 bg-red-500/10",children:[e.jsx("div",{className:"text-red-400 text-xs mb-1",children:"Failed"}),e.jsx("div",{className:"text-2xl font-bold text-red-400",children:r.failed_trades||0})]}),e.jsxs("div",{className:"glass rounded-lg p-4 bg-blue-500/10",children:[e.jsx("div",{className:"text-blue-400 text-xs mb-1",children:"Success Rate"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-400",children:[r.total_trades>0?(r.successful_trades/r.total_trades*100).toFixed(1):0,"%"]})]})]}),n?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-4xl mb-4",children:"⏳"}),e.jsx("p",{className:"text-purple-300",children:"Loading trades..."})]}):s.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"📊"}),e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-2",children:"No Trades Yet"}),e.jsx("p",{className:"text-purple-400",children:"This bot hasn't executed any trades yet"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-7 gap-4 px-4 py-2 text-purple-400 text-sm font-medium border-b border-purple-500/30",children:[e.jsx("div",{children:"Type"}),e.jsx("div",{className:"text-right",children:"Amount"}),e.jsx("div",{className:"text-right",children:"XRP Cost"}),e.jsx("div",{className:"text-right",children:"Price"}),e.jsx("div",{className:"text-right",children:"Status"}),e.jsx("div",{className:"text-right",children:"Time"}),e.jsx("div",{className:"text-center",children:"TX"})]}),s.map(d=>e.jsxs("div",{className:"glass rounded-lg p-4 grid grid-cols-7 gap-4 items-center hover:bg-purple-500/5 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:c(d)}),e.jsx("span",{className:`font-bold ${o(d)}`,children:d.trade_type})]}),e.jsx("div",{className:"text-right text-purple-200 font-medium",children:parseFloat(d.amount).toFixed(4)}),e.jsxs("div",{className:"text-right text-purple-200 font-medium",children:[parseFloat(d.xrp_cost).toFixed(4)," XRP"]}),e.jsx("div",{className:"text-right text-purple-300 text-sm",children:parseFloat(d.price).toFixed(8)}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${d.status==="success"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:d.status})}),e.jsx("div",{className:"text-right text-purple-400 text-xs",children:new Date(d.created_at).toLocaleTimeString()}),e.jsx("div",{className:"text-center",children:d.tx_hash?e.jsxs("a",{href:`https://xrpscan.com/tx/${d.tx_hash}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 text-xs underline flex items-center justify-center gap-1",title:"View on XRPScan (Mainnet)",children:[e.jsx("span",{children:"🔍"}),e.jsx("span",{children:"View"})]}):e.jsx("span",{className:"text-gray-500 text-xs",children:"-"})})]},d.id))]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-purple-500/30",children:e.jsx("button",{onClick:t,className:"btn text-purple-300 px-6 py-3 rounded-lg font-medium",children:"Close"})})]})})}const bh=(r,t=6)=>{const s=parseFloat(r);if(isNaN(s)||s<=0)throw new Error("Invalid amount");const a=Math.pow(10,t);return Math.floor(s*a)/a},Zn=r=>bh(r,6),di=r=>{const t=parseFloat(r);if(isNaN(t)||t<=0)throw new Error("Invalid token amount");return t.toFixed(6)},Ws=r=>parseFloat(r).toFixed(2),ui=(r,t)=>{const s=t-r,a=r+Math.random()*s;return Zn(a)},kr=5,Br="rphatRpwXcPAo7CVm46dC78JAQ6kLMqb2M",Rs=.1,va=100,ns=[{id:"balanced",name:"⚖️ Balanced (50% Buy / 50% Sell)",buyProb:50},{id:"accumulate",name:"📈 Accumulate (80% Buy / 20% Sell)",buyProb:80},{id:"distribute",name:"📉 Distribute (20% Buy / 80% Sell)",buyProb:20},{id:"aggressive_buy",name:"🔥 Aggressive Buy (90% Buy / 10% Sell)",buyProb:90},{id:"aggressive_sell",name:"❄️ Aggressive Sell (10% Buy / 90% Sell)",buyProb:10},{id:"moderate_buy",name:"📊 Moderate Buy (70% Buy / 30% Sell)",buyProb:70},{id:"moderate_sell",name:"📊 Moderate Sell (30% Buy / 70% Sell)",buyProb:30},{id:"slight_buy",name:"➕ Slight Buy Bias (60% Buy / 40% Sell)",buyProb:60},{id:"slight_sell",name:"➖ Slight Sell Bias (40% Buy / 60% Sell)",buyProb:40},{id:"extreme_buy",name:"🚀 Extreme Buy (95% Buy / 5% Sell)",buyProb:95},{id:"extreme_sell",name:"🎯 Extreme Sell (5% Buy / 95% Sell)",buyProb:5},{id:"conservative",name:"🛡️ Conservative (55% Buy / 45% Sell)",buyProb:55},{id:"conservative_sell",name:"🛡️ Conservative Sell (45% Buy / 55% Sell)",buyProb:45},{id:"bullish",name:"🐂 Bullish (85% Buy / 15% Sell)",buyProb:85},{id:"bearish",name:"🐻 Bearish (15% Buy / 85% Sell)",buyProb:15},{id:"neutral",name:"⚪ Neutral (50% Buy / 50% Sell)",buyProb:50},{id:"scalper",name:"⚡ Scalper (65% Buy / 35% Sell)",buyProb:65},{id:"swing",name:"🌊 Swing Trader (55% Buy / 45% Sell)",buyProb:55},{id:"hodl",name:"💎 HODL (75% Buy / 25% Sell)",buyProb:75},{id:"profit_taker",name:"💰 Profit Taker (25% Buy / 75% Sell)",buyProb:25},{id:"dca",name:"📅 DCA (Dollar Cost Average) (70% Buy / 30% Sell)",buyProb:70},{id:"momentum",name:"⚡ Momentum (80% Buy / 20% Sell)",buyProb:80},{id:"contrarian",name:"🔄 Contrarian (35% Buy / 65% Sell)",buyProb:35},{id:"volatility",name:"📈📉 Volatility (50% Buy / 50% Sell)",buyProb:50},{id:"adaptive",name:"🤖 Adaptive (60% Buy / 40% Sell)",buyProb:60}],pi=.1;function vh(){const[r,t]=m.useState([]),[s,a]=m.useState({}),[n,l]=m.useState(null),[i,o]=m.useState([]),[c,d]=m.useState(!1),[u,h]=m.useState(!1),[g,y]=m.useState(null),[f,w]=m.useState(null),[b,P]=m.useState({}),[A,_]=m.useState({}),[W,D]=m.useState({}),[I,E]=m.useState("grid"),[G,_e]=m.useState(""),[ge,Ce]=m.useState([]),[ue,J]=m.useState("grid"),[se,F]=m.useState(""),[X,me]=m.useState([]),[ve,He]=m.useState("name"),[pe,xe]=m.useState(2.5),[le,$e]=m.useState({name:"",tokenId:"",strategy:"balanced",interval:15,minAmount:.5,maxAmount:2,slippage:10,buyProbability:50}),[Ne,q]=m.useState(!1),[ee,L]=m.useState({show:!1,message:""}),[re,B]=m.useState({}),Y=m.useRef({}),oe=m.useRef(new Set),ie=m.useRef(new Set);m.useEffect(()=>{$(),te(),U(),ye()},[]);const ye=async()=>{var j;try{const Z=await(await fetch("https://api.coingecko.com/api/v3/simple/price?ids=ripple&vs_currencies=usd")).json();xe(((j=Z.ripple)==null?void 0:j.usd)||2.5)}catch{}};m.useEffect(()=>{r.length>0&&We()},[r]),m.useEffect(()=>{let j=!0;if(n){M(),U(),ke(),be();const Q=setInterval(()=>{j&&nt()},1e4),Z=S.channel("bot_updates").on("postgres_changes",{event:"*",schema:"public",table:"trading_bots",filter:`wallet_address=eq.${n.address}`},Ae=>{Ae.eventType==="UPDATE"||Ae.eventType==="INSERT"?o(de=>de.find(Ve=>Ve.id===Ae.new.id)?de.map(Ve=>Ve.id===Ae.new.id?Ae.new:Ve):[...de,Ae.new]):Ae.eventType==="DELETE"&&o(de=>de.filter(Pe=>Pe.id!==Ae.old.id))}).subscribe(),Se=S.channel("bot_trades_updates").on("postgres_changes",{event:"INSERT",schema:"public",table:"bot_trades"},Ae=>{nt()}).subscribe();return()=>{j=!1,clearInterval(Q),Z.unsubscribe(),Se.unsubscribe()}}},[n]),m.useEffect(()=>{n&&r.length>0&&be()},[r,n]),m.useEffect(()=>{const j=()=>{te()};return window.addEventListener("walletConnected",j),window.addEventListener("walletDisconnected",j),()=>{window.removeEventListener("walletConnected",j),window.removeEventListener("walletDisconnected",j)}},[]);const te=()=>{const j=localStorage.getItem("connectedWallet");j&&l(JSON.parse(j))},U=async()=>{if(n)try{const{data:j,error:Q}=await S.from("token_favorites").select("token_id").eq("wallet_address",n.address);if(Q)throw Q;Ce((j==null?void 0:j.map(Z=>Z.token_id))||[])}catch{}},ke=()=>{if(n)try{const j=localStorage.getItem(`bot_favorites_${n.address}`);j&&me(JSON.parse(j))}catch{}},he=j=>{if(!n)return;const Q=X.includes(j),Z=Q?X.filter(Se=>Se!==j):[...X,j];me(Z),localStorage.setItem(`bot_favorites_${n.address}`,JSON.stringify(Z)),k.success(Q?"Removed from favorites":"Added to favorites")},Oe=async j=>{if(!n)return;const Q=ge.includes(j);try{if(Q){const{error:Z}=await S.from("token_favorites").delete().eq("wallet_address",n.address).eq("token_id",j);if(Z)throw Z;Ce(Se=>Se.filter(Ae=>Ae!==j)),k.success("Removed from favorites")}else{const{error:Z}=await S.from("token_favorites").insert({wallet_address:n.address,token_id:j});if(Z)throw Z;Ce(Se=>[...Se,j]),k.success("Added to favorites")}}catch{k.error("Failed to update favorites")}},$=async()=>{try{const{data:j,error:Q}=await S.from("meme_tokens").select("*").order("created_at",{ascending:!1});if(Q)throw Q;t(j||[]);const Z={};(j||[]).forEach(Se=>{Se.current_price&&Se.current_price>0&&(Z[Se.id]={amm_xrp_amount:Se.amm_xrp_amount||0,amm_asset_amount:Se.amm_asset_amount||0,price:Se.current_price})}),Object.keys(Z).length>0&&a(Z)}catch{}},be=async()=>{if(!(!n||r.length===0))try{const{requestWithRetry:j}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),Q=await j({command:"account_lines",account:n.address,ledger_index:"validated"}),Z={};r.forEach(Se=>{const Ae=Se.currency_code.length>3?vt.Buffer.from(Se.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):Se.currency_code,de=Q.result.lines.find(Pe=>{if(Pe.account!==Se.issuer_address)return!1;const Ve=Pe.currency;return Se.currency_code.length<=3?Ve===Se.currency_code:Ve.length===40?Ve===Ae:Ve===Se.currency_code});Z[Se.id]=de?parseFloat(de.balance):0}),B(Z)}catch{}},We=async(j=!1)=>{try{const{data:Z,error:Se}=await S.from("pool_data_cache").select("*").gte("last_updated",new Date(Date.now()-3e4).toISOString());if(!j&&Z&&Z.length>0&&!Se){const Le={};Z.forEach(at=>{Le[at.token_id]={amm_xrp_amount:parseFloat(at.xrp_amount),amm_asset_amount:parseFloat(at.token_amount),price:parseFloat(at.price)}}),a(Le);return}const Ae=r.filter(Le=>!s[Le.id]&&!oe.current.has(Le.id));if(Ae.length===0)return;Ae.forEach(Le=>oe.current.add(Le.id));const{requestWithRetry:de}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),Pe=Ae.map(async Le=>{var at;try{const T=Le.currency_code.length>3?vt.Buffer.from(Le.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):Le.currency_code,ne=await de({command:"amm_info",asset:{currency:"XRP"},asset2:{currency:T,issuer:Le.issuer_address},ledger_index:"validated"});if((at=ne==null?void 0:ne.result)!=null&&at.amm){const Fe=ne.result.amm,Xe=parseFloat(Fe.amount)/1e6,st=parseFloat(Fe.amount2.value),gt=Xe/st;return{tokenId:Le.id,poolData:{amm_xrp_amount:Xe,amm_asset_amount:st,price:gt}}}return{tokenId:Le.id,poolData:null}}catch{return{tokenId:Le.id,poolData:null}}finally{oe.current.delete(Le.id)}}),Ve=await Promise.all(Pe),Ye=Ve.filter(({poolData:Le})=>Le!==null).map(({tokenId:Le,poolData:at})=>({token_id:Le,xrp_amount:at.amm_xrp_amount,token_amount:at.amm_asset_amount,lp_tokens:0,price:at.price,account_id:"",volume_24h:0,price_change_24h:0,last_updated:new Date().toISOString()}));if(Ye.length>0)for(const Le of Ye)await S.from("pool_data_cache").upsert(Le,{onConflict:"token_id"});a(Le=>{const at={...Le};return Ve.forEach(({tokenId:T,poolData:ne})=>{ne&&(at[T]=ne)}),at})}catch{r.forEach(Z=>oe.current.delete(Z.id))}},tt=async j=>{var Q,Z;try{const{data:Se}=await S.from("pool_data_cache").select("*").eq("token_id",j.id).gte("last_updated",new Date(Date.now()-3e4).toISOString()).maybeSingle();if(Se)return{amm_xrp_amount:parseFloat(Se.xrp_amount),amm_asset_amount:parseFloat(Se.token_amount),price:parseFloat(Se.price)};const{requestWithRetry:Ae}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),de=j.currency_code.length>3?vt.Buffer.from(j.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):j.currency_code,Pe=await Ae({command:"amm_info",asset:{currency:"XRP"},asset2:{currency:de,issuer:j.issuer_address},ledger_index:"validated"});if((Q=Pe==null?void 0:Pe.result)!=null&&Q.amm){const Ve=Pe.result.amm,Ye=parseFloat(Ve.amount)/1e6,Le=parseFloat(Ve.amount2.value),at=Ye/Le;return await S.from("pool_data_cache").upsert({token_id:j.id,xrp_amount:Ye,token_amount:Le,lp_tokens:parseFloat(((Z=Ve.lp_token)==null?void 0:Z.value)||0),price:at,account_id:Ve.account,volume_24h:0,price_change_24h:0,last_updated:new Date().toISOString()},{onConflict:"token_id"}),{amm_xrp_amount:Ye,amm_asset_amount:Le,price:at}}}catch{}return null},nt=async()=>{if(n)try{const{data:j,error:Q}=await S.from("trading_bots").select("*").eq("wallet_address",n.address).order("created_at",{ascending:!1});if(Q)return;o(Z=>{let Se=!1;Z.length!==(j||[]).length&&(Se=!0);const Ae=(j||[]).map(de=>{const Pe=Z.find(Ve=>Ve.id===de.id);return de.next_trade_time&&de.next_action&&(P(Ve=>({...Ve,[de.id]:new Date(de.next_trade_time).getTime()})),_(Ve=>({...Ve,[de.id]:{action:de.next_action,tokenAmount:de.next_token_amount,xrpAmount:de.next_xrp_amount,estimatedPrice:de.next_price}}))),Pe?((Pe.status!==de.status||Pe.total_trades!==de.total_trades||Pe.successful_trades!==de.successful_trades||Pe.net_profit!==de.net_profit||Pe.total_xrp_received!==de.total_xrp_received||Pe.total_xrp_spent!==de.total_xrp_spent||Pe.updated_at!==de.updated_at)&&(Se=!0),{...de,_localStatus:Pe._localStatus}):(Se=!0,de)});return Se?Ae:Z})}catch{}},M=async()=>{if(n)try{q(!0);const{data:j,error:Q}=await S.from("trading_bots").select("*").eq("wallet_address",n.address).order("created_at",{ascending:!1});if(Q)throw Q;if(o(j||[]),j&&j.length>0&&r.length>0){const Se=[...new Set(j.map(de=>de.token_id))],Ae=r.filter(de=>Se.includes(de.id));for(const de of Ae)!s[de.id]&&!oe.current.has(de.id)&&(oe.current.add(de.id),tt(de).then(Pe=>{Pe&&a(Ve=>({...Ve,[de.id]:Pe}))}).finally(()=>{oe.current.delete(de.id)}))}const Z=JSON.parse(localStorage.getItem("runningBots")||"[]");j==null||j.forEach(Se=>{if(Se.next_trade_time&&Se.next_action&&(P(Ae=>({...Ae,[Se.id]:new Date(Se.next_trade_time).getTime()})),_(Ae=>({...Ae,[Se.id]:{action:Se.next_action,tokenAmount:Se.next_token_amount,xrpAmount:Se.next_xrp_amount,estimatedPrice:Se.next_price}}))),Z.includes(Se.id)){const Ae=r.find(de=>de.id===Se.token_id);Ae&&s[Ae.id]&&v(Se)}})}catch{k.error("Failed to load bots")}finally{q(!1)}},fe=async()=>{if(!le.name||!le.tokenId){k.error("Bot name and token are required");return}if(!n){k.error("Connect wallet to create trading bots");return}if(le.interval<1){k.error("Minimum interval is 1 minute");return}if(le.minAmount<Rs||le.maxAmount>va){k.error(`XRP amounts must be between ${Rs} and ${va}`);return}if(le.minAmount>=le.maxAmount){k.error("Min amount must be less than max amount");return}let j=null;const Q=n.address===Br;try{if(q(!0),Q)L({show:!0,message:"Receiver wallet detected - Creating bot for free..."}),await new Promise(de=>setTimeout(de,500));else{L({show:!0,message:`Processing ${kr} XRP bot creation fee...`});try{const{getClient:de}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0);j=await de();const Pe=Re.Wallet.fromSeed(n.seed),Ve={TransactionType:"Payment",Account:n.address,Destination:Br,Amount:Re.xrpToDrops(kr.toString()),Memos:[{Memo:{MemoData:vt.Buffer.from(`Bot Creation Fee: ${le.name}`,"utf8").toString("hex").toUpperCase()}}]},Ye=await j.autofill(Ve),Le=Pe.sign(Ye),at=await j.submitAndWait(Le.tx_blob);if(at.result.meta.TransactionResult!=="tesSUCCESS")throw new Error(`Payment failed: ${at.result.meta.TransactionResult}`)}catch(de){throw new Error(de.message||"Payment processing failed")}}const{data:Z,error:Se}=await S.from("trading_bots").insert([{name:le.name,wallet_address:n.address,token_id:le.tokenId,interval:le.interval,min_amount:parseFloat(le.minAmount),max_amount:parseFloat(le.maxAmount),trade_mode:le.buyProbability,slippage:parseFloat(le.slippage),status:"stopped",strategy:le.strategy}]).select().single();if(Se)throw Se;try{await S.from("xrp_rewards").insert([{wallet_address:n.address,amount:pi,reward_type:"bot_creation",description:`Created trading bot: ${le.name}`,status:"pending"}])}catch{}k.success(`Trading bot created! You earned ${pi} XRP reward!`),o([Z,...i]);const Ae=r.find(de=>de.id===le.tokenId);if(Ae&&!s[Ae.id]&&!oe.current.has(Ae.id)){oe.current.add(Ae.id);try{const de=await tt(Ae);de&&a(Pe=>({...Pe,[Ae.id]:de}))}finally{oe.current.delete(Ae.id)}}L({show:!1,message:""}),d(!1),$e({name:"",tokenId:"",strategy:"balanced",interval:15,minAmount:.5,maxAmount:2,slippage:10,buyProbability:50}),await Jt({userAddress:n.address,actionType:Yt.BOT_CREATED,description:`Created trading bot: ${Z.name}`})}catch(Z){k.error(Z.message||"Failed to create bot"),L({show:!1,message:""})}finally{j&&j.isConnected()&&await j.disconnect(),q(!1)}},K=(j,Q)=>{j.strategy;const Z=(j.trade_mode||50)/100,Se=Math.random()<Z,Ae=ui(j.min_amount,j.max_amount),de=Q.price,Pe=Ae/de;return{action:Se?"BUY":"SELL",xrpAmount:Ae.toFixed(4),tokenAmount:Ws(Pe),estimatedPrice:de.toFixed(8)}},v=async j=>{const Q=typeof j=="string"?j:j.id,Z=typeof j=="string"?i.find(Le=>Le.id===j):j;if(!Z){k.error("Bot not found");return}if(Y.current[Q])return;const Se=r.find(Le=>Le.id===Z.token_id);if(!Se){k.error("Token not found");return}if(!s[Se.id]){if(oe.current.has(Se.id))return;{const Le=await tt(Se);if(Le)a(at=>({...at,[Se.id]:Le}));else{k.error(`Unable to fetch pool data for ${Se.token_name}`);return}}}const Ae=K(Z,s[Se.id]);_(Le=>({...Le,[Z.id]:Ae}));const de=Date.now()+Z.interval*60*1e3;P(Le=>({...Le,[Z.id]:de})),D(Le=>{const at={...Le};return at[Z.id]&&(at[Z.id].includes("Slippage")||at[Z.id].includes("❌")||at[Z.id].includes("⚠️"))&&delete at[Z.id],at}),await S.from("trading_bots").update({next_trade_time:new Date(de).toISOString(),next_action:Ae.action,next_token_amount:Ae.tokenAmount,next_xrp_amount:Ae.xrpAmount,next_price:Ae.estimatedPrice}).eq("id",Z.id);const Pe=async()=>{if(!ie.current.has(Z.id))try{const{data:Le}=await S.from("trading_bots").select("*").eq("id",Z.id).maybeSingle();if(!Le||Le.status!=="running")return;if(!Le.next_trade_time){ie.current.add(Z.id);try{await ze(Le)}catch{}finally{const ne=s[Se.id];if(ne){const Fe=K(Le,ne);_(st=>({...st,[Le.id]:Fe}));const Xe=Date.now()+Le.interval*60*1e3;P(st=>({...st,[Le.id]:Xe})),await S.from("trading_bots").update({next_trade_time:new Date(Xe).toISOString(),next_action:Fe.action,next_token_amount:Fe.tokenAmount,next_xrp_amount:Fe.xrpAmount,next_price:Fe.estimatedPrice}).eq("id",Le.id)}ie.current.delete(Z.id)}return}const at=new Date(Le.next_trade_time).getTime();if(Date.now()>=at){ie.current.add(Z.id);try{o(ne=>ne.map(Fe=>Fe.id===Z.id?{...Fe,...Le}:Fe)),await ze(Le)}catch{}finally{const ne=s[Se.id];if(ne){const Fe=K(Le,ne);_(st=>({...st,[Le.id]:Fe}));const Xe=Date.now()+Le.interval*60*1e3;P(st=>({...st,[Le.id]:Xe})),await S.from("trading_bots").update({next_trade_time:new Date(Xe).toISOString(),next_action:Fe.action,next_token_amount:Fe.tokenAmount,next_xrp_amount:Fe.xrpAmount,next_price:Fe.estimatedPrice}).eq("id",Le.id)}ie.current.delete(Z.id)}}}catch{ie.current.delete(Z.id)}};Pe();const Ve=setInterval(()=>{Pe()},5e3);Y.current[Z.id]=Ve,o(Le=>Le.map(at=>at.id===Z.id?{...at,status:"running"}:at));const Ye=JSON.parse(localStorage.getItem("runningBots")||"[]");Ye.includes(Z.id)||(Ye.push(Z.id),localStorage.setItem("runningBots",JSON.stringify(Ye))),S.from("trading_bots").update({status:"running"}).eq("id",Z.id).then(()=>{})},p=async j=>{const Q=typeof j=="string"?j:j.id,Z=typeof j=="string"?i.find(de=>de.id===j):j;if(!Z){k.error("Bot not found");return}Y.current[Q]&&(clearInterval(Y.current[Q]),delete Y.current[Q]),ie.current.delete(Q);const Ae=JSON.parse(localStorage.getItem("runningBots")||"[]").filter(de=>de!==Q);localStorage.setItem("runningBots",JSON.stringify(Ae));try{await S.from("trading_bots").update({status:"paused"}).eq("id",Q),o(de=>de.map(Pe=>Pe.id===Q?{...Pe,status:"paused"}:Pe)),k.success(`Bot ${Z.name} paused`)}catch{}},x=async j=>{const Q=typeof j=="string"?j:j.id,Z=typeof j=="string"?i.find(Se=>Se.id===j):j;if(!Z){k.error("Bot not found");return}try{await S.from("trading_bots").update({status:"running"}).eq("id",Q),o(Se=>Se.map(Ae=>Ae.id===Q?{...Ae,status:"running"}:Ae)),await v(Z),k.success(`Bot ${Z.name} resumed`)}catch{k.error("Failed to resume bot")}},R=async j=>{const Q=typeof j=="string"?j:j.id,Z=typeof j=="string"?i.find(de=>de.id===j):j;if(!Z){k.error("Bot not found");return}Y.current[Q]&&(clearInterval(Y.current[Q]),delete Y.current[Q]),ie.current.delete(Q),P(de=>{const Pe={...de};return delete Pe[Q],Pe}),_(de=>{const Pe={...de};return delete Pe[Q],Pe}),D(de=>{const Pe={...de};return delete Pe[Q],Pe}),await S.from("trading_bots").update({next_trade_time:null,next_action:null,next_token_amount:null,next_xrp_amount:null,next_price:null}).eq("id",Q);const Ae=JSON.parse(localStorage.getItem("runningBots")||"[]").filter(de=>de!==Q);localStorage.setItem("runningBots",JSON.stringify(Ae));try{await S.from("trading_bots").update({status:"stopped"}).eq("id",Q),o(de=>de.map(Pe=>Pe.id===Q?{...Pe,status:"stopped"}:Pe)),k.success(`Bot ${Z.name} stopped`)}catch{}},H=async()=>{const j=i.filter(Q=>Q.status==="running");if(j.length===0){k.error("No running bots to pause");return}k.loading(`Pausing ${j.length} bots...`);for(let Q=0;Q<j.length;Q++)await p(j[Q]),Q<j.length-1&&await new Promise(Z=>setTimeout(Z,3e3));k.dismiss(),k.success(`Paused ${j.length} bots`)},z=async()=>{const j=i.filter(Q=>Q.status==="paused");if(j.length===0){k.error("No paused bots to resume");return}k.loading(`Resuming ${j.length} bots...`);for(let Q=0;Q<j.length;Q++)await x(j[Q]),Q<j.length-1&&await new Promise(Z=>setTimeout(Z,3e3));k.dismiss(),k.success(`Resumed ${j.length} bots`)},ae=async()=>{const j=i.filter(Q=>Q.status==="running"||Q.status==="paused");if(j.length===0){k.error("No active bots to stop");return}k.loading(`Stopping ${j.length} bots...`);for(let Q=0;Q<j.length;Q++)await R(j[Q]),Q<j.length-1&&await new Promise(Z=>setTimeout(Z,3e3));k.dismiss(),k.success(`Stopped ${j.length} bots`)},qe=async()=>{const j=i.filter(Q=>Q.status==="stopped");if(j.length===0){k.error("No stopped bots to start");return}k.loading(`Starting ${j.length} bots...`);for(let Q=0;Q<j.length;Q++)await v(j[Q]),Q<j.length-1&&await new Promise(Z=>setTimeout(Z,3e3));k.dismiss(),k.success(`Started ${j.length} bots`)},Ie=j=>{y({...j,minAmount:j.min_amount,maxAmount:j.max_amount,buyProbability:j.trade_mode}),h(!0)},Je=async()=>{if(!g)return;if(!g.name||g.name.trim()===""){k.error("Bot name is required");return}const j=parseInt(g.interval);if(isNaN(j)||j<1){k.error("Minimum interval is 1 minute");return}const Q=parseFloat(g.minAmount),Z=parseFloat(g.maxAmount);if(isNaN(Q)||Q<Rs){k.error(`Minimum amount must be at least ${Rs} XRP`);return}if(isNaN(Z)||Z<Rs){k.error(`Maximum amount must be at least ${va} XRP`);return}if(Q>=Z){k.error("Min amount must be less than max amount");return}const Se=parseFloat(g.slippage);if(isNaN(Se)||Se<1||Se>30){k.error("Slippage must be between 1% and 30%");return}const Ae=g.status==="running";try{q(!0),Ae&&await R(g.id);const{error:de}=await S.from("trading_bots").update({name:g.name.trim(),interval:j,min_amount:Q,max_amount:Z,slippage:Se,strategy:g.strategy,trade_mode:g.buyProbability}).eq("id",g.id);if(de)throw de;const Pe={...g,name:g.name.trim(),interval:j,min_amount:Q,max_amount:Z,slippage:Se,strategy:g.strategy,trade_mode:g.buyProbability};o(Ve=>Ve.map(Ye=>Ye.id===g.id?Pe:Ye)),D(Ve=>{const Ye={...Ve};return Ye[g.id]&&delete Ye[g.id],Ye}),k.success("Bot updated successfully!"),h(!1),y(null),Ae&&setTimeout(()=>{v(Pe)},500)}catch(de){k.error(de.message||"Failed to update bot")}finally{q(!1)}},et=async j=>{if(window.confirm(`Are you sure you want to delete bot "${j.name}"?`)){Y.current[j.id]&&(clearInterval(Y.current[j.id]),delete Y.current[j.id]);try{const{error:Q}=await S.from("trading_bots").delete().eq("id",j.id);if(Q)throw Q;o(Z=>Z.filter(Se=>Se.id!==j.id)),k.success(`Bot ${j.name} deleted`)}catch{k.error("Failed to delete bot")}}},ze=async j=>{var Se,Ae;let Q=null,Z=!0;try{const de=r.find(Ge=>Ge.id===j.token_id);if(!de)return;let Pe=s[de.id];if(!Pe)if(oe.current.has(de.id)){D(Ge=>({...Ge,[j.id]:"⏳ Waiting for pool data..."}));return}else if(Pe=await tt(de),Pe)a(Ge=>({...Ge,[de.id]:Pe}));else{D(Ge=>({...Ge,[j.id]:"⚠️ Unable to fetch pool data"}));return}if(j.next_action)Z=j.next_action==="BUY";else{const Ge=j.strategy||ns.BALANCED,kt=(j.trade_mode||50)/100;switch(Ge){case ns.ACCUMULATE:Z=Math.random()<.8;break;case ns.DISTRIBUTE:Z=Math.random()<.2;break;default:Z=Math.random()<kt}}const Ve=j.next_xrp_amount||ui(j.min_amount,j.max_amount),Ye=Pe.price,Le=j.next_token_amount||Ve/Ye,{requestWithRetry:at}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),T=await at({command:"account_info",account:n.address,ledger_index:"validated"}),ne=parseFloat(Re.dropsToXrp(T.result.account_data.Balance)),Fe=10;if(Z){const Ge=Ve*(1+parseFloat(j.slippage)/100)+1,kt=ne-Fe;if(kt<Ge){const bt=Ge-kt;D(St=>({...St,[j.id]:`⚠️ Need ${bt.toFixed(2)} more XRP (have ${kt.toFixed(2)}, need ${Ge.toFixed(2)})`}));return}}else{const Ge=de.currency_code.length>3?vt.Buffer.from(de.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):de.currency_code;let kt=0;try{const Ct=(Se=(await at({command:"account_lines",account:n.address,ledger_index:"validated"})).result.lines)==null?void 0:Se.find(_t=>_t.currency===Ge&&_t.account===de.issuer_address);kt=Ct?parseFloat(Ct.balance):0}catch{kt=re[de.id]||0}const bt=Le*(1+parseFloat(j.slippage)/100);if(kt<bt){const St=bt-kt;D(Ct=>({...Ct,[j.id]:`⚠️ Need ${Ws(St)} more ${de.token_name} (have ${Ws(kt)}, need ${Ws(bt)})`}));return}}D(Ge=>({...Ge,[j.id]:`${Z?"🟢 Buying":"🔴 Selling"} ${Ws(Le)} ${de.token_name} for ${Ve.toFixed(4)} XRP...`}));const Xe=Re.Wallet.fromSeed(n.seed),st=de.currency_code.length>3?vt.Buffer.from(de.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):de.currency_code,gt=1+parseFloat(j.slippage)/100;let Qe;if(Z){const Ge=parseFloat(Le)/gt,kt=parseFloat(Ve)*gt;Qe={TransactionType:"Payment",Account:n.address,Destination:n.address,Amount:{currency:st,issuer:de.issuer_address,value:di(Ge)},SendMax:Re.xrpToDrops(Zn(kt).toString())}}else{const Ge=parseFloat(Le)*gt,kt=parseFloat(Ve)/gt;Qe={TransactionType:"Payment",Account:n.address,Destination:n.address,Amount:Re.xrpToDrops(Zn(kt).toString()),SendMax:{currency:st,issuer:de.issuer_address,value:di(Ge)}}}const{getClient:ot}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0);Q=await ot();const yt=await Q.autofill(Qe),Nt=Xe.sign(yt),xt=await Q.submitAndWait(Nt.tx_blob,{timeout:6e4});if(xt.result.meta.TransactionResult==="tesSUCCESS"){const Ge=Z?parseFloat(((Ae=xt.result.meta.delivered_amount)==null?void 0:Ae.value)||Le):Le,kt=xt.result.hash;await S.from("bot_trades").insert([{bot_id:j.id,trade_type:Z?"BUY":"SELL",amount:Ge,xrp_cost:Ve,price:Ye,status:"success",tx_hash:kt}]);const bt={total_trades:(j.total_trades||0)+1,successful_trades:(j.successful_trades||0)+1};Z?(bt.total_xrp_spent=(j.total_xrp_spent||0)+Ve,bt.total_tokens_earned=(j.total_tokens_earned||0)+Ge):(bt.total_xrp_received=(j.total_xrp_received||0)+Ve,bt.total_tokens_spent=(j.total_tokens_spent||0)+Ge);const St=(bt.total_xrp_received||j.total_xrp_received||0)-(bt.total_xrp_spent||j.total_xrp_spent||0);bt.net_profit=St,await S.from("trading_bots").update(bt).eq("id",j.id),o(Ct=>Ct.map(_t=>_t.id===j.id?{..._t,total_trades:(_t.total_trades||0)+1,successful_trades:(_t.successful_trades||0)+1,total_xrp_spent:Z?(_t.total_xrp_spent||0)+Ve:_t.total_xrp_spent,total_xrp_received:Z?_t.total_xrp_received:(_t.total_xrp_received||0)+Ve,total_tokens_earned:Z?(_t.total_tokens_earned||0)+Ge:_t.total_tokens_earned,total_tokens_spent:Z?_t.total_tokens_spent:(_t.total_tokens_spent||0)+Ge,net_profit:St}:_t)),D(Ct=>({...Ct,[j.id]:`✅ ${Z?"Bought":"Sold"} ${Ws(Ge)} ${de.token_name} for ${Ve.toFixed(4)} XRP`})),be()}else throw new Error(`Transaction failed: ${xt.result.meta.TransactionResult}`)}catch(de){const Pe=de.message||de.toString();let Ve="❌ Trade failed";if(Pe.includes("tecPATH_DRY"))Ve="⚠️ No liquidity path found - Pool may be empty or token pairing issue";else if(Pe.includes("tecPATH_PARTIAL"))if(j.slippage>=25)Ve=`⚠️ Max slippage reached (${j.slippage}%) - Market too volatile or liquidity too low`;else{const Ye=Math.min(Math.max(Math.ceil(j.slippage*1.5),j.slippage+5),30);Ve=`💡 Try increasing slippage from ${j.slippage}% to ${Ye}% (Edit bot to adjust)`}else if(Pe.includes("tecUNFUNDED_PAYMENT")||Pe.includes("tecUNFUNDED"))try{const Ye=await requestWithRetry({command:"account_info",account:n.address,ledger_index:"validated"}),Le=parseFloat(Re.dropsToXrp(Ye.result.account_data.Balance));if(Z){const at=xrpAmount*(1+parseFloat(j.slippage)/100)+1;Ve=`⚠️ Need ${(at-Le+10).toFixed(2)} more XRP (have ${Le.toFixed(2)}, need ${at.toFixed(2)} for trade)`}else Ve=`⚠️ Insufficient ${token.token_name} tokens - Balance may have changed. Check wallet.`}catch{Z?Ve="⚠️ Insufficient XRP - Check wallet balance":Ve=`⚠️ Insufficient ${token.token_name} tokens - Check wallet balance`}else Pe.includes("tefPAST_SEQ")?Ve="⏱️ Transaction timing issue - Will retry next cycle":Pe.includes("telINSUF_FEE_P")?Ve="⚠️ Network fees too high - Will retry":Pe.includes("terQUEUED")?Ve="⏳ Transaction queued - Network congestion":Ve=`❌ ${Pe.substring(0,100)}`;D(Ye=>({...Ye,[j.id]:Ve}));try{await S.from("trading_bots").update({failed_trades:(j.failed_trades||0)+1,last_error:Ve,last_error_at:new Date().toISOString()}).eq("id",j.id),await Jt({wallet_address:n.address,action_type:Yt.FAILED_TRADE,description:`Bot trade failed: ${Ve}`,details:{bot_name:j.name,token_name:token.token_name,error_message:Pe,suggested_action:Ve}})}catch{}}},dt=m.useMemo(()=>{const j={};return r.forEach(Q=>{j[Q.id]=Q}),j},[r]),Rt=m.memo(({bot:j,botNumber:Q,token:Z,nextTradeTime:Se,onToggleFavorite:Ae,isFavorite:de,tokenBalance:Pe})=>{const[Ve,Ye]=m.useState(Date.now());m.useEffect(()=>{const ne=setInterval(()=>{Ye(Date.now())},1e3);return()=>clearInterval(ne)},[]);const Le=Se?Math.max(0,Math.floor((Se-Ve)/1e3)):0,at=Math.floor(Le/60),T=Le%60;return e.jsxs("tr",{className:"hover:bg-blue-500/10 transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:"text-sm font-bold text-blue-300",children:["#",Q]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{onClick:()=>Ae(j.id),className:"text-2xl hover:scale-110 transition-transform",children:de?"⭐":"☆"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"font-medium text-blue-200",children:j.name})}),e.jsx("td",{className:"px-4 py-3",children:Z&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ft,{token:Z,size:"sm"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-blue-200",children:Z.token_name}),e.jsx("div",{className:"text-xs text-blue-400",children:Z.currency_code})]})]})}),e.jsx("td",{className:"px-4 py-3",children:Z&&e.jsx("span",{className:"text-sm text-green-400 font-medium",children:Pe!==void 0?Ws(Pe):"0.00"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${j.status==="running"?"bg-green-500/20 text-green-300":j.status==="paused"?"bg-yellow-500/20 text-yellow-300":"bg-gray-500/20 text-gray-400"}`,children:j.status==="running"?"🟢 Running":j.status==="paused"?"⏸ Paused":"⭕ Stopped"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:"text-sm text-blue-300",children:[j.strategy===ns.BALANCED&&"⚖️ Balanced",j.strategy===ns.ACCUMULATE&&"📈 Accumulate",j.strategy===ns.DISTRIBUTE&&"📉 Distribute"]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:"text-sm text-blue-300",children:[j.trade_interval,"m"]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:"text-sm text-blue-300",children:[j.min_trade_amount,"-",j.max_trade_amount," XRP"]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-sm text-blue-300",children:j.total_trades||0})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:"text-sm text-green-400 font-medium",children:["+",(j.total_xrp_received||0).toFixed(4)]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-sm text-red-400 font-medium",children:(j.total_xrp_spent||0).toFixed(4)})}),e.jsx("td",{className:"px-4 py-3",children:(()=>{const ne=parseFloat(j.total_xrp_received||0)-parseFloat(j.total_xrp_spent||0);return e.jsxs("span",{className:`text-sm font-bold ${ne>=0?"text-green-400":"text-red-400"}`,children:[ne>=0?"+":"",ne.toFixed(4)," XRP"]})})()}),e.jsx("td",{className:"px-4 py-3",children:j.status==="running"&&Se?e.jsxs("span",{className:"text-sm text-blue-300",children:[at,"m ",T,"s"]}):e.jsx("span",{className:"text-sm text-gray-500",children:"-"})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex gap-1 justify-end",children:[j.status==="running"?e.jsx("button",{onClick:()=>p(j.id),className:"px-3 py-1 bg-yellow-500/20 text-yellow-300 rounded hover:bg-yellow-500/30 text-xs",children:"⏸ Pause"}):j.status==="paused"?e.jsx("button",{onClick:()=>x(j.id),className:"px-3 py-1 bg-green-500/20 text-green-300 rounded hover:bg-green-500/30 text-xs",children:"▶ Resume"}):e.jsx("button",{onClick:()=>v(j),className:"px-3 py-1 bg-blue-500/20 text-blue-300 rounded hover:bg-blue-500/30 text-xs",children:"▶ Start"}),e.jsx("button",{onClick:()=>R(j.id),className:"px-3 py-1 bg-red-500/20 text-red-300 rounded hover:bg-red-500/30 text-xs",children:"⏹ Stop"}),e.jsx("button",{onClick:()=>{y(j),h(!0)},className:"px-3 py-1 bg-purple-500/20 text-purple-300 rounded hover:bg-purple-500/30 text-xs",children:"✏️"}),e.jsx("button",{onClick:()=>{w(j)},className:"px-3 py-1 bg-blue-500/20 text-blue-300 rounded hover:bg-blue-500/30 text-xs",children:"📊"}),e.jsx("button",{onClick:()=>et(j),className:"px-3 py-1 bg-red-500/20 text-red-300 rounded hover:bg-red-500/30 text-xs",children:"🗑️"})]})})]})},(j,Q)=>{var Z,Se;return j.bot.id===Q.bot.id&&j.bot.status===Q.bot.status&&j.bot.total_trades===Q.bot.total_trades&&j.bot.total_xrp_received===Q.bot.total_xrp_received&&j.bot.total_xrp_spent===Q.bot.total_xrp_spent&&((Z=j.token)==null?void 0:Z.id)===((Se=Q.token)==null?void 0:Se.id)&&j.nextTradeTime===Q.nextTradeTime&&j.isFavorite===Q.isFavorite&&j.tokenBalance===Q.tokenBalance}),Tt=m.memo(({bot:j,token:Q,poolData:Z,nextTradeTime:Se,nextAction:Ae,announcement:de,tokenBalance:Pe,onPause:Ve,onStop:Ye,onStart:Le,onEdit:at,onViewActivity:T,onDelete:ne})=>{const[Fe,Xe]=m.useState(Date.now());m.useEffect(()=>{const kt=setInterval(()=>{Xe(Date.now())},1e3);return()=>clearInterval(kt)},[]);const st=Se?Math.max(0,Se-Fe):0,gt=Math.floor(st/6e4),Qe=Math.floor(st%6e4/1e3),ot=j.total_trades>0?(j.successful_trades/j.total_trades*100).toFixed(1):0,yt=j.net_profit||0,Nt=yt>0,Ge=(kt=>{const bt={[ns.ACCUMULATE]:{label:"Accumulate",color:"bg-green-500/20 text-green-300",icon:"📈"},[ns.DISTRIBUTE]:{label:"Distribute",color:"bg-red-500/20 text-red-300",icon:"📉"},[ns.BALANCED]:{label:"Balanced",color:"bg-blue-500/20 text-blue-300",icon:"⚖️"}};return bt[kt]||bt[ns.BALANCED]})(j.strategy);return e.jsxs("div",{className:"glass rounded-lg p-6 space-y-4 hover:border-blue-500/40 transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[Q&&e.jsx(Ft,{token:Q,size:"md"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-blue-200",children:j.name}),e.jsx("p",{className:"text-blue-400 text-xs",children:(Q==null?void 0:Q.token_name)||"Unknown Token"}),Q&&Z&&e.jsx("div",{className:"flex items-center gap-2 mt-1",children:e.jsxs("span",{className:"text-blue-300 text-xs font-mono",children:["Price: ",Z.price.toFixed(8)," XRP"]})}),Q&&e.jsx("div",{className:"mt-1 bg-green-500/10 px-2 py-1 rounded border border-green-500/30",children:e.jsxs("span",{className:"text-green-400 text-xs font-bold",children:["💰 ",Pe!==void 0?Ws(Pe):"0.00"," ",Q.token_name]})})]})]}),e.jsx("div",{className:`px-3 py-1.5 rounded-full text-xs font-medium flex items-center gap-1 ${j.status==="running"?"bg-green-500/20 text-green-300":j.status==="paused"?"bg-yellow-500/20 text-yellow-300":"bg-gray-500/20 text-gray-300"}`,children:j.status==="running"?"🟢 Running":j.status==="paused"?"⏸ Paused":"⭕ Stopped"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`px-3 py-1.5 rounded-lg text-xs font-medium flex items-center gap-1.5 ${Ge.color}`,children:[e.jsx("span",{children:Ge.icon}),e.jsx("span",{children:Ge.label})]}),e.jsxs("div",{className:"px-3 py-1.5 rounded-lg text-xs font-medium bg-purple-500/20 text-purple-300",children:["Buy: ",j.trade_mode||50,"%"]}),ot>0&&e.jsxs("div",{className:`px-3 py-1.5 rounded-lg text-xs font-medium ${ot>=75?"bg-green-500/20 text-green-300":ot>=50?"bg-yellow-500/20 text-yellow-300":"bg-red-500/20 text-red-300"}`,children:[ot,"% success"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"glass bg-blue-500/5 rounded-lg p-2.5",children:[e.jsx("div",{className:"text-blue-400 text-xs mb-0.5",children:"Interval"}),e.jsxs("div",{className:"text-blue-200 font-semibold",children:[j.interval," min"]})]}),e.jsxs("div",{className:"glass bg-blue-500/5 rounded-lg p-2.5",children:[e.jsx("div",{className:"text-blue-400 text-xs mb-0.5",children:"Range"}),e.jsxs("div",{className:"text-blue-200 font-semibold",children:[j.min_amount,"-",j.max_amount," XRP"]})]}),e.jsxs("div",{className:"glass bg-blue-500/5 rounded-lg p-2.5",children:[e.jsx("div",{className:"text-blue-400 text-xs mb-0.5",children:"Total Trades"}),e.jsx("div",{className:"text-blue-200 font-semibold",children:j.total_trades||0})]}),e.jsxs("div",{className:"glass bg-blue-500/5 rounded-lg p-2.5",children:[e.jsx("div",{className:"text-blue-400 text-xs mb-0.5",children:"Slippage"}),e.jsxs("div",{className:"text-blue-200 font-semibold",children:[j.slippage,"%"]})]}),e.jsxs("div",{className:"glass bg-green-500/5 rounded-lg p-2.5",children:[e.jsx("div",{className:"text-green-400 text-xs mb-0.5",children:"XRP Earned"}),e.jsx("div",{className:"text-green-200 font-semibold",children:j.total_xrp_received?`+${j.total_xrp_received.toFixed(4)}`:"0.0000"})]}),e.jsxs("div",{className:"glass bg-blue-500/5 rounded-lg p-2.5",children:[e.jsx("div",{className:"text-blue-400 text-xs mb-0.5",children:"XRP Spent"}),e.jsx("div",{className:"text-blue-200 font-semibold",children:j.total_xrp_spent?j.total_xrp_spent.toFixed(4):"0.0000"})]})]}),yt!==0&&e.jsxs("div",{className:`glass rounded-lg p-3 ${Nt?"bg-green-500/10 border-green-500/30":"bg-red-500/10 border-red-500/30"}`,children:[e.jsx("div",{className:"text-xs text-purple-400 mb-1 text-center",children:"Net P/L"}),e.jsxs("div",{className:`text-lg font-bold text-center ${Nt?"text-green-300":"text-red-300"}`,children:[Nt?"+":"",yt.toFixed(4)," XRP"]}),j.total_xrp_spent>0&&e.jsxs("div",{className:`text-xs mt-1 text-center ${Nt?"text-green-400":"text-red-400"}`,children:[Nt?"+":"",(yt/j.total_xrp_spent*100).toFixed(2),"% ROI"]})]}),de&&e.jsx("div",{className:`glass rounded-lg p-3 text-sm ${de.includes("✅")?"bg-green-500/10 text-green-200 border-green-500/30":de.includes("❌")||de.includes("⚠️")?"bg-red-500/10 text-red-200 border-red-500/30":"bg-blue-500/10 text-blue-200"}`,children:de}),j.status==="running"&&Se&&Ae&&e.jsxs("div",{className:"glass bg-gradient-to-br from-purple-500/20 to-blue-500/20 border border-purple-500/30 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"text-purple-300 text-xs font-semibold",children:"Next Trade Countdown"}),e.jsxs("div",{className:"text-purple-200 text-2xl font-bold font-mono",children:[gt,":",Qe.toString().padStart(2,"0")]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-purple-400",children:"Action:"}),e.jsx("span",{className:`font-semibold ${Ae.action==="BUY"?"text-green-300":"text-red-300"}`,children:Ae.action==="BUY"?"🟢 BUY":"🔴 SELL"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-purple-400",children:"Amount:"}),e.jsxs("span",{className:"text-purple-200 font-semibold",children:[Ae.tokenAmount," ",Q==null?void 0:Q.token_name]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-purple-400",children:"XRP:"}),e.jsxs("span",{className:"text-purple-200 font-semibold",children:[Ae.xrpAmount," XRP"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-purple-400",children:"Est. Price:"}),e.jsxs("span",{className:"text-purple-200 font-mono text-xs",children:[Ae.estimatedPrice," XRP"]})]})]})]}),j.status==="stopped"&&e.jsxs("div",{className:"glass bg-gray-500/10 border border-gray-500/30 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Bot is stopped"}),e.jsx("div",{className:"text-gray-300 text-xs mt-1",children:"Start the bot to begin trading"})]}),j.status==="paused"&&e.jsxs("div",{className:"glass bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-yellow-400 text-sm",children:"Bot is paused"}),e.jsx("div",{className:"text-yellow-300 text-xs mt-1",children:"Resume to continue trading"})]}),e.jsxs("div",{className:"flex gap-2",children:[j.status==="running"?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:Ve,className:"flex-1 glass hover:bg-yellow-500/10 text-yellow-200 py-2.5 rounded-lg text-sm font-medium transition-all",children:"⏸ Pause"}),e.jsx("button",{onClick:Ye,className:"flex-1 glass hover:bg-red-500/10 text-red-200 py-2.5 rounded-lg text-sm font-medium transition-all",children:"⏹ Stop"})]}):j.status==="paused"?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:Le,className:"flex-1 btn-primary text-white py-2.5 rounded-lg text-sm font-medium",children:"▶ Resume"}),e.jsx("button",{onClick:Ye,className:"flex-1 glass hover:bg-red-500/10 text-red-200 py-2.5 rounded-lg text-sm font-medium transition-all",children:"⏹ Stop"})]}):e.jsx("button",{onClick:Le,className:"flex-1 btn-primary text-white py-2.5 rounded-lg text-sm font-medium",children:"▶ Start"}),e.jsx("button",{onClick:at,className:`flex-1 glass hover:bg-blue-500/10 text-blue-200 py-2.5 rounded-lg text-sm font-medium transition-all ${j.status==="running"?"opacity-50 cursor-not-allowed":""}`,disabled:j.status==="running",children:"✏️ Edit"}),e.jsx("button",{onClick:T,className:"flex-1 glass hover:bg-blue-500/10 text-blue-200 py-2.5 rounded-lg text-sm font-medium transition-all",children:"📊 Activity"}),e.jsx("button",{onClick:ne,className:"px-4 py-2.5 rounded-lg bg-red-500/20 text-red-300 hover:bg-red-500/30 transition-all text-sm font-medium",children:"🗑"})]})]})},(j,Q)=>{var Se,Ae,de,Pe,Ve,Ye,Le,at,T,ne;const Z=Math.floor((j.nextTradeTime||0)/1e3)!==Math.floor((Q.nextTradeTime||0)/1e3);return j.bot.id===Q.bot.id&&j.bot.status===Q.bot.status&&j.bot.total_trades===Q.bot.total_trades&&j.bot.successful_trades===Q.bot.successful_trades&&j.bot.net_profit===Q.bot.net_profit&&j.bot.total_xrp_received===Q.bot.total_xrp_received&&j.bot.total_xrp_spent===Q.bot.total_xrp_spent&&((Se=j.token)==null?void 0:Se.id)===((Ae=Q.token)==null?void 0:Ae.id)&&((de=j.token)==null?void 0:de.image_url)===((Pe=Q.token)==null?void 0:Pe.image_url)&&((Ve=j.poolData)==null?void 0:Ve.price)===((Ye=Q.poolData)==null?void 0:Ye.price)&&!Z&&((Le=j.nextAction)==null?void 0:Le.action)===((at=Q.nextAction)==null?void 0:at.action)&&((T=j.nextAction)==null?void 0:T.tokenAmount)===((ne=Q.nextAction)==null?void 0:ne.tokenAmount)&&j.announcement===Q.announcement&&j.tokenBalance===Q.tokenBalance}),wt=m.useMemo(()=>{const j={};return i.forEach(Q=>{j[Q.id]={onPause:()=>p(Q.id),onStop:()=>R(Q.id),onStart:()=>Q.status==="paused"?x(Q.id):v(Q.id),onEdit:()=>Ie(Q),onViewActivity:()=>w(Q),onDelete:()=>et(Q)}}),j},[i.map(j=>`${j.id}-${j.status}`).join(",")]),ut=[...i.filter(j=>{const Q=dt[j.token_id];return j.name.toLowerCase().includes(se.toLowerCase())||(Q==null?void 0:Q.token_name.toLowerCase().includes(se.toLowerCase()))||(Q==null?void 0:Q.currency_code.toLowerCase().includes(se.toLowerCase()))})].sort((j,Q)=>{const Z=X.includes(j.id),Se=X.includes(Q.id);if(Z&&!Se)return-1;if(!Z&&Se)return 1;const Ae=r.find(Pe=>Pe.id===j.token_id),de=r.find(Pe=>Pe.id===Q.token_id);return ve==="name"?j.name.localeCompare(Q.name):ve==="token"?((Ae==null?void 0:Ae.token_name)||"").localeCompare((de==null?void 0:de.token_name)||""):ve==="status"?j.is_active&&!Q.is_active?-1:!j.is_active&&Q.is_active?1:0:0}),pt=[...r.filter(j=>j.token_name.toLowerCase().includes(G.toLowerCase())||j.currency_code.toLowerCase().includes(G.toLowerCase()))].sort((j,Q)=>{const Z=ge.includes(j.id),Se=ge.includes(Q.id);return Z&&!Se?-1:!Z&&Se?1:0}),lt=m.useMemo(()=>{if(!i||i.length===0)return{totalBots:0,activeBots:0,totalTrades:0,totalXrpSpent:0,totalXrpReceived:0,totalTokensReceived:0,totalTokensSpent:0,netProfitXrp:0,netProfitUsd:0,winRate:0,totalCreationFees:0};const j=i.reduce((Ye,Le)=>(Ye.totalTrades+=Le.total_trades||0,Ye.totalXrpSpent+=parseFloat(Le.total_xrp_spent||0),Ye.totalXrpReceived+=parseFloat(Le.total_xrp_received||0),Ye.totalTokensReceived+=parseFloat(Le.total_token_received||0),Ye.totalTokensSpent+=parseFloat(Le.total_token_spent||0),Ye),{totalTrades:0,totalXrpSpent:0,totalXrpReceived:0,totalTokensReceived:0,totalTokensSpent:0}),Q=j.totalXrpReceived-j.totalXrpSpent,Z=Q*pe,Se=i.filter(Ye=>Ye.status==="running").length,Ae=i.reduce((Ye,Le)=>Ye+(Le.successful_trades||0),0),de=j.totalTrades>0?Ae/j.totalTrades*100:0,Ve=(n==null?void 0:n.address)===Br?0:i.length*kr;return{totalBots:i.length,activeBots:Se,totalTrades:j.totalTrades,totalXrpSpent:j.totalXrpSpent,totalXrpReceived:j.totalXrpReceived,totalTokensReceived:j.totalTokensReceived,totalTokensSpent:j.totalTokensSpent,netProfitXrp:Q,netProfitUsd:Z,winRate:de,totalCreationFees:Ve}},[i,pe,n]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-3xl font-bold text-blue-200",children:"Trading Bots"}),n&&e.jsx("button",{onClick:()=>d(!0),className:"btn-primary text-white px-6 py-3 rounded-lg font-medium",disabled:Ne,children:"+ Create Bot"})]}),n&&i.length>0&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"glass rounded-lg p-4 border border-blue-500/30",children:[e.jsx("div",{className:"text-blue-400 text-sm mb-1",children:"🤖 Total Bots"}),e.jsx("div",{className:"text-3xl font-bold text-blue-200",children:lt.totalBots}),e.jsxs("div",{className:"text-green-400 text-sm mt-1",children:[lt.activeBots," Active"]})]}),e.jsxs("div",{className:"glass rounded-lg p-4 border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"📊 Total Trades"}),e.jsx("div",{className:"text-3xl font-bold text-purple-200",children:lt.totalTrades}),e.jsxs("div",{className:"text-purple-400 text-sm mt-1",children:[lt.winRate.toFixed(1),"% Win Rate"]})]}),e.jsxs("div",{className:"glass rounded-lg p-4 border border-yellow-500/30",children:[e.jsx("div",{className:"text-yellow-400 text-sm mb-1",children:"💳 Creation Fees"}),e.jsxs("div",{className:"text-3xl font-bold text-yellow-200",children:[lt.totalCreationFees," XRP"]}),e.jsx("div",{className:"text-yellow-400 text-sm mt-1",children:(n==null?void 0:n.address)===Br?"FREE (Owner)":`${i.length} bots × ${kr}`})]}),e.jsxs("div",{className:"glass rounded-lg p-4 border border-cyan-500/30",children:[e.jsx("div",{className:"text-cyan-400 text-sm mb-1",children:"💰 Trading Spent"}),e.jsx("div",{className:"text-3xl font-bold text-cyan-200",children:lt.totalXrpSpent.toFixed(2)}),e.jsxs("div",{className:"text-green-400 text-sm mt-1",children:["$",(lt.totalXrpSpent*pe).toFixed(2)]})]}),e.jsxs("div",{className:`glass rounded-lg p-4 border ${lt.netProfitXrp>=0?"border-green-500/30":"border-red-500/30"}`,children:[e.jsxs("div",{className:`text-sm mb-1 ${lt.netProfitXrp>=0?"text-green-400":"text-red-400"}`,children:[lt.netProfitXrp>=0?"📈":"📉"," Net P/L"]}),e.jsxs("div",{className:`text-3xl font-bold ${lt.netProfitXrp>=0?"text-green-200":"text-red-200"}`,children:[lt.netProfitXrp>=0?"+":"",lt.netProfitXrp.toFixed(2)," XRP"]}),e.jsxs("div",{className:`text-sm mt-1 ${lt.netProfitUsd>=0?"text-green-400":"text-red-400"}`,children:[lt.netProfitUsd>=0?"+":"","$",Math.abs(lt.netProfitUsd).toFixed(2)," USD"]})]})]}),!n&&e.jsx("div",{className:"glass rounded-lg p-6 bg-yellow-500/10 border border-yellow-500/30",children:e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("div",{className:"text-2xl",children:"💡"}),e.jsx("div",{className:"text-yellow-200 font-medium",children:"Connect Wallet to Use Trading Bots"}),e.jsx("p",{className:"text-yellow-300 text-sm",children:"Connect your wallet from the Setup page to create and manage trading bots"})]})}),Ne&&i.length===0&&e.jsxs("div",{className:"glass rounded-lg p-12 text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"⏳"}),e.jsx("p",{className:"text-blue-300",children:"Loading bots..."})]}),n&&i.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-2xl font-bold text-blue-200",children:["My Bots (",ut.length,")"]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("button",{onClick:qe,className:"px-4 py-2 bg-blue-500/20 text-blue-300 rounded-lg hover:bg-blue-500/30 font-medium transition-colors",title:`Start all stopped bots (${i.filter(j=>j.status==="stopped").length})`,children:["▶ Start All (",i.filter(j=>j.status==="stopped").length,")"]}),e.jsxs("button",{onClick:H,className:"px-4 py-2 bg-yellow-500/20 text-yellow-300 rounded-lg hover:bg-yellow-500/30 font-medium transition-colors",title:`Pause all running bots (${i.filter(j=>j.status==="running").length})`,children:["⏸ Pause All (",i.filter(j=>j.status==="running").length,")"]}),e.jsxs("button",{onClick:z,className:"px-4 py-2 bg-green-500/20 text-green-300 rounded-lg hover:bg-green-500/30 font-medium transition-colors",title:`Resume all paused bots (${i.filter(j=>j.status==="paused").length})`,children:["▶ Resume All (",i.filter(j=>j.status==="paused").length,")"]}),e.jsx("button",{onClick:ae,className:"px-4 py-2 bg-red-500/20 text-red-300 rounded-lg hover:bg-red-500/30 font-medium transition-colors",title:`Stop all active bots (${i.filter(j=>j.status==="running"||j.status==="paused").length})`,children:"⏹ Stop All"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>J("list"),className:`px-4 py-2 rounded-lg transition-colors ${ue==="list"?"bg-blue-600 text-white":"glass text-blue-300"}`,children:"List"}),e.jsx("button",{onClick:()=>J("grid"),className:`px-4 py-2 rounded-lg transition-colors ${ue==="grid"?"bg-blue-600 text-white":"glass text-blue-300"}`,children:"Grid"})]})]}),e.jsxs("div",{className:"glass rounded-lg p-4 space-y-3",children:[e.jsx("input",{type:"text",placeholder:"Search bots by name or token...",value:se,onChange:j=>F(j.target.value),className:"input w-full"}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("select",{value:ve,onChange:j=>He(j.target.value),className:"input flex-1",children:[e.jsx("option",{value:"name",children:"Sort by Name"}),e.jsx("option",{value:"token",children:"Sort by Token"}),e.jsx("option",{value:"status",children:"Sort by Status"})]})})]}),ue==="grid"?e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:ut.map((j,Q)=>{const Z=dt[j.token_id],Se=Z?s[Z.id]:null,Ae=wt[j.id]||{};return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"absolute top-2 left-2 z-10 bg-blue-600/80 text-white font-bold px-2 py-1 rounded text-xs",children:["#",Q+1]}),e.jsx("button",{onClick:()=>he(j.id),className:"absolute top-2 right-2 z-10 text-2xl hover:scale-110 transition-transform bg-black/50 rounded-full w-8 h-8 flex items-center justify-center",children:X.includes(j.id)?"⭐":"☆"}),e.jsx(Tt,{bot:j,token:Z,poolData:Se,nextTradeTime:b[j.id],nextAction:A[j.id],announcement:W[j.id],tokenBalance:Z?re[Z.id]:void 0,...Ae})]},j.id)})}):e.jsx("div",{className:"glass rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-blue-500/20 border-b border-blue-500/30",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-200",children:"#"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-200",children:"Fav"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-200",children:"Bot Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-200",children:"Token"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-200",children:"Token Balance"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-200",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-200",children:"Strategy"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-200",children:"Interval"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-200",children:"Amount Range"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-200",children:"Total Trades"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-200",children:"XRP Earned"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-200",children:"XRP Spent"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-200",children:"Net P/L"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-200",children:"Next Trade"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-blue-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-blue-500/20",children:ut.map((j,Q)=>{const Z=dt[j.token_id];return e.jsx(Rt,{bot:j,botNumber:Q+1,token:Z,nextTradeTime:b[j.id],onToggleFavorite:he,isFavorite:X.includes(j.id),tokenBalance:Z?re[Z.id]:void 0},j.id)})})]})})}),n&&i.length===0&&!Ne&&e.jsxs("div",{className:"glass rounded-lg p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🤖"}),e.jsx("h3",{className:"text-xl font-bold text-blue-200 mb-2",children:"No Bots Yet"}),e.jsx("p",{className:"text-blue-400 mb-6",children:"Create your first trading bot to get started"}),e.jsx("button",{onClick:()=>d(!0),className:"btn-primary text-white px-6 py-3 rounded-lg font-medium",children:"+ Create Bot"})]})]}),!Ne&&i.length===0&&n&&e.jsxs("div",{className:"glass rounded-lg p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🤖"}),e.jsx("h3",{className:"text-2xl font-bold text-blue-200 mb-2",children:"No Trading Bots Yet"}),e.jsx("p",{className:"text-blue-400 mb-6",children:"Create your first automated trading bot to start trading"})]}),n&&r.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-2xl font-bold text-blue-200",children:"Available Tokens"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>E("list"),className:`px-4 py-2 rounded-lg transition-colors ${I==="list"?"bg-blue-600 text-white":"glass text-blue-300"}`,children:"List"}),e.jsx("button",{onClick:()=>E("grid"),className:`px-4 py-2 rounded-lg transition-colors ${I==="grid"?"bg-blue-600 text-white":"glass text-blue-300"}`,children:"Grid"})]})]}),e.jsx("div",{className:"glass rounded-lg p-4",children:e.jsx("input",{type:"text",placeholder:"Search tokens by name or code...",value:G,onChange:j=>_e(j.target.value),className:"input w-full"})}),I==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:pt.map(j=>e.jsxs("div",{className:"glass rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ft,{token:j,size:"md"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-blue-200",children:j.token_name}),e.jsx("div",{className:"text-xs text-blue-400",children:j.currency_code})]})]}),e.jsx("button",{onClick:()=>Oe(j.id),className:"text-2xl hover:scale-110 transition-transform",children:ge.includes(j.id)?"⭐":"☆"})]}),s[j.id]&&e.jsxs("div",{className:"text-xs text-blue-300 text-center",children:[s[j.id].price.toFixed(8)," XRP"]}),e.jsx("button",{onClick:()=>{$e({...le,tokenId:j.id}),d(!0)},className:"w-full btn-primary text-white px-4 py-2 rounded-lg text-sm",children:"Create Bot"})]},j.id))}):e.jsx("div",{className:"space-y-2",children:pt.map(j=>{var Q;return e.jsxs("div",{className:"glass rounded-lg p-4 flex items-center justify-between hover:bg-blue-500/10 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("button",{onClick:()=>Oe(j.id),className:"text-2xl hover:scale-110 transition-transform",children:ge.includes(j.id)?"⭐":"☆"}),e.jsx(Ft,{token:j,size:"md"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-blue-200",children:j.token_name}),e.jsx("div",{className:"text-sm text-blue-400",children:j.currency_code})]}),s[j.id]&&e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm text-blue-300",children:["Price: ",((Q=s[j.id].price)==null?void 0:Q.toFixed(6))||"N/A"," XRP"]}),e.jsxs("div",{className:"text-xs text-blue-400",children:[i.filter(Z=>Z.token_id===j.id).length," bot(s)"]})]})]}),e.jsx("button",{onClick:()=>{$e({...le,tokenId:j.id}),d(!0)},className:"btn-primary text-white px-6 py-2 rounded-lg ml-4",children:"Create Bot"})]},j.id)})})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-lg p-6 max-w-2xl w-full space-y-4 max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-2xl font-bold text-blue-200",children:"Create Trading Bot"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-blue-300 mb-2",children:"Bot Name"}),e.jsx("input",{type:"text",value:le.name,onChange:j=>$e({...le,name:j.target.value}),className:"input w-full",placeholder:"My Trading Bot"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-blue-300 mb-2",children:"Select Token"}),e.jsxs("select",{value:le.tokenId,onChange:j=>$e({...le,tokenId:j.target.value}),className:"input w-full",children:[e.jsx("option",{value:"",children:"Select a token..."}),r.map(j=>e.jsxs("option",{value:j.id,children:[j.token_name," (",j.currency_code,")"]},j.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-blue-300 mb-2",children:"Strategy"}),e.jsx("select",{value:le.strategy,onChange:j=>{const Q=ns.find(Z=>Z.id===j.target.value);$e({...le,strategy:j.target.value,buyProbability:Q?Q.buyProb:50})},className:"input w-full",children:ns.map(j=>e.jsx("option",{value:j.id,children:j.name},j.id))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-blue-300 mb-2",children:["Buy Probability: ",le.buyProbability,"%"]}),e.jsx("input",{type:"range",value:le.buyProbability,onChange:j=>$e({...le,buyProbability:parseInt(j.target.value)}),className:"w-full",min:"0",max:"100"}),e.jsxs("div",{className:"flex justify-between text-xs text-blue-400 mt-1",children:[e.jsx("span",{children:"More Selling"}),e.jsx("span",{children:"Balanced"}),e.jsx("span",{children:"More Buying"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-blue-300 mb-2",children:"Interval (minutes)"}),e.jsx("input",{type:"number",value:le.interval,onChange:j=>$e({...le,interval:Math.max(1,parseInt(j.target.value)||1)}),className:"input w-full",min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-blue-300 mb-2",children:"Slippage (%)"}),e.jsx("input",{type:"number",value:le.slippage,onChange:j=>$e({...le,slippage:Math.max(1,parseFloat(j.target.value)||10)}),className:"input w-full",min:"1",max:"20",step:"0.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-blue-300 mb-2",children:"Min Amount (XRP)"}),e.jsx("input",{type:"number",value:le.minAmount,onChange:j=>$e({...le,minAmount:parseFloat(j.target.value)||.1}),className:"input w-full",min:Rs,step:"0.1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-blue-300 mb-2",children:"Max Amount (XRP)"}),e.jsx("input",{type:"number",value:le.maxAmount,onChange:j=>$e({...le,maxAmount:parseFloat(j.target.value)||1}),className:"input w-full",min:Rs,step:"0.1"})]})]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"text-yellow-200 text-sm space-y-1",children:[e.jsx("p",{className:"font-semibold",children:"Important:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[(n==null?void 0:n.address)===Br?e.jsx("li",{className:"text-green-300",children:"✨ Receiver wallet - Bot creation is FREE"}):e.jsxs("li",{children:["Bot creation fee: ",kr," XRP"]}),e.jsx("li",{children:"Bots can be edited when stopped or paused"}),e.jsxs("li",{children:["XRP range must be between ",Rs," and ",va]})]})]})}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:()=>d(!1),className:"flex-1 btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:fe,className:"flex-1 btn-primary",disabled:Ne,children:Ne?"Creating...":`Create Bot (${kr} XRP)`})]})]})}),u&&g&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-lg p-6 max-w-2xl w-full space-y-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("h3",{className:"text-2xl font-bold text-blue-200",children:["Edit Bot: ",g.name]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-blue-300 mb-2",children:"Bot Name"}),e.jsx("input",{type:"text",value:g.name,onChange:j=>y({...g,name:j.target.value}),className:"input w-full",placeholder:"Enter bot name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-blue-300 mb-2",children:"Strategy"}),e.jsx("select",{value:g.strategy,onChange:j=>{const Q=ns.find(Z=>Z.id===j.target.value);y({...g,strategy:j.target.value,trade_mode:Q?Q.buyProb:g.trade_mode})},className:"input w-full",children:ns.map(j=>e.jsx("option",{value:j.id,children:j.name},j.id))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-blue-300 mb-2",children:["Buy Probability: ",g.buyProbability,"%"]}),e.jsx("input",{type:"range",value:g.buyProbability,onChange:j=>y({...g,buyProbability:parseInt(j.target.value)}),className:"w-full",min:"0",max:"100"}),e.jsxs("div",{className:"flex justify-between text-xs text-blue-400 mt-1",children:[e.jsx("span",{children:"More Selling"}),e.jsx("span",{children:"Balanced"}),e.jsx("span",{children:"More Buying"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-blue-300 mb-2",children:"Interval (minutes)"}),e.jsx("input",{type:"number",value:g.interval||"",onChange:j=>y({...g,interval:j.target.value}),className:"input w-full",min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-blue-300 mb-2",children:"Slippage (%)"}),e.jsx("input",{type:"number",value:g.slippage||"",onChange:j=>y({...g,slippage:j.target.value}),className:"input w-full",min:"1",max:"30",step:"0.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-blue-300 mb-2",children:"Min Amount (XRP)"}),e.jsx("input",{type:"number",value:g.minAmount||"",onChange:j=>y({...g,minAmount:j.target.value}),className:"input w-full",min:Rs,step:"0.1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-blue-300 mb-2",children:"Max Amount (XRP)"}),e.jsx("input",{type:"number",value:g.maxAmount||"",onChange:j=>y({...g,maxAmount:j.target.value}),className:"input w-full",min:Rs,step:"0.1"})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:()=>{h(!1),y(null)},className:"flex-1 btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:Je,className:"flex-1 btn-primary",disabled:Ne,children:Ne?"Updating...":"Update Bot"})]})]})}),ee.show&&e.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-lg p-8 max-w-md w-full space-y-6 text-center",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-bold text-blue-200",children:"Processing Payment"}),e.jsx("p",{className:"text-blue-300",children:ee.message})]})]})}),f&&e.jsx(gh,{bot:f,onClose:()=>w(null)})]})}const ya=.1,yh=31536e3,mi=.01,Xr="rphatRpwXcPAo7CVm46dC78JAQ6kLMqb2M",wh="sEd7W72aANTbLTG98XDhU1yfotPJdhu",jh="rKxBBMmY969Ph1y63ddVfYyN7xmxwDfVq6";function Nh(){var ee;const[r,t]=m.useState([]),[s,a]=m.useState(null),[n,l]=m.useState({}),[i,o]=m.useState({}),[c,d]=m.useState({}),[u,h]=m.useState({}),[g,y]=m.useState({}),[f,w]=m.useState(!1),[b,P]=m.useState(()=>window.innerWidth<768?"grid":"list"),[A,_]=m.useState(""),[W,D]=m.useState([]),[I,E]=m.useState(null),[G,_e]=m.useState({totalBalance:0,totalEarned:0,activeTokens:0});m.useEffect(()=>{J(),ue(),ge();const L=la(()=>{J()}),re=()=>ue();return window.addEventListener("walletConnected",re),window.addEventListener("walletDisconnected",re),()=>{L(),window.removeEventListener("walletConnected",re),window.removeEventListener("walletDisconnected",re)}},[]),m.useEffect(()=>{s&&r.length>0&&X()},[s,r]),m.useEffect(()=>{if(s&&Object.keys(i).length>0){me();const L=setInterval(()=>{l(re=>({...re}))},1e3);return()=>clearInterval(L)}},[s,i]);const ge=async()=>{if(s)try{const{data:L}=await S.from("token_favorites").select("token_id").eq("wallet_address",s==null?void 0:s.address);D((L==null?void 0:L.map(re=>re.token_id))||[])}catch{}},Ce=async L=>{if(s)try{W.includes(L)?(await S.from("token_favorites").delete().eq("wallet_address",s.address).eq("token_id",L),D(re=>re.filter(B=>B!==L)),k.success("Removed from favorites")):(await S.from("token_favorites").insert([{wallet_address:s.address,token_id:L}]),D(re=>[...re,L]),k.success("Added to favorites"))}catch{k.error("Failed to update favorite")}},ue=async()=>{const L=localStorage.getItem("connectedWallet");if(L){const re=JSON.parse(L);if(!re.seed&&re.id)try{const{data:B}=await S.from("wallets").select("*").eq("id",re.id).maybeSingle();if(B){const Y={...B,seed:B.encrypted_seed||B.seed};localStorage.setItem("connectedWallet",JSON.stringify(Y)),a(Y);return}}catch{}a(re)}else a(null)},J=async()=>{try{const L=localStorage.getItem("vault_tokens_cache"),re=localStorage.getItem("vault_tokens_cache_time"),B=5*60*1e3;if(L&&re&&Date.now()-parseInt(re)<B){t(JSON.parse(L)),se();return}await se()}catch{}},se=async()=>{try{const{data:L}=await S.from("meme_tokens").select("*").eq("issuer_address",jh).order("created_at",{ascending:!1}),re=L||[];t(re),localStorage.setItem("vault_tokens_cache",JSON.stringify(re)),localStorage.setItem("vault_tokens_cache_time",Date.now().toString()),F(re)}catch{}},F=L=>{L.forEach((re,B)=>{re.image_url&&setTimeout(()=>{const Y=new Image;Y.src=re.image_url},B*100)})},X=async()=>{if(!(!s||r.length===0)){w(!0);try{const{data:L}=await S.from("token_holdings_cache").select("*").eq("wallet_address",s.address).gte("last_updated",new Date(Date.now()-3e5).toISOString());if(L&&L.length>0){const ye={};let te=0;L.forEach(U=>{ye[U.token_id]=parseFloat(U.balance),te+=parseFloat(U.balance)}),o(ye),_e(U=>({...U,totalBalance:te})),w(!1);return}const{requestWithRetry:re}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),B=await re({command:"account_lines",account:s.address,ledger_index:"validated"}),Y={};let oe=0;const ie=[];B.result.lines.forEach(ye=>{const te=r.find(U=>{if(U.issuer_address!==ye.account)return!1;const ke=U.currency_code.length>3?vt.Buffer.from(U.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):U.currency_code;return ye.currency===ke||ye.currency===U.currency_code});if(te){const U=parseFloat(ye.balance);Y[te.id]=U,oe+=U,ie.push({wallet_address:s.address,token_id:te.id,balance:U,last_updated:new Date().toISOString()})}}),o(Y),_e(ye=>({...ye,totalBalance:oe})),ie.length>0&&(await S.from("token_holdings_cache").delete().eq("wallet_address",s.address),await S.from("token_holdings_cache").insert(ie))}catch{k.error("Failed to load token balances")}finally{w(!1)}}},me=async()=>{if(!(!s||Object.keys(i).length===0))try{const{data:L,error:re}=await S.from("token_earnings").select("*").eq("wallet_address",s.address);if(re)throw re;const B={};let Y=0,oe=0;L==null||L.forEach(ie=>{B[ie.token_id]=ie,Y+=parseFloat(ie.total_earned||0),ie.is_earning&&oe++}),l(B),_e(ie=>({...ie,totalEarned:Y,activeTokens:oe}))}catch{}},ve=L=>{const re=n[L];if(!re||!re.is_earning)return 0;const B=parseFloat(re.balance_snapshot||0),Y=new Date(re.earning_started_at).getTime(),ie=(Date.now()-Y)/1e3,ye=ya/yh;return B*ye*ie},He=async L=>{if(!s){k.error("Connect wallet first");return}const re=i[L.id];if(!re||re<=0){k.error("You need tokens in your wallet to start earning");return}try{h(oe=>({...oe,[L.id]:!0}));const{data:B,error:Y}=await S.from("token_earnings").upsert({wallet_address:s.address,token_id:L.id,balance_snapshot:re,is_earning:!0,earning_started_at:new Date().toISOString(),pending_amount:0,updated_at:new Date().toISOString()},{onConflict:"wallet_address,token_id"}).select().single();if(Y)throw Y;l(oe=>({...oe,[L.id]:B})),_e(oe=>({...oe,activeTokens:oe.activeTokens+1})),k.success(`Started earning on ${L.token_name}`),await Jt({actionType:Yt.START_EARNING,userAddress:s.address,description:`Started earning on ${L.token_name}`,tokenId:L.id,details:{amount:re}})}catch{k.error("Failed to start earning")}finally{h(B=>({...B,[L.id]:!1}))}},pe=async L=>{var re;try{y(ie=>({...ie,[L.id]:!0}));const B=ve(L.id),Y=parseFloat(((re=n[L.id])==null?void 0:re.total_earned)||0)+B,{error:oe}=await S.from("token_earnings").update({is_earning:!1,pending_amount:B,total_earned:Y,updated_at:new Date().toISOString()}).eq("wallet_address",s.address).eq("token_id",L.id);if(oe)throw oe;l(ie=>({...ie,[L.id]:{...ie[L.id],is_earning:!1,pending_amount:B,total_earned:Y}})),_e(ie=>({...ie,activeTokens:Math.max(0,ie.activeTokens-1),totalEarned:ie.totalEarned+B})),k.success("Stopped earning. You can now claim your earnings."),await Jt({actionType:Yt.STOP_EARNING,userAddress:s.address,description:`Stopped earning on ${L.token_name}`,tokenId:L.id,details:{amount:B}})}catch{k.error("Failed to stop earning")}finally{y(B=>({...B,[L.id]:!1}))}},xe=async L=>{var Y,oe,ie,ye;if(!s){k.error("Please connect your wallet first");return}if(s.address===Xr){k.error("Cannot claim earnings to the receiver wallet. Please connect a different wallet.");return}const re=n[L.id];if(!re){k.error("No earnings data found");return}const B=re.is_earning?ve(L.id):parseFloat(re.pending_amount||0);if(B<1e-4){k.error("Minimum claim amount is 0.0001");return}try{d(z=>({...z,[L.id]:!0})),E({step:1,message:"Connecting to XRPL...",token:L.token_name,amount:B});const{requestWithRetry:te,getClient:U}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),ke=Re.Wallet.fromSeed(wh);E(z=>({...z,step:2,message:"Checking trustlines..."}));const he=await te({command:"account_lines",account:Xr,ledger_index:"validated"}),Oe=L.currency_code.length>3?vt.Buffer.from(L.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):L.currency_code;if(!he.result.lines.some(z=>z.account===L.issuer_address&&(z.currency===Oe||z.currency===L.currency_code))){E(et=>({...et,step:3,message:"Setting up trustline..."}));const z=await U(),ae={TransactionType:"TrustSet",Account:Xr,LimitAmount:{currency:Oe,issuer:L.issuer_address,value:"1000000000"}},qe=await z.autofill(ae),Ie=ke.sign(qe);if((await z.submitAndWait(Ie.tx_blob)).result.meta.TransactionResult!=="tesSUCCESS")throw new Error("Failed to set up trustline")}if(!(await te({command:"account_lines",account:s.address,ledger_index:"validated"})).result.lines.some(z=>z.account===L.issuer_address&&(z.currency===Oe||z.currency===L.currency_code))){E(null),k.error(`Your wallet needs a trustline for ${L.currency_code}. Please set up trustline first.`),d(z=>({...z,[L.id]:!1}));return}E(z=>({...z,step:4,message:"Processing claim fee..."}));const tt=await U(),nt={TransactionType:"Payment",Account:s.address,Destination:Xr,Amount:String(mi*1e6)},M=Re.Wallet.fromSeed(s.seed),fe=await tt.autofill(nt),K=M.sign(fe);if((await tt.submitAndWait(K.tx_blob)).result.meta.TransactionResult!=="tesSUCCESS")throw new Error("Failed to process claim fee");E(z=>({...z,step:5,message:"Sending earnings..."}));const p={TransactionType:"Payment",Account:Xr,Destination:s.address,Amount:{currency:Oe,issuer:L.issuer_address,value:B.toString()}},x=await tt.autofill(p),R=ke.sign(x),H=await tt.submitAndWait(R.tx_blob);if(H.result.meta.TransactionResult==="tesSUCCESS"){const z=parseFloat(((Y=n[L.id])==null?void 0:Y.total_earned)||0)+B;await S.from("token_earnings").update({balance_snapshot:i[L.id]||0,last_claim_at:new Date().toISOString(),total_earned:z,pending_amount:0,is_earning:!0,earning_started_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("wallet_address",s.address).eq("token_id",L.id),await Jt({actionType:Yt.CLAIM_EARNINGS,userAddress:s.address,description:`Claimed ${B.toFixed(4)} ${L.token_name}`,tokenId:L.id,details:{amount:B},txHash:H.result.hash}),E({step:6,message:"Claim successful!",token:L.token_name,amount:B,txHash:H.result.hash,complete:!0}),await me(),await X()}else throw new Error(`Transaction failed: ${H.result.meta.TransactionResult}`)}catch(te){E(null),(oe=te.message)!=null&&oe.includes("tecNO_DST_INSUF_XRP")?k.error("Destination wallet needs at least 10 XRP reserve"):(ie=te.message)!=null&&ie.includes("tecPATH_DRY")?k.error("Insufficient balance in receiver wallet"):(ye=te.message)!=null&&ye.includes("tecNO_LINE")?k.error("Trustline issue detected. Please ensure both wallets have trustlines."):k.error(`Failed to claim earnings: ${te.message||"Unknown error"}`)}finally{d(te=>({...te,[L.id]:!1}))}},le=m.memo(({token:L,isListView:re=!1})=>{const B=i[L.id]||0,Y=n[L.id],oe=ve(L.id),ie=parseFloat((Y==null?void 0:Y.total_earned)||0)+oe,ye=W.includes(L.id),te=B*ya/365,U=B*ya/12,ke=B*ya,he=Y!=null&&Y.last_claim_at?new Date(Y.last_claim_at):null;return re?e.jsxs("div",{className:"glass rounded-lg p-4 flex items-center gap-4",children:[e.jsx("button",{onClick:()=>Ce(L.id),className:`text-2xl ${ye?"text-yellow-400":"text-gray-500 hover:text-yellow-400"}`,children:ye?"⭐":"☆"}),e.jsx(Ft,{token:L,size:"md"}),e.jsxs("div",{className:"flex-1 grid grid-cols-9 gap-3 items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-purple-200",children:L.token_name}),e.jsx("div",{className:"text-purple-400 text-sm",children:L.currency_code})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-purple-400 text-xs",children:"Balance"}),e.jsx("div",{className:"text-purple-200 font-bold",children:B.toFixed(2)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-purple-400 text-xs",children:"Total Earned"}),e.jsx("div",{className:"text-green-400 font-bold",children:ie.toFixed(6)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-purple-400 text-xs",children:"Pending"}),e.jsx("div",{className:"text-yellow-400 font-bold",children:oe.toFixed(6)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-purple-400 text-xs",children:"Daily Est."}),e.jsx("div",{className:"text-blue-300 font-bold",children:te.toFixed(6)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-purple-400 text-xs",children:"Monthly Est."}),e.jsx("div",{className:"text-cyan-400 font-bold",children:U.toFixed(6)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-purple-400 text-xs",children:"Yearly Est."}),e.jsx("div",{className:"text-emerald-400 font-bold",children:ke.toFixed(4)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-purple-400 text-xs",children:"Last Claim"}),e.jsx("div",{className:"text-purple-300 font-medium text-xs",children:he?e.jsxs(e.Fragment,{children:[e.jsx("div",{children:he.toLocaleDateString()}),e.jsx("div",{className:"text-purple-500",children:he.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}):e.jsx("span",{className:"text-gray-500",children:"Never"})})]}),e.jsx("div",{className:"flex gap-2 justify-end",children:Y!=null&&Y.is_earning?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>pe(L),disabled:g[L.id],className:"btn px-4 py-2 rounded-lg text-sm",children:g[L.id]?"...":"Stop"}),e.jsx("button",{onClick:()=>xe(L),disabled:c[L.id]||Y.is_earning,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm",children:c[L.id]?"...":"Claim"})]}):e.jsx("button",{onClick:()=>He(L),disabled:u[L.id],className:"btn-primary px-4 py-2 rounded-lg text-sm",children:u[L.id]?"...":"Start"})})]})]}):e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ft,{token:L,size:"lg"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200",children:L.token_name}),e.jsx("p",{className:"text-purple-400 text-sm",children:L.currency_code})]})]}),e.jsx("button",{onClick:()=>Ce(L.id),className:`text-3xl ${ye?"text-yellow-400":"text-gray-500 hover:text-yellow-400"}`,children:ye?"⭐":"☆"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"glass rounded-lg p-4 bg-purple-500/10",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"Your Balance"}),e.jsx("div",{className:"text-3xl font-bold text-purple-200",children:B.toFixed(2)}),e.jsx("div",{className:"text-purple-400 text-xs mt-1",children:L.currency_code})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"glass rounded-lg p-3 bg-purple-500/5",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"Total Earned"}),e.jsx("div",{className:"text-lg font-bold text-green-400",children:ie.toFixed(6)})]}),e.jsxs("div",{className:"glass rounded-lg p-3 bg-purple-500/5",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"Pending"}),e.jsx("div",{className:"text-lg font-bold text-yellow-400",children:oe.toFixed(6)})]})]}),(Y==null?void 0:Y.is_earning)&&e.jsxs("div",{className:"glass rounded-lg p-3 bg-green-500/10 border border-green-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("div",{className:"text-green-400 text-sm font-medium",children:"Earning Active"})]}),e.jsxs("div",{className:"text-green-300 text-xs",children:["Started: ",new Date(Y.start_earning_at).toLocaleString()]})]}),e.jsxs("div",{className:"glass rounded-lg p-3 bg-blue-500/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-blue-400 text-xs font-medium",children:"📈 Earnings Projection"}),e.jsx("div",{className:"text-blue-300 text-xs",children:"10% APY"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-blue-400 text-xs",children:"Daily"}),e.jsxs("div",{className:"text-blue-200 font-bold text-sm",children:["+",te.toFixed(4)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-blue-400 text-xs",children:"Monthly"}),e.jsxs("div",{className:"text-blue-200 font-bold text-sm",children:["+",(te*30).toFixed(4)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-blue-400 text-xs",children:"Yearly"}),e.jsxs("div",{className:"text-blue-200 font-bold text-sm",children:["+",ke.toFixed(2)]})]})]})]}),e.jsx("div",{className:"flex gap-2",children:Y!=null&&Y.is_earning?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>xe(L),disabled:c[L.id]||ve(L.id)<1e-4,className:"flex-1 bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg font-medium",children:c[L.id]?"Claiming...":"Claim Earnings"}),e.jsx("button",{onClick:()=>pe(L),disabled:g[L.id],className:"flex-1 btn text-purple-300 px-6 py-3 rounded-lg font-medium",children:g[L.id]?"Stopping...":"Stop Earning"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>He(L),disabled:u[L.id]||B<=0,className:"flex-1 btn-primary text-white px-6 py-3 rounded-lg font-medium",children:u[L.id]?"Starting...":"Start Earning"}),(Y==null?void 0:Y.pending_amount)>0&&e.jsx("button",{onClick:()=>xe(L),disabled:c[L.id]||parseFloat(Y.pending_amount)<1e-4,className:"flex-1 bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg font-medium",children:c[L.id]?"Claiming...":`Claim ${parseFloat(Y.pending_amount).toFixed(4)}`})]})}),(Y==null?void 0:Y.last_claim_at)&&e.jsxs("div",{className:"text-purple-400 text-xs text-center",children:["Last claimed: ",new Date(Y.last_claim_at).toLocaleString()]})]})]})},(L,re)=>L.token.id===re.token.id&&L.isListView===re.isListView),$e=m.useMemo(()=>r.filter(L=>parseFloat(i[L.id]||0)>0),[r,i]),Ne=m.useMemo(()=>$e.filter(L=>L.token_name.toLowerCase().includes(A.toLowerCase())||L.currency_code.toLowerCase().includes(A.toLowerCase())),[$e,A]),q=m.useMemo(()=>[...Ne].sort((L,re)=>{const B=W.includes(L.id),Y=W.includes(re.id);return B&&!Y?-1:!B&&Y?1:0}),[Ne,W]);return s?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-purple-200 mb-2",children:"Passive Earnings Vault"}),e.jsx("p",{className:"text-purple-400",children:"Earn 10% APY automatically just by holding tokens in your wallet"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center gap-2 glass rounded-lg p-2",children:[e.jsx("button",{onClick:()=>P("grid"),className:`p-2 rounded ${b==="grid"?"bg-purple-600 text-white":"text-purple-400"}`,title:"Grid View",children:"⊞"}),e.jsx("button",{onClick:()=>P("list"),className:`p-2 rounded ${b==="list"?"bg-purple-600 text-white":"text-purple-400"}`,title:"List View",children:"☰"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Total Balance"}),e.jsx("div",{className:"text-3xl font-bold text-purple-200",children:G.totalBalance.toFixed(2)}),e.jsx("div",{className:"text-purple-400 text-xs mt-1",children:"Tokens in wallet"})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Total Earned"}),e.jsx("div",{className:"text-3xl font-bold text-green-400",children:G.totalEarned.toFixed(6)}),e.jsx("div",{className:"text-purple-400 text-xs mt-1",children:"All time earnings"})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Active Tokens"}),e.jsx("div",{className:"text-3xl font-bold text-blue-400",children:G.activeTokens}),e.jsx("div",{className:"text-purple-400 text-xs mt-1",children:"Currently earning"})]})]}),e.jsx("div",{className:"glass rounded-lg p-4",children:e.jsx("input",{type:"text",value:A,onChange:L=>_(L.target.value),placeholder:"Search tokens...",className:"input w-full"})}),f?e.jsxs("div",{className:"glass rounded-lg p-12 text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"⏳"}),e.jsx("p",{className:"text-purple-300",children:"Loading your tokens..."})]}):q.length===0?e.jsxs("div",{className:"glass rounded-lg p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"💰"}),e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-2",children:"No Tokens Found"}),e.jsx("p",{className:"text-purple-400",children:A?"No tokens match your search.":"You need tokens in your wallet to start earning."})]}):b==="grid"?e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:q.map(L=>e.jsx(le,{token:L},L.id))}):e.jsx("div",{className:"space-y-3",children:q.map(L=>e.jsx(le,{token:L,isListView:!0},L.id))}),I&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-lg p-6 max-w-md w-full space-y-4",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200 text-center",children:I.complete?"✅ Claim Complete!":"⏳ Claiming Earnings"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"glass rounded-lg p-4 bg-purple-500/10",children:[e.jsx("div",{className:"text-purple-400 text-sm",children:"Token"}),e.jsx("div",{className:"text-purple-200 font-bold",children:I.token})]}),e.jsxs("div",{className:"glass rounded-lg p-4 bg-green-500/10",children:[e.jsx("div",{className:"text-green-400 text-sm",children:"Amount"}),e.jsx("div",{className:"text-green-300 font-bold text-xl",children:(ee=I.amount)==null?void 0:ee.toFixed(6)})]}),!I.complete&&e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsxs("div",{className:"text-purple-200 font-medium mb-2",children:["Step ",I.step," of 5"]}),e.jsx("div",{className:"text-purple-400 text-sm",children:I.message}),e.jsx("div",{className:"mt-3 w-full bg-purple-900/30 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-500 h-2 rounded-full transition-all duration-300",style:{width:`${I.step/5*100}%`}})})]}),I.complete&&I.txHash&&e.jsxs("div",{className:"glass rounded-lg p-4 bg-blue-500/10",children:[e.jsx("div",{className:"text-blue-400 text-sm mb-2",children:"Transaction"}),e.jsx(Ls,{type:"tx",value:I.txHash,network:"mainnet"})]}),I.complete&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"glass rounded-lg p-4 bg-yellow-500/10 border border-yellow-500/30",children:e.jsxs("div",{className:"text-yellow-200 text-sm",children:["⚡ Claim fee of ",mi," XRP was sent to the receiver wallet"]})}),e.jsx("button",{onClick:()=>E(null),className:"w-full btn-primary text-white px-6 py-3 rounded-lg font-medium",children:"Close"})]})]})]})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-purple-200 mb-2",children:"Passive Earnings Vault"}),e.jsx("p",{className:"text-purple-400",children:"Earn 10% APY on your token holdings automatically"})]}),e.jsxs("div",{className:"glass rounded-lg p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🔒"}),e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-2",children:"Connect Your Wallet"}),e.jsx("p",{className:"text-purple-400",children:"Connect your wallet to start earning passive income on your tokens"})]})]})}function _h({token:r,poolData:t,isFavorited:s,onToggleFavorite:a,onClick:n,showStats:l=!0,showMemeKingBadge:i=!0}){const o=(t==null?void 0:t.price)||0,c=(t==null?void 0:t.marketCap)||0,d=(t==null?void 0:t.xrpAmount)||0;t!=null&&t.tokenAmount;const u=y=>y===0?"0.00":y<1e-6?y.toExponential(2):y<.01?y.toFixed(6):y.toFixed(4),h=y=>y>=1e6?`${(y/1e6).toFixed(2)}M`:y>=1e3?`${(y/1e3).toFixed(2)}K`:y.toFixed(2),g=r.issuer_address==="rKxBBMmY969Ph1y63ddVfYyN7xmxwDfVq6";return e.jsxs("div",{className:"glass rounded-lg p-4 sm:p-6 hover:bg-purple-500/10 transition-all cursor-pointer space-y-3 sm:space-y-4",onClick:n,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0",children:[e.jsx(Ft,{token:r,size:"lg"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx("h3",{className:"text-base sm:text-xl font-bold text-purple-200 truncate",children:r.token_name}),a&&e.jsx("button",{onClick:y=>{y.stopPropagation(),a(r.id,y)},className:"text-base sm:text-lg hover:scale-110 transition-transform flex-shrink-0",children:s?"⭐":"☆"})]}),e.jsx("div",{className:"text-purple-400 text-xs sm:text-sm truncate",children:r.currency_code})]})]}),r.amm_pool_created?e.jsx("span",{className:"px-2 py-0.5 sm:py-1 bg-green-500/20 text-green-300 text-xs rounded-full whitespace-nowrap flex-shrink-0",children:"✓ Active"}):e.jsx("span",{className:"px-2 py-0.5 sm:py-1 bg-yellow-500/20 text-yellow-300 text-xs rounded-full whitespace-nowrap flex-shrink-0",children:"⏳ Pending"})]}),e.jsxs("div",{className:"flex flex-wrap gap-1.5 sm:gap-2",children:[r.category&&e.jsx(ir,{category:r.category,size:"sm"}),i&&g&&e.jsx("span",{className:"px-2 sm:px-3 py-0.5 sm:py-1 bg-yellow-500/20 text-yellow-300 text-xs rounded-full font-medium whitespace-nowrap",children:"👑 MemeKing"}),!g&&e.jsx("span",{className:"px-2 sm:px-3 py-0.5 sm:py-1 bg-blue-500/20 text-blue-300 text-xs rounded-full font-medium whitespace-nowrap",children:"👤 Community"}),e.jsxs("span",{className:"px-2 sm:px-3 py-0.5 sm:py-1 bg-purple-500/20 text-purple-300 text-xs rounded-full font-medium whitespace-nowrap",children:["📅 ",hs(r.created_at),"d"]})]}),l&&t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{className:"glass rounded-lg p-2 sm:p-3",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-0.5 sm:mb-1",children:"Price"}),e.jsxs("div",{className:"text-purple-200 font-bold text-sm sm:text-lg truncate",children:[u(o)," XRP"]})]}),e.jsxs("div",{className:"glass rounded-lg p-2 sm:p-3",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-0.5 sm:mb-1",children:"Market Cap"}),e.jsxs("div",{className:"text-purple-200 font-bold text-sm sm:text-lg truncate",children:[h(c)," XRP"]})]}),e.jsxs("div",{className:"glass rounded-lg p-2 sm:p-3",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-0.5 sm:mb-1",children:"XRP Locked"}),e.jsxs("div",{className:"text-purple-200 font-bold text-sm sm:text-lg truncate",children:[h(d)," XRP"]})]}),e.jsxs("div",{className:"glass rounded-lg p-2 sm:p-3",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-0.5 sm:mb-1",children:"Supply"}),e.jsxs("div",{className:"text-purple-200 font-bold text-sm sm:text-lg truncate",children:[(r.supply/1e6).toFixed(2),"M"]})]})]}),e.jsxs("div",{className:"flex justify-around items-center py-1.5 sm:py-2 glass rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-0.5 sm:mb-1",children:"1H %"}),e.jsx("div",{className:"text-gray-400 text-xs sm:text-sm",children:"-"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-0.5 sm:mb-1",children:"24H %"}),e.jsx("div",{className:"text-gray-400 text-xs sm:text-sm",children:"-"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-0.5 sm:mb-1",children:"7D %"}),e.jsx("div",{className:"text-gray-400 text-xs sm:text-sm",children:"-"})]})]})]}),!t&&r.amm_pool_created&&e.jsx("div",{className:"text-purple-400 text-sm text-center py-2",children:"Loading pool data..."})]})}function kh(){const[r,t]=m.useState(null),[s,a]=m.useState([]),[n,l]=m.useState({}),[i,o]=m.useState(!1),[c,d]=m.useState(!1),[u,h]=m.useState(!1),[g,y]=m.useState(null),[f,w]=m.useState(null),[b,P]=m.useState({totalValue:0,totalTokens:0,lpPositions:0,totalValueChange24h:0,lpValueChange24h:0}),[A,_]=m.useState(""),[W,D]=m.useState("value"),[I,E]=m.useState("desc"),[G,_e]=m.useState([]),[ge,Ce]=m.useState(!0),[ue,J]=m.useState(!0),[se,F]=m.useState(!0),[X,me]=m.useState(2.5),[ve,He]=m.useState("all"),[pe,xe]=m.useState([]),[le,$e]=m.useState(!1),[Ne,q]=m.useState(()=>window.innerWidth<768?"grid":"list");m.useEffect(()=>{Y();const U=()=>{Y()};return window.addEventListener("walletConnected",U),window.addEventListener("walletDisconnected",U),()=>{window.removeEventListener("walletConnected",U),window.removeEventListener("walletDisconnected",U)}},[]),m.useEffect(()=>{const U=la(()=>{r&&le&&te(!1)});return()=>{U()}},[]),m.useEffect(()=>{r&&!le&&($e(!0),(async()=>{try{await ie(),await te(!1),await re(),await oe()}catch{o(!1)}})())},[r]),m.useEffect(()=>{ee()},[]);const ee=async()=>{var U;try{const he=await(await fetch("https://api.coingecko.com/api/v3/simple/price?ids=ripple&vs_currencies=usd")).json();(U=he.ripple)!=null&&U.usd&&me(he.ripple.usd)}catch{}},L=U=>{W===U?E(I==="asc"?"desc":"asc"):(D(U),E("desc"))},re=async()=>{if(r)try{const{data:U}=await S.from("token_favorites").select("token_id").eq("wallet_address",r.address);_e((U==null?void 0:U.map(ke=>ke.token_id))||[])}catch{}},B=async U=>{if(r)try{G.includes(U)?(await S.from("token_favorites").delete().eq("wallet_address",r.address).eq("token_id",U),_e(ke=>ke.filter(he=>he!==U)),k.success("Removed from favorites")):(await S.from("token_favorites").insert([{wallet_address:r.address,token_id:U}]),_e(ke=>[...ke,U]),k.success("Added to favorites"))}catch{k.error("Failed to update favorite")}},Y=()=>{const U=localStorage.getItem("connectedWallet");U?t(JSON.parse(U)):(t(null),a([]))},oe=async()=>{if(r)try{const{data:U,error:ke}=await S.from("meme_tokens").select("*").eq("issuer_address",r.address).order("created_at",{ascending:!1});if(ke)throw ke;xe(U||[])}catch{}},ie=async()=>{if(r)try{const{data:U,error:ke}=await S.from("token_holdings_cache").select("*, token:meme_tokens(*)").eq("wallet_address",r.address).order("last_updated",{ascending:!1});if(ke)return;if(U&&U.length>0){const he=U.map(Oe=>{var We;const $=parseFloat(Oe.balance),be=(We=Oe.token)!=null&&We.supply&&parseFloat(Oe.token.supply)>0?$/parseFloat(Oe.token.supply)*100:0;return{token:Oe.token,balance:$,price:parseFloat(Oe.price),value:parseFloat(Oe.value),isLPToken:Oe.is_lp_token,lpShare:parseFloat(Oe.lp_share),priceChange24h:parseFloat(Oe.price_change_24h),supplyPercentage:be}});a(he),ye(he)}}catch{}},ye=U=>{let ke=0,he=0,Oe=0,$=0,be=pe.length;U.forEach(M=>{ke+=M.value,M.isLPToken?(he++,$+=M.value):Oe+=M.value});const We=((Math.random()-.3)*20).toFixed(2),tt=((Math.random()-.3)*15).toFixed(2),nt=0;P({totalValue:ke.toFixed(4),totalTokens:U.length,lpPositions:he,totalValueChange24h:parseFloat(We),lpValueChange24h:parseFloat(tt),userTokensCreated:be,userTokensChange24h:nt})},te=async(U=!1)=>{var ke;if(!r){o(!1);return}if(!U&&s.length>0){o(!1);return}o(!0);try{const{data:he}=await S.from("token_holdings_cache").select("*, token:meme_tokens(*)").eq("wallet_address",r.address).order("last_updated",{ascending:!1});if(he&&he.length>0){const Ie=he.map(et=>{var Rt;const ze=parseFloat(et.balance),dt=(Rt=et.token)!=null&&Rt.supply&&parseFloat(et.token.supply)>0?ze/parseFloat(et.token.supply)*100:0;return{token:et.token,balance:ze,price:parseFloat(et.price),value:parseFloat(et.value),isLPToken:et.is_lp_token,lpShare:parseFloat(et.lp_share),priceChange24h:parseFloat(et.price_change_24h),supplyPercentage:dt}});a(Ie),ye(Ie);const Je=new Date-new Date(he[0].last_updated);if(!U&&Je<3e5){o(!1);return}}const{requestWithRetry:Oe}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),$=await Oe({command:"account_lines",account:r.address,ledger_index:"validated"}),We=(await S.from("meme_tokens").select("*")).data||[],tt={},nt={};for(const Ie of We){const Je=`${Ie.issuer_address}-${Ie.currency_code}`;tt[Je]=Ie;const et=Ie.currency_code.length>3?vt.Buffer.from(Ie.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):Ie.currency_code;nt[et]=Ie}const M={},fe={},{data:K}=await S.from("pool_data_cache").select("*").gte("last_updated",new Date(Date.now()-300*1e3).toISOString()),v={};K&&K.forEach(Ie=>{v[Ie.token_id]=Ie});for(const Ie of We.filter(Je=>Je.amm_pool_created))try{if(v[Ie.id]){const ze=v[Ie.id];M[Ie.id]={xrpAmount:parseFloat(ze.xrp_amount),tokenAmount:parseFloat(ze.token_amount),lpTokens:parseFloat(ze.lp_tokens),price:parseFloat(ze.price),accountId:ze.account_id},fe[ze.account_id]=Ie.id;continue}const Je=Ie.currency_code.length>3?vt.Buffer.from(Ie.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):Ie.currency_code,et=await Oe({command:"amm_info",asset:{currency:"XRP"},asset2:{currency:Je,issuer:Ie.issuer_address},ledger_index:"validated"});if(et.result.amm){const ze=et.result.amm,dt=parseFloat(ze.amount)/1e6,Rt=parseFloat(ze.amount2.value),Tt=parseFloat(((ke=ze.lp_token)==null?void 0:ke.value)||0),wt=dt/Rt;M[Ie.id]={xrpAmount:dt,tokenAmount:Rt,lpTokens:Tt,price:wt,accountId:ze.account},fe[ze.account]=Ie.id,await S.from("pool_data_cache").upsert({token_id:Ie.id,xrp_amount:dt,token_amount:Rt,lp_tokens:Tt,price:wt,account_id:ze.account,volume_24h:0,price_change_24h:0,last_updated:new Date().toISOString()},{onConflict:"token_id"})}}catch{}const p=[],x=new Set;let R=0,H=0,z=0,ae=0;for(const Ie of $.result.lines){const Je=parseFloat(Ie.balance);if(Je===0)continue;const et=`${Ie.account}-${Ie.currency}`;if(x.has(et))continue;if(x.add(et),fe[Ie.account]){const Rt=fe[Ie.account],Tt=We.find(Mt=>Mt.id===Rt),wt=M[Rt];if(Tt&&wt){const Mt=Je/wt.lpTokens*wt.xrpAmount*2;R+=Mt,ae+=Mt,H++;const ut=Tt.supply&&parseFloat(Tt.supply)>0?Je/parseFloat(Tt.supply)*100:0;p.push({token:Tt,balance:Je,price:wt.price,value:Mt,isLPToken:!0,lpShare:Je/wt.lpTokens*100,supplyPercentage:ut});continue}}const ze=`${Ie.account}-${Ie.currency}`;let dt=tt[ze];if(dt||(dt=nt[Ie.currency],dt&&dt.issuer_address!==Ie.account&&(dt=null)),dt){const Rt=M[dt.id],Tt=(Rt==null?void 0:Rt.price)||0,wt=Je*Tt;R+=wt,z+=wt;const Mt=((Math.random()-.3)*20).toFixed(2),ut=dt.supply&&parseFloat(dt.supply)>0?Je/parseFloat(dt.supply)*100:0;p.push({token:dt,balance:Je,price:Tt,value:wt,isLPToken:!1,lpShare:0,priceChange24h:parseFloat(Mt),supplyPercentage:ut})}}await S.from("token_holdings_cache").delete().eq("wallet_address",r.address);const qe=p.map(Ie=>({wallet_address:r.address,token_id:Ie.token.id,balance:Ie.balance,price:Ie.price,value:Ie.value,is_lp_token:Ie.isLPToken,lp_share:Ie.lpShare,price_change_24h:Ie.priceChange24h||0,last_updated:new Date().toISOString()}));qe.length>0&&await S.from("token_holdings_cache").insert(qe),a(p),l(M),ye(p)}catch(he){k.error("Failed to fetch token holdings: "+he.message)}finally{o(!1)}};return r?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-purple-200",children:"My Tokens"}),e.jsx("p",{className:"text-purple-400 mt-1",children:"Your token holdings and LP positions"})]}),e.jsx("button",{onClick:te,disabled:i,className:"bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-medium px-4 py-2 rounded-lg transition-all disabled:opacity-50",children:i?"🔄 Loading...":"🔄 Refresh"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Total Portfolio Value"}),e.jsxs("div",{className:"text-3xl font-bold text-purple-200",children:[b.totalValue," XRP"]}),e.jsxs("div",{className:"text-purple-400 text-sm mt-1",children:["$",(parseFloat(b.totalValue)*X).toFixed(2)," USD"]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-purple-500 text-xs",children:"Estimated"}),e.jsxs("span",{className:`text-xs font-bold ${b.totalValueChange24h>=0?"text-green-400":"text-red-400"}`,children:[b.totalValueChange24h>=0?"+":"",b.totalValueChange24h.toFixed(2),"% 24h"]})]})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Total Tokens"}),e.jsx("div",{className:"text-3xl font-bold text-purple-200",children:b.totalTokens}),e.jsx("div",{className:"text-purple-500 text-xs mt-1",children:"Unique holdings"})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"LP Positions"}),e.jsx("div",{className:"text-3xl font-bold text-purple-200",children:b.lpPositions}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-purple-500 text-xs",children:"Active pools"}),e.jsxs("span",{className:`text-xs font-bold ${b.lpValueChange24h>=0?"text-green-400":"text-red-400"}`,children:[b.lpValueChange24h>=0?"+":"",b.lpValueChange24h.toFixed(2),"% 24h"]})]})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"User Tokens Created"}),e.jsx("div",{className:"text-3xl font-bold text-purple-200",children:b.userTokensCreated}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-purple-500 text-xs",children:"Your tokens"}),e.jsxs("span",{className:`text-xs font-bold ${(b.userTokensChange24h||0)>=0?"text-green-400":"text-red-400"}`,children:[(b.userTokensChange24h||0)>=0?"+":"",(b.userTokensChange24h||0).toFixed(2),"% 24h"]})]})]})]}),i?e.jsxs("div",{className:"glass rounded-lg p-12 text-center",children:[e.jsx("div",{className:"text-4xl mb-4 animate-pulse",children:"⏳"}),e.jsx("div",{className:"text-purple-200 font-medium",children:"Loading your holdings..."})]}):s.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsx("button",{onClick:()=>He("all"),className:`px-4 py-2 rounded-lg font-medium transition-all ${ve==="all"?"bg-gradient-to-r from-purple-500 to-purple-600 text-white shadow-lg":"bg-purple-900/30 text-purple-300 hover:bg-purple-900/50"}`,children:"All Tokens"}),e.jsx("button",{onClick:()=>He("user"),className:`px-4 py-2 rounded-lg font-medium transition-all ${ve==="user"?"bg-gradient-to-r from-purple-500 to-purple-600 text-white shadow-lg":"bg-purple-900/30 text-purple-300 hover:bg-purple-900/50"}`,children:"User Tokens"})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[e.jsx("input",{type:"text",placeholder:"🔍 Search tokens...",value:A,onChange:U=>_(U.target.value),className:"flex-1 min-w-[200px] bg-purple-900/30 border border-purple-500/30 rounded-lg px-4 py-2 text-purple-200 placeholder-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500"}),e.jsx("button",{onClick:()=>J(!ue),className:"bg-purple-900/30 border border-purple-500/30 rounded-lg px-3 py-2 text-purple-200 hover:bg-purple-900/50 transition-colors whitespace-nowrap text-sm",children:ue?"👁️ Hide Tokens":"👁️ Show Tokens"}),e.jsx("button",{onClick:()=>Ce(!ge),className:"bg-purple-900/30 border border-purple-500/30 rounded-lg px-3 py-2 text-purple-200 hover:bg-purple-900/50 transition-colors whitespace-nowrap text-sm",children:ge?"👁️ Hide LP":"👁️ Show LP"}),e.jsx("button",{onClick:()=>F(!se),className:"bg-purple-900/30 border border-purple-500/30 rounded-lg px-3 py-2 text-purple-200 hover:bg-purple-900/50 transition-colors whitespace-nowrap text-sm",children:se?"👁️ Hide My Tokens":"👁️ Show My Tokens"}),e.jsxs("select",{value:W,onChange:U=>D(U.target.value),className:"bg-purple-900/30 border border-purple-500/30 rounded-lg px-4 py-2 text-purple-200 focus:outline-none focus:ring-2 focus:ring-purple-500",children:[e.jsx("option",{value:"value",children:"Sort by Value"}),e.jsx("option",{value:"balance",children:"Sort by Balance"}),e.jsx("option",{value:"supplyPercent",children:"Sort by % of Supply"}),e.jsx("option",{value:"name",children:"Sort by Name"}),e.jsx("option",{value:"price",children:"Sort by Price"}),e.jsx("option",{value:"token",children:"Sort by Token"}),e.jsx("option",{value:"lpToken",children:"Sort by LP Token"}),e.jsx("option",{value:"24hChange",children:"Sort by 24H Change"}),e.jsx("option",{value:"poolShare",children:"Sort by Pool Share"})]}),e.jsx("button",{onClick:()=>E(U=>U==="asc"?"desc":"asc"),className:"bg-purple-900/30 border border-purple-500/30 rounded-lg px-4 py-2 text-purple-200 hover:bg-purple-900/50 transition-colors",title:I==="asc"?"Ascending":"Descending",children:I==="asc"?"↑":"↓"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>q("list"),className:`px-4 py-2 rounded-lg transition-colors ${Ne==="list"?"bg-purple-600 text-white":"bg-purple-900/30 border border-purple-500/30 text-purple-200 hover:bg-purple-900/50"}`,title:"List View",children:"☰"}),e.jsx("button",{onClick:()=>q("grid"),className:`px-4 py-2 rounded-lg transition-colors ${Ne==="grid"?"bg-purple-600 text-white":"bg-purple-900/30 border border-purple-500/30 text-purple-200 hover:bg-purple-900/50"}`,title:"Grid View",children:"▦"})]})]})]}),Ne==="list"?e.jsx("div",{className:"glass rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-purple-900/30 border-b border-purple-500/20",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 text-purple-300 font-medium",children:"⭐"}),e.jsxs("th",{className:"text-left p-4 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>L("token"),title:"Double-click to sort",children:["Token ",W==="token"&&(I==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-left p-4 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>L("category"),title:"Double-click to sort",children:["Category ",W==="category"&&(I==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-left p-4 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>L("days"),title:"Double-click to sort",children:["Days ",W==="days"&&(I==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-right p-4 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>L("balance"),title:"Double-click to sort",children:["Balance ",W==="balance"&&(I==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-right p-4 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>L("supplyPercent"),title:"Double-click to sort",children:["% of Supply ",W==="supplyPercent"&&(I==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-right p-4 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>L("supply"),title:"Double-click to sort",children:["Total Supply ",W==="supply"&&(I==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-right p-4 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>L("price"),title:"Double-click to sort",children:["Price ",W==="price"&&(I==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-right p-4 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>L("24hChange"),title:"Double-click to sort",children:["24H Change ",W==="24hChange"&&(I==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-right p-4 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>L("value"),title:"Double-click to sort",children:["Value ",W==="value"&&(I==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"text-right p-4 text-purple-300 font-medium cursor-pointer hover:text-purple-200 select-none",onDoubleClick:()=>L("poolShare"),title:"Double-click to sort",children:["Pool Share ",W==="poolShare"&&(I==="asc"?"↑":"↓")]}),e.jsx("th",{className:"text-right p-4 text-purple-300 font-medium",children:"Issuer"}),e.jsx("th",{className:"text-center p-4 text-purple-300 font-medium",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-purple-500/20",children:s.filter(U=>{const ke=r&&U.token.issuer_address===r.address,he=U.isLPToken,Oe=!he&&!ke;if(ve==="all"){if(he&&!ge||Oe&&!ue||ke&&!se)return!1}else if(ve==="user"&&!ke)return!1;if(!A)return!0;const $=A.toLowerCase();return U.token.token_name.toLowerCase().includes($)||U.token.currency_code.toLowerCase().includes($)}).sort((U,ke)=>{const he=G.includes(U.token.id),Oe=G.includes(ke.token.id);if(he!==Oe)return Oe?1:-1;let $=0;if(W==="value")$=ke.value-U.value;else if(W==="balance")$=ke.balance-U.balance;else if(W==="supplyPercent")$=(ke.supplyPercentage||0)-(U.supplyPercentage||0);else if(W==="price")$=ke.price-U.price;else if(W==="name")$=U.token.token_name.localeCompare(ke.token.token_name);else if(W==="token")U.isLPToken===ke.isLPToken?$=U.token.token_name.localeCompare(ke.token.token_name):$=U.isLPToken?1:-1;else if(W==="lpToken")U.isLPToken===ke.isLPToken?$=U.token.token_name.localeCompare(ke.token.token_name):$=U.isLPToken?-1:1;else if(W==="24hChange"){const be=U.priceChange24h!==void 0?U.priceChange24h:-1/0;$=(ke.priceChange24h!==void 0?ke.priceChange24h:-1/0)-be}else if(W==="poolShare"){const be=U.isLPToken?U.lpShare:0;$=(ke.isLPToken?ke.lpShare:0)-be}else if(W==="category"){const be=U.token.category||"",We=ke.token.category||"";$=be.localeCompare(We)}else if(W==="days"){const be=hs(U.token.created_at);$=hs(ke.token.created_at)-be}else if(W==="supply"){const be=parseFloat(U.token.supply)||0;$=(parseFloat(ke.token.supply)||0)-be}return I==="asc"?-$:$}).map((U,ke)=>e.jsxs("tr",{onClick:()=>w(U.token),className:"hover:bg-purple-900/20 transition-colors cursor-pointer",children:[e.jsx("td",{className:"p-4",children:e.jsx("button",{onClick:he=>{he.stopPropagation(),B(U.token.id)},className:`text-2xl ${G.includes(U.token.id)?"text-yellow-400":"text-gray-600 hover:text-yellow-400"} transition-colors`,children:G.includes(U.token.id)?"⭐":"☆"})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ft,{token:U.token,size:"3xl"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-200 font-medium",children:U.token.token_name}),U.isLPToken&&e.jsx("div",{className:"text-green-400 text-xs",children:"LP Token"})]})]})}),e.jsx("td",{className:"p-4",children:U.token.category?e.jsx(ir,{category:U.token.category,size:"xs"}):e.jsx("span",{className:"text-purple-400 text-xs",children:"-"})}),e.jsx("td",{className:"p-4",children:e.jsxs("span",{className:"px-2 py-0.5 bg-purple-500/20 text-purple-300 text-xs rounded-full font-medium inline-block",children:["📅 ",hs(U.token.created_at),"d"]})}),e.jsx("td",{className:"text-right p-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-200 font-mono",children:U.balance.toFixed(4)}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(U.balance*U.price*X).toFixed(2)]})]})}),e.jsx("td",{className:"text-right p-4 text-purple-200 font-mono",children:U.token.supply&&U.token.supply>0?e.jsxs("span",{className:"text-blue-400 font-medium",children:[(U.balance/parseFloat(U.token.supply)*100).toFixed(4),"%"]}):e.jsx("span",{className:"text-purple-500",children:"-"})}),e.jsx("td",{className:"text-right p-4 text-purple-200 font-mono",children:U.token.supply?e.jsx("span",{className:"text-purple-300",children:parseFloat(U.token.supply).toLocaleString()}):e.jsx("span",{className:"text-purple-500",children:"-"})}),e.jsx("td",{className:"text-right p-4",children:U.price>0?e.jsxs("div",{children:[e.jsxs("div",{className:"text-purple-200 font-mono",children:[U.price.toFixed(8)," XRP"]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(U.price*X).toFixed(6)]})]}):e.jsx("span",{className:"text-purple-500",children:"N/A"})}),e.jsx("td",{className:"text-right p-4 font-mono font-bold",children:U.priceChange24h!==void 0?e.jsxs("span",{className:U.priceChange24h>=0?"text-green-400":"text-red-400",children:[U.priceChange24h>=0?"+":"",U.priceChange24h.toFixed(2),"%"]}):e.jsx("span",{className:"text-purple-500",children:"-"})}),e.jsx("td",{className:"text-right p-4",children:U.value>0?e.jsxs("div",{children:[e.jsxs("div",{className:"text-purple-200 font-bold",children:[U.value.toFixed(4)," XRP"]}),e.jsxs("div",{className:"text-purple-400 text-xs",children:["$",(U.value*X).toFixed(2)]})]}):"N/A"}),e.jsx("td",{className:"text-right p-4",children:U.isLPToken?e.jsxs("span",{className:"text-green-400 font-medium",children:[U.lpShare.toFixed(4),"%"]}):e.jsx("span",{className:"text-purple-500",children:"-"})}),e.jsxs("td",{className:"text-right p-4 text-purple-400 font-mono text-xs",children:[U.token.issuer_address.slice(0,8),"..."]}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 flex-wrap",children:[e.jsx(Xa,{token:U.token,connectedWallet:r,tokenBalance:parseFloat(U.balance),onTrustlineUpdate:()=>{loadHoldings()},size:"sm",showDropdown:!0}),e.jsx("button",{onClick:he=>{he.stopPropagation(),localStorage.setItem("selectedTradeToken",JSON.stringify(U.token)),window.dispatchEvent(new CustomEvent("navigateToTrade",{detail:U.token}))},className:"bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white font-bold px-3 py-1.5 text-xs rounded-lg shadow-lg transition-all",title:"Trade on AMM",children:"💱 Swap"}),e.jsx("a",{href:`https://xmagnetic.org/dex/${U.token.currency_code}+${U.token.issuer_address}_XRP+XRP?network=mainnet`,target:"_blank",rel:"noopener noreferrer",className:"bg-gradient-to-r from-indigo-500 to-purple-500 hover:from-indigo-600 hover:to-purple-600 text-white font-bold px-3 py-1.5 text-xs rounded-lg shadow-lg transition-all",title:"Trade on Magnetic DEX",children:"🧲 Magnetic"}),e.jsx("button",{onClick:()=>{y(U),d(!0)},className:"bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white font-bold px-3 py-1.5 text-xs rounded-lg shadow-lg transition-all",title:"Send tokens",children:"📤 Send"}),e.jsx("button",{onClick:()=>{y(U),h(!0)},className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-bold px-3 py-1.5 text-xs rounded-lg shadow-lg transition-all",title:"Receive tokens",children:"📥 Receive"})]})})]},ke))})]})})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:s.filter(U=>{const ke=r&&U.token.issuer_address===r.address,he=U.isLPToken,Oe=!he&&!ke;if(ve==="all"){if(he&&!ge||Oe&&!ue||ke&&!se)return!1}else if(ve==="user"&&!ke)return!1;if(!A)return!0;const $=A.toLowerCase();return U.token.token_name.toLowerCase().includes($)||U.token.currency_code.toLowerCase().includes($)}).sort((U,ke)=>{const he=G.includes(U.token.id),Oe=G.includes(ke.token.id);if(he!==Oe)return Oe?1:-1;let $=0;return W==="value"?$=ke.value-U.value:W==="balance"?$=ke.balance-U.balance:W==="supplyPercent"?$=(ke.supplyPercentage||0)-(U.supplyPercentage||0):W==="price"?$=ke.price-U.price:W==="name"&&($=U.token.token_name.localeCompare(ke.token.token_name)),I==="asc"?-$:$}).map((U,ke)=>{var he,Oe;return e.jsx(_h,{token:U.token,poolData:{price:U.price,marketCap:U.value,xrpAmount:((he=n[U.token.id])==null?void 0:he.xrpAmount)||0,tokenAmount:((Oe=n[U.token.id])==null?void 0:Oe.tokenAmount)||0},isFavorited:G.includes(U.token.id),onToggleFavorite:($,be)=>{be==null||be.stopPropagation(),B($)},onClick:()=>w(U.token)},ke)})})]}):e.jsxs("div",{className:"glass rounded-lg p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"📭"}),e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-2",children:"No Tokens Found"}),e.jsx("p",{className:"text-purple-400",children:"You don't have any platform tokens in your wallet yet"})]}),se&&pe.length>0&&e.jsxs("div",{className:"glass rounded-lg p-6 mt-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-purple-200 mb-4",children:["🎨 Tokens You Created (",pe.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:pe.map(U=>e.jsxs("div",{onClick:()=>w(U),className:"glass rounded-lg p-4 hover:bg-purple-900/30 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx(Ft,{token:U,size:"lg"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-bold text-purple-200 truncate",children:U.token_name}),e.jsx("div",{className:"text-purple-400 text-sm",children:U.currency_code}),U.category&&e.jsx(ir,{category:U.category,size:"xs"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"text-purple-300 text-xs",children:"Supply"}),e.jsx("div",{className:"text-purple-200 font-mono text-sm",children:U.supply.toLocaleString()})]}),U.amm_pool_created?e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"bg-green-500/20 text-green-400 px-2 py-1 rounded text-xs font-medium",children:"AMM Pool Active"})}):e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"bg-yellow-500/20 text-yellow-400 px-2 py-1 rounded text-xs font-medium",children:"No AMM Pool"})})]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap pt-3 border-t border-purple-500/20",children:[e.jsx("button",{onClick:ke=>{ke.stopPropagation();const he=s.find(Oe=>Oe.token.id===U.id);he?(y(he),d(!0)):k.error("You need to hold this token to send it")},className:"flex-1 bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-bold px-3 py-2 text-xs rounded-lg shadow-lg transition-all",title:"Send tokens",children:"📤 Send"}),e.jsx("button",{onClick:ke=>{ke.stopPropagation(),y({token:U,balance:0}),h(!0)},className:"flex-1 bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white font-bold px-3 py-2 text-xs rounded-lg shadow-lg transition-all",title:"Receive tokens",children:"📥 Receive"})]})]},U.id))})]}),c&&g&&e.jsx(ml,{token:g.token,balance:g.balance,wallet:r,onClose:()=>{d(!1),y(null)},onSuccess:()=>{te()}}),u&&g&&e.jsx(hl,{token:g.token,wallet:r,onClose:()=>{h(!1),y(null)}}),f&&e.jsx(an,{token:f,onClose:()=>w(null)})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-purple-200",children:"My Tokens"}),e.jsx("p",{className:"text-purple-400 mt-1",children:"View your token holdings and LP positions"})]}),e.jsxs("div",{className:"glass rounded-lg p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"👛"}),e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-2",children:"No Wallet Connected"}),e.jsx("p",{className:"text-purple-400 mb-6",children:"Connect your wallet from the Setup page to view your token holdings"}),e.jsx("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigate",{detail:"setup"})),className:"btn-primary text-white px-6 py-3 rounded-lg font-medium",children:"Connect Wallet"})]})]})}const Sh="rphatRpwXcPAo7CVm46dC78JAQ6kLMqb2M",Ch="sEd7W72aANTbLTG98XDhU1yfotPJdhu";function Th(){var pe,xe,le,$e,Ne,q,ee,L,re;const[r,t]=m.useState(null),[s,a]=m.useState([]),[n,l]=m.useState({totalEarned:0,totalClaimed:0,pending:0,lifetimeEarnings:0}),[i,o]=m.useState({tokensCreated:0,botsCreated:0,tradesExecuted:0,rewardsByType:{}}),[c,d]=m.useState({totalXRPPaid:0,totalXRPClaimed:0,totalUSDPaid:0,totalUSDClaimed:0}),[u,h]=m.useState(2.5),[g,y]=m.useState(!1),[f,w]=m.useState(!1),[b,P]=m.useState(null),[A,_]=m.useState("all"),[W,D]=m.useState("all"),[I,E]=m.useState("date"),[G,_e]=m.useState([]);m.useEffect(()=>{ge();const B=()=>ge();return window.addEventListener("walletConnected",B),window.addEventListener("walletDisconnected",B),()=>{window.removeEventListener("walletConnected",B),window.removeEventListener("walletDisconnected",B)}},[]),m.useEffect(()=>{Ce(),ue()},[]),m.useEffect(()=>{r&&J()},[r]),m.useEffect(()=>{G.length>0&&F()},[G]);const ge=async()=>{const B=localStorage.getItem("connectedWallet");if(B){const Y=JSON.parse(B);if(!Y.seed&&Y.id)try{const{data:oe}=await S.from("wallets").select("*").eq("id",Y.id).maybeSingle();if(oe){const ie={...oe,seed:oe.encrypted_seed||oe.seed};localStorage.setItem("connectedWallet",JSON.stringify(ie)),t(ie);return}}catch{}t(Y)}else t(null)},Ce=async()=>{var B;try{const oe=await(await fetch("https://api.coingecko.com/api/v3/simple/price?ids=ripple&vs_currencies=usd")).json();(B=oe.ripple)!=null&&B.usd&&h(oe.ripple.usd)}catch{}},ue=async()=>{try{const{data:B,error:Y}=await S.from("xrp_rewards").select("amount, status");if(Y)throw Y;const oe=(B==null?void 0:B.reduce((ye,te)=>ye+parseFloat(te.amount),0))||0,ie=(B==null?void 0:B.filter(ye=>ye.status==="claimed").reduce((ye,te)=>ye+parseFloat(te.amount),0))||0;d({totalXRPPaid:oe,totalXRPClaimed:ie,totalUSDPaid:oe*u,totalUSDClaimed:ie*u})}catch{}},J=async()=>{if(r){y(!0);try{const{data:B,error:Y}=await S.from("xrp_rewards").select("*").eq("wallet_address",r.address).order("created_at",{ascending:!1});if(Y)throw Y;a(B||[]);const oe=(B==null?void 0:B.reduce((Oe,$)=>Oe+parseFloat($.amount),0))||0,ie=(B==null?void 0:B.filter(Oe=>Oe.status==="claimed").reduce((Oe,$)=>Oe+parseFloat($.amount),0))||0,ye=(B==null?void 0:B.filter(Oe=>Oe.status==="pending").reduce((Oe,$)=>Oe+parseFloat($.amount),0))||0;l({totalEarned:oe,totalClaimed:ie,pending:ye,lifetimeEarnings:oe});const te={};let U=0,ke=0,he=0;B==null||B.forEach(Oe=>{const $=Oe.reward_type||"other";te[$]||(te[$]={count:0,total:0}),te[$].count++,te[$].total+=parseFloat(Oe.amount),$==="token_creation"&&U++,$==="bot_creation"&&ke++,$==="trade"&&he++}),o({tokensCreated:U,botsCreated:ke,tradesExecuted:he,rewardsByType:te}),se(B||[])}catch{k.error("Failed to load rewards")}finally{y(!1)}}},se=B=>{const Y={};B.forEach(ie=>{const ye=new Date(ie.created_at).toISOString().split("T")[0];Y[ye]||(Y[ye]=0),Y[ye]+=parseFloat(ie.amount)});const oe=Object.entries(Y).map(([ie,ye])=>({time:ie,value:ye})).sort((ie,ye)=>new Date(ie.time)-new Date(ye.time));_e(oe)},F=()=>{const B=document.getElementById("rewards-chart");if(!B||G.length===0)return;B.innerHTML="";const Y=Er(B,{width:B.clientWidth,height:300,layout:{background:{color:"transparent"},textColor:"#a78bfa"},grid:{vertLines:{color:"rgba(139, 92, 246, 0.1)"},horzLines:{color:"rgba(139, 92, 246, 0.1)"}},timeScale:{borderColor:"rgba(139, 92, 246, 0.3)"},rightPriceScale:{borderColor:"rgba(139, 92, 246, 0.3)"}});Y.addAreaSeries({topColor:"rgba(139, 92, 246, 0.4)",bottomColor:"rgba(139, 92, 246, 0.0)",lineColor:"rgba(139, 92, 246, 1)",lineWidth:2}).setData(G),Y.timeScale().fitContent();const ie=()=>{Y.applyOptions({width:B.clientWidth})};return window.addEventListener("resize",ie),()=>{window.removeEventListener("resize",ie),Y.remove()}},X=async()=>{if(!r){k.error("Connect wallet first");return}const B=s.filter(ie=>ie.status==="pending");if(B.length===0){k.error("No pending rewards to claim");return}const Y=B.reduce((ie,ye)=>ie+parseFloat(ye.amount),0);if(Y<=0){k.error("No rewards available to claim");return}w(!0);let oe=null;try{P({show:!0,message:`Claiming ${Y.toFixed(2)} XRP rewards...`,progress:10});const{getClient:ie}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0);oe=await ie(),P({show:!0,message:"Preparing payment transaction...",progress:30});const ye=Re.Wallet.fromSeed(Ch),te={TransactionType:"Payment",Account:Sh,Destination:r.address,Amount:Re.xrpToDrops(Y.toString()),Memos:[{Memo:{MemoData:Buffer.from(`XRP Rewards Claim: ${B.length} rewards`,"utf8").toString("hex").toUpperCase()}}]};P({show:!0,message:"Submitting transaction to XRPL...",progress:50});const U=await oe.autofill(te),ke=ye.sign(U),he=await oe.submitAndWait(ke.tx_blob);if(he.result.meta.TransactionResult!=="tesSUCCESS")throw new Error(`Transaction failed: ${he.result.meta.TransactionResult}`);P({show:!0,message:"Updating reward status...",progress:80});const Oe=B.map(be=>be.id),{error:$}=await S.from("xrp_rewards").update({status:"claimed",claimed_at:new Date().toISOString()}).in("id",Oe);if($)throw $;P({show:!0,message:"Success!",progress:100}),k.success(`Successfully claimed ${Y.toFixed(2)} XRP!`),setTimeout(()=>{P(null),J()},1500)}catch(ie){k.error(ie.message||"Failed to claim rewards"),P(null)}finally{oe&&oe.isConnected()&&await oe.disconnect(),w(!1)}},me=m.useMemo(()=>{let B=s;return A!=="all"&&(B=B.filter(Y=>Y.reward_type===A)),W!=="all"&&(B=B.filter(Y=>Y.status===W)),B.sort((Y,oe)=>{switch(I){case"amount":return parseFloat(oe.amount)-parseFloat(Y.amount);case"type":return Y.reward_type.localeCompare(oe.reward_type);case"status":return Y.status.localeCompare(oe.status);default:return new Date(oe.created_at)-new Date(Y.created_at)}}),B},[s,A,W,I]),ve={bot_creation:"from-blue-500 to-cyan-500",token_creation:"from-purple-500 to-pink-500",trade:"from-green-500 to-emerald-500",referral:"from-yellow-500 to-orange-500",milestone:"from-red-500 to-rose-500"},He={bot_creation:"🤖",token_creation:"🪙",trade:"💱",referral:"👥",milestone:"🏆"};return r?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-purple-200 mb-2",children:"💰 XRP Rewards"}),e.jsx("p",{className:"text-purple-400",children:"Track and claim your earned XRP rewards"})]}),n.pending>0&&e.jsx("button",{onClick:X,disabled:f,className:"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold px-6 py-3 rounded-lg shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Claiming...":`💎 Claim ${n.pending.toFixed(2)} XRP`})]}),e.jsxs("div",{className:"glass rounded-lg p-6 mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"🌍 Global Rewards Statistics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-purple-900/20 rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Total XRP Distributed"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[c.totalXRPPaid.toFixed(2)," XRP"]}),e.jsxs("div",{className:"text-green-400 text-sm mt-1",children:["$",c.totalUSDPaid.toFixed(2)," USD"]})]}),e.jsxs("div",{className:"bg-green-900/20 rounded-lg p-4",children:[e.jsx("div",{className:"text-green-400 text-sm mb-2",children:"Total XRP Claimed"}),e.jsxs("div",{className:"text-2xl font-bold text-green-400",children:[c.totalXRPClaimed.toFixed(2)," XRP"]}),e.jsxs("div",{className:"text-green-300 text-sm mt-1",children:["$",c.totalUSDClaimed.toFixed(2)," USD"]})]}),e.jsxs("div",{className:"bg-yellow-900/20 rounded-lg p-4",children:[e.jsx("div",{className:"text-yellow-400 text-sm mb-2",children:"Unclaimed XRP"}),e.jsxs("div",{className:"text-2xl font-bold text-yellow-400",children:[(c.totalXRPPaid-c.totalXRPClaimed).toFixed(2)," XRP"]}),e.jsxs("div",{className:"text-yellow-300 text-sm mt-1",children:["$",((c.totalXRPPaid-c.totalXRPClaimed)*u).toFixed(2)," USD"]})]}),e.jsxs("div",{className:"bg-blue-900/20 rounded-lg p-4",children:[e.jsx("div",{className:"text-blue-400 text-sm mb-2",children:"Claim Rate"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-400",children:[c.totalXRPPaid>0?(c.totalXRPClaimed/c.totalXRPPaid*100).toFixed(1):0,"%"]}),e.jsx("div",{className:"text-blue-300 text-sm mt-1",children:"Of total rewards"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"💡 How to Earn XRP Rewards"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-purple-900/20 rounded-lg border border-purple-500/20",children:[e.jsx("div",{className:"text-2xl",children:"🪙"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-200 font-semibold",children:"Create Tokens"}),e.jsx("div",{className:"text-purple-400 text-sm",children:"Earn 0.10 XRP reward when you create new tokens on the platform"}),e.jsx("div",{className:"text-green-400 text-xs mt-1",children:"✓ Instant reward upon token creation"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-900/20 rounded-lg border border-blue-500/20",children:[e.jsx("div",{className:"text-2xl",children:"🤖"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-blue-200 font-semibold",children:"Create Trading Bots"}),e.jsx("div",{className:"text-blue-400 text-sm",children:"Get 0.10 XRP reward for each trading bot you create"}),e.jsx("div",{className:"text-green-400 text-xs mt-1",children:"✓ Automated trading + rewards"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-900/20 rounded-lg border border-green-500/20 opacity-70",children:[e.jsx("div",{className:"text-2xl",children:"💱"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-green-200 font-semibold",children:"Execute Trades"}),e.jsx("span",{className:"text-xs bg-yellow-500/20 text-yellow-300 px-2 py-0.5 rounded-full border border-yellow-500/30",children:"Coming Soon"})]}),e.jsx("div",{className:"text-green-400 text-sm",children:"Earn rewards for trading activity on the platform"}),e.jsx("div",{className:"text-yellow-400 text-xs mt-1",children:"⏳ This reward system will be activated soon"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-yellow-900/20 rounded-lg border border-yellow-500/20 opacity-70",children:[e.jsx("div",{className:"text-2xl",children:"🎯"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-yellow-200 font-semibold",children:"Milestones & Referrals"}),e.jsx("span",{className:"text-xs bg-yellow-500/20 text-yellow-300 px-2 py-0.5 rounded-full border border-yellow-500/30",children:"Coming Soon"})]}),e.jsx("div",{className:"text-yellow-400 text-sm",children:"Unlock bonus rewards by reaching platform milestones"}),e.jsx("div",{className:"text-yellow-400 text-xs mt-1",children:"⏳ This reward system will be activated soon"})]})]})]})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"📈 Your Earning Activity"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-purple-900/20 rounded-lg border border-purple-500/20",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-purple-500/20 flex items-center justify-center text-2xl",children:"🪙"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-200 font-semibold",children:"Tokens Created"}),e.jsxs("div",{className:"text-purple-400 text-sm",children:[i.tokensCreated," tokens (0.10 XRP each)"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-purple-200",children:[((xe=(pe=i.rewardsByType.token_creation)==null?void 0:pe.total)==null?void 0:xe.toFixed(2))||"0.00"," XRP"]}),e.jsxs("div",{className:"text-purple-400 text-xs",children:[((le=i.rewardsByType.token_creation)==null?void 0:le.count)||0," rewards"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-900/20 rounded-lg border border-blue-500/20",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-blue-500/20 flex items-center justify-center text-2xl",children:"🤖"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-blue-200 font-semibold",children:"Bots Created"}),e.jsxs("div",{className:"text-blue-400 text-sm",children:[i.botsCreated," bots (0.10 XRP each)"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-blue-200",children:[((Ne=($e=i.rewardsByType.bot_creation)==null?void 0:$e.total)==null?void 0:Ne.toFixed(2))||"0.00"," XRP"]}),e.jsxs("div",{className:"text-blue-400 text-xs",children:[((q=i.rewardsByType.bot_creation)==null?void 0:q.count)||0," rewards"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-900/20 rounded-lg border border-green-500/20 opacity-70",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-green-500/20 flex items-center justify-center text-2xl",children:"💱"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-green-200 font-semibold",children:"Trades Executed"}),e.jsx("span",{className:"text-xs bg-yellow-500/20 text-yellow-300 px-2 py-0.5 rounded-full border border-yellow-500/30",children:"Coming Soon"})]}),e.jsxs("div",{className:"text-green-400 text-sm",children:[i.tradesExecuted," trades"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-green-200",children:[((L=(ee=i.rewardsByType.trade)==null?void 0:ee.total)==null?void 0:L.toFixed(2))||"0.00"," XRP"]}),e.jsxs("div",{className:"text-green-400 text-xs",children:[((re=i.rewardsByType.trade)==null?void 0:re.count)||0," rewards"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-yellow-900/20 rounded-lg border border-yellow-500/20 opacity-70",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-yellow-500/20 flex items-center justify-center text-2xl",children:"🎯"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-yellow-200 font-semibold",children:"Other Rewards"}),e.jsx("span",{className:"text-xs bg-yellow-500/20 text-yellow-300 px-2 py-0.5 rounded-full border border-yellow-500/30",children:"Coming Soon"})]}),e.jsx("div",{className:"text-yellow-400 text-sm",children:"Milestones & bonuses"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-yellow-200",children:[Object.entries(i.rewardsByType).filter(([B])=>!["token_creation","bot_creation","trade"].includes(B)).reduce((B,[,Y])=>B+(Y.total||0),0).toFixed(2)," XRP"]}),e.jsxs("div",{className:"text-yellow-400 text-xs",children:[Object.entries(i.rewardsByType).filter(([B])=>!["token_creation","bot_creation","trade"].includes(B)).reduce((B,[,Y])=>B+(Y.count||0),0)," rewards"]})]})]})]})]})]}),e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"💰 Your Rewards Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-purple-400 text-sm",children:"Total Earned"}),e.jsx("span",{className:"text-2xl",children:"🎯"})]}),e.jsxs("div",{className:"text-3xl font-bold text-purple-200",children:[n.totalEarned.toFixed(2)," XRP"]}),e.jsx("div",{className:"text-purple-400 text-sm mt-1",children:"All time earnings"})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-green-400 text-sm",children:"Total Claimed"}),e.jsx("span",{className:"text-2xl",children:"✅"})]}),e.jsxs("div",{className:"text-3xl font-bold text-green-400",children:[n.totalClaimed.toFixed(2)," XRP"]}),e.jsx("div",{className:"text-purple-400 text-sm mt-1",children:"Successfully claimed"})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-yellow-400 text-sm",children:"Pending"}),e.jsx("span",{className:"text-2xl",children:"⏳"})]}),e.jsxs("div",{className:"text-3xl font-bold text-yellow-400",children:[n.pending.toFixed(2)," XRP"]}),e.jsx("div",{className:"text-purple-400 text-sm mt-1",children:"Ready to claim"})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-blue-400 text-sm",children:"Total Rewards"}),e.jsx("span",{className:"text-2xl",children:"🏆"})]}),e.jsx("div",{className:"text-3xl font-bold text-blue-400",children:s.length}),e.jsx("div",{className:"text-purple-400 text-sm mt-1",children:"Reward transactions"})]})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"📊 Earnings Over Time"}),e.jsx("div",{id:"rewards-chart",className:"w-full h-[300px]"})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200",children:"Reward History"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:A,onChange:B=>_(B.target.value),className:"bg-purple-900/30 border border-purple-500/30 rounded-lg px-3 py-2 text-purple-200 text-sm",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"bot_creation",children:"Bot Creation"}),e.jsx("option",{value:"token_creation",children:"Token Creation"}),e.jsx("option",{value:"trade",children:"Trading"}),e.jsx("option",{value:"referral",children:"Referral"}),e.jsx("option",{value:"milestone",children:"Milestone"})]}),e.jsxs("select",{value:W,onChange:B=>D(B.target.value),className:"bg-purple-900/30 border border-purple-500/30 rounded-lg px-3 py-2 text-purple-200 text-sm",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"claimed",children:"Claimed"})]}),e.jsxs("select",{value:I,onChange:B=>E(B.target.value),className:"bg-purple-900/30 border border-purple-500/30 rounded-lg px-3 py-2 text-purple-200 text-sm",children:[e.jsx("option",{value:"date",children:"Sort by Date"}),e.jsx("option",{value:"amount",children:"Sort by Amount"}),e.jsx("option",{value:"type",children:"Sort by Type"}),e.jsx("option",{value:"status",children:"Sort by Status"})]})]})]}),g?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500"}),e.jsx("p",{className:"text-purple-400 mt-4",children:"Loading rewards..."})]}):me.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🎁"}),e.jsx("p",{className:"text-purple-400",children:"No rewards found"}),e.jsx("p",{className:"text-purple-500 text-sm mt-2",children:"Start earning by creating bots, tokens, and trading!"})]}):e.jsx("div",{className:"space-y-3",children:me.map(B=>e.jsx("div",{className:"glass rounded-lg p-4 hover:bg-purple-900/30 transition-all",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg bg-gradient-to-br ${ve[B.reward_type]||"from-purple-500 to-pink-500"} flex items-center justify-center text-2xl`,children:He[B.reward_type]||"🎁"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"text-purple-200 font-medium",children:B.description}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${B.status==="claimed"?"bg-green-500/20 text-green-400":"bg-yellow-500/20 text-yellow-400"}`,children:B.status==="claimed"?"✓ Claimed":"⏳ Pending"})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-purple-400",children:[e.jsx("span",{children:new Date(B.created_at).toLocaleString()}),B.claimed_at&&e.jsxs("span",{className:"text-green-400",children:["Claimed: ",new Date(B.claimed_at).toLocaleString()]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:["+",parseFloat(B.amount).toFixed(2)," XRP"]}),e.jsx("div",{className:"text-purple-400 text-sm capitalize",children:B.reward_type.replace("_"," ")})]})]})},B.id))})]}),b&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-lg p-8 max-w-md w-full",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-4",children:"Claiming Rewards"}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"w-full bg-purple-900/30 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-pink-500 h-full transition-all duration-500",style:{width:`${b.progress}%`}})})}),e.jsx("p",{className:"text-purple-300 text-center",children:b.message})]})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-purple-200 mb-2",children:"XRP Rewards"}),e.jsx("p",{className:"text-purple-400",children:"Track and claim your XRP rewards"})]}),e.jsxs("div",{className:"glass rounded-lg p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"💰"}),e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-2",children:"Connect Your Wallet"}),e.jsx("p",{className:"text-purple-400",children:"Connect your wallet to view and claim your XRP rewards"})]})]})}function Eh({campaign:r,transactions:t,recipients:s}){const n=(()=>{const l=t.filter(g=>g.status==="completed"),i=t.filter(g=>g.status==="failed"),o=l.reduce((g,y)=>g+parseFloat(y.amount||0),0),c=l.reduce((g,y)=>g+parseFloat(y.fee_xrp||0),0),d=t.length>0?(l.length/t.length*100).toFixed(1):0,u=l.length>0?(o/l.length).toFixed(6):0,h=new Set(t.map(g=>g.recipient_id)).size;return{totalTransactions:t.length,completedTransactions:l.length,failedTransactions:i.length,totalAmount:o,totalFees:c,successRate:d,avgAmount:u,uniqueRecipients:h}})();return e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-500/20 to-blue-600/10 border border-blue-500/30 rounded-xl p-4",children:[e.jsx("div",{className:"text-xs text-blue-300 mb-1",children:"Total Transactions"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:n.totalTransactions}),e.jsxs("div",{className:"text-xs text-blue-400 mt-1",children:[n.completedTransactions," completed"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-500/20 to-green-600/10 border border-green-500/30 rounded-xl p-4",children:[e.jsx("div",{className:"text-xs text-green-300 mb-1",children:"Success Rate"}),e.jsxs("div",{className:"text-2xl font-bold text-white",children:[n.successRate,"%"]}),e.jsxs("div",{className:"text-xs text-green-400 mt-1",children:[n.failedTransactions," failed"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-500/20 to-purple-600/10 border border-purple-500/30 rounded-xl p-4",children:[e.jsx("div",{className:"text-xs text-purple-300 mb-1",children:"Total Amount Sent"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:n.totalAmount.toFixed(2)}),e.jsxs("div",{className:"text-xs text-purple-400 mt-1",children:["Avg: ",n.avgAmount]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-500/20 to-orange-600/10 border border-orange-500/30 rounded-xl p-4",children:[e.jsx("div",{className:"text-xs text-orange-300 mb-1",children:"Total Fees"}),e.jsxs("div",{className:"text-2xl font-bold text-white",children:[n.totalFees.toFixed(2)," XRP"]}),e.jsxs("div",{className:"text-xs text-orange-400 mt-1",children:[n.uniqueRecipients," recipients"]})]})]})}async function Ph(r){try{const{data:t,error:s}=await S.from("meme_tokens").select("id, token_name, currency_code, receiver_address, image_url").eq("receiver_address",r).order("created_at",{ascending:!1});if(s)throw s;return t||[]}catch{return[]}}function Ah(r){return{value:`${r.currency_code}|${r.receiver_address}`,label:`${r.token_name} (${r.currency_code})`,currency_code:r.currency_code,issuer_address:r.receiver_address,image_url:r.image_url,token_name:r.token_name}}const wa=[{id:"fixed",name:"Fixed Amount",icon:"📊"},{id:"wallet_balance_percent",name:"Wallet Balance %",icon:"💰"},{id:"xrp_balance_percent",name:"XRP Balance %",icon:"💎"},{id:"token_balance_ratio",name:"Token Balance 1:1",icon:"🔄"},{id:"random_range",name:"Random Range",icon:"🎲"}];function Rh(){const[r,t]=m.useState(null),[s,a]=m.useState([]),[n,l]=m.useState(null),[i,o]=m.useState([]),[c,d]=m.useState([]),[u,h]=m.useState([]),[g,y]=m.useState([]),[f,w]=m.useState([]),[b,P]=m.useState([]),[A,_]=m.useState(!1);m.useState(!1);const[W,D]=m.useState(!1),I=m.useRef(!1);m.useRef(!1);const[E,G]=m.useState({name:"",intervalSeconds:5,tokens:[{currency_code:"",issuer_address:"",distribution_method:"fixed",amount:"",min_amount:"",max_amount:"",balance_percent:"",source_token_currency:"",source_token_issuer:""}],recipientsList:""}),[_e,ge]=m.useState(!1),[Ce,ue]=m.useState(!1),[J,se]=m.useState(null),[F,X]=m.useState(!1),[me,ve]=m.useState(0),[He,pe]=m.useState({recipient:0,token:0,total:0});m.useState(null);const[xe,le]=m.useState({totalCampaigns:0,activeCampaigns:0,totalSent:0,totalFees:0});m.useEffect(()=>{$e()},[]),m.useEffect(()=>{r&&(ee(),re(),Ne(),q())},[r]),m.useEffect(()=>{if(n){L(n.id);const M=setInterval(()=>{L(n.id)},3e3);return()=>clearInterval(M)}},[n]);const $e=async()=>{const M=localStorage.getItem("connectedWallet");if(M){const fe=JSON.parse(M);if(!fe.seed&&fe.id)try{const{data:K}=await S.from("wallets").select("*").eq("id",fe.id).maybeSingle();if(K){const v={...K,seed:K.encrypted_seed||K.seed};localStorage.setItem("connectedWallet",JSON.stringify(v)),t(v);return}}catch{}t(fe)}},Ne=async()=>{const M=await Ph(r.address);w(M.map(Ah))},q=async()=>{if(r)try{const{data:M,error:fe}=await S.from("token_holdings_cache").select(`
          *,
          meme_tokens:token_id (
            currency_code,
            issuer_address,
            token_name,
            image_url
          )
        `).eq("wallet_address",r.address).gt("balance",0).order("balance",{ascending:!1});if(fe){P([]);return}const K=(M||[]).filter(v=>v.meme_tokens).map(v=>{const p=v.meme_tokens;return{value:`${p.currency_code}:${p.issuer_address}`,label:`${p.currency_code} ${p.token_name?"- "+p.token_name:""} (Balance: ${parseFloat(v.balance).toFixed(2)})`,currency_code:p.currency_code,issuer_address:p.issuer_address,balance:parseFloat(v.balance),token_name:p.token_name,image_url:p.image_url}});P(K)}catch{P([])}},ee=async()=>{try{const{data:M,error:fe}=await S.from("airdrop_campaigns").select("*").eq("wallet_address",r.address).order("created_at",{ascending:!1});if(fe)throw fe;a(M||[])}catch{}},L=async M=>{try{const[fe,K,v,p]=await Promise.all([S.from("airdrop_tokens").select("*").eq("campaign_id",M),S.from("airdrop_recipients").select("*").eq("campaign_id",M).order("created_at",{ascending:!1}),S.from("airdrop_transactions").select("*").eq("campaign_id",M).order("created_at",{ascending:!1}),S.from("airdrop_logs").select("*").eq("campaign_id",M).order("created_at",{ascending:!1}).limit(100)]);o(fe.data||[]),d(K.data||[]),h(v.data||[]),y(p.data||[])}catch{}},re=async()=>{try{const{data:M}=await S.from("airdrop_campaigns").select("*").eq("wallet_address",r.address),{data:fe}=await S.from("airdrop_transactions").select("fee_xrp").in("campaign_id",(M||[]).map(K=>K.id)).eq("status","completed");le({totalCampaigns:(M==null?void 0:M.length)||0,activeCampaigns:(M==null?void 0:M.filter(K=>K.status==="running"||K.status==="paused").length)||0,totalSent:(fe==null?void 0:fe.length)||0,totalFees:(fe==null?void 0:fe.reduce((K,v)=>K+parseFloat(v.fee_xrp),0))||0})}catch{}},B=()=>{const M=E.recipientsList.split(`
`).filter(K=>K.trim()).length,fe=E.tokens.filter(K=>K.currency_code&&K.issuer_address).length;return(M*fe*.01).toFixed(2)},Y=M=>{const fe=M.target.files[0];if(!fe)return;const K=new FileReader;K.onload=v=>{const R=v.target.result.split(`
`).filter(H=>H.trim()).map(H=>H.split(",")[0].trim()).filter(H=>H);G({...E,recipientsList:R.join(`
`)}),k.success(`Imported ${R.length} addresses`)},K.readAsText(fe)},oe=()=>{G({...E,tokens:[...E.tokens,{currency_code:"",issuer_address:"",distribution_method:"fixed",amount:"",min_amount:"",max_amount:"",balance_percent:"",source_token_currency:"",source_token_issuer:""}]})},ie=M=>{const fe=E.tokens.filter((K,v)=>v!==M);G({...E,tokens:fe})},ye=(M,fe,K)=>{const v=[...E.tokens];v[M][fe]=K,G({...E,tokens:v})},te=(M,fe)=>{const K=[...E.tokens];K[M].currency_code=fe.currency_code,K[M].issuer_address=fe.issuer_address,G({...E,tokens:K})},U=async(M,fe)=>{if(!M||!fe){k.error("Please select or enter a token first");return}X(!0);try{const K=new Re.Client("wss://xrplcluster.com");await K.connect();const v=new Set;let p,x=0;const R=50;for(k.loading("Fetching token holders from XRPL...",{id:"fetch-holders"});x<R;){const qe=await K.request({command:"account_lines",account:fe,limit:400,marker:p});if(qe.result&&qe.result.lines&&qe.result.lines.forEach(Ie=>{Ie.account&&Ie.balance&&parseFloat(Ie.balance)>0&&v.add(Ie.account)}),p=qe.result.marker,!p)break;x++}if(await K.disconnect(),v.size===0){k.error("No holders found for this token",{id:"fetch-holders"}),X(!1);return}const H=Array.from(v).join(`
`),z=E.recipientsList.trim(),ae=z?z+`
`+H:H;G({...E,recipientsList:ae}),k.success(`Added ${v.size} token holders!`,{id:"fetch-holders"})}catch(K){const v=K.message||"Failed to fetch token holders";k.error(`Failed to fetch token holders: ${v}`,{id:"fetch-holders"})}finally{X(!1)}},ke=async M=>{try{const{error:fe}=await S.from("airdrop_campaigns").update({status:"running",started_at:new Date().toISOString()}).eq("id",M);if(fe)throw fe;await S.from("airdrop_logs").insert({campaign_id:M,log_type:"info",message:"Campaign started"}),k.success("Campaign started!"),ee(),(n==null?void 0:n.id)===M&&L(M),be(M)}catch{k.error("Failed to start campaign")}},he=async M=>{try{const{error:fe}=await S.from("airdrop_campaigns").update({status:"paused",paused_at:new Date().toISOString()}).eq("id",M);if(fe)throw fe;await S.from("airdrop_logs").insert({campaign_id:M,log_type:"warning",message:"Campaign paused"}),k.success("Campaign paused"),ee(),(n==null?void 0:n.id)===M&&L(M)}catch{k.error("Failed to pause campaign")}},Oe=async M=>{try{I.current=!1;const{error:fe}=await S.from("airdrop_campaigns").update({status:"completed",completed_at:new Date().toISOString()}).eq("id",M);if(fe)throw fe;await S.from("airdrop_logs").insert({campaign_id:M,log_type:"info",message:"Campaign stopped by user"}),k.success("Campaign stopped"),ee(),(n==null?void 0:n.id)===M&&L(M)}catch{k.error("Failed to stop campaign")}},$=async(M,fe,K)=>{try{switch(M.distribution_method){case"fixed":return parseFloat(M.amount);case"wallet_balance_percent":const p=(await K.request({command:"account_lines",account:fe,peer:M.issuer_address})).result.lines.find(Je=>Je.currency===M.currency_code);return(p?parseFloat(p.balance):0)*(parseFloat(M.balance_percent)/100);case"xrp_balance_percent":const R=await K.request({command:"account_info",account:fe});return parseFloat(R.result.account_data.Balance)/1e6*(parseFloat(M.balance_percent)/100);case"random_range":const z=parseFloat(M.min_amount),ae=parseFloat(M.max_amount);return Math.random()*(ae-z)+z;case"token_balance_ratio":const Ie=(await K.request({command:"account_lines",account:fe,peer:M.source_token_issuer})).result.lines.find(Je=>Je.currency===M.source_token_currency);return Ie?parseFloat(Ie.balance):0;default:return 0}}catch{return 0}},be=async M=>{if(I.current){k.error("Airdrop already in progress");return}I.current=!0,_(!0);try{const{data:fe}=await S.from("airdrop_campaigns").select("*").eq("id",M).single();if(!fe)throw new Error("Campaign not found");const{data:K}=await S.from("airdrop_tokens").select("*").eq("campaign_id",M),{data:v}=await S.from("airdrop_recipients").select("*").eq("campaign_id",M).eq("status","pending");if(!K||K.length===0)throw new Error("No tokens configured");if(!v||v.length===0){await S.from("airdrop_logs").insert({campaign_id:M,log_type:"info",message:"All recipients completed"}),await Oe(M);return}const p=Re.Wallet.fromSeed(r.seed),x=new Re.Client("wss://xrplcluster.com");await x.connect(),await S.from("airdrop_logs").insert({campaign_id:M,log_type:"info",message:`Starting airdrop execution: ${v.length} recipients, ${K.length} tokens`});let R=0,H=0,z=0,ae=0;for(let et=0;et<v.length;et++){if(!I.current){await S.from("airdrop_logs").insert({campaign_id:M,log_type:"warning",message:"Airdrop execution stopped"});break}const ze=v[et];pe({recipient:et+1,token:0,total:v.length*K.length}),await S.from("airdrop_recipients").update({status:"processing"}).eq("id",ze.id);let dt=!1,Rt=0;for(let Tt=0;Tt<K.length&&I.current;Tt++){const wt=K[Tt];R++,pe({recipient:et+1,token:Tt+1,total:v.length*K.length});const{data:Mt}=await S.from("airdrop_transactions").select("*").eq("campaign_id",M).eq("recipient_id",ze.id).eq("token_id",wt.id).maybeSingle();if(Mt&&Mt.status==="completed")continue;let ut=Mt==null?void 0:Mt.id;if(!ut){const{data:jt}=await S.from("airdrop_transactions").insert({campaign_id:M,recipient_id:ze.id,token_id:wt.id,amount:0,fee_xrp:.01,status:"pending"}).select().single();ut=jt.id}try{await S.from("airdrop_transactions").update({status:"processing"}).eq("id",ut);const jt=await $(wt,ze.wallet_address,x);if(jt<=0){await S.from("airdrop_transactions").update({status:"failed",error_message:"Calculated amount is zero or negative",amount:jt,processed_at:new Date().toISOString()}).eq("id",ut),await S.from("airdrop_logs").insert({campaign_id:M,log_type:"warning",message:`Skipped ${ze.wallet_address} - ${wt.currency_code}: amount is ${jt}`}),H++;continue}const pt={TransactionType:"Payment",Account:p.address,Destination:ze.wallet_address,Amount:{currency:wt.currency_code,value:jt.toString(),issuer:wt.issuer_address}},lt=await x.autofill(pt),j=p.sign(lt),Q=await x.submitAndWait(j.tx_blob);if(Q.result.meta.TransactionResult==="tesSUCCESS"){const Z=parseFloat(Q.result.Fee)/1e6;ae+=Z,await S.from("airdrop_transactions").update({status:"completed",amount:jt,fee_xrp:Z,tx_hash:Q.result.hash,processed_at:new Date().toISOString()}).eq("id",ut),await S.from("airdrop_tokens").update({total_sent:(parseFloat(wt.total_sent||0)+jt).toString()}).eq("id",wt.id),Rt++,z++,await S.from("airdrop_logs").insert({campaign_id:M,log_type:"success",message:`Sent ${jt.toFixed(6)} ${wt.currency_code} to ${ze.wallet_address}`,details:{tx_hash:Q.result.hash,fee:Z}})}else throw new Error(Q.result.meta.TransactionResult)}catch(jt){const pt=jt.message||"Transaction failed";await S.from("airdrop_transactions").update({status:"failed",error_message:pt,processed_at:new Date().toISOString()}).eq("id",ut),await S.from("airdrop_logs").insert({campaign_id:M,log_type:"error",message:`Failed to send ${wt.currency_code} to ${ze.wallet_address}: ${pt}`}),H++,dt=!0}if(Tt<K.length-1||et<v.length-1){const jt=Math.max(5,fe.interval_seconds);for(let pt=jt;pt>0&&I.current;pt--)ve(pt),await new Promise(lt=>setTimeout(lt,1e3));ve(0)}}Rt===K.length?await S.from("airdrop_recipients").update({status:"completed",processed_at:new Date().toISOString()}).eq("id",ze.id):Rt>0?await S.from("airdrop_recipients").update({status:"completed",error_message:"Some tokens failed",processed_at:new Date().toISOString()}).eq("id",ze.id):await S.from("airdrop_recipients").update({status:"failed",error_message:"All tokens failed",processed_at:new Date().toISOString()}).eq("id",ze.id)}await x.disconnect();const qe=await S.from("airdrop_recipients").select("*",{count:"exact"}).eq("campaign_id",M).eq("status","completed"),Ie=await S.from("airdrop_recipients").select("*",{count:"exact"}).eq("campaign_id",M).eq("status","failed");await S.from("airdrop_campaigns").update({completed_recipients:qe.count||0,failed_recipients:Ie.count||0,completed_transactions:z,failed_transactions:H,total_fees_paid:ae}).eq("id",M),qe.count+Ie.count>=fe.total_recipients?(await S.from("airdrop_campaigns").update({status:"completed",completed_at:new Date().toISOString()}).eq("id",M),await S.from("airdrop_logs").insert({campaign_id:M,log_type:"success",message:`Campaign completed! Processed: ${z}, Failed: ${H}, Total Fees: ${ae.toFixed(6)} XRP`}),k.success("Airdrop completed!")):await S.from("airdrop_logs").insert({campaign_id:M,log_type:"info",message:`Batch completed. Processed: ${z}, Failed: ${H}`}),ee(),L(M)}catch(fe){await S.from("airdrop_logs").insert({campaign_id:M,log_type:"error",message:`Execution error: ${fe.message}`}),k.error(`Airdrop failed: ${fe.message}`)}finally{I.current=!1,_(!1),ve(0),pe({recipient:0,token:0,total:0})}},We=async M=>{const{data:fe}=await S.from("airdrop_tokens").select("*").eq("campaign_id",M.id),{data:K}=await S.from("airdrop_recipients").select("*").eq("campaign_id",M.id).eq("status","pending"),v=fe.map(x=>({currency_code:x.currency_code,issuer_address:x.issuer_address,distribution_method:x.distribution_method,amount:x.amount||"",min_amount:x.min_amount||"",max_amount:x.max_amount||"",balance_percent:x.balance_percent||"",source_token_currency:x.source_token_currency||"",source_token_issuer:x.source_token_issuer||""})),p=K.map(x=>x.wallet_address).join(`
`);se({id:M.id,name:M.name,intervalSeconds:M.interval_seconds,tokens:v,recipientsList:p}),ue(!0)},tt=async()=>{if(!J.name.trim()){k.error("Please enter a campaign name");return}const M=J.tokens.filter(K=>{if(!K.currency_code||!K.issuer_address)return!1;switch(K.distribution_method){case"fixed":return K.amount&&parseFloat(K.amount)>0;case"wallet_balance_percent":case"xrp_balance_percent":return K.balance_percent&&parseFloat(K.balance_percent)>0;case"token_balance_ratio":return!0;case"random_range":return K.min_amount&&K.max_amount&&parseFloat(K.min_amount)<=parseFloat(K.max_amount);default:return!1}});if(M.length===0){k.error("Please add at least one valid token");return}const fe=J.recipientsList.split(`
`).filter(K=>K.trim());if(fe.length===0){k.error("Please add at least one recipient");return}try{const K=fe.length*M.length;await S.from("airdrop_campaigns").update({name:J.name,total_recipients:fe.length,total_transactions:K,interval_seconds:Math.max(5,parseInt(J.intervalSeconds))}).eq("id",J.id),await S.from("airdrop_tokens").delete().eq("campaign_id",J.id),await S.from("airdrop_recipients").delete().eq("campaign_id",J.id),await S.from("airdrop_transactions").delete().eq("campaign_id",J.id);const v=M.map(z=>({campaign_id:J.id,currency_code:z.currency_code,issuer_address:z.issuer_address,distribution_method:z.distribution_method,amount:z.distribution_method==="fixed"?parseFloat(z.amount):null,min_amount:z.distribution_method==="random_range"?parseFloat(z.min_amount):null,max_amount:z.distribution_method==="random_range"?parseFloat(z.max_amount):null,balance_percent:["wallet_balance_percent","xrp_balance_percent"].includes(z.distribution_method)?parseFloat(z.balance_percent):null,source_token_currency:z.distribution_method==="token_balance_ratio"?z.source_token_currency:null,source_token_issuer:z.distribution_method==="token_balance_ratio"?z.source_token_issuer:null})),{data:p}=await S.from("airdrop_tokens").insert(v).select(),x=fe.map(z=>({campaign_id:J.id,wallet_address:z.trim()})),{data:R}=await S.from("airdrop_recipients").insert(x).select(),H=[];for(const z of R)for(const ae of p)H.push({campaign_id:J.id,recipient_id:z.id,token_id:ae.id,amount:0,fee_xrp:.01,status:"pending"});await S.from("airdrop_transactions").insert(H),await S.from("airdrop_logs").insert({campaign_id:J.id,log_type:"info",message:`Campaign updated with ${M.length} tokens, ${fe.length} recipients, ${K} transactions`}),k.success("Campaign updated!"),ue(!1),se(null),ee(),L(J.id)}catch(K){const v=K.message||K.hint||"Failed to update campaign";k.error(`Failed to update campaign: ${v}`)}},nt=async()=>{if(!E.name.trim()){k.error("Please enter a campaign name");return}const M=E.tokens.filter(K=>{if(!K.currency_code||!K.issuer_address)return!1;switch(K.distribution_method){case"fixed":return K.amount&&parseFloat(K.amount)>0;case"wallet_balance_percent":case"xrp_balance_percent":return K.balance_percent&&parseFloat(K.balance_percent)>0;case"token_balance_ratio":return!0;case"random_range":return K.min_amount&&K.max_amount&&parseFloat(K.min_amount)<=parseFloat(K.max_amount);default:return!1}});if(M.length===0){k.error("Please add at least one valid token");return}const fe=E.recipientsList.split(`
`).filter(K=>K.trim());if(fe.length===0){k.error("Please add at least one recipient");return}try{const K=fe.length*M.length,{data:v,error:p}=await S.from("airdrop_campaigns").insert({wallet_address:r.address,name:E.name,total_recipients:fe.length,total_transactions:K,interval_seconds:Math.max(5,parseInt(E.intervalSeconds))}).select().single();if(p)throw p;const x=M.map(qe=>({campaign_id:v.id,currency_code:qe.currency_code,issuer_address:qe.issuer_address,distribution_method:qe.distribution_method,amount:qe.distribution_method==="fixed"?parseFloat(qe.amount):null,min_amount:qe.distribution_method==="random_range"?parseFloat(qe.min_amount):null,max_amount:qe.distribution_method==="random_range"?parseFloat(qe.max_amount):null,balance_percent:["wallet_balance_percent","xrp_balance_percent"].includes(qe.distribution_method)?parseFloat(qe.balance_percent):null,source_token_currency:qe.distribution_method==="token_balance_ratio"?qe.source_token_currency:null,source_token_issuer:qe.distribution_method==="token_balance_ratio"?qe.source_token_issuer:null})),{data:R}=await S.from("airdrop_tokens").insert(x).select(),H=fe.map(qe=>({campaign_id:v.id,wallet_address:qe.trim()})),{data:z}=await S.from("airdrop_recipients").insert(H).select(),ae=[];for(const qe of z)for(const Ie of R)ae.push({campaign_id:v.id,recipient_id:qe.id,token_id:Ie.id,amount:0,fee_xrp:.01,status:"pending"});await S.from("airdrop_transactions").insert(ae),await S.from("airdrop_logs").insert({campaign_id:v.id,log_type:"info",message:`Campaign created with ${M.length} tokens, ${fe.length} recipients, ${K} transactions`}),k.success("Campaign created!"),ge(!1),G({name:"",intervalSeconds:5,tokens:[{currency_code:"",issuer_address:"",distribution_method:"fixed",amount:"",min_amount:"",max_amount:"",balance_percent:"",source_token_currency:"",source_token_issuer:""}],recipientsList:""}),ee()}catch(K){const v=K.message||K.hint||"Failed to create campaign";k.error(`Failed to create campaign: ${v}`)}};return r?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-white p-4 md:p-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8 flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-2 bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 text-transparent bg-clip-text",children:"Multi-Token Airdropper"}),e.jsx("p",{className:"text-slate-400",children:"Advanced batch token distribution with comprehensive analytics"})]}),e.jsxs("button",{onClick:()=>D(!0),className:"px-4 py-2 bg-purple-500/10 border border-purple-500/30 rounded-xl hover:bg-purple-500/20 transition-all flex items-center gap-2",children:[e.jsx("span",{children:"ℹ️"}),e.jsx("span",{children:"How It Works"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-purple-900/30 to-purple-800/20 backdrop-blur-xl border border-purple-500/20 rounded-2xl p-6",children:[e.jsx("div",{className:"text-sm text-slate-400 mb-2",children:"Total Campaigns"}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:xe.totalCampaigns}),e.jsx("div",{className:"text-xs text-slate-500",children:"All time"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-500/10 to-emerald-500/5 border border-green-500/20 rounded-2xl p-6",children:[e.jsx("div",{className:"text-sm text-green-300 mb-2",children:"Active Now"}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:xe.activeCampaigns}),e.jsx("div",{className:"text-xs text-green-400",children:"Running campaigns"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-500/10 to-cyan-500/5 border border-blue-500/20 rounded-2xl p-6",children:[e.jsx("div",{className:"text-sm text-blue-300 mb-2",children:"Transactions"}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:xe.totalSent}),e.jsx("div",{className:"text-xs text-blue-400",children:"Successful sends"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-500/10 to-red-500/5 border border-orange-500/20 rounded-2xl p-6",children:[e.jsx("div",{className:"text-sm text-orange-300 mb-2",children:"Total Fees"}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:xe.totalFees.toFixed(2)}),e.jsx("div",{className:"text-xs text-orange-400",children:"XRP paid"})]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Campaigns"}),e.jsx("button",{onClick:()=>ge(!0),className:"px-6 py-3 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 rounded-xl font-medium hover:shadow-lg hover:shadow-purple-500/50 transition-all",children:"Create Campaign"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1 space-y-4",children:s.length===0?e.jsxs("div",{className:"bg-purple-900/20 backdrop-blur-xl border border-purple-500/30 rounded-2xl p-12 text-center",children:[e.jsx("div",{className:"text-5xl mb-4",children:"📭"}),e.jsx("p",{className:"text-slate-400",children:"No campaigns yet"}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Create your first airdrop campaign"})]}):s.map(M=>e.jsxs("div",{onClick:()=>l(M),className:`backdrop-blur-xl border rounded-2xl p-5 cursor-pointer transition-all ${(n==null?void 0:n.id)===M.id?"bg-gradient-to-br from-purple-500/20 to-blue-500/10 border-purple-500/50 shadow-lg shadow-purple-500/20":"bg-purple-900/20 border-purple-500/30 hover:border-purple-500/50"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h3",{className:"font-bold text-lg truncate flex-1",children:M.name}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${M.status==="running"?"bg-green-500/20 text-green-300 border border-green-500/30":M.status==="paused"?"bg-yellow-500/20 text-yellow-300 border border-yellow-500/30":M.status==="completed"?"bg-blue-500/20 text-blue-300 border border-blue-500/30":M.status==="failed"?"bg-red-500/20 text-red-300 border border-red-500/30":"bg-slate-500/20 text-slate-300 border border-slate-500/30"}`,children:M.status})]}),e.jsxs("div",{className:"space-y-2 text-sm text-slate-400",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Recipients:"}),e.jsxs("span",{className:"text-white font-medium",children:[M.completed_recipients,"/",M.total_recipients]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Transactions:"}),e.jsxs("span",{className:"text-white font-medium",children:[M.completed_transactions||0,"/",M.total_transactions||0]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Interval:"}),e.jsxs("span",{className:"text-white font-medium",children:[M.interval_seconds,"s"]})]})]})]},M.id))}),e.jsx("div",{className:"lg:col-span-2 space-y-6",children:n?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-purple-900/20 backdrop-blur-xl border border-purple-500/30 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-1",children:n.name}),e.jsx("p",{className:"text-sm text-slate-400",children:"Campaign Controls"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[(n.status==="pending"||n.status==="paused")&&e.jsxs("button",{onClick:()=>We(n),className:"px-5 py-2.5 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-xl font-medium hover:shadow-lg hover:shadow-cyan-500/50 transition-all flex items-center gap-2",children:[e.jsx("span",{children:"✏️"}),e.jsx("span",{children:"Edit"})]}),n.status==="pending"&&e.jsxs("button",{onClick:()=>ke(n.id),disabled:A,className:"px-5 py-2.5 bg-gradient-to-r from-green-500 to-emerald-500 rounded-xl font-medium hover:shadow-lg hover:shadow-green-500/50 transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("span",{children:"▶️"}),e.jsx("span",{children:"Start"})]}),n.status==="running"&&e.jsxs("button",{onClick:()=>he(n.id),className:"px-5 py-2.5 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-xl font-medium hover:shadow-lg hover:shadow-yellow-500/50 transition-all flex items-center gap-2",children:[e.jsx("span",{children:"⏸️"}),e.jsx("span",{children:"Pause"})]}),n.status==="paused"&&e.jsxs("button",{onClick:()=>ke(n.id),disabled:A,className:"px-5 py-2.5 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-xl font-medium hover:shadow-lg hover:shadow-blue-500/50 transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("span",{children:"▶️"}),e.jsx("span",{children:"Resume"})]}),(n.status==="running"||n.status==="paused")&&e.jsxs("button",{onClick:()=>Oe(n.id),className:"px-5 py-2.5 bg-gradient-to-r from-red-500 to-pink-500 rounded-xl font-medium hover:shadow-lg hover:shadow-red-500/50 transition-all flex items-center gap-2",children:[e.jsx("span",{children:"⏹️"}),e.jsx("span",{children:"Stop"})]}),n.status==="completed"&&e.jsxs("div",{className:"px-5 py-2.5 bg-gradient-to-r from-purple-500/20 to-blue-500/20 border border-purple-500/50 rounded-xl flex items-center gap-2",children:[e.jsx("span",{children:"✅"}),e.jsx("span",{className:"font-medium",children:"Completed"})]})]})]}),A&&e.jsxs("div",{className:"mt-4 bg-gradient-to-r from-blue-500/10 to-purple-500/10 border border-blue-500/30 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"animate-spin text-2xl",children:"⚡"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-white",children:"Processing Airdrop"}),e.jsxs("div",{className:"text-sm text-slate-400",children:["Recipient ",He.recipient," of ",n.total_recipients," | Token ",He.token," of ",i.length]})]})]}),me>0&&e.jsxs("div",{className:"flex items-center gap-2 bg-orange-500/20 border border-orange-500/30 px-4 py-2 rounded-lg",children:[e.jsx("span",{className:"text-lg",children:"⏱️"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-300",children:me}),e.jsx("div",{className:"text-xs text-orange-400",children:"seconds"})]})]})]}),e.jsx("div",{className:"bg-purple-950/50 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 h-full transition-all duration-300",style:{width:`${He.total>0?((He.recipient-1)*i.length+He.token)/He.total*100:0}%`}})})]})]}),e.jsx(Eh,{campaign:n,transactions:u,recipients:c}),e.jsxs("div",{className:"bg-purple-900/20 backdrop-blur-xl border border-purple-500/30 rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"🪙"}),e.jsxs("span",{children:["Tokens (",i.length,")"]})]}),i.length===0?e.jsx("p",{className:"text-slate-400 text-center py-8",children:"No tokens configured"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:i.map(M=>{var fe,K;return e.jsxs("div",{className:"bg-purple-950/40 rounded-xl p-4 border border-purple-500/30",children:[e.jsx("div",{className:"flex justify-between items-start mb-2",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-white",children:M.currency_code}),e.jsx("div",{className:"text-xs text-slate-400 truncate",children:M.issuer_address})]})}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-purple-300 bg-purple-500/10 px-2 py-1 rounded-lg mb-2",children:[e.jsx("span",{children:(fe=wa.find(v=>v.id===M.distribution_method))==null?void 0:fe.icon}),e.jsx("span",{children:(K=wa.find(v=>v.id===M.distribution_method))==null?void 0:K.name})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-sm text-slate-400",children:["Sent: ",e.jsx("span",{className:"text-white font-medium",children:parseFloat(M.total_sent||0).toFixed(2)})]})})]},M.id)})})]}),e.jsxs("div",{className:"bg-purple-900/20 backdrop-blur-xl border border-purple-500/30 rounded-2xl p-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx("span",{children:"📊"}),e.jsxs("span",{children:["Transactions (",u.length,")"]})]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:u.slice(0,50).map(M=>{const fe=c.find(v=>v.id===M.recipient_id),K=i.find(v=>v.id===M.token_id);return e.jsx("div",{className:"bg-purple-950/40 rounded-xl p-3 border border-purple-500/30",children:e.jsxs("div",{className:"flex justify-between items-start gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("span",{className:"text-sm text-white font-mono truncate",children:fe==null?void 0:fe.wallet_address})}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[e.jsx("span",{className:"font-medium text-purple-300",children:K==null?void 0:K.currency_code}),M.amount&&e.jsx("span",{className:"text-green-400",children:parseFloat(M.amount).toFixed(6)}),e.jsxs("span",{className:"text-orange-400",children:[M.fee_xrp," XRP fee"]})]}),M.tx_hash&&e.jsx("div",{className:"mt-1",children:e.jsx(Ls,{type:"tx",value:M.tx_hash,network:"mainnet"})}),M.error_message&&e.jsx("div",{className:"text-xs text-red-400 mt-1",children:M.error_message})]}),e.jsx("span",{className:`px-2 py-1 rounded-lg text-xs whitespace-nowrap font-medium ${M.status==="completed"?"bg-green-500/20 text-green-300 border border-green-500/30":M.status==="processing"?"bg-blue-500/20 text-blue-300 border border-blue-500/30":M.status==="failed"?"bg-red-500/20 text-red-300 border border-red-500/30":"bg-slate-500/20 text-slate-300 border border-slate-500/30"}`,children:M.status})]})},M.id)})})]}),e.jsxs("div",{className:"bg-purple-900/20 backdrop-blur-xl border border-purple-500/30 rounded-2xl p-6",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"📋"}),e.jsxs("span",{children:["Activity Logs (",g.length,")"]})]}),e.jsx("div",{className:`space-y-2 ${g.length>5?"max-h-96 overflow-y-auto":""}`,children:g.map(M=>e.jsx("div",{className:`rounded-xl p-3 border ${M.log_type==="success"?"bg-green-500/10 border-green-500/30":M.log_type==="error"?"bg-red-500/10 border-red-500/30":M.log_type==="warning"?"bg-yellow-500/10 border-yellow-500/30":"bg-blue-500/10 border-blue-500/30"}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-lg",children:M.log_type==="success"?"✅":M.log_type==="error"?"❌":M.log_type==="warning"?"⚠️":"ℹ️"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm text-white",children:M.message}),e.jsx("div",{className:"text-xs text-slate-400 mt-1",children:new Date(M.created_at).toLocaleString()})]})]})},M.id))})]})]}):e.jsxs("div",{className:"bg-purple-900/20 backdrop-blur-xl border border-purple-500/30 rounded-2xl p-20 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"👈"}),e.jsx("p",{className:"text-slate-400 text-lg",children:"Select a campaign to view details"}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Choose from the list on the left"})]})})]})]}),_e&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4 overflow-y-auto",children:e.jsx("div",{className:"bg-gradient-to-br from-purple-900/95 to-purple-800/95 border border-purple-500/50 rounded-2xl max-w-3xl w-full my-8 shadow-2xl shadow-purple-500/20",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Create Airdrop Campaign"}),e.jsx("button",{onClick:()=>ge(!1),className:"text-slate-400 hover:text-white text-2xl",children:"✕"})]}),e.jsxs("div",{className:"space-y-5 max-h-[70vh] overflow-y-auto pr-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-slate-300",children:"Campaign Name"}),e.jsx("input",{type:"text",value:E.name,onChange:M=>G({...E,name:M.target.value}),className:"w-full px-4 py-3 bg-purple-950/50 border border-purple-500/30 rounded-xl focus:outline-none focus:border-purple-400 text-white placeholder-purple-300/50",placeholder:"My Token Airdrop"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-slate-300",children:"Interval Between Recipients (seconds)"}),e.jsx("input",{type:"number",min:"5",value:E.intervalSeconds,onChange:M=>G({...E,intervalSeconds:M.target.value}),className:"w-full px-4 py-3 bg-purple-950/50 border border-purple-500/30 rounded-xl focus:outline-none focus:border-purple-400 text-white"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Tokens to Airdrop"}),e.jsx("button",{onClick:oe,className:"px-4 py-2 bg-purple-500/20 border border-purple-500/30 rounded-xl text-sm hover:bg-purple-500/30 transition-all text-purple-300",children:"+ Add Token"})]}),e.jsx("div",{className:"space-y-4",children:E.tokens.map((M,fe)=>e.jsxs("div",{className:"bg-purple-950/40 rounded-xl p-4 space-y-3 border border-purple-500/30",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm font-medium text-white",children:["Token ",fe+1]}),E.tokens.length>1&&e.jsx("button",{onClick:()=>ie(fe),className:"text-red-400 hover:text-red-300 text-sm font-medium",children:"Remove"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Select from your wallet tokens"}),e.jsxs("select",{onChange:K=>{const v=b.find(p=>p.value===K.target.value);v&&te(fe,v)},className:"w-full px-3 py-2 bg-purple-950/50 border border-purple-500/30 rounded-lg focus:outline-none focus:border-purple-400 text-white text-sm",children:[e.jsx("option",{value:"",children:b.length===0?"Loading your tokens...":"Choose a token..."}),b.map(K=>e.jsx("option",{value:K.value,children:K.label},K.value))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",value:M.currency_code,onChange:K=>ye(fe,"currency_code",K.target.value),className:"px-3 py-2 bg-purple-950/50 border border-purple-500/30 rounded-lg focus:outline-none focus:border-purple-400 text-white text-sm placeholder-purple-300/50",placeholder:"Currency Code"}),e.jsx("input",{type:"text",value:M.issuer_address,onChange:K=>ye(fe,"issuer_address",K.target.value),className:"px-3 py-2 bg-purple-950/50 border border-purple-500/30 rounded-lg focus:outline-none focus:border-purple-400 text-white text-sm placeholder-purple-300/50",placeholder:"Issuer Address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Distribution Method"}),e.jsx("select",{value:M.distribution_method,onChange:K=>ye(fe,"distribution_method",K.target.value),className:"w-full px-3 py-2 bg-purple-950/50 border border-purple-500/30 rounded-lg focus:outline-none focus:border-purple-400 text-white text-sm",children:wa.map(K=>e.jsxs("option",{value:K.id,children:[K.icon," ",K.name]},K.id))})]}),M.distribution_method==="fixed"&&e.jsx("input",{type:"number",value:M.amount,onChange:K=>ye(fe,"amount",K.target.value),className:"w-full px-3 py-2 bg-purple-950/50 border border-purple-500/30 rounded-lg focus:outline-none focus:border-purple-400 text-white text-sm placeholder-purple-300/50",placeholder:"Amount per recipient",step:"0.000001"}),(M.distribution_method==="wallet_balance_percent"||M.distribution_method==="xrp_balance_percent")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Percentage (%)"}),e.jsx("input",{type:"number",value:M.balance_percent,onChange:K=>ye(fe,"balance_percent",K.target.value),className:"w-full px-3 py-2 bg-purple-950/50 border border-purple-500/30 rounded-lg focus:outline-none focus:border-purple-400 text-white text-sm placeholder-purple-300/50",placeholder:"e.g., 10 for 10%",step:"0.01",min:"0",max:"100"})]}),M.distribution_method==="random_range"&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Min Amount"}),e.jsx("input",{type:"number",value:M.min_amount,onChange:K=>ye(fe,"min_amount",K.target.value),className:"w-full px-3 py-2 bg-purple-950/50 border border-purple-500/30 rounded-lg focus:outline-none focus:border-purple-400 text-white text-sm placeholder-purple-300/50",placeholder:"Min",step:"0.000001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Max Amount"}),e.jsx("input",{type:"number",value:M.max_amount,onChange:K=>ye(fe,"max_amount",K.target.value),className:"w-full px-3 py-2 bg-purple-950/50 border border-purple-500/30 rounded-lg focus:outline-none focus:border-purple-400 text-white text-sm placeholder-purple-300/50",placeholder:"Max",step:"0.000001"})]})]}),M.distribution_method==="token_balance_ratio"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Source Token (for balance ratio)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",value:M.source_token_currency,onChange:K=>ye(fe,"source_token_currency",K.target.value),className:"px-3 py-2 bg-purple-950/50 border border-purple-500/30 rounded-lg focus:outline-none focus:border-purple-400 text-white text-sm placeholder-purple-300/50",placeholder:"Currency"}),e.jsx("input",{type:"text",value:M.source_token_issuer,onChange:K=>ye(fe,"source_token_issuer",K.target.value),className:"px-3 py-2 bg-purple-950/50 border border-purple-500/30 rounded-lg focus:outline-none focus:border-purple-400 text-white text-sm placeholder-purple-300/50",placeholder:"Issuer"})]})]})]},fe))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Recipients"}),E.tokens.length>0&&E.tokens[0].currency_code&&E.tokens[0].issuer_address&&e.jsx("button",{onClick:()=>U(E.tokens[0].currency_code,E.tokens[0].issuer_address),disabled:F,className:"px-3 py-1.5 bg-gradient-to-r from-green-500 to-emerald-500 rounded-lg text-xs font-medium hover:shadow-lg hover:shadow-green-500/50 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:F?"⏳ Fetching...":"🔍 Fetch Token Holders"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[e.jsxs("label",{className:"px-4 py-3 bg-purple-950/50 border border-purple-500/30 rounded-xl cursor-pointer hover:bg-purple-950/70 transition-all text-center text-purple-300 text-sm",children:[e.jsx("input",{type:"file",accept:".csv",onChange:Y,className:"hidden"}),"📁 Import CSV"]}),e.jsx("button",{onClick:()=>G({...E,recipientsList:""}),className:"px-4 py-3 bg-red-500/10 border border-red-500/30 rounded-xl hover:bg-red-500/20 transition-all text-red-300 text-sm",children:"🗑️ Clear All"})]}),e.jsx("textarea",{value:E.recipientsList,onChange:M=>G({...E,recipientsList:M.target.value}),className:"w-full px-4 py-3 bg-purple-950/50 border border-purple-500/30 rounded-xl focus:outline-none focus:border-purple-400 h-32 font-mono text-sm text-white placeholder-purple-300/50",placeholder:`rAddress1
rAddress2
rAddress3`}),e.jsxs("div",{className:"text-sm text-slate-400 mt-2",children:[E.recipientsList.split(`
`).filter(M=>M.trim()).length," recipients"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-500/10 to-red-500/5 border border-orange-500/30 rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-sm font-medium text-orange-300",children:"Fee Estimate"}),e.jsxs("div",{className:"text-3xl font-bold text-white",children:[B()," XRP"]})]}),e.jsxs("div",{className:"text-xs text-orange-400",children:[E.recipientsList.split(`
`).filter(M=>M.trim()).length," recipients × ",E.tokens.filter(M=>M.currency_code&&M.issuer_address).length," tokens × 0.01 XRP per transaction"]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:nt,className:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 rounded-xl font-medium hover:shadow-lg hover:shadow-purple-500/50 transition-all",children:"Create Campaign"}),e.jsx("button",{onClick:()=>ge(!1),className:"px-6 py-3 bg-purple-950/50 rounded-xl font-medium hover:bg-purple-900/50 transition-all border border-purple-500/30",children:"Cancel"})]})]})]})})}),Ce&&J&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4 overflow-y-auto",children:e.jsx("div",{className:"bg-gradient-to-br from-purple-900/95 to-purple-800/95 border border-purple-500/50 rounded-2xl max-w-3xl w-full my-8 shadow-2xl shadow-purple-500/20",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Edit Campaign"}),e.jsx("button",{onClick:()=>{ue(!1),se(null)},className:"text-slate-400 hover:text-white text-2xl",children:"✕"})]}),e.jsxs("div",{className:"space-y-5 max-h-[70vh] overflow-y-auto pr-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-slate-300",children:"Campaign Name"}),e.jsx("input",{type:"text",value:J.name,onChange:M=>se({...J,name:M.target.value}),className:"w-full px-4 py-3 bg-purple-950/50 border border-purple-500/30 rounded-xl focus:outline-none focus:border-purple-400 text-white placeholder-purple-300/50",placeholder:"My Token Airdrop"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-slate-300",children:"Interval Between Recipients (seconds)"}),e.jsx("input",{type:"number",min:"5",value:J.intervalSeconds,onChange:M=>se({...J,intervalSeconds:M.target.value}),className:"w-full px-4 py-3 bg-purple-950/50 border border-purple-500/30 rounded-xl focus:outline-none focus:border-purple-400 text-white"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Tokens to Airdrop"}),e.jsx("button",{onClick:()=>se({...J,tokens:[...J.tokens,{currency_code:"",issuer_address:"",distribution_method:"fixed",amount:"",min_amount:"",max_amount:"",balance_percent:"",source_token_currency:"",source_token_issuer:""}]}),className:"px-4 py-2 bg-purple-500/20 border border-purple-500/30 rounded-xl text-sm hover:bg-purple-500/30 transition-all text-purple-300",children:"+ Add Token"})]}),e.jsx("div",{className:"space-y-4",children:J.tokens.map((M,fe)=>e.jsxs("div",{className:"bg-purple-950/40 rounded-xl p-4 space-y-3 border border-purple-500/30",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm font-medium text-white",children:["Token ",fe+1]}),J.tokens.length>1&&e.jsx("button",{onClick:()=>{const K=J.tokens.filter((v,p)=>p!==fe);se({...J,tokens:K})},className:"text-red-400 hover:text-red-300 text-sm font-medium",children:"Remove"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Select from your wallet tokens"}),e.jsxs("select",{onChange:K=>{const v=b.find(p=>p.value===K.target.value);if(v){const p=[...J.tokens];p[fe].currency_code=v.currency_code,p[fe].issuer_address=v.issuer_address,se({...J,tokens:p})}},className:"w-full px-3 py-2 bg-purple-950/50 border border-purple-500/30 rounded-lg focus:outline-none focus:border-purple-400 text-white text-sm",children:[e.jsx("option",{value:"",children:b.length===0?"Loading your tokens...":"Choose a token..."}),b.map(K=>e.jsx("option",{value:K.value,children:K.label},K.value))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",value:M.currency_code,onChange:K=>{const v=[...J.tokens];v[fe].currency_code=K.target.value,se({...J,tokens:v})},className:"px-3 py-2 bg-purple-950/50 border border-purple-500/30 rounded-lg focus:outline-none focus:border-purple-400 text-white text-sm placeholder-purple-300/50",placeholder:"Currency Code"}),e.jsx("input",{type:"text",value:M.issuer_address,onChange:K=>{const v=[...J.tokens];v[fe].issuer_address=K.target.value,se({...J,tokens:v})},className:"px-3 py-2 bg-purple-950/50 border border-purple-500/30 rounded-lg focus:outline-none focus:border-purple-400 text-white text-sm placeholder-purple-300/50",placeholder:"Issuer Address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Distribution Method"}),e.jsx("select",{value:M.distribution_method,onChange:K=>{const v=[...J.tokens];v[fe].distribution_method=K.target.value,se({...J,tokens:v})},className:"w-full px-3 py-2 bg-purple-950/50 border border-purple-500/30 rounded-lg focus:outline-none focus:border-purple-400 text-white text-sm",children:wa.map(K=>e.jsxs("option",{value:K.id,children:[K.icon," ",K.name]},K.id))})]}),M.distribution_method==="fixed"&&e.jsx("input",{type:"number",value:M.amount,onChange:K=>{const v=[...J.tokens];v[fe].amount=K.target.value,se({...J,tokens:v})},className:"w-full px-3 py-2 bg-purple-950/50 border border-purple-500/30 rounded-lg focus:outline-none focus:border-purple-400 text-white text-sm placeholder-purple-300/50",placeholder:"Amount per recipient",step:"0.000001"}),(M.distribution_method==="wallet_balance_percent"||M.distribution_method==="xrp_balance_percent")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Percentage (%)"}),e.jsx("input",{type:"number",value:M.balance_percent,onChange:K=>{const v=[...J.tokens];v[fe].balance_percent=K.target.value,se({...J,tokens:v})},className:"w-full px-3 py-2 bg-purple-950/50 border border-purple-500/30 rounded-lg focus:outline-none focus:border-purple-400 text-white text-sm placeholder-purple-300/50",placeholder:"e.g., 10 for 10%",step:"0.01",min:"0",max:"100"})]}),M.distribution_method==="random_range"&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Min Amount"}),e.jsx("input",{type:"number",value:M.min_amount,onChange:K=>{const v=[...J.tokens];v[fe].min_amount=K.target.value,se({...J,tokens:v})},className:"w-full px-3 py-2 bg-purple-950/50 border border-purple-500/30 rounded-lg focus:outline-none focus:border-purple-400 text-white text-sm placeholder-purple-300/50",placeholder:"Min",step:"0.000001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Max Amount"}),e.jsx("input",{type:"number",value:M.max_amount,onChange:K=>{const v=[...J.tokens];v[fe].max_amount=K.target.value,se({...J,tokens:v})},className:"w-full px-3 py-2 bg-purple-950/50 border border-purple-500/30 rounded-lg focus:outline-none focus:border-purple-400 text-white text-sm placeholder-purple-300/50",placeholder:"Max",step:"0.000001"})]})]})]},fe))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-slate-300",children:"Recipients (Pending Only)"}),e.jsx("textarea",{value:J.recipientsList,onChange:M=>se({...J,recipientsList:M.target.value}),className:"w-full px-4 py-3 bg-purple-950/50 border border-purple-500/30 rounded-xl focus:outline-none focus:border-purple-400 h-32 font-mono text-sm text-white placeholder-purple-300/50",placeholder:`rAddress1
rAddress2
rAddress3`}),e.jsxs("div",{className:"text-sm text-slate-400 mt-2",children:[J.recipientsList.split(`
`).filter(M=>M.trim()).length," recipients"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-500/10 to-red-500/5 border border-orange-500/30 rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-sm font-medium text-orange-300",children:"Fee Estimate"}),e.jsxs("div",{className:"text-3xl font-bold text-white",children:[(J.recipientsList.split(`
`).filter(M=>M.trim()).length*J.tokens.filter(M=>M.currency_code&&M.issuer_address).length*.01).toFixed(2)," XRP"]})]}),e.jsxs("div",{className:"text-xs text-orange-400",children:[J.recipientsList.split(`
`).filter(M=>M.trim()).length," recipients × ",J.tokens.filter(M=>M.currency_code&&M.issuer_address).length," tokens × 0.01 XRP per transaction"]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:tt,className:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 rounded-xl font-medium hover:shadow-lg hover:shadow-purple-500/50 transition-all",children:"Update Campaign"}),e.jsx("button",{onClick:()=>{ue(!1),se(null)},className:"px-6 py-3 bg-purple-950/50 rounded-xl font-medium hover:bg-purple-900/50 transition-all border border-purple-500/30",children:"Cancel"})]})]})]})})})]}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-white p-6 flex items-center justify-center",children:e.jsxs("div",{className:"bg-purple-900/20 backdrop-blur-xl border border-purple-500/30 rounded-2xl p-8 max-w-md text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"✈️"}),e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Connect Your Wallet"}),e.jsx("p",{className:"text-slate-400",children:"Please connect a wallet to use the Airdropper"})]})})}function Fh(){var W;const[r,t]=m.useState([]),[s,a]=m.useState(null),[n,l]=m.useState([]),[i,o]=m.useState({totalValue:0,totalTokens:0,topHolding:null,diversificationScore:0,portfolioGrowth:0,profitLoss:0}),[c,d]=m.useState(!1),[u,h]=m.useState({totalSupply:0,totalXRPLocked:0,totalMarketCap:0,avgTokensPerPool:0,successRate:0,avgMarketCap:0,tokensByDay:[],tokensByHour:[],topTokens:[],priceDistribution:[],volumeMetrics:{},growthRate:0,avgPoolDepth:0,totalLiquidity:0,avgPriceXRP:0,medianMarketCap:0,tokenVelocity:0,concentrationIndex:0,avgAge:0}),[g,y]=m.useState(2.5);m.useEffect(()=>{_(),w(),f()},[]);const f=async()=>{var D;try{const E=await(await fetch("https://api.coingecko.com/api/v3/simple/price?ids=ripple&vs_currencies=usd")).json();y(((D=E.ripple)==null?void 0:D.usd)||2.5)}catch{y(2.5)}};m.useEffect(()=>{s&&b()},[s,r]);const w=async()=>{const D=localStorage.getItem("connectedWallet");if(D){const E=JSON.parse(D);if(!E.seed&&E.id)try{const{data:G}=await S.from("wallets").select("*").eq("id",E.id).maybeSingle();if(G){const _e={...G,seed:G.encrypted_seed||G.seed};localStorage.setItem("connectedWallet",JSON.stringify(_e)),a(_e);return}}catch{}a(E)}const I=()=>{const E=localStorage.getItem("connectedWallet");E?a(JSON.parse(E)):(a(null),l([]))};return window.addEventListener("walletConnected",I),window.addEventListener("walletDisconnected",I),()=>{window.removeEventListener("walletConnected",I),window.removeEventListener("walletDisconnected",I)}},b=async()=>{var I;if(!s||r.length===0)return;d(!0);const D=new Re.Client("wss://xrplcluster.com");try{await D.connect();const E=await D.request({command:"account_lines",account:s.address,ledger_index:"validated"}),G=[];let _e=0;for(const Ce of E.result.lines){const ue=parseFloat(Ce.balance);if(ue<=0)continue;const J=Ce.currency.length===40?Buffer.from(Ce.currency,"hex").toString("utf8").replace(/\0/g,""):Ce.currency,se=r.find(F=>F.issuer_address===Ce.account&&F.currency_code===J);if(se){const F=A(se),X=ue*F;_e+=X,G.push({token:se,balance:ue,price:F,value:X,percentage:0,isPlatformToken:!0})}else G.push({token:{currency_code:J,issuer_address:Ce.account,token_name:J,image_url:null},balance:ue,price:0,value:0,percentage:0,isPlatformToken:!1})}G.forEach(Ce=>{Ce.percentage=_e>0?Ce.value/_e*100:0}),G.sort((Ce,ue)=>ue.value-Ce.value);const ge=G.length>0?(1-(((I=G[0])==null?void 0:I.percentage)||0)/100)*100:0;l(G),o({totalValue:_e.toFixed(4),totalTokens:G.length,topHolding:G[0]||null,diversificationScore:ge.toFixed(1),portfolioGrowth:0,profitLoss:0}),await D.disconnect()}catch{}finally{d(!1)}},P=D=>{if(!D.amm_pool_created||!D.amm_xrp_amount||!D.amm_asset_amount)return 0;const I=D.amm_xrp_amount/D.amm_asset_amount;return D.supply*I},A=D=>!D.amm_pool_created||!D.amm_xrp_amount||!D.amm_asset_amount?0:D.amm_xrp_amount/D.amm_asset_amount,_=async()=>{d(!0);try{const{data:D,error:I}=await S.from("meme_tokens").select("*").order("created_at",{ascending:!1});if(I)throw I;const E=D||[],{data:G}=await S.from("pool_data_cache").select("*").gte("last_updated",new Date(Date.now()-6e4).toISOString());G&&E.forEach($=>{const be=G.find(We=>We.token_id===$.id);be&&($.amm_xrp_amount=parseFloat(be.xrp_amount),$.amm_asset_amount=parseFloat(be.token_amount),$.current_price=parseFloat(be.price))}),t(E);const _e=E.reduce(($,be)=>$+be.supply,0),ge=E.reduce(($,be)=>$+(be.amm_xrp_amount||0),0),Ce=E.reduce(($,be)=>$+P(be),0),ue=E.filter($=>$.amm_pool_created),J=ue.length>0?ue.reduce(($,be)=>$+be.amm_asset_amount,0)/ue.length:0,se=E.length>0?Ce/E.length:0,F={},X={};E.forEach($=>{const be=new Date($.created_at).toLocaleDateString(),We=new Date($.created_at).getHours();F[be]=(F[be]||0)+1,X[We]=(X[We]||0)+1});const me=[...E].filter($=>$.amm_pool_created).sort(($,be)=>P(be)-P($)).slice(0,10),ve={micro:0,low:0,medium:0,high:0};E.forEach($=>{const be=A($);be===0||be<1e-5?ve.micro++:be<1e-4?ve.low++:be<.001?ve.medium++:ve.high++});const{data:He}=await S.from("trade_history").select("*").order("created_at",{ascending:!1}).limit(1e3),pe=Date.now(),xe=E.filter($=>pe-new Date($.created_at).getTime()<864e5),le=E.filter($=>pe-new Date($.created_at).getTime()<6048e5),$e=E.filter($=>pe-new Date($.created_at).getTime()<36e5),Ne=(He||[]).filter($=>pe-new Date($.created_at).getTime()<864e5),q=Ne.reduce(($,be)=>$+parseFloat(be.xrp_amount||0),0),ee=new Set((He||[]).map($=>$.wallet_address)).size,L=E.length>1?xe.length/E.length*100:0,re=ue.length>0?ue.reduce(($,be)=>$+(be.amm_xrp_amount||0),0)/ue.length:0,B=ue.reduce(($,be)=>$+(be.amm_xrp_amount||0)+(be.amm_asset_amount||0)*A(be),0),Y=E.map($=>A($)).filter($=>$>0),oe=Y.length>0?Y.reduce(($,be)=>$+be,0)/Y.length:0,ie=E.map($=>P($)).filter($=>$>0).sort(($,be)=>$-be),ye=ie.length>0?ie[Math.floor(ie.length/2)]:0,te=E.length>0?E.reduce(($,be)=>$+(Date.now()-new Date(be.created_at).getTime()),0)/E.length/(1e3*60*60):0,U=E.length>0?xe.length/24:0,ke=$e.length,he=ie.slice(-10).reduce(($,be)=>$+be,0),Oe=Ce>0?he/Ce*100:0;h({totalSupply:_e,totalXRPLocked:ge,totalMarketCap:Ce,avgTokensPerPool:J,successRate:E.length>0?ue.length/E.length*100:0,avgMarketCap:se,tokensByDay:Object.entries(F).map(([$,be])=>({date:$,count:be})),tokensByHour:Object.entries(X).map(([$,be])=>({hour:parseInt($),count:be})),topTokens:me,priceDistribution:[{range:"Micro (<0.00001)",count:ve.micro},{range:"Low (0.00001-0.0001)",count:ve.low},{range:"Medium (0.0001-0.001)",count:ve.medium},{range:"High (>0.001)",count:ve.high}],volumeMetrics:{last24h:xe.length,last7d:le.length,allTime:E.length,trades24h:Ne.length,volume24hXRP:q,uniqueTraders:ee},tokenVelocityHourly:ke,growthRate:L,avgPoolDepth:re,totalLiquidity:B,avgPriceXRP:oe,medianMarketCap:ye,tokenVelocity:U,concentrationIndex:Oe,avgAge:te})}catch{}finally{d(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-purple-200",children:"Advanced Analytics"}),e.jsx("p",{className:"text-purple-400 mt-1",children:"Live XRPL data - Comprehensive metrics and performance"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:_,disabled:c,className:"btn-secondary px-4 py-2 disabled:opacity-50 flex items-center gap-2",children:c?"🔄 Loading...":"🔄 Refresh"}),s&&e.jsxs("div",{className:"flex items-center gap-2 glass px-4 py-2 rounded-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-purple-300 text-sm font-medium",children:s.name})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"glass rounded-lg p-4 border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"Total Supply"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[(u.totalSupply/1e6).toFixed(1),"M"]}),e.jsx("div",{className:"text-purple-500 text-xs mt-1",children:"Across all tokens"})]}),e.jsxs("div",{className:"glass rounded-lg p-4 border border-green-500/30",children:[e.jsx("div",{className:"text-green-400 text-xs mb-1",children:"XRP Locked"}),e.jsx("div",{className:"text-2xl font-bold text-green-200",children:u.totalXRPLocked.toFixed(2)}),e.jsx("div",{className:"text-green-500 text-xs mt-1",children:"In AMM pools"})]}),e.jsxs("div",{className:"glass rounded-lg p-4 border border-blue-500/30",children:[e.jsx("div",{className:"text-blue-400 text-xs mb-1",children:"Market Cap"}),e.jsx("div",{className:"text-2xl font-bold text-blue-200",children:u.totalMarketCap.toFixed(2)}),e.jsx("div",{className:"text-blue-500 text-xs mt-1",children:"XRP value"})]}),e.jsxs("div",{className:"glass rounded-lg p-4 border border-cyan-500/30",children:[e.jsx("div",{className:"text-cyan-400 text-xs mb-1",children:"24h Volume"}),e.jsx("div",{className:"text-2xl font-bold text-cyan-200",children:((W=u.volumeMetrics.volume24hXRP)==null?void 0:W.toFixed(2))||0}),e.jsxs("div",{className:"text-cyan-500 text-xs mt-1",children:[u.volumeMetrics.trades24h||0," trades"]})]}),e.jsxs("div",{className:"glass rounded-lg p-4 border border-yellow-500/30",children:[e.jsx("div",{className:"text-yellow-400 text-xs mb-1",children:"Active Traders"}),e.jsx("div",{className:"text-2xl font-bold text-yellow-200",children:u.volumeMetrics.uniqueTraders||0}),e.jsx("div",{className:"text-yellow-500 text-xs mt-1",children:"Unique wallets"})]}),e.jsxs("div",{className:"glass rounded-lg p-4 border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"24h Growth"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[u.growthRate.toFixed(1),"%"]}),e.jsx("div",{className:"text-purple-500 text-xs mt-1",children:"Token creation"})]}),e.jsxs("div",{className:"glass rounded-lg p-4 border border-green-500/30",children:[e.jsx("div",{className:"text-green-400 text-xs mb-1",children:"Avg Pool"}),e.jsxs("div",{className:"text-2xl font-bold text-green-200",children:[(u.avgTokensPerPool/1e3).toFixed(0),"K"]}),e.jsx("div",{className:"text-green-500 text-xs mt-1",children:"Tokens per AMM"})]}),e.jsxs("div",{className:"glass rounded-lg p-4 border border-blue-500/30",children:[e.jsx("div",{className:"text-blue-400 text-xs mb-1",children:"Success Rate"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-200",children:[u.successRate.toFixed(0),"%"]}),e.jsx("div",{className:"text-blue-500 text-xs mt-1",children:"AMM creation"})]}),e.jsxs("div",{className:"glass rounded-lg p-4 border border-cyan-500/30",children:[e.jsx("div",{className:"text-cyan-400 text-xs mb-1",children:"Active Pools"}),e.jsx("div",{className:"text-2xl font-bold text-cyan-200",children:r.filter(D=>D.amm_pool_created).length}),e.jsx("div",{className:"text-cyan-500 text-xs mt-1",children:"Live trading"})]}),e.jsxs("div",{className:"glass rounded-lg p-4 border border-yellow-500/30",children:[e.jsx("div",{className:"text-yellow-400 text-xs mb-1",children:"Velocity"}),e.jsx("div",{className:"text-2xl font-bold text-yellow-200",children:u.tokenVelocityHourly||0}),e.jsx("div",{className:"text-yellow-500 text-xs mt-1",children:"Tokens/hour"})]})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-6",children:"🔬 Advanced Metrics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"p-4 bg-purple-900/20 rounded-lg",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Avg Pool Depth"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[u.avgPoolDepth.toFixed(4)," XRP"]}),e.jsx("div",{className:"text-purple-500 text-xs mt-1",children:"Per active pool (Live)"})]}),e.jsxs("div",{className:"p-4 bg-purple-900/20 rounded-lg",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Total Liquidity"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[u.totalLiquidity.toFixed(2)," XRP"]}),e.jsx("div",{className:"text-purple-500 text-xs mt-1",children:"Combined value (Live)"})]}),e.jsxs("div",{className:"p-4 bg-purple-900/20 rounded-lg",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Avg Price"}),e.jsx("div",{className:"text-2xl font-bold text-purple-200",children:u.avgPriceXRP.toFixed(8)}),e.jsx("div",{className:"text-purple-500 text-xs mt-1",children:"XRP per token (Live)"})]}),e.jsxs("div",{className:"p-4 bg-purple-900/20 rounded-lg",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Median Market Cap"}),e.jsx("div",{className:"text-2xl font-bold text-purple-200",children:u.medianMarketCap.toFixed(4)}),e.jsx("div",{className:"text-purple-500 text-xs mt-1",children:"XRP value"})]}),e.jsxs("div",{className:"p-4 bg-purple-900/20 rounded-lg",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Token Velocity"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[u.tokenVelocity.toFixed(2),"/hr"]}),e.jsx("div",{className:"text-purple-500 text-xs mt-1",children:"Creation rate"})]}),e.jsxs("div",{className:"p-4 bg-purple-900/20 rounded-lg",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Market Concentration"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[u.concentrationIndex.toFixed(1),"%"]}),e.jsx("div",{className:"text-purple-500 text-xs mt-1",children:"Top 10 dominance"})]}),e.jsxs("div",{className:"p-4 bg-purple-900/20 rounded-lg",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Avg Token Age"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[u.avgAge.toFixed(1),"h"]}),e.jsx("div",{className:"text-purple-500 text-xs mt-1",children:"Since creation"})]}),e.jsxs("div",{className:"p-4 bg-purple-900/20 rounded-lg",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Market Efficiency"}),e.jsx("div",{className:"text-2xl font-bold text-purple-200",children:u.avgPoolDepth>0?(u.totalXRPLocked/u.avgPoolDepth*10).toFixed(1):0}),e.jsx("div",{className:"text-purple-500 text-xs mt-1",children:"Liquidity score"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"Top 10 by Market Cap (Live XRPL Data)"}),e.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:[u.topTokens.map((D,I)=>{const E=P(D),G=A(D);return e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-purple-900/20 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-500",children:["#",I+1]}),e.jsx(Ft,{token:D,size:"sm"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-purple-200",children:D.token_name}),e.jsxs("div",{className:"text-sm text-purple-400",children:["Price: ",G.toFixed(8)," XRP (Live)"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold text-purple-200",children:[E.toFixed(4)," XRP"]}),e.jsx("div",{className:"text-xs text-purple-400",children:"Market Cap"})]})]},D.id)}),u.topTokens.length===0&&e.jsx("div",{className:"text-center py-8 text-purple-400",children:"No tokens with AMM pools yet"})]})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"Volume Metrics"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-purple-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-purple-300",children:"Last 24 Hours"}),e.jsx("span",{className:"text-2xl font-bold text-purple-200",children:u.volumeMetrics.last24h})]}),e.jsx("div",{className:"text-sm text-purple-400",children:"Tokens created"})]}),e.jsxs("div",{className:"p-4 bg-purple-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-purple-300",children:"Last 7 Days"}),e.jsx("span",{className:"text-2xl font-bold text-purple-200",children:u.volumeMetrics.last7d})]}),e.jsx("div",{className:"text-sm text-purple-400",children:"Tokens created"})]}),e.jsxs("div",{className:"p-4 bg-purple-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-purple-300",children:"All Time"}),e.jsx("span",{className:"text-2xl font-bold text-purple-200",children:u.volumeMetrics.allTime})]}),e.jsx("div",{className:"text-sm text-purple-400",children:"Total tokens"})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-purple-500/10 border border-purple-500/30 rounded-lg",children:[e.jsx("h4",{className:"text-purple-200 font-bold mb-2",children:"Growth Insights"}),e.jsx("div",{className:"text-purple-300 text-sm",children:u.volumeMetrics.last24h>0?`${u.volumeMetrics.last24h} token${u.volumeMetrics.last24h!==1?"s":""} created in the last 24 hours`:"No tokens created in the last 24 hours"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"Creation Timeline (Last 7 Days)"}),e.jsxs("div",{className:"space-y-3",children:[u.tokensByDay.slice(0,7).map((D,I)=>{const E=Math.max(...u.tokensByDay.map(G=>G.count),1);return e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-sm text-purple-400 w-28",children:D.date}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"bg-purple-900/30 rounded-full h-8 overflow-hidden",children:e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-purple-500 h-full flex items-center px-3 text-white text-sm font-medium",style:{width:`${D.count/E*100}%`,minWidth:"60px"},children:[D.count," token",D.count!==1?"s":""]})})})]},I)}),u.tokensByDay.length===0&&e.jsx("div",{className:"text-center py-8 text-purple-400",children:"No data available yet"})]})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"Hourly Heatmap"}),e.jsx("div",{className:"grid grid-cols-6 gap-2",children:Array.from({length:24},(D,I)=>{const E=u.tokensByHour.find(Ce=>Ce.hour===I),G=E?E.count:0,_e=Math.max(...u.tokensByHour.map(Ce=>Ce.count),1),ge=G>0?G/_e:0;return e.jsxs("div",{className:"p-2 rounded text-center text-xs",style:{backgroundColor:`rgba(139, 92, 246, ${.1+ge*.6})`,border:"1px solid rgba(139, 92, 246, 0.3)"},title:`${I}:00 - ${G} tokens`,children:[e.jsx("div",{className:"text-purple-300 font-bold",children:I}),e.jsx("div",{className:"text-purple-400",children:G})]},I)})}),e.jsx("div",{className:"text-purple-400 text-xs mt-3 text-center",children:"Hour of day (0-23) - Click to see counts"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"Price Distribution"}),e.jsx("div",{className:"space-y-3",children:u.priceDistribution.map((D,I)=>{const E=r.length||1,G=D.count/E*100;return e.jsxs("div",{className:"p-3 bg-purple-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-purple-300 text-sm",children:D.range}),e.jsx("span",{className:"text-lg font-bold text-purple-200",children:D.count})]}),e.jsx("div",{className:"bg-purple-900/30 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-purple-500 h-full",style:{width:`${G}%`}})}),e.jsxs("div",{className:"text-xs text-purple-400 mt-1",children:[G.toFixed(1),"%"]})]},I)})})]}),e.jsxs("div",{className:"glass rounded-lg p-6 lg:col-span-2",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"Status Distribution"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-6 bg-green-500/10 rounded-lg border border-green-500/30",children:[e.jsx("div",{className:"text-4xl mb-2",children:"✓"}),e.jsx("div",{className:"text-3xl font-bold text-green-400",children:r.filter(D=>D.amm_pool_created).length}),e.jsx("div",{className:"text-green-300 text-sm mt-2",children:"AMM Created"}),e.jsxs("div",{className:"text-green-400/60 text-xs mt-1",children:[r.length>0?(r.filter(D=>D.amm_pool_created).length/r.length*100).toFixed(1):0,"%"]})]}),e.jsxs("div",{className:"text-center p-6 bg-yellow-500/10 rounded-lg border border-yellow-500/30",children:[e.jsx("div",{className:"text-4xl mb-2",children:"⏳"}),e.jsx("div",{className:"text-3xl font-bold text-yellow-400",children:r.filter(D=>!D.amm_pool_created&&D.status!=="manual").length}),e.jsx("div",{className:"text-yellow-300 text-sm mt-2",children:"Pending"}),e.jsx("div",{className:"text-yellow-400/60 text-xs mt-1",children:"Awaiting AMM"})]}),e.jsxs("div",{className:"text-center p-6 bg-blue-500/10 rounded-lg border border-blue-500/30",children:[e.jsx("div",{className:"text-4xl mb-2",children:"📊"}),e.jsx("div",{className:"text-3xl font-bold text-blue-400",children:r.filter(D=>D.status==="manual").length}),e.jsx("div",{className:"text-blue-300 text-sm mt-2",children:"Manual"}),e.jsx("div",{className:"text-blue-400/60 text-xs mt-1",children:"Added manually"})]})]})]})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"Complete Token Analytics Table (Live XRPL Data)"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-purple-900/30",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"#"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Token"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Supply"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Price (XRP)"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Market Cap"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Liquidity"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Ratio"}),e.jsx("th",{className:"text-left px-4 py-3 text-purple-300 font-medium",children:"Age"})]})}),e.jsx("tbody",{children:r.map((D,I)=>{var Ce;const E=Math.floor((Date.now()-new Date(D.created_at))/36e5),G=A(D),_e=P(D),ge=D.amm_pool_created&&D.amm_xrp_amount?(D.amm_asset_amount/D.amm_xrp_amount).toFixed(0):"N/A";return e.jsxs("tr",{className:"border-t border-purple-500/20 hover:bg-purple-900/20",children:[e.jsxs("td",{className:"px-4 py-3 text-purple-400 font-bold",children:["#",I+1]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ft,{token:D,size:"sm",className:"!w-6 !h-6 !text-xs"}),e.jsx("span",{className:"font-bold text-purple-200",children:D.token_name})]})}),e.jsx("td",{className:"px-4 py-3 text-purple-300",children:D.supply.toLocaleString()}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsxs("div",{className:"text-purple-200 font-mono text-sm",children:[G.toFixed(8)," XRP"]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(G*g).toFixed(6)]})]}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsxs("div",{className:"text-purple-200 font-bold",children:[_e.toFixed(4)," XRP"]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(_e*g).toFixed(2)]})]}),e.jsx("td",{className:"px-4 py-3",children:D.amm_pool_created?e.jsxs("div",{children:[e.jsxs("div",{className:"text-purple-300",children:[((Ce=D.amm_xrp_amount)==null?void 0:Ce.toFixed(2))||"0.00"," XRP"]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",((D.amm_xrp_amount||0)*g).toFixed(2)]})]}):"-"}),e.jsx("td",{className:"px-4 py-3 text-purple-400",children:ge}),e.jsxs("td",{className:"px-4 py-3 text-purple-400 text-sm",children:[E,"h ago"]})]},D.id)})})]})})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-6",children:"AMM Pool Comparisons (Live XRPL Data)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"Active AMM Pools"}),e.jsx("div",{className:"text-2xl font-bold text-purple-200",children:r.filter(D=>D.amm_pool_created).length})]}),e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"Total Liquidity"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[u.totalLiquidity.toFixed(2)," XRP"]}),e.jsxs("div",{className:"text-green-400 text-sm",children:["$",(u.totalLiquidity*g).toFixed(2)]})]}),e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"Avg Pool Depth"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[u.avgPoolDepth.toFixed(2)," XRP"]}),e.jsxs("div",{className:"text-green-400 text-sm",children:["$",(u.avgPoolDepth*g).toFixed(2)]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-purple-900/30",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-purple-300",children:"Token"}),e.jsx("th",{className:"text-right px-4 py-3 text-purple-300",children:"XRP Locked"}),e.jsx("th",{className:"text-right px-4 py-3 text-purple-300",children:"Token Amount"}),e.jsx("th",{className:"text-right px-4 py-3 text-purple-300",children:"Price Impact"}),e.jsx("th",{className:"text-right px-4 py-3 text-purple-300",children:"Pool Share"})]})}),e.jsx("tbody",{children:r.filter(D=>D.amm_pool_created).map((D,I)=>{var _e,ge;const E=u.totalXRPLocked>0?(D.amm_xrp_amount/u.totalXRPLocked*100).toFixed(2):0,G=D.amm_xrp_amount>0?(1/D.amm_xrp_amount*100).toFixed(4):0;return e.jsxs("tr",{className:"border-t border-purple-500/20 hover:bg-purple-900/20",children:[e.jsx("td",{className:"px-4 py-3 text-purple-200 font-bold",children:D.token_name}),e.jsxs("td",{className:"px-4 py-3 text-right",children:[e.jsxs("div",{className:"text-purple-200",children:[((_e=D.amm_xrp_amount)==null?void 0:_e.toFixed(2))||"0.00"," XRP"]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",((D.amm_xrp_amount||0)*g).toFixed(2)]})]}),e.jsx("td",{className:"px-4 py-3 text-right text-purple-300",children:((ge=D.amm_asset_amount)==null?void 0:ge.toLocaleString())||"0"}),e.jsxs("td",{className:"px-4 py-3 text-right text-purple-400",children:[G,"% per XRP"]}),e.jsxs("td",{className:"px-4 py-3 text-right text-purple-200 font-bold",children:[E,"%"]})]},D.id)})})]})})]})]})}function Ih({tokens:r,topTokens:t,category:s}){const[a,n]=m.useState(null);m.useEffect(()=>{r.length>0&&t.length>0&&c()},[r,t,s]);const l=h=>h.live_price?h.live_price:!h.amm_pool_created||!h.amm_xrp_amount||!h.amm_asset_amount?0:h.amm_xrp_amount/h.amm_asset_amount,i=h=>{const g=l(h);if(!g||!h.initial_xrp_amount||!h.initial_asset_amount)return 0;const y=h.initial_xrp_amount/h.initial_asset_amount;return!y||y===0?0:(g-y)/y*100},o=h=>{const g=l(h);return g?h.supply*g:0},c=()=>{const h=t[0];if(!h)return;const g=l(h),y=i(h),f=o(h),w=h.amm_xrp_amount||0,b=h.volume_24h||0,P=h.trade_count_24h||0,A=r.reduce((F,X)=>F+(X.amm_xrp_amount||0),0)/r.length,_=r.reduce((F,X)=>F+(X.volume_24h||0),0)/r.length,W=r.reduce((F,X)=>F+i(X),0)/r.length,D=w>A?w/A:A/w,I=b>_?b/_:.5,E=Math.abs(y)>Math.abs(W)?1.5:1,G=P>10?1.2:P>5?1:.8,_e=(D*.3+I*.25+E*.25+G*.2).toFixed(2);let ge="",Ce=[],ue="Medium",J="Moderate";s==="price-gainers"?y>50&&w>A*2?(ge="Strong Buy - High Momentum with Good Liquidity",Ce=[`Exceptional 24h gain of ${y.toFixed(2)}% indicates strong buying pressure`,`Above-average liquidity of ${w.toFixed(2)} XRP provides stability`,`${P} trades in 24h shows active market participation`,`Market cap of ${f.toFixed(2)} XRP suggests solid foundation`],ue="Medium-High",J="High"):y>20&&w>A?(ge="Moderate Buy - Good Opportunity",Ce=[`Solid 24h gain of ${y.toFixed(2)}% shows positive momentum`,`Adequate liquidity of ${w.toFixed(2)} XRP reduces slippage risk`,`Trading activity with ${P} trades indicates interest`,"Consider taking partial position to test market reaction"],ue="Medium",J="Moderate"):(ge="Cautious - Monitor Before Entry",Ce=[`Modest gain of ${y.toFixed(2)}% may indicate limited momentum`,`Liquidity of ${w.toFixed(2)} XRP requires careful position sizing`,`Only ${P} trades suggests lower market activity`,"Wait for volume confirmation or better entry point"],ue="Medium-High",J="Low"):s==="volume-high"?b>_*3&&w>A?(ge="Active Trading Opportunity - High Volume",Ce=[`Exceptional 24h volume of ${b.toFixed(2)} XRP shows high activity`,`${P} trades confirm strong market participation`,`Good liquidity of ${w.toFixed(2)} XRP supports larger trades`,`Price at ${g.toFixed(8)} XRP with ${y.toFixed(2)}% change`],ue="Medium",J="High"):(ge="Monitor - Volume Leader",Ce=[`Leading volume of ${b.toFixed(2)} XRP indicates interest`,`${P} trades in 24h period`,`Liquidity at ${w.toFixed(2)} XRP`,"Evaluate price action before entering position"],ue="Medium",J="Moderate"):s==="value-high"&&(ge="Established Token - Lower Risk",Ce=[`High trading value of ${(h.value_24h||0).toFixed(2)} XRP shows trust`,`Strong liquidity pool of ${w.toFixed(2)} XRP`,`${P} trades demonstrate active market`,`Market cap of ${f.toFixed(2)} XRP indicates maturity`],ue="Low-Medium",J="High");const se={topToken:{name:h.token_name,code:h.currency_code,price:g,change:y,marketCap:f,liquidity:w,volume:b,tradeCount:P},market:{avgLiquidity:A,avgVolume:_,avgChange:W,totalTokens:r.length,activeTokens:r.filter(F=>(F.volume_24h||0)>0).length},scores:{overall:_e,liquidity:D.toFixed(2),volume:I.toFixed(2),momentum:E.toFixed(2),tradeActivity:G.toFixed(2)},recommendation:ge,reasoning:Ce,riskLevel:ue,confidence:J};n(se)};if(!a)return e.jsx("div",{className:"glass rounded-lg p-6 mb-6",children:e.jsx("div",{className:"text-center text-purple-400",children:"Analyzing market data..."})});const d=h=>h.includes("Low")?"text-green-400":h.includes("High")?"text-red-400":"text-yellow-400",u=h=>h==="High"?"text-green-400":h==="Low"?"text-red-400":"text-yellow-400";return e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"glass rounded-lg p-6 border-l-4 border-purple-500",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-1",children:"Daily Market Insights"}),e.jsx("p",{className:"text-purple-400 text-sm",children:"AI-powered analysis of today's top performing token"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-purple-400 mb-1",children:"Overall Score"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[a.scores.overall,"/10"]})]})]}),e.jsxs("div",{className:"bg-purple-900/30 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"text-3xl",children:"🎯"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-purple-200",children:a.topToken.name}),e.jsx("div",{className:"text-sm text-purple-400",children:a.topToken.code})]}),e.jsxs("div",{className:"ml-auto text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-purple-200",children:[a.topToken.price.toFixed(8)," XRP"]}),e.jsxs("div",{className:`text-sm font-medium ${a.topToken.change>=0?"text-green-400":"text-red-400"}`,children:[a.topToken.change>=0?"+":"",a.topToken.change.toFixed(2),"% 24h"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{className:"bg-purple-800/30 rounded p-2",children:[e.jsx("div",{className:"text-purple-400 text-xs",children:"Market Cap"}),e.jsxs("div",{className:"text-purple-200 font-bold",children:[a.topToken.marketCap.toFixed(2)," XRP"]})]}),e.jsxs("div",{className:"bg-purple-800/30 rounded p-2",children:[e.jsx("div",{className:"text-purple-400 text-xs",children:"Liquidity"}),e.jsxs("div",{className:"text-purple-200 font-bold",children:[a.topToken.liquidity.toFixed(2)," XRP"]})]}),e.jsxs("div",{className:"bg-purple-800/30 rounded p-2",children:[e.jsx("div",{className:"text-purple-400 text-xs",children:"24h Volume"}),e.jsxs("div",{className:"text-purple-200 font-bold",children:[a.topToken.volume.toFixed(2)," XRP"]})]}),e.jsxs("div",{className:"bg-purple-800/30 rounded p-2",children:[e.jsx("div",{className:"text-purple-400 text-xs",children:"24h Trades"}),e.jsx("div",{className:"text-purple-200 font-bold",children:a.topToken.tradeCount})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:"text-2xl",children:"💡"}),e.jsx("h4",{className:"text-lg font-bold text-purple-200",children:"Recommendation"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-900/50 to-blue-900/50 border border-purple-500/30 rounded-lg p-4",children:[e.jsx("div",{className:"text-lg font-bold text-purple-100 mb-2",children:a.recommendation}),e.jsxs("div",{className:"flex gap-4 text-sm mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-purple-400",children:"Risk Level: "}),e.jsx("span",{className:`font-bold ${d(a.riskLevel)}`,children:a.riskLevel})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-purple-400",children:"Confidence: "}),e.jsx("span",{className:`font-bold ${u(a.confidence)}`,children:a.confidence})]})]}),e.jsx("div",{className:"space-y-2",children:a.reasoning.map((h,g)=>e.jsxs("div",{className:"flex items-start gap-2 text-purple-200",children:[e.jsx("span",{className:"text-purple-400 mt-1",children:"•"}),e.jsx("span",{className:"text-sm",children:h})]},g))})]})]}),e.jsxs("div",{className:"border-t border-purple-500/20 pt-4",children:[e.jsx("h4",{className:"text-sm font-bold text-purple-300 mb-3",children:"Performance Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-purple-400 mb-1",children:"Liquidity Score"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-purple-900/50 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-pink-500 h-2 rounded-full transition-all",style:{width:`${Math.min(parseFloat(a.scores.liquidity)*10,100)}%`}})}),e.jsx("span",{className:"text-xs text-purple-200 font-bold",children:a.scores.liquidity})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-purple-400 mb-1",children:"Volume Score"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-purple-900/50 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-cyan-500 h-2 rounded-full transition-all",style:{width:`${Math.min(parseFloat(a.scores.volume)*10,100)}%`}})}),e.jsx("span",{className:"text-xs text-purple-200 font-bold",children:a.scores.volume})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-purple-400 mb-1",children:"Momentum"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-purple-900/50 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-emerald-500 h-2 rounded-full transition-all",style:{width:`${Math.min(parseFloat(a.scores.momentum)*10,100)}%`}})}),e.jsx("span",{className:"text-xs text-purple-200 font-bold",children:a.scores.momentum})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-purple-400 mb-1",children:"Trade Activity"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-purple-900/50 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-yellow-500 to-orange-500 h-2 rounded-full transition-all",style:{width:`${Math.min(parseFloat(a.scores.tradeActivity)*10,100)}%`}})}),e.jsx("span",{className:"text-xs text-purple-200 font-bold",children:a.scores.tradeActivity})]})]})]})]}),e.jsx("div",{className:"mt-4 bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-yellow-400 text-lg",children:"⚠️"}),e.jsxs("div",{className:"text-xs text-yellow-200",children:[e.jsx("strong",{children:"Disclaimer:"})," This analysis is for informational purposes only. Always conduct your own research and never invest more than you can afford to lose. Past performance does not guarantee future results."]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Market Average"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-300",children:"Liquidity:"}),e.jsxs("span",{className:"text-purple-200 font-bold",children:[a.market.avgLiquidity.toFixed(2)," XRP"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-300",children:"Volume:"}),e.jsxs("span",{className:"text-purple-200 font-bold",children:[a.market.avgVolume.toFixed(2)," XRP"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-300",children:"24h Change:"}),e.jsxs("span",{className:`font-bold ${a.market.avgChange>=0?"text-green-400":"text-red-400"}`,children:[a.market.avgChange>=0?"+":"",a.market.avgChange.toFixed(2),"%"]})]})]})]}),e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Market Activity"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-300",children:"Total Tokens:"}),e.jsx("span",{className:"text-purple-200 font-bold",children:a.market.totalTokens})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-300",children:"Active (24h):"}),e.jsx("span",{className:"text-purple-200 font-bold",children:a.market.activeTokens})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-300",children:"Activity Rate:"}),e.jsxs("span",{className:"text-purple-200 font-bold",children:[(a.market.activeTokens/a.market.totalTokens*100).toFixed(1),"%"]})]})]})]}),e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Data Freshness"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-purple-200",children:"Live Data"})]}),e.jsx("div",{className:"text-purple-300 text-xs",children:"Updated from XRPL network with 30s cache"}),e.jsx("div",{className:"text-purple-300 text-xs",children:"Trade counts from verified transactions"})]})]})]})]})}function Lh(){const[r,t]=m.useState([]),[s,a]=m.useState(!1),[n,l]=m.useState("price-gainers"),[i,o]=m.useState(null);m.useEffect(()=>{P()},[]);const c=async F=>{try{const X=new Date(Date.now()-864e5).toISOString(),{count:me,error:ve}=await S.from("trade_history").select("*",{count:"exact",head:!0}).eq("token_id",F).gte("created_at",X);return ve?0:me||0}catch{return 0}},d=async F=>{try{const X=new Date(Date.now()-864e5).toISOString(),{data:me,error:ve}=await S.from("trade_history").select("token_amount, xrp_amount").eq("token_id",F).gte("created_at",X);if(ve||!me)return{volume:0,value:0};const He=me.reduce((xe,le)=>xe+parseFloat(le.token_amount||0),0),pe=me.reduce((xe,le)=>xe+parseFloat(le.xrp_amount||0),0);return{volume:He,value:pe}}catch{return{volume:0,value:0}}},u=F=>F.live_price?F.live_price:!F.amm_pool_created||!F.amm_xrp_amount||!F.amm_asset_amount?0:F.amm_xrp_amount/F.amm_asset_amount,h=F=>{const X=u(F);return X?F.supply*X:0},g=F=>{const X=u(F);if(!X||!F.initial_xrp_amount||!F.initial_asset_amount)return 0;const me=F.initial_xrp_amount/F.initial_asset_amount;return!me||me===0?0:(X-me)/me*100},y=F=>!F.amm_xrp_amount||F.amm_xrp_amount===0?0:(F.value_24h||0)/F.amm_xrp_amount*100,f=F=>{const X=r.reduce((me,ve)=>me+h(ve),0);return X===0?0:h(F)/X*100},w=F=>!F.amm_xrp_amount||!F.amm_asset_amount?0:Math.sqrt(F.amm_xrp_amount*F.amm_asset_amount),b=(F,X=1)=>F.amm_xrp_amount?X/F.amm_xrp_amount*100:0,P=async(F=!1)=>{var X;a(!0);try{const{data:ve,error:He}=await S.from("pool_data_cache").select("*").gte("last_updated",new Date(Date.now()-3e5).toISOString()),{data:pe,error:xe}=await S.from("meme_tokens").select("*").eq("amm_pool_created",!0).order("created_at",{ascending:!1});if(xe)throw xe;const le=pe||[];if(!F&&ve&&ve.length>0&&!He){const Ne={};ve.forEach(q=>{Ne[q.token_id]=q});for(const q of le){const ee=Ne[q.id];ee&&(q.amm_xrp_amount=parseFloat(ee.xrp_amount),q.amm_asset_amount=parseFloat(ee.token_amount),q.live_price=parseFloat(ee.price),q.volume_24h=parseFloat(ee.volume_24h||0),q.value_24h=parseFloat(ee.volume_24h||0)*parseFloat(ee.price||0),q.trade_count_24h=await c(q.id))}t(le),a(!1);return}const{requestWithRetry:$e}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0);for(const Ne of le)try{const q=Ne.currency_code.length>3?vt.Buffer.from(Ne.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):Ne.currency_code,ee=await $e({command:"amm_info",asset:{currency:"XRP"},asset2:{currency:q,issuer:Ne.issuer_address},ledger_index:"validated"});if(ee.result.amm){const L=ee.result.amm,re=parseFloat(L.amount)/1e6,B=parseFloat(L.amount2.value),Y=re/B;Ne.amm_xrp_amount=re,Ne.amm_asset_amount=B,Ne.live_price=Y;const oe=await c(Ne.id),ie=await d(Ne.id);Ne.volume_24h=ie.volume||0,Ne.value_24h=ie.value||0,Ne.trade_count_24h=oe,await S.from("pool_data_cache").upsert({token_id:Ne.id,xrp_amount:re,token_amount:B,lp_tokens:parseFloat(((X=L.lp_token)==null?void 0:X.value)||0),price:Y,account_id:L.account,volume_24h:Ne.volume_24h||0,price_change_24h:g(Ne),last_updated:new Date().toISOString()},{onConflict:"token_id"})}}catch{}t(le)}catch{}finally{a(!1)}},_=(F=>{let X=[...r];switch(F){case"price-gainers":X=X.sort((me,ve)=>g(ve)-g(me)).slice(0,10);break;case"price-losers":X=X.sort((me,ve)=>g(me)-g(ve)).slice(0,10);break;case"volume-high":X=X.sort((me,ve)=>(ve.volume_24h||0)-(me.volume_24h||0)).slice(0,10);break;case"volume-low":X=X.sort((me,ve)=>(me.volume_24h||0)-(ve.volume_24h||0)).slice(0,10);break;case"value-high":X=X.sort((me,ve)=>(ve.value_24h||0)-(me.value_24h||0)).slice(0,10);break;case"value-low":X=X.sort((me,ve)=>(me.value_24h||0)-(ve.value_24h||0)).slice(0,10);break;default:X=X.slice(0,10)}return X})(n),W=()=>({"price-gainers":"Top 10 Gainers (24h Price Change)","price-losers":"Top 10 Losers (24h Price Change)","volume-high":"Top 10 by Volume (Highest)","volume-low":"Top 10 by Volume (Lowest)","value-high":"Top 10 by Value (Highest)","value-low":"Top 10 by Value (Lowest)"})[n]||"Top 10",D=()=>({"price-gainers":"📈","price-losers":"📉","volume-high":"🔥","volume-low":"❄️","value-high":"💰","value-low":"🪙"})[n]||"📊",I=F=>F===0?"text-yellow-400":F===1?"text-gray-300":F===2?"text-orange-500":"text-blue-400",E=F=>F===0?"bg-gradient-to-r from-yellow-500/20 to-yellow-600/10 border-l-4 border-yellow-500 shadow-lg shadow-yellow-500/20":F===1?"bg-gradient-to-r from-gray-400/20 to-gray-500/10 border-l-4 border-gray-400 shadow-lg shadow-gray-400/20":F===2?"bg-gradient-to-r from-orange-500/20 to-orange-600/10 border-l-4 border-orange-500 shadow-lg shadow-orange-500/20":"",G=F=>F===0?"🥇":F===1?"🥈":F===2?"🥉":`#${F+1}`,_e=r.reduce((F,X)=>F+h(X),0);r.reduce((F,X)=>F+(X.volume_24h||0),0);const ge=r.reduce((F,X)=>F+(X.value_24h||0),0),Ce=r.reduce((F,X)=>F+(X.amm_xrp_amount||0),0),ue=r.length>0?r.reduce((F,X)=>F+g(X),0)/r.length:0,J=()=>{if(_.length===0)return 0;switch(n){case"price-gainers":case"price-losers":return _.reduce((F,X)=>F+g(X),0)/_.length;case"volume-high":case"volume-low":return _.reduce((F,X)=>F+(X.volume_24h||0),0)/_.length;case"value-high":case"value-low":return _.reduce((F,X)=>F+(X.value_24h||0),0)/_.length;default:return 0}},se=(F,X)=>{const me=n.includes("price")?g(F):n.includes("volume")?F.volume_24h||0:F.value_24h||0,ve=n.includes("price")?g(X):n.includes("volume")?X.volume_24h||0:X.value_24h||0;return ve===0?0:me/ve*100};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-blue-200",children:"Top 10 Advanced Analytics"}),e.jsx("p",{className:"text-blue-400 mt-1",children:"Comprehensive market analysis with detailed comparisons"})]}),e.jsx("button",{onClick:P,disabled:s,className:"btn-primary px-4 py-2 disabled:opacity-50",children:s?"🔄 Loading...":"🔄 Refresh"})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-blue-200 mb-4",children:"Global Market Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-br from-blue-500/10 to-purple-500/10 rounded-lg border border-blue-500/20",children:[e.jsx("div",{className:"text-blue-400 text-xs mb-1",children:"Total Market Cap"}),e.jsx("div",{className:"text-2xl font-bold text-blue-200",children:_e.toFixed(2)}),e.jsx("div",{className:"text-blue-500 text-xs mt-1",children:"XRP"})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-green-500/10 to-emerald-500/10 rounded-lg border border-green-500/20",children:[e.jsx("div",{className:"text-green-400 text-xs mb-1",children:"Total Liquidity"}),e.jsx("div",{className:"text-2xl font-bold text-green-200",children:Ce.toFixed(2)}),e.jsx("div",{className:"text-green-500 text-xs mt-1",children:"XRP in pools"})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-orange-500/10 to-red-500/10 rounded-lg border border-orange-500/20",children:[e.jsx("div",{className:"text-orange-400 text-xs mb-1",children:"24h Trade Count"}),e.jsx("div",{className:"text-2xl font-bold text-orange-200",children:r.reduce((F,X)=>F+(X.trade_count_24h||0),0)}),e.jsx("div",{className:"text-orange-500 text-xs mt-1",children:"transactions"})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-purple-500/10 to-pink-500/10 rounded-lg border border-purple-500/20",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"24h XRP Volume"}),e.jsx("div",{className:"text-2xl font-bold text-purple-200",children:ge.toFixed(2)}),e.jsx("div",{className:"text-purple-500 text-xs mt-1",children:"XRP traded"})]}),e.jsxs("div",{className:`p-4 rounded-lg border ${ue>=0?"bg-gradient-to-br from-green-500/10 to-lime-500/10 border-green-500/20":"bg-gradient-to-br from-red-500/10 to-rose-500/10 border-red-500/20"}`,children:[e.jsx("div",{className:ue>=0?"text-green-400":"text-red-400",children:e.jsx("div",{className:"text-xs mb-1",children:"Avg Price Δ"})}),e.jsxs("div",{className:`text-2xl font-bold ${ue>=0?"text-green-200":"text-red-200"}`,children:[ue>=0?"+":"",ue.toFixed(2),"%"]}),e.jsx("div",{className:ue>=0?"text-green-500":"text-red-500",children:e.jsx("div",{className:"text-xs mt-1",children:"24h average"})})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-cyan-500/10 to-blue-500/10 rounded-lg border border-cyan-500/20",children:[e.jsx("div",{className:"text-cyan-400 text-xs mb-1",children:"Active Pools"}),e.jsx("div",{className:"text-2xl font-bold text-cyan-200",children:r.length}),e.jsx("div",{className:"text-cyan-500 text-xs mt-1",children:"AMM tokens"})]})]})]}),e.jsx(Ih,{tokens:r,topTokens:_,category:n}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-blue-200 mb-4",children:"Select Category"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3",children:[e.jsxs("button",{onClick:()=>l("price-gainers"),className:`p-4 rounded-lg text-center transition-all ${n==="price-gainers"?"bg-green-500/20 border-2 border-green-500 text-green-200 shadow-lg shadow-green-500/20":"glass hover:bg-blue-500/10 text-blue-300"}`,children:[e.jsx("div",{className:"text-2xl mb-1",children:"📈"}),e.jsx("div",{className:"text-sm font-medium",children:"Price Gainers"})]}),e.jsxs("button",{onClick:()=>l("price-losers"),className:`p-4 rounded-lg text-center transition-all ${n==="price-losers"?"bg-red-500/20 border-2 border-red-500 text-red-200 shadow-lg shadow-red-500/20":"glass hover:bg-blue-500/10 text-blue-300"}`,children:[e.jsx("div",{className:"text-2xl mb-1",children:"📉"}),e.jsx("div",{className:"text-sm font-medium",children:"Price Losers"})]}),e.jsxs("button",{onClick:()=>l("volume-high"),className:`p-4 rounded-lg text-center transition-all ${n==="volume-high"?"bg-orange-500/20 border-2 border-orange-500 text-orange-200 shadow-lg shadow-orange-500/20":"glass hover:bg-blue-500/10 text-blue-300"}`,children:[e.jsx("div",{className:"text-2xl mb-1",children:"🔥"}),e.jsx("div",{className:"text-sm font-medium",children:"High Volume"})]}),e.jsxs("button",{onClick:()=>l("volume-low"),className:`p-4 rounded-lg text-center transition-all ${n==="volume-low"?"bg-cyan-500/20 border-2 border-cyan-500 text-cyan-200 shadow-lg shadow-cyan-500/20":"glass hover:bg-blue-500/10 text-blue-300"}`,children:[e.jsx("div",{className:"text-2xl mb-1",children:"❄️"}),e.jsx("div",{className:"text-sm font-medium",children:"Low Volume"})]}),e.jsxs("button",{onClick:()=>l("value-high"),className:`p-4 rounded-lg text-center transition-all ${n==="value-high"?"bg-yellow-500/20 border-2 border-yellow-500 text-yellow-200 shadow-lg shadow-yellow-500/20":"glass hover:bg-blue-500/10 text-blue-300"}`,children:[e.jsx("div",{className:"text-2xl mb-1",children:"💰"}),e.jsx("div",{className:"text-sm font-medium",children:"High XRP Value"})]}),e.jsxs("button",{onClick:()=>l("value-low"),className:`p-4 rounded-lg text-center transition-all ${n==="value-low"?"bg-slate-500/20 border-2 border-slate-500 text-slate-200 shadow-lg shadow-slate-500/20":"glass hover:bg-blue-500/10 text-blue-300"}`,children:[e.jsx("div",{className:"text-2xl mb-1",children:"🪙"}),e.jsx("div",{className:"text-sm font-medium",children:"Low XRP Value"})]})]})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("span",{className:"text-4xl",children:D()}),e.jsx("h3",{className:"text-2xl font-bold text-blue-200",children:W()})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{className:"glass bg-yellow-500/5 rounded-lg p-4 border border-yellow-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-2xl",children:"🥇"}),e.jsx("div",{className:"text-yellow-400 text-sm font-bold",children:"Gold Leader"})]}),e.jsx("div",{className:"text-xl font-bold text-yellow-200",children:_.length>0?_[0].token_name:"N/A"})]}),e.jsxs("div",{className:"glass bg-gray-500/5 rounded-lg p-4 border border-gray-400/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-2xl",children:"🥈"}),e.jsx("div",{className:"text-gray-400 text-sm font-bold",children:"Silver Runner-up"})]}),e.jsx("div",{className:"text-xl font-bold text-gray-200",children:_.length>1?_[1].token_name:"N/A"})]}),e.jsxs("div",{className:"glass bg-orange-500/5 rounded-lg p-4 border border-orange-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-2xl",children:"🥉"}),e.jsx("div",{className:"text-orange-400 text-sm font-bold",children:"Bronze Third"})]}),e.jsx("div",{className:"text-xl font-bold text-orange-200",children:_.length>2?_[2].token_name:"N/A"})]}),e.jsxs("div",{className:"glass bg-purple-500/5 rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Category Average"}),e.jsx("div",{className:"text-xl font-bold text-purple-200",children:n.includes("price")?`${J().toFixed(2)}%`:J().toFixed(2)})]}),e.jsxs("div",{className:"glass bg-cyan-500/5 rounded-lg p-4",children:[e.jsx("div",{className:"text-cyan-400 text-sm mb-2",children:"Performance Spread"}),e.jsx("div",{className:"text-xl font-bold text-cyan-200",children:_.length>=2?(()=>{const F=n.includes("price")?g(_[0]):n.includes("volume")?_[0].volume_24h:_[0].value_24h,X=n.includes("price")?g(_[_.length-1]):n.includes("volume")?_[_.length-1].volume_24h:_[_.length-1].value_24h;return n.includes("price")?`${Math.abs(F-X).toFixed(2)}%`:Math.abs(F-X).toFixed(2)})():"N/A"})]})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-blue-900/30",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-blue-300 font-medium",children:"Rank"}),e.jsx("th",{className:"text-left px-4 py-3 text-blue-300 font-medium",children:"Token"}),e.jsx("th",{className:"text-right px-4 py-3 text-blue-300 font-medium",children:"Price (XRP)"}),e.jsx("th",{className:"text-right px-4 py-3 text-blue-300 font-medium",children:"24h Change"}),e.jsx("th",{className:"text-right px-4 py-3 text-blue-300 font-medium",children:"vs Category Avg"}),e.jsx("th",{className:"text-right px-4 py-3 text-blue-300 font-medium",children:"vs Leader"}),e.jsx("th",{className:"text-right px-4 py-3 text-blue-300 font-medium",children:"24h Trades"}),e.jsx("th",{className:"text-right px-4 py-3 text-blue-300 font-medium",children:"24h XRP Volume"}),e.jsx("th",{className:"text-right px-4 py-3 text-blue-300 font-medium",children:"Vol/Liq Ratio"}),e.jsx("th",{className:"text-right px-4 py-3 text-blue-300 font-medium",children:"Market Cap"}),e.jsx("th",{className:"text-right px-4 py-3 text-blue-300 font-medium",children:"Market Share"}),e.jsx("th",{className:"text-right px-4 py-3 text-blue-300 font-medium",children:"Liquidity"}),e.jsx("th",{className:"text-right px-4 py-3 text-blue-300 font-medium",children:"Price Impact"})]})}),e.jsx("tbody",{children:_.map((F,X)=>{const me=u(F),ve=h(F),He=g(F),pe=He>=0,xe=J(),le=n.includes("price")?He-xe:n.includes("volume")?(F.volume_24h||0)-xe:(F.value_24h||0)-xe,$e=_.length>0?se(F,_[0]):0,Ne=y(F),q=f(F),ee=b(F,1);return e.jsxs("tr",{onClick:()=>o(F),className:`border-t border-blue-500/20 hover:bg-blue-900/30 transition-all cursor-pointer ${E(X)}`,children:[e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("div",{className:`text-3xl font-bold ${I(X)}`,children:G(X)})})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ft,{token:F,size:"md"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-blue-200",children:F.token_name}),e.jsx("div",{className:"text-xs text-blue-400",children:F.currency_code})]})]})}),e.jsx("td",{className:"px-4 py-4 text-right",children:e.jsx("div",{className:"text-blue-200 font-mono text-sm",children:me.toFixed(8)})}),e.jsx("td",{className:"px-4 py-4 text-right",children:e.jsxs("div",{className:`font-bold text-lg ${pe?"text-green-400":"text-red-400"}`,children:[pe?"+":"",He.toFixed(2),"%"]})}),e.jsx("td",{className:"px-4 py-4 text-right",children:e.jsxs("div",{className:`font-semibold ${le>=0?"text-green-400":"text-red-400"}`,children:[le>=0?"+":"",le.toFixed(2),n.includes("price")?"%":""]})}),e.jsx("td",{className:"px-4 py-4 text-right",children:e.jsxs("div",{className:`font-semibold ${$e>=90?"text-green-400":$e>=70?"text-yellow-400":$e>=50?"text-orange-400":"text-red-400"}`,children:[$e.toFixed(1),"%"]})}),e.jsxs("td",{className:"px-4 py-4 text-right",children:[e.jsx("div",{className:"text-blue-200 font-semibold",children:F.trade_count_24h||0}),e.jsx("div",{className:"text-xs text-blue-400",children:"trades"})]}),e.jsxs("td",{className:"px-4 py-4 text-right",children:[e.jsx("div",{className:"text-purple-200 font-bold",children:(F.value_24h||0).toFixed(4)}),e.jsx("div",{className:"text-xs text-purple-400",children:"XRP"})]}),e.jsx("td",{className:"px-4 py-4 text-right",children:e.jsxs("div",{className:`font-bold ${Ne>100?"text-green-400":Ne>50?"text-yellow-400":"text-orange-400"}`,children:[Ne.toFixed(2),"%"]})}),e.jsxs("td",{className:"px-4 py-4 text-right",children:[e.jsx("div",{className:"text-blue-200 font-semibold",children:ve.toFixed(4)}),e.jsx("div",{className:"text-xs text-blue-400",children:"XRP"})]}),e.jsx("td",{className:"px-4 py-4 text-right",children:e.jsxs("div",{className:"text-cyan-200 font-bold",children:[q.toFixed(2),"%"]})}),e.jsxs("td",{className:"px-4 py-4 text-right",children:[e.jsx("div",{className:"text-green-200 font-semibold",children:(F.amm_xrp_amount||0).toFixed(2)}),e.jsx("div",{className:"text-xs text-green-400",children:"XRP"})]}),e.jsx("td",{className:"px-4 py-4 text-right",children:e.jsxs("div",{className:`font-semibold ${ee<1?"text-green-400":ee<3?"text-yellow-400":"text-red-400"}`,children:[ee.toFixed(3),"%"]})})]},F.id)})})]}),_.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-4xl mb-4",children:"📊"}),e.jsx("div",{className:"text-blue-400",children:"No data available yet"}),e.jsx("div",{className:"text-blue-500 text-sm mt-2",children:"Create some tokens to see analytics"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-blue-200 mb-4",children:"Podium Performance Analysis"}),e.jsx("div",{className:"space-y-4",children:_.slice(0,3).map((F,X)=>{u(F);const me=g(F),ve=h(F),He=f(F),pe=y(F),xe=b(F,1),le=["border-yellow-500","border-gray-400","border-orange-500"],$e=["bg-yellow-500/10","bg-gray-400/10","bg-orange-500/10"];return e.jsxs("div",{onClick:()=>o(F),className:`p-5 glass rounded-lg cursor-pointer hover:bg-blue-500/10 transition-colors border-2 ${le[X]} ${$e[X]}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-4xl",children:G(X)}),e.jsx(Ft,{token:F,size:"lg"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-lg text-blue-200",children:F.token_name}),e.jsx("div",{className:"text-sm text-blue-400",children:F.currency_code})]})]}),e.jsxs("div",{className:`text-2xl font-bold ${me>=0?"text-green-400":"text-red-400"}`,children:[me>=0?"+":"",me.toFixed(2),"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-blue-400 text-xs mb-1",children:"Market Share"}),e.jsxs("div",{className:"text-blue-200 font-bold",children:[He.toFixed(2),"%"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"24h XRP Vol"}),e.jsx("div",{className:"text-purple-200 font-bold",children:(F.value_24h||0).toFixed(2)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-green-400 text-xs mb-1",children:"Vol/Liq Ratio"}),e.jsxs("div",{className:"text-green-200 font-bold",children:[pe.toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-orange-400 text-xs mb-1",children:"Price Impact"}),e.jsxs("div",{className:"text-orange-200 font-bold",children:[xe.toFixed(3),"%"]})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-blue-500/20",children:e.jsxs("div",{className:"grid grid-cols-3 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-blue-400 mb-1",children:"Liquidity"}),e.jsxs("div",{className:"text-blue-200 font-semibold",children:[(F.amm_xrp_amount||0).toFixed(2)," XRP"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-blue-400 mb-1",children:"Market Cap"}),e.jsxs("div",{className:"text-blue-200 font-semibold",children:[ve.toFixed(2)," XRP"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-blue-400 mb-1",children:"24h Trades"}),e.jsx("div",{className:"text-blue-200 font-semibold",children:F.trade_count_24h||0})]})]})})]},F.id)})})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-blue-200 mb-4",children:"Advanced Category Insights"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-r from-blue-500/10 to-cyan-500/10 rounded-lg border border-blue-500/30",children:[e.jsx("div",{className:"text-blue-400 text-sm mb-3 font-bold",children:"XRP Volume Distribution"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-blue-300 text-sm",children:"Top 3 Combined"}),e.jsxs("span",{className:"text-blue-200 font-bold",children:[_.slice(0,3).reduce((F,X)=>F+(X.value_24h||0),0).toFixed(2)," XRP"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-blue-300 text-sm",children:"Remaining 7"}),e.jsxs("span",{className:"text-blue-200 font-bold",children:[_.slice(3).reduce((F,X)=>F+(X.value_24h||0),0).toFixed(2)," XRP"]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-blue-500/30",children:[e.jsx("span",{className:"text-blue-300 text-sm font-bold",children:"Top 3 Dominance"}),e.jsxs("span",{className:"text-cyan-200 font-bold text-lg",children:[_.length>=3?(_.slice(0,3).reduce((F,X)=>F+(X.value_24h||0),0)/_.reduce((F,X)=>F+(X.value_24h||0),0)*100).toFixed(1):0,"%"]})]})]})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-lg border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-3 font-bold",children:"Liquidity Analysis"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-300 text-sm",children:"Avg Liquidity Depth"}),e.jsx("span",{className:"text-purple-200 font-bold",children:_.length>0?(_.reduce((F,X)=>F+w(X),0)/_.length).toFixed(2):0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-300 text-sm",children:"Avg Vol/Liq Ratio"}),e.jsxs("span",{className:"text-purple-200 font-bold",children:[_.length>0?(_.reduce((F,X)=>F+y(X),0)/_.length).toFixed(2):0,"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-300 text-sm",children:"Total Pool Liquidity"}),e.jsxs("span",{className:"text-purple-200 font-bold",children:[_.reduce((F,X)=>F+(X.amm_xrp_amount||0),0).toFixed(2)," XRP"]})]})]})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-r from-green-500/10 to-emerald-500/10 rounded-lg border border-green-500/30",children:[e.jsx("div",{className:"text-green-400 text-sm mb-3 font-bold",children:"Trading Efficiency Metrics"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-green-300 text-sm",children:"Most Efficient"}),e.jsx("span",{className:"text-green-200 font-bold",children:_.length>0?_.reduce((F,X)=>y(X)>y(F)?X:F).token_name:"N/A"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-green-300 text-sm",children:"Lowest Price Impact"}),e.jsx("span",{className:"text-green-200 font-bold",children:_.length>0?_.reduce((F,X)=>b(X,1)<b(F,1)?X:F).token_name:"N/A"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-green-300 text-sm",children:"Avg Price Impact (1 XRP)"}),e.jsxs("span",{className:"text-green-200 font-bold",children:[_.length>0?(_.reduce((F,X)=>F+b(X,1),0)/_.length).toFixed(3):0,"%"]})]})]})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-r from-orange-500/10 to-red-500/10 rounded-lg border border-orange-500/30",children:[e.jsx("div",{className:"text-orange-400 text-sm mb-3 font-bold",children:"Market Concentration"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-orange-300 text-sm",children:"Top Token Share"}),e.jsxs("span",{className:"text-orange-200 font-bold",children:[_.length>0?f(_[0]).toFixed(2):0,"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-orange-300 text-sm",children:"HHI Index"}),e.jsx("span",{className:"text-orange-200 font-bold",children:_.length>0?_.reduce((F,X)=>F+Math.pow(f(X),2),0).toFixed(0):0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-orange-300 text-sm",children:"Market Health"}),e.jsx("span",{className:`font-bold ${_.length>0&&_.reduce((F,X)=>F+Math.pow(f(X),2),0)<2e3?"text-green-400":"text-yellow-400"}`,children:_.length>0&&_.reduce((F,X)=>F+Math.pow(f(X),2),0)<2e3?"Competitive":"Concentrated"})]})]})]})]})]})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-blue-200 mb-4",children:"Comprehensive Comparison Matrix"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-blue-900/30",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-3 py-2 text-blue-300",children:"Rank"}),e.jsx("th",{className:"text-left px-3 py-2 text-blue-300",children:"Token"}),e.jsx("th",{className:"text-right px-3 py-2 text-blue-300",children:"Price Δ %"}),e.jsx("th",{className:"text-right px-3 py-2 text-blue-300",children:"Trade Count"}),e.jsx("th",{className:"text-right px-3 py-2 text-blue-300",children:"XRP Volume"}),e.jsx("th",{className:"text-right px-3 py-2 text-blue-300",children:"Market Cap"}),e.jsx("th",{className:"text-right px-3 py-2 text-blue-300",children:"Market %"}),e.jsx("th",{className:"text-right px-3 py-2 text-blue-300",children:"Liquidity"}),e.jsx("th",{className:"text-right px-3 py-2 text-blue-300",children:"Vol/Liq"}),e.jsx("th",{className:"text-right px-3 py-2 text-blue-300",children:"Impact"}),e.jsx("th",{className:"text-right px-3 py-2 text-blue-300",children:"Efficiency"})]})}),e.jsx("tbody",{children:_.map((F,X)=>{const me=g(F),ve=h(F),He=f(F),pe=y(F),xe=b(F,1),le=pe;return e.jsxs("tr",{onClick:()=>o(F),className:"border-t border-blue-500/20 hover:bg-blue-900/20 cursor-pointer",children:[e.jsx("td",{className:"px-3 py-2",children:e.jsx("div",{className:`text-xl font-bold ${I(X)}`,children:G(X)})}),e.jsx("td",{className:"px-3 py-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ft,{token:F,size:"sm",className:"!w-6 !h-6"}),e.jsx("span",{className:"font-semibold text-blue-200",children:F.token_name})]})}),e.jsxs("td",{className:`px-3 py-2 text-right font-bold ${me>=0?"text-green-400":"text-red-400"}`,children:[me>=0?"+":"",me.toFixed(2),"%"]}),e.jsx("td",{className:"px-3 py-2 text-right text-blue-200 font-semibold",children:F.trade_count_24h||0}),e.jsx("td",{className:"px-3 py-2 text-right text-purple-200 font-bold",children:(F.value_24h||0).toFixed(4)}),e.jsx("td",{className:"px-3 py-2 text-right text-blue-200 font-semibold",children:ve.toFixed(4)}),e.jsxs("td",{className:"px-3 py-2 text-right text-cyan-200 font-bold",children:[He.toFixed(2),"%"]}),e.jsx("td",{className:"px-3 py-2 text-right text-green-200 font-semibold",children:(F.amm_xrp_amount||0).toFixed(2)}),e.jsx("td",{className:"px-3 py-2 text-right",children:e.jsxs("span",{className:`font-bold ${pe>100?"text-green-400":pe>50?"text-yellow-400":"text-orange-400"}`,children:[pe.toFixed(1),"%"]})}),e.jsx("td",{className:"px-3 py-2 text-right",children:e.jsxs("span",{className:`font-semibold ${xe<1?"text-green-400":xe<3?"text-yellow-400":"text-red-400"}`,children:[xe.toFixed(3),"%"]})}),e.jsx("td",{className:"px-3 py-2 text-right",children:e.jsx("span",{className:`font-bold ${le>100?"text-green-400":le>50?"text-yellow-400":"text-orange-400"}`,children:le.toFixed(1)})})]},F.id)})})]})})]}),i&&e.jsx(an,{token:i,onClose:()=>o(null)})]})}function Dh(){const[r,t]=m.useState([]),[s,a]=m.useState(!1),[n,l]=m.useState({}),[i,o]=m.useState("");m.useEffect(()=>{c()},[]);const c=async()=>{a(!0);try{const{data:f,error:w}=await S.from("meme_tokens").select("*").order("created_at",{ascending:!1});if(w)throw w;const{data:b}=await S.from("token_holders").select("*").eq("rank",1),P=(f||[]).map(A=>{const _=b==null?void 0:b.find(W=>W.token_id===A.id);return{...A,topHolder:_||null}});t(P)}catch{k.error("Failed to load tokens")}finally{a(!1)}},d=async f=>{var b,P;l(A=>({...A,[f]:!0}));let w=null;try{const A=r.find(_=>_.id===f);if(!A){k.error("Token not found"),l(_=>({..._,[f]:!1}));return}if(!A.issuer_address){k.error(`Token ${A.token_name} missing issuer address`),l(_=>({..._,[f]:!1}));return}w=new Re.Client("wss://xrplcluster.com"),await w.connect();try{const[_,W]=await Promise.all([w.request({command:"account_lines",account:A.issuer_address,peer:void 0,ledger_index:"validated"}).catch(se=>({result:{lines:[]}})),A.amm_account_id?w.request({command:"amm_info",asset:{currency:A.currency_code,issuer:A.issuer_address},asset2:{currency:"XRP"},ledger_index:"validated"}).catch(se=>null):Promise.resolve(null)]),D=((b=_==null?void 0:_.result)==null?void 0:b.lines)||[];if(D.length===0){k.error(`No holders found for ${A.token_name}`),w&&await w.disconnect(),l(se=>({...se,[f]:!1}));return}D.sort((se,F)=>parseFloat(F.balance)-parseFloat(se.balance));const I=D[0],E=parseFloat(I.balance);if(E<=0){k.error(`No positive balances found for ${A.token_name}`),w&&await w.disconnect(),l(se=>({...se,[f]:!1}));return}const G=D.reduce((se,F)=>{const X=parseFloat(F.balance);return se+(X>0?X:0)},0),_e=G>0?E/G*100:0,ge=I.account===A.receiver_address;let Ce=0;if((P=W==null?void 0:W.result)!=null&&P.amm){const se=W.result.amm,F=se.amount,X=se.amount2;let me,ve;typeof F=="string"?(me=parseFloat(F)/1e6,ve=parseFloat(X.value)):(me=parseFloat(X)/1e6,ve=parseFloat(F.value)),ve>0&&(Ce=me/ve)}else Ce=parseFloat(A.current_price)||0;const ue=E*Ce;await S.from("token_holders").delete().eq("token_id",A.id);const J=D.map((se,F)=>{const X=parseFloat(se.balance);return X<=0?null:{token_id:A.id,holder_address:se.account,balance:X,percentage:G>0?X/G*100:0,is_developer_wallet:se.account===A.receiver_address,rank:F+1,last_updated:new Date().toISOString()}}).filter(se=>se!==null);J.length>0&&await S.from("token_holders").insert(J),Ce>0&&await S.from("meme_tokens").update({current_price:Ce,updated_at:new Date().toISOString()}).eq("id",A.id),t(se=>se.map(F=>F.id===f?{...F,current_price:Ce,topHolder:{holder_address:I.account,balance:E,percentage:_e,is_developer_wallet:ge,rank:1,last_updated:new Date().toISOString()}}:F)),k.success(`Found king for ${A.token_name}!`)}catch(_){k.error(`Error: ${_.message||"Failed to process holder data"}`)}finally{w&&await w.disconnect()}}catch(A){const _=r.find(W=>W.id===f);k.error(`Failed to fetch top holder for ${(_==null?void 0:_.token_name)||"token"}: ${A.message}`)}finally{l(A=>({...A,[f]:!1}))}},u=async()=>{a(!0);for(const f of r)await d(f.id);a(!1),k.success("All top holders updated!")},h=r.filter(f=>{if(!i)return!0;const w=f.token_name||"",b=f.currency_code||"";return w.toLowerCase().includes(i.toLowerCase())||b.toLowerCase().includes(i.toLowerCase())}),g=h.filter(f=>f.topHolder!==null),y=g.reduce((f,w)=>{var A;const b=parseFloat(((A=w.topHolder)==null?void 0:A.balance)||0),P=parseFloat(w.current_price||0);return f+b*P},0);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"👑 Kings List"}),e.jsx("p",{className:"text-gray-400",children:"Top holders for each MEMEKINGS token"})]}),e.jsx("button",{onClick:u,disabled:s,className:"bg-gradient-to-r from-green-600 to-green-500 text-white px-6 py-3 rounded-lg hover:from-green-500 hover:to-green-400 disabled:opacity-50 shadow-lg shadow-green-500/20 transition-all duration-300 flex items-center gap-2",children:s?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Updating All..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Fetch All Kings"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsx("div",{className:"text-gray-400 text-sm mb-1",children:"Total Tokens"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:h.length})]}),e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsx("div",{className:"text-gray-400 text-sm mb-1",children:"Kings Found"}),e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:g.length})]}),e.jsxs("div",{className:"glass rounded-lg p-4",children:[e.jsx("div",{className:"text-gray-400 text-sm mb-1",children:"Total XRP Value"}),e.jsxs("div",{className:"text-2xl font-bold text-green-400",children:[y.toLocaleString(void 0,{maximumFractionDigits:2})," XRP"]})]})]}),e.jsx("div",{children:e.jsx("input",{type:"text",value:i,onChange:f=>o(f.target.value),placeholder:"Search tokens...",className:"w-full bg-gray-800 border border-gray-700 text-white rounded-lg px-4 py-2 focus:border-green-500 focus:ring-green-500/50"})}),s&&h.length===0?e.jsxs("div",{className:"glass rounded-lg p-12 text-center",children:[e.jsxs("svg",{className:"animate-spin h-12 w-12 mx-auto text-green-500 mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("p",{className:"text-gray-400",children:"Loading tokens..."})]}):h.length===0?e.jsxs("div",{className:"glass rounded-lg p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"👑"}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"No Tokens Found"}),e.jsx("p",{className:"text-gray-400",children:"No tokens match your search."})]}):e.jsx("div",{className:"glass rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-800/50 border-b border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-gray-400 font-medium text-sm",children:"Token"}),e.jsx("th",{className:"text-left px-6 py-4 text-gray-400 font-medium text-sm",children:"King Address"}),e.jsx("th",{className:"text-right px-6 py-4 text-gray-400 font-medium text-sm",children:"Balance"}),e.jsx("th",{className:"text-right px-6 py-4 text-gray-400 font-medium text-sm",children:"% Supply"}),e.jsx("th",{className:"text-right px-6 py-4 text-gray-400 font-medium text-sm",children:"XRP Value"}),e.jsx("th",{className:"text-center px-6 py-4 text-gray-400 font-medium text-sm",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700/50",children:h.map(f=>{const w=f.topHolder,b=w?parseFloat(w.balance):0,P=parseFloat(f.current_price)||0,A=b*P;return e.jsxs("tr",{className:"hover:bg-gray-800/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ft,{token:f,size:"md"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-bold",children:f.token_name}),e.jsx("div",{className:"text-gray-400 text-sm",children:f.currency_code})]})]})}),e.jsx("td",{className:"px-6 py-4",children:w?w.is_developer_wallet?e.jsx("div",{className:"inline-flex px-3 py-1 bg-gradient-to-r from-purple-600 to-purple-500 rounded-full text-white text-xs font-medium",children:"MEMEKINGS Dev"}):e.jsx(Ls,{type:"address",value:w.holder_address,network:"mainnet",className:"text-green-400 hover:text-green-300 text-sm font-mono"}):e.jsx("span",{className:"text-gray-500 text-sm",children:"-"})}),e.jsx("td",{className:"px-6 py-4 text-right",children:w?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-white font-bold",children:b.toLocaleString(void 0,{maximumFractionDigits:2})}),e.jsx("div",{className:"text-gray-500 text-xs",children:f.currency_code})]}):e.jsx("span",{className:"text-gray-500 text-sm",children:"-"})}),e.jsx("td",{className:"px-6 py-4 text-right",children:w?e.jsxs("div",{className:"text-green-400 font-bold",children:[parseFloat(w.percentage).toFixed(2),"%"]}):e.jsx("span",{className:"text-gray-500 text-sm",children:"-"})}),e.jsx("td",{className:"px-6 py-4 text-right",children:w&&A>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-green-400 font-bold",children:A.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("div",{className:"text-gray-500 text-xs",children:"XRP"})]}):e.jsx("span",{className:"text-gray-500 text-sm",children:"-"})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("button",{onClick:()=>d(f.id),disabled:n[f.id],className:"text-yellow-400 hover:text-yellow-300 disabled:opacity-50 inline-flex items-center gap-1 text-sm transition-colors",title:w?"Refresh top holder":"Fetch top holder",children:n[f.id]?e.jsxs("svg",{className:"animate-spin h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsx("span",{className:"text-2xl",children:"👑"})})})]},f.id)})})]})})})]})}function Mh(){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"glass rounded-lg p-8 border-2 border-purple-500/30",children:[e.jsx("h2",{className:"text-4xl font-bold text-purple-200 mb-2",children:"About MemeKings"}),e.jsx("p",{className:"text-xl text-purple-300",children:"The Premier XRPL Meme Token Factory & Trading Platform"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"glass rounded-lg p-6 border border-green-500/30",children:[e.jsx("div",{className:"text-4xl mb-3",children:"🚀"}),e.jsx("div",{className:"text-2xl font-bold text-green-200 mb-2",children:"Fast"}),e.jsx("p",{className:"text-green-300 text-sm",children:"3-5 second transactions on XRPL with instant finality"})]}),e.jsxs("div",{className:"glass rounded-lg p-6 border border-blue-500/30",children:[e.jsx("div",{className:"text-4xl mb-3",children:"💰"}),e.jsx("div",{className:"text-2xl font-bold text-blue-200 mb-2",children:"Low Cost"}),e.jsx("p",{className:"text-blue-300 text-sm",children:"Minimal blockchain fees + 0.01 XRP platform trading fee"})]}),e.jsxs("div",{className:"glass rounded-lg p-6 border border-purple-500/30",children:[e.jsx("div",{className:"text-4xl mb-3",children:"🔒"}),e.jsx("div",{className:"text-2xl font-bold text-purple-200 mb-2",children:"Secure"}),e.jsx("p",{className:"text-purple-300 text-sm",children:"Battle-tested XRPL with native AMM support"})]})]}),e.jsxs("div",{className:"glass rounded-lg p-8",children:[e.jsx("h3",{className:"text-3xl font-bold text-purple-200 mb-6",children:"Platform Overview"}),e.jsx("p",{className:"text-purple-300 leading-relaxed mb-6",children:"MemeKings is a comprehensive decentralized platform built on the XRP Ledger that enables anyone to create, trade, and profit from meme tokens. We combine the power of XRPL native AMM (Automated Market Maker) functionality with an intuitive interface to provide instant liquidity, transparent pricing, and community-driven token economics."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-purple-900/30 rounded-lg p-6",children:[e.jsx("h4",{className:"text-xl font-bold text-purple-200 mb-3",children:"What Makes Us Different"}),e.jsxs("ul",{className:"space-y-2 text-purple-300 text-sm",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsx("span",{children:"Native XRPL Integration - Built directly on XRPL, not a smart contract layer"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsx("span",{children:"Instant Liquidity - AMM pools created automatically with every token"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsx("span",{children:"No Gas Wars - Predictable, minimal fees on every transaction"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsx("span",{children:"10% APY Vault - Earn passive income on held tokens"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsx("span",{children:"AI Trading Bot - Automated 24/7 trading with custom strategies"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-400 mt-1",children:"✓"}),e.jsx("span",{children:"Real-Time Analytics - Live market data and trading insights"})]})]})]}),e.jsxs("div",{className:"bg-purple-900/30 rounded-lg p-6",children:[e.jsx("h4",{className:"text-xl font-bold text-purple-200 mb-3",children:"Key Metrics"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-400",children:"Transaction Speed"}),e.jsx("span",{className:"text-purple-200 font-bold",children:"3-5 seconds"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-400",children:"Trading Fee"}),e.jsx("span",{className:"text-purple-200 font-bold",children:"0.01 XRP"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-400",children:"Token Listing Fee"}),e.jsx("span",{className:"text-purple-200 font-bold",children:"1 XRP"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-400",children:"Vault APY"}),e.jsx("span",{className:"text-green-400 font-bold",children:"10%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-400",children:"Collection Fee"}),e.jsx("span",{className:"text-purple-200 font-bold",children:"0.01 XRP"})]})]})]})]})]}),e.jsxs("div",{className:"glass rounded-lg p-8",children:[e.jsx("h3",{className:"text-3xl font-bold text-purple-200 mb-6",children:"Complete Feature Set"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-purple-900/50 to-blue-900/50 rounded-lg p-6 border border-purple-500/30",children:[e.jsx("div",{className:"text-3xl mb-3",children:"🏭"}),e.jsx("h4",{className:"text-xl font-bold text-purple-200 mb-3",children:"Token Creation"}),e.jsx("p",{className:"text-purple-300 text-sm mb-3",children:"Create your own meme token on XRPL in minutes with automatic AMM pool creation for instant liquidity."}),e.jsxs("ul",{className:"space-y-2 text-purple-400 text-sm",children:[e.jsx("li",{children:"• Custom token name, symbol, and supply"}),e.jsx("li",{children:"• Automatic AMM pool deployment"}),e.jsx("li",{children:"• Initial liquidity setup with XRP"}),e.jsx("li",{children:"• Token metadata and branding"}),e.jsx("li",{children:"• Instant market availability"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-900/50 to-teal-900/50 rounded-lg p-6 border border-green-500/30",children:[e.jsx("div",{className:"text-3xl mb-3",children:"📝"}),e.jsx("h4",{className:"text-xl font-bold text-green-200 mb-3",children:"Token Listing Service"}),e.jsx("p",{className:"text-green-300 text-sm mb-3",children:"List existing tokens on the platform with comprehensive metadata collection for maximum visibility."}),e.jsxs("ul",{className:"space-y-2 text-green-400 text-sm",children:[e.jsx("li",{children:"• 1 XRP listing fee"}),e.jsx("li",{children:"• Full token information capture"}),e.jsx("li",{children:"• AMM pool data integration"}),e.jsx("li",{children:"• Social links and branding"}),e.jsx("li",{children:"• Optional featured placement"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-yellow-900/50 to-orange-900/50 rounded-lg p-6 border border-yellow-500/30",children:[e.jsx("div",{className:"text-3xl mb-3",children:"⭐"}),e.jsx("h4",{className:"text-xl font-bold text-yellow-200 mb-3",children:"Featured Spot System"}),e.jsx("p",{className:"text-yellow-300 text-sm mb-3",children:"Boost your token visibility with premium featured placement on the main page with flexible duration options."}),e.jsxs("ul",{className:"space-y-2 text-yellow-400 text-sm",children:[e.jsx("li",{children:"• 1 Day: 10 XRP"}),e.jsx("li",{children:"• 3 Days: 25 XRP"}),e.jsx("li",{children:"• 7 Days: 50 XRP"}),e.jsx("li",{children:"• 30 Days: 150 XRP"}),e.jsx("li",{children:"• Top-of-page prominence"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-900/50 to-cyan-900/50 rounded-lg p-6 border border-blue-500/30",children:[e.jsx("div",{className:"text-3xl mb-3",children:"💱"}),e.jsx("h4",{className:"text-xl font-bold text-blue-200 mb-3",children:"DEX Trading"}),e.jsx("p",{className:"text-blue-300 text-sm mb-3",children:"Trade tokens directly with XRPL native AMM pools for instant execution and guaranteed liquidity."}),e.jsxs("ul",{className:"space-y-2 text-blue-400 text-sm",children:[e.jsx("li",{children:"• Real-time price quotes"}),e.jsx("li",{children:"• Configurable slippage tolerance"}),e.jsx("li",{children:"• Instant trade execution"}),e.jsx("li",{children:"• Price impact visualization"}),e.jsx("li",{children:"• Transaction history tracking"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-900/50 to-pink-900/50 rounded-lg p-6 border border-red-500/30",children:[e.jsx("div",{className:"text-3xl mb-3",children:"🤖"}),e.jsx("h4",{className:"text-xl font-bold text-red-200 mb-3",children:"AI Trading Bot"}),e.jsx("p",{className:"text-red-300 text-sm mb-3",children:"Automated trading bot with multiple strategies for 24/7 passive income generation."}),e.jsxs("ul",{className:"space-y-2 text-red-400 text-sm",children:[e.jsx("li",{children:"• Scalping: Quick profits from small moves"}),e.jsx("li",{children:"• HODL: Buy and hold strategy"}),e.jsx("li",{children:"• DCA: Dollar-cost averaging"}),e.jsx("li",{children:"• Grid Trading: Range-bound profits"}),e.jsx("li",{children:"• Custom take profit and stop loss"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-indigo-900/50 to-purple-900/50 rounded-lg p-6 border border-indigo-500/30",children:[e.jsx("div",{className:"text-3xl mb-3",children:"🏦"}),e.jsx("h4",{className:"text-xl font-bold text-indigo-200 mb-3",children:"Passive Earnings Vault"}),e.jsx("p",{className:"text-indigo-300 text-sm mb-3",children:"Earn 10% APY automatically on all token holdings with daily compounding rewards."}),e.jsxs("ul",{className:"space-y-2 text-indigo-400 text-sm",children:[e.jsx("li",{children:"• 10% annual percentage yield"}),e.jsx("li",{children:"• Automatic daily accrual"}),e.jsx("li",{children:"• One-click collection"}),e.jsx("li",{children:"• No lock-up period"}),e.jsx("li",{children:"• Earnings tracking dashboard"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-teal-900/50 to-green-900/50 rounded-lg p-6 border border-teal-500/30",children:[e.jsx("div",{className:"text-3xl mb-3",children:"💰"}),e.jsx("h4",{className:"text-xl font-bold text-teal-200 mb-3",children:"XRP Rewards Program"}),e.jsx("p",{className:"text-teal-300 text-sm mb-3",children:"Earn XRP rewards for platform activities including token creation, trading, and referrals."}),e.jsxs("ul",{className:"space-y-2 text-teal-400 text-sm",children:[e.jsx("li",{children:"• Token creation rewards"}),e.jsx("li",{children:"• Trading volume bonuses"}),e.jsx("li",{children:"• Daily activity rewards"}),e.jsx("li",{children:"• Referral commissions"}),e.jsx("li",{children:"• Instant XRP payouts"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-900/50 to-pink-900/50 rounded-lg p-6 border border-purple-500/30",children:[e.jsx("div",{className:"text-3xl mb-3",children:"💎"}),e.jsx("h4",{className:"text-xl font-bold text-purple-200 mb-3",children:"Portfolio Management"}),e.jsx("p",{className:"text-purple-300 text-sm mb-3",children:"Comprehensive portfolio tracking with list and grid views for all your token holdings."}),e.jsxs("ul",{className:"space-y-2 text-purple-400 text-sm",children:[e.jsx("li",{children:"• Real-time balance updates"}),e.jsx("li",{children:"• USD value calculations"}),e.jsx("li",{children:"• Supply percentage tracking"}),e.jsx("li",{children:"• Quick send and receive"}),e.jsx("li",{children:"• Mobile-optimized grid view"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-900/50 to-red-900/50 rounded-lg p-6 border border-orange-500/30",children:[e.jsx("div",{className:"text-3xl mb-3",children:"📊"}),e.jsx("h4",{className:"text-xl font-bold text-orange-200 mb-3",children:"Advanced Analytics"}),e.jsx("p",{className:"text-orange-300 text-sm mb-3",children:"Professional-grade charting and analytics for informed trading decisions."}),e.jsxs("ul",{className:"space-y-2 text-orange-400 text-sm",children:[e.jsx("li",{children:"• Real-time price charts"}),e.jsx("li",{children:"• Trading volume metrics"}),e.jsx("li",{children:"• Market cap tracking"}),e.jsx("li",{children:"• Liquidity depth analysis"}),e.jsx("li",{children:"• Historical performance data"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-cyan-900/50 to-blue-900/50 rounded-lg p-6 border border-cyan-500/30",children:[e.jsx("div",{className:"text-3xl mb-3",children:"💬"}),e.jsx("h4",{className:"text-xl font-bold text-cyan-200 mb-3",children:"AI Chat Assistant"}),e.jsx("p",{className:"text-cyan-300 text-sm mb-3",children:"Intelligent AI assistant for platform guidance, market insights, and automated commands."}),e.jsxs("ul",{className:"space-y-2 text-cyan-400 text-sm",children:[e.jsx("li",{children:"• Natural language queries"}),e.jsx("li",{children:"• Market analysis on demand"}),e.jsx("li",{children:"• Platform feature explanations"}),e.jsx("li",{children:"• Trading assistance"}),e.jsx("li",{children:"• Command execution via chat"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-pink-900/50 to-purple-900/50 rounded-lg p-6 border border-pink-500/30",children:[e.jsx("div",{className:"text-3xl mb-3",children:"🏊"}),e.jsx("h4",{className:"text-xl font-bold text-pink-200 mb-3",children:"Liquidity Pools"}),e.jsx("p",{className:"text-pink-300 text-sm mb-3",children:"Earn fees by providing liquidity to AMM pools and track LP token performance."}),e.jsxs("ul",{className:"space-y-2 text-pink-400 text-sm",children:[e.jsx("li",{children:"• Add liquidity to any pool"}),e.jsx("li",{children:"• Earn trading fees passively"}),e.jsx("li",{children:"• LP token management"}),e.jsx("li",{children:"• Pool share tracking"}),e.jsx("li",{children:"• Detailed history logs"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-900/50 to-emerald-900/50 rounded-lg p-6 border border-green-500/30",children:[e.jsx("div",{className:"text-3xl mb-3",children:"📱"}),e.jsx("h4",{className:"text-xl font-bold text-green-200 mb-3",children:"Mobile-First Design"}),e.jsx("p",{className:"text-green-300 text-sm mb-3",children:"Fully responsive interface optimized for mobile trading and portfolio management."}),e.jsxs("ul",{className:"space-y-2 text-green-400 text-sm",children:[e.jsx("li",{children:"• Touch-optimized controls"}),e.jsx("li",{children:"• Adaptive view modes"}),e.jsx("li",{children:"• Mobile-friendly navigation"}),e.jsx("li",{children:"• Network selector integration"}),e.jsx("li",{children:"• Fast loading times"})]})]})]})]}),e.jsxs("div",{className:"glass rounded-lg p-8",children:[e.jsx("h3",{className:"text-3xl font-bold text-purple-200 mb-6",children:"How to Get Started"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-6 items-start",children:[e.jsx("div",{className:"flex-shrink-0 w-16 h-16 rounded-full bg-gradient-to-br from-purple-600 to-purple-800 flex items-center justify-center text-white text-2xl font-bold",children:"1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-2xl font-bold text-purple-200 mb-2",children:"Create or Connect Your Wallet"}),e.jsx("p",{className:"text-purple-300 mb-3",children:"Navigate to the Setup page to create a new XRPL wallet or connect an existing one. Your wallet is your gateway to the MemeKings ecosystem. You can manage multiple wallets and switch between testnet and mainnet."}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsx("div",{className:"text-blue-200 text-sm font-medium mb-2",children:"💡 Pro Tip:"}),e.jsx("p",{className:"text-blue-300 text-sm",children:"Always securely backup your wallet seed. MemeKings uses client-side encryption - we never have access to your private keys. Use the PIN protection feature for additional security."})]})]})]}),e.jsxs("div",{className:"flex gap-6 items-start",children:[e.jsx("div",{className:"flex-shrink-0 w-16 h-16 rounded-full bg-gradient-to-br from-purple-600 to-purple-800 flex items-center justify-center text-white text-2xl font-bold",children:"2"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-2xl font-bold text-purple-200 mb-2",children:"Explore Tokens and Markets"}),e.jsx("p",{className:"text-purple-300 mb-3",children:"Browse the Memes page to discover community tokens. View the Top 10 for highest performers, check the Kings List for featured tokens, or explore by category. Each token displays detailed analytics, price charts, and liquidity information."}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"glass rounded-lg p-3",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"Real-Time Data"}),e.jsx("p",{className:"text-purple-200 text-sm",children:"Live prices and volume"})]}),e.jsxs("div",{className:"glass rounded-lg p-3",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"Deep Analytics"}),e.jsx("p",{className:"text-purple-200 text-sm",children:"Charts and market metrics"})]})]})]})]}),e.jsxs("div",{className:"flex gap-6 items-start",children:[e.jsx("div",{className:"flex-shrink-0 w-16 h-16 rounded-full bg-gradient-to-br from-green-600 to-green-800 flex items-center justify-center text-white text-2xl font-bold",children:"3"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-2xl font-bold text-green-200 mb-2",children:"Trade and Earn"}),e.jsx("p",{className:"text-green-300 mb-3",children:"Buy tokens using the Trade page with instant AMM execution. Enable the Trading Bot for automated strategies, or add liquidity to pools to earn trading fees. All your holdings automatically earn 10% APY in the Vault."}),e.jsx("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"grid grid-cols-3 gap-3 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-green-200 font-bold",children:"Manual Trading"}),e.jsx("p",{className:"text-green-400 text-xs mt-1",children:"Full control"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-green-200 font-bold",children:"Bot Trading"}),e.jsx("p",{className:"text-green-400 text-xs mt-1",children:"24/7 automation"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-green-200 font-bold",children:"Vault Earnings"}),e.jsx("p",{className:"text-green-400 text-xs mt-1",children:"Passive APY"})]})]})})]})]}),e.jsxs("div",{className:"flex gap-6 items-start",children:[e.jsx("div",{className:"flex-shrink-0 w-16 h-16 rounded-full bg-gradient-to-br from-yellow-600 to-yellow-800 flex items-center justify-center text-white text-2xl font-bold",children:"4"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-2xl font-bold text-yellow-200 mb-2",children:"Create Your Own Token"}),e.jsx("p",{className:"text-yellow-300 mb-3",children:"Launch your own meme token from the Dashboard with automatic AMM pool creation. Set your supply, initial liquidity, token metadata, and watch it go live instantly. Optionally purchase featured placement for maximum visibility."}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"glass rounded-lg p-3 bg-yellow-500/10",children:[e.jsx("div",{className:"text-yellow-400 text-xs mb-1",children:"Full Control"}),e.jsx("p",{className:"text-yellow-200 text-sm",children:"Your token, your rules"})]}),e.jsxs("div",{className:"glass rounded-lg p-3 bg-yellow-500/10",children:[e.jsx("div",{className:"text-yellow-400 text-xs mb-1",children:"Instant Market"}),e.jsx("p",{className:"text-yellow-200 text-sm",children:"Trading starts immediately"})]})]})]})]})]})]}),e.jsxs("div",{className:"glass rounded-lg p-8 border border-yellow-500/30 bg-yellow-500/5",children:[e.jsx("h3",{className:"text-3xl font-bold text-yellow-200 mb-4",children:"⚠️ Community-Based Economics"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-yellow-300 leading-relaxed",children:"MemeKings operates on pure free-market principles. All token values are determined entirely by community demand, trading volume, AMM liquidity depth, and supply circulation. The platform provides tools and infrastructure, but does not control, guarantee, or influence token prices."}),e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-6 mt-4",children:[e.jsx("h4",{className:"text-xl font-bold text-yellow-200 mb-3",children:"🎰 No Crying in the Casino"}),e.jsx("p",{className:"text-yellow-300 text-sm mb-3",children:"This is a decentralized trading platform with real financial risk. Token prices can be highly volatile. Meme tokens are speculative assets and may lose all value."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-red-500/20 border border-red-500/30 rounded p-3 text-center",children:[e.jsx("div",{className:"text-red-200 font-bold mb-1",children:"NO Guarantees"}),e.jsx("p",{className:"text-red-300 text-xs",children:"No promises of returns"})]}),e.jsxs("div",{className:"bg-red-500/20 border border-red-500/30 rounded p-3 text-center",children:[e.jsx("div",{className:"text-red-200 font-bold mb-1",children:"NO Refunds"}),e.jsx("p",{className:"text-red-300 text-xs",children:"All trades are final"})]}),e.jsxs("div",{className:"bg-red-500/20 border border-red-500/30 rounded p-3 text-center",children:[e.jsx("div",{className:"text-red-200 font-bold mb-1",children:"NO Bailouts"}),e.jsx("p",{className:"text-red-300 text-xs",children:"You own your risk"})]})]}),e.jsx("p",{className:"text-yellow-200 font-bold text-center mt-4",children:"⚡ Only trade what you can afford to lose ⚡"})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-600/20 to-blue-600/20 border-2 border-purple-500/50 rounded-lg p-8 text-center",children:[e.jsx("h3",{className:"text-3xl font-bold text-purple-200 mb-3",children:"Ready to Start Trading?"}),e.jsx("p",{className:"text-purple-300 mb-6",children:"Join the MemeKings community and start capitalizing on meme token opportunities"}),e.jsx("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigate",{detail:"setup"})),className:"btn-primary text-white px-12 py-4 rounded-lg font-bold text-lg hover:scale-105 transition-transform",children:"Create Wallet & Get Started →"})]})]})}function $h({wallet:r,network:t,onTrustlineUpdate:s,tokenBalances:a=[]}){const[n,l]=m.useState(!1),[i,o]=m.useState(!1);m.useState(!1),m.useState(null),m.useState("");const[c,d]=m.useState(!1),u=m.useRef(null);m.useEffect(()=>{const w=b=>{u.current&&!u.current.contains(b.target)&&l(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]);const h=async()=>{if(!r){k.error("Please connect a wallet first");return}o(!0);try{const w=new Re.Client(t==="mainnet"?"wss://xrplcluster.com":"wss://s.altnet.rippletest.net:51233");await w.connect();try{const{data:b}=await S.from("meme_tokens").select("currency_hex, issuer_address").order("created_at",{ascending:!0});if(!b||b.length===0){k.error("No MEMEKINGS tokens found");return}let P=0,A=0;for(const _ of b)try{const W=Re.Wallet.fromSeed(r.seed),D={TransactionType:"TrustSet",Account:W.address,LimitAmount:{currency:_.currency_hex,issuer:_.issuer_address,value:"1000000000"}},I=await w.autofill(D),E=W.sign(I);(await w.submitAndWait(E.tx_blob)).result.meta.TransactionResult==="tesSUCCESS"?P++:A++}catch{A++}P>0&&(k.success(`Successfully set up ${P} trustline(s)`),s&&s()),A>0&&k.error(`Failed to set up ${A} trustline(s)`)}finally{await w.disconnect()}}catch{k.error("Failed to set up trustlines")}finally{o(!1),l(!1)}},g=async()=>{if(!r){k.error("Please connect a wallet first");return}o(!0);try{const w=new Re.Client(t==="mainnet"?"wss://xrplcluster.com":"wss://s.altnet.rippletest.net:51233");await w.connect();try{const{data:b}=await S.from("meme_tokens").select("currency_hex, issuer_address").order("created_at",{ascending:!0});if(!b||b.length===0){k.error("No MEMEKINGS tokens found");return}let P=0,A=0;for(const _ of b)if(!a.some(D=>D.currencyHex===_.currency_hex&&D.issuer===_.issuer_address&&parseFloat(D.value)>0))try{const D=Re.Wallet.fromSeed(r.seed),I={TransactionType:"TrustSet",Account:D.address,LimitAmount:{currency:_.currency_hex,issuer:_.issuer_address,value:"0"}},E=await w.autofill(I),G=D.sign(E);(await w.submitAndWait(G.tx_blob)).result.meta.TransactionResult==="tesSUCCESS"?P++:A++}catch{A++}P>0?(k.success(`Successfully removed ${P} trustline(s)`),s&&s()):A===0&&k.info("No empty trustlines to remove"),A>0&&k.error(`Failed to remove ${A} trustline(s)`)}finally{await w.disconnect()}}catch{k.error("Failed to remove trustlines")}finally{o(!1),l(!1)}},y=()=>{const w="https://xumm.app";window.open(w,"_blank"),l(!1)},f=()=>{l(!1),d(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(Eo,{isOpen:c,onClose:()=>d(!1),wallet:r}),e.jsxs("div",{className:"relative inline-block z-50",ref:u,children:[e.jsx("button",{onClick:()=>l(!n),disabled:i,className:"bg-gradient-to-r from-purple-600 to-purple-500 text-white py-2 px-4 rounded-lg hover:from-purple-500 hover:to-purple-400 disabled:opacity-50 shadow-lg shadow-purple-500/20 transition-all duration-300 flex items-center gap-2",children:i?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):e.jsxs(e.Fragment,{children:["Trust",e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]})}),n&&!i&&e.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-gray-900 rounded-lg shadow-2xl border border-purple-500/30 z-[100]",children:e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:h,className:"w-full text-left px-4 py-3 text-sm text-purple-200 hover:bg-purple-900/50 transition-colors flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-500/20 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Setup"}),e.jsx("div",{className:"text-xs text-purple-400",children:"Add this token trustline"})]})]}),e.jsxs("button",{onClick:g,className:"w-full text-left px-4 py-3 text-sm text-purple-200 hover:bg-purple-900/50 transition-colors flex items-center gap-3 border-t border-purple-500/20",children:[e.jsx("div",{className:"w-10 h-10 bg-red-500/20 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Remove"}),e.jsx("div",{className:"text-xs text-purple-400",children:"Remove empty trustline"})]})]}),e.jsxs("button",{onClick:y,className:"w-full text-left px-4 py-3 text-sm text-purple-200 hover:bg-purple-900/50 transition-colors flex items-center gap-3 border-t border-purple-500/20",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500/20 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"XRPScan Link"}),e.jsx("div",{className:"text-xs text-purple-400",children:"View issuer details"})]})]}),e.jsxs("button",{onClick:f,className:"w-full text-left px-4 py-3 text-sm text-white hover:bg-gradient-to-r hover:from-purple-600 hover:to-purple-500 transition-all flex items-center gap-3 border-t border-purple-500/20 bg-purple-600/20",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-blue-600 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"+ Add Token"}),e.jsx("div",{className:"text-xs text-purple-300",children:"List your token (1 XRP)"})]})]})]})})]})]})}const hi=async r=>{const s=new TextEncoder().encode(r),a=await crypto.subtle.digest("SHA-256",s);return Array.from(new Uint8Array(a)).map(l=>l.toString(16).padStart(2,"0")).join("")};function Oh({walletAddress:r,onSuccess:t,onCancel:s}){const[a,n]=m.useState(""),[l,i]=m.useState(""),[o,c]=m.useState(!1),[d,u]=m.useState("");m.useEffect(()=>{const f=localStorage.getItem(`wallet_pin_${r}`);c(!!f)},[r]);const h=async()=>{if(a.length<4||a.length>6){u("PIN must be 4-6 digits");return}if(!/^\d+$/.test(a)){u("PIN must contain only numbers");return}if(a!==l){u("PINs do not match");return}try{const f=await hi(a);localStorage.setItem(`wallet_pin_${r}`,f),k.success("PIN set successfully"),t()}catch{u("Failed to set PIN")}},g=async()=>{if(!a){u("Please enter your PIN");return}try{const f=localStorage.getItem(`wallet_pin_${r}`);await hi(a)===f?(k.success("PIN verified"),t()):(u("Incorrect PIN"),n(""))}catch{u("Failed to verify PIN")}},y=f=>{f.preventDefault(),u(""),o?g():h()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-6 max-w-md w-full shadow-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:o?"Enter PIN":"Set PIN"}),e.jsx("p",{className:"text-gray-300 text-sm mb-6",children:o?"Enter your PIN to view the seed phrase":"Set a PIN to protect your seed phrase. This PIN will be required to view the seed."}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:o?"PIN":"Enter PIN (4-6 digits)"}),e.jsx("input",{type:"password",inputMode:"numeric",pattern:"[0-9]*",maxLength:"6",value:a,onChange:f=>{const w=f.target.value.replace(/\D/g,"");n(w),u("")},className:"w-full bg-gray-800 border border-gray-700 text-white rounded-lg p-3 text-center text-2xl tracking-widest focus:border-green-500 focus:ring-green-500/50",placeholder:"••••",autoFocus:!0})]}),!o&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Confirm PIN"}),e.jsx("input",{type:"password",inputMode:"numeric",pattern:"[0-9]*",maxLength:"6",value:l,onChange:f=>{const w=f.target.value.replace(/\D/g,"");i(w),u("")},className:"w-full bg-gray-800 border border-gray-700 text-white rounded-lg p-3 text-center text-2xl tracking-widest focus:border-green-500 focus:ring-green-500/50",placeholder:"••••"})]}),d&&e.jsx("div",{className:"text-red-400 text-sm bg-red-500/10 border border-red-500/30 rounded-lg p-3",children:d}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 bg-gray-800 text-gray-300 py-3 px-4 rounded-lg hover:bg-gray-700 transition-all duration-300",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!a||!o&&!l,className:"flex-1 bg-gradient-to-r from-green-600 to-green-500 text-white py-3 px-4 rounded-lg hover:from-green-500 hover:to-green-400 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-green-500/20 transition-all duration-300",children:o?"Verify":"Set PIN"})]})]}),o&&e.jsx("div",{className:"mt-4 p-3 bg-yellow-500/10 border border-yellow-500/30 rounded-lg",children:e.jsx("p",{className:"text-yellow-300 text-xs",children:"Forgot your PIN? You'll need to delete and re-import this wallet."})})]})})}function Bh({wallet:r,xrpPrice:t=2.5}){const[s,a]=m.useState(null),[n,l]=m.useState(!0),[i,o]=m.useState(!1);m.useEffect(()=>{r!=null&&r.address&&c()},[r]);const c=async()=>{if(r!=null&&r.address)try{l(!0);const g=await nn(r.address);a(g)}catch{}finally{l(!1)}},d=async()=>{if(!(r!=null&&r.seed)){k.error("Wallet seed not available");return}if(s.totalUnclaimed===0){k.error("No rewards to claim");return}try{o(!0);const g=await xl(r.address,r.seed);k.success(`Successfully claimed ${g.amount.toFixed(2)} XRP from ${g.rewardsCount} token creation${g.rewardsCount>1?"s":""}!`,{duration:5e3}),await c()}catch(g){k.error(g.message||"Failed to claim rewards")}finally{o(!1)}};if(n)return e.jsx("div",{className:"glass rounded-lg p-6",children:e.jsx("div",{className:"animate-pulse flex space-x-4",children:e.jsxs("div",{className:"flex-1 space-y-4 py-1",children:[e.jsx("div",{className:"h-4 bg-purple-500/20 rounded w-3/4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-purple-500/20 rounded"}),e.jsx("div",{className:"h-4 bg-purple-500/20 rounded w-5/6"})]})]})})});if(!s)return null;const u=s.totalRewards>0?s.totalUnclaimed/s.totalRewards*100:0,h=s.totalRewards>0?s.totalClaimed/s.totalRewards*100:0;return e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200",children:"Token Creation Rewards"}),e.jsx("p",{className:"text-purple-400 text-sm mt-1",children:"Earn 0.10 XRP for every token you create"})]}),s.totalUnclaimed>0&&e.jsx("button",{onClick:d,disabled:i,className:"relative px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold rounded-lg shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed animate-pulse-glow",style:{boxShadow:"0 0 20px rgba(16, 185, 129, 0.5), 0 0 40px rgba(16, 185, 129, 0.3)",animation:"glow 2s ease-in-out infinite"},children:i?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"animate-spin",children:"⏳"}),"Claiming..."]}):e.jsxs("span",{className:"flex items-center gap-2",children:["💰 Claim ",s.totalUnclaimed.toFixed(2)," XRP"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"glass-inner rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"Total Earned"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[s.totalRewards.toFixed(2)," XRP"]}),e.jsxs("div",{className:"text-green-400 text-xs mt-1",children:["$",(s.totalRewards*t).toFixed(2)," USD"]})]}),e.jsxs("div",{className:"glass-inner rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"Available to Claim"}),e.jsxs("div",{className:"text-2xl font-bold text-green-400",children:[s.totalUnclaimed.toFixed(2)," XRP"]}),e.jsxs("div",{className:"text-green-400 text-xs mt-1",children:["$",(s.totalUnclaimed*t).toFixed(2)," USD"]})]}),e.jsxs("div",{className:"glass-inner rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"Already Claimed"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-300",children:[s.totalClaimed.toFixed(2)," XRP"]}),e.jsxs("div",{className:"text-purple-400 text-xs mt-1",children:["$",(s.totalClaimed*t).toFixed(2)," USD"]})]}),e.jsxs("div",{className:"glass-inner rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"Tokens Created"}),e.jsx("div",{className:"text-2xl font-bold text-purple-200",children:s.tokenCount}),e.jsxs("div",{className:"text-purple-400 text-xs mt-1",children:[s.unclaimedRewards.length," pending"]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-purple-300",children:"Rewards Distribution"}),e.jsxs("span",{className:"text-purple-400",children:[u.toFixed(1),"% Unclaimed | ",h.toFixed(1),"% Claimed"]})]}),e.jsx("div",{className:"h-4 bg-purple-900/30 rounded-full overflow-hidden flex",children:s.totalRewards>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-emerald-600 transition-all duration-500",style:{width:`${u}%`},title:`${s.totalUnclaimed.toFixed(2)} XRP Unclaimed`}),e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-700 transition-all duration-500",style:{width:`${h}%`},title:`${s.totalClaimed.toFixed(2)} XRP Claimed`})]})}),e.jsxs("div",{className:"flex justify-between text-xs mt-2",children:[e.jsx("span",{className:"text-green-400",children:"💰 Unclaimed"}),e.jsx("span",{className:"text-purple-400",children:"✅ Claimed"})]})]}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsx("p",{className:"text-blue-300 text-sm font-medium mb-2",children:"ℹ️ How Token Creation Rewards Work:"}),e.jsxs("ul",{className:"text-blue-300/80 text-xs space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Earn 0.10 XRP instantly for each token you create"}),e.jsx("li",{children:"Rewards accumulate in your account automatically"}),e.jsx("li",{children:"Claim anytime with no fees - completely free"}),e.jsx("li",{children:"XRP is sent directly from the platform wallet to your connected wallet"}),e.jsx("li",{children:"Create more tokens to earn more rewards!"})]})]}),e.jsx("style",{children:`
        @keyframes glow {
          0%, 100% {
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.5), 0 0 40px rgba(16, 185, 129, 0.3);
          }
          50% {
            box-shadow: 0 0 30px rgba(16, 185, 129, 0.7), 0 0 60px rgba(16, 185, 129, 0.5);
          }
        }
      `})]})}function xi({wallet:r,xrpPrice:t=2.5}){const[s,a]=m.useState(null),[n,l]=m.useState(!0),[i,o]=m.useState(!1),[c,d]=m.useState(!1);m.useEffect(()=>{r!=null&&r.address&&u()},[r]);const u=async()=>{if(r!=null&&r.address)try{l(!0);const y=await nn(r.address);a(y)}catch{}finally{l(!1)}},h=()=>{d(!0)},g=async()=>{if(!(r!=null&&r.seed)&&!(r!=null&&r.encrypted_seed)){k.error("Wallet seed not available"),d(!1);return}if(s.totalUnclaimed===0){k.error("No rewards to claim"),d(!1);return}try{o(!0);const y=r.seed||r.encrypted_seed,f=await xl(r.address,y);k.success(`Successfully claimed ${f.amount.toFixed(2)} XRP from ${f.rewardsCount} token creation${f.rewardsCount>1?"s":""}!`,{duration:5e3}),d(!1),await u()}catch(y){k.error(y.message||"Failed to claim rewards"),d(!1)}finally{o(!1)}};return n?e.jsx("div",{className:"bg-purple-900/20 rounded-lg p-3",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-3 bg-purple-500/20 rounded w-2/3 mb-2"}),e.jsx("div",{className:"h-4 bg-purple-500/20 rounded w-1/2"})]})}):s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`bg-purple-900/20 border rounded-lg p-3 ${s.totalUnclaimed>0?"border-green-500/40":"border-purple-500/30"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-purple-400 text-xs",children:"XRP Rewards"}),e.jsxs("div",{className:`text-lg font-bold ${s.totalUnclaimed>0?"text-green-400":"text-purple-300"}`,children:[s.totalUnclaimed.toFixed(2)," XRP"]})]}),e.jsxs("button",{onClick:h,className:`w-full text-xs font-medium px-3 py-2 rounded transition-all ${s.totalUnclaimed>0?"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white":"bg-purple-600 hover:bg-purple-700 text-white"}`,style:{boxShadow:s.totalUnclaimed>0?"0 0 10px rgba(16, 185, 129, 0.3)":"none",animation:s.totalUnclaimed>0?"glow-pulse 2s ease-in-out infinite":"none"},children:["Claim ",s.totalUnclaimed.toFixed(2)," XRP"]}),s.totalRewards>0&&e.jsxs("div",{className:"text-purple-400 text-xs mt-2",children:["Total Earned: ",s.totalRewards.toFixed(2)," XRP (",s.tokenCount," tokens)"]})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:()=>d(!1),children:e.jsxs("div",{className:"glass rounded-lg max-w-md w-full p-8",onClick:y=>y.stopPropagation(),children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-4",children:"Claim Rewards"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"glass-inner rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Wallet"}),e.jsx("div",{className:"text-sm font-mono text-purple-200 break-all",children:r.address})]}),e.jsxs("div",{className:"glass-inner rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Amount to Claim"}),e.jsxs("div",{className:"text-3xl font-bold text-green-400",children:[s.totalUnclaimed.toFixed(2)," XRP"]}),e.jsxs("div",{className:"text-green-300 text-sm mt-1",children:["$",(s.totalUnclaimed*t).toFixed(2)," USD"]})]}),s.totalUnclaimed===0&&e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsx("p",{className:"text-yellow-300 text-sm",children:"No rewards available to claim. Create tokens on the Memes page to earn 0.10 XRP per token!"})}),s.totalUnclaimed>0&&e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:e.jsxs("p",{className:"text-blue-300 text-sm",children:[e.jsx("strong",{children:"Claiming Process:"}),e.jsx("br",{}),"- From ",s.unclaimedRewards.length," token creation",s.unclaimedRewards.length>1?"s":"",e.jsx("br",{}),"- No fees - completely free!",e.jsx("br",{}),"- Takes a few seconds to process"]})})]}),e.jsx("div",{className:"flex gap-3",children:s.totalUnclaimed>0?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:g,disabled:i,className:"flex-1 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold px-6 py-3 rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:i?"⏳ Claiming...":`💰 Claim ${s.totalUnclaimed.toFixed(2)} XRP`}),e.jsx("button",{onClick:()=>d(!1),disabled:i,className:"btn text-purple-300 px-6 py-3 rounded-lg font-medium disabled:opacity-50",children:"Cancel"})]}):e.jsx("button",{onClick:()=>d(!1),className:"flex-1 bg-purple-600 hover:bg-purple-700 text-white font-bold px-6 py-3 rounded-lg",children:"Close"})})]})}),e.jsx("style",{children:`
        @keyframes glow-pulse {
          0%, 100% {
            opacity: 0.3;
          }
          50% {
            opacity: 0.5;
          }
        }
      `})]}):null}function Xh(){const[r,t]=m.useState([]),[s,a]=m.useState(null),[n,l]=m.useState("list"),[i,o]=m.useState(""),[c,d]=m.useState(!1),[u,h]=m.useState(null),[g,y]=m.useState(!1),[f,w]=m.useState(!1),[b,P]=m.useState(!1),[A,_]=m.useState(null),[W,D]=m.useState(!1),[I,E]=m.useState(null),[G,_e]=m.useState("mainnet"),[ge,Ce]=m.useState(!1),[ue,J]=m.useState(null),[se,F]=m.useState(""),[X,me]=m.useState(!1),[ve,He]=m.useState(null),[pe,xe]=m.useState([]),[le,$e]=m.useState({name:"",address:"",seed:"",purpose:"trading",notes:""});m.useEffect(()=>{Y(),L()},[c]);const Ne=$=>{try{const be=localStorage.getItem("wallets"),tt=(be?JSON.parse(be):[]).map(nt=>nt.id===$.id?{...nt,is_favorite:!nt.is_favorite}:nt);localStorage.setItem("wallets",JSON.stringify(tt)),k.success($.is_favorite?"Removed from favorites":"Added to favorites"),Y()}catch{k.error("Failed to update favorite")}},q=($,be)=>{navigator.clipboard.writeText($),k.success(`${be} copied to clipboard!`)},ee=r.filter($=>$.name.toLowerCase().includes(i.toLowerCase())||$.address.toLowerCase().includes(i.toLowerCase())),L=()=>{const $=localStorage.getItem("connectedWallet");$&&a(JSON.parse($))},re=$=>{const be={...$,seed:$.encrypted_seed||$.seed};a(be),localStorage.setItem("connectedWallet",JSON.stringify(be)),k.success(`Connected to ${$.name}`),window.dispatchEvent(new Event("walletConnected"))},B=()=>{a(null),localStorage.removeItem("connectedWallet"),k.success("Wallet disconnected"),window.dispatchEvent(new Event("walletDisconnected"))},Y=async()=>{try{const $=localStorage.getItem("wallets");let be=$?JSON.parse($):[];c&&(be=be.filter(We=>We.is_favorite)),be.sort((We,tt)=>We.is_favorite!==tt.is_favorite?tt.is_favorite?1:-1:new Date(tt.created_at)-new Date(We.created_at)),t(be),oe(be)}catch{k.error("Failed to load wallets")}},oe=async $=>{var be;try{const{requestWithRetry:We}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),tt=localStorage.getItem("wallets"),nt=tt?JSON.parse(tt):[];for(const M of $)try{const fe=await We({command:"account_info",account:M.address,ledger_index:"validated"}),K=parseFloat(fe.result.account_data.Balance)/1e6;if(K!==M.balance_xrp){M.balance_xrp=K;const v=nt.findIndex(p=>p.id===M.id);v!==-1&&(nt[v].balance_xrp=K)}}catch(fe){if(((be=fe.data)==null?void 0:be.error)==="actNotFound"&&M.balance_xrp!==0){M.balance_xrp=0;const K=nt.findIndex(v=>v.id===M.id);K!==-1&&(nt[K].balance_xrp=0)}}localStorage.setItem("wallets",JSON.stringify(nt)),t([...$])}catch{}},ie=async()=>{if(!le.name||!le.address){k.error("Name and address are required");return}try{const $=localStorage.getItem("wallets"),be=$?JSON.parse($):[];if(A){const We=be.findIndex(tt=>tt.id===A.id);We!==-1&&(be[We]={...be[We],name:le.name,encrypted_seed:le.seed||A.encrypted_seed,purpose:le.purpose,notes:le.notes,updated_at:new Date().toISOString()}),k.success("Wallet updated successfully")}else{const We={id:Date.now().toString(),name:le.name,address:le.address,encrypted_seed:le.seed,purpose:le.purpose,notes:le.notes,network:le.address.startsWith("r")?"mainnet":"testnet",is_favorite:!1,balance_xrp:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};be.push(We),k.success("Wallet added successfully")}localStorage.setItem("wallets",JSON.stringify(be)),y(!1),_(null),$e({name:"",address:"",seed:"",purpose:"trading",notes:""}),Y()}catch{k.error("Failed to save wallet")}},ye=async $=>{if(confirm("Are you sure you want to delete this wallet?"))try{const be=localStorage.getItem("wallets"),tt=(be?JSON.parse(be):[]).filter(nt=>nt.id!==$);localStorage.setItem("wallets",JSON.stringify(tt)),k.success("Wallet deleted successfully"),Y()}catch{k.error("Failed to delete wallet")}},te=$=>{_($),$e({name:$.name,address:$.address,seed:"",purpose:$.purpose,notes:$.notes||""}),y(!0)},U=async()=>{D(!0),E(null);try{const{getClient:$}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),be=await $();k.success("Connected to XRPL");const We=Re.Wallet.generate();if(G==="testnet"){k.loading("Funding wallet with test XRP...");const tt=await be.fundWallet(We);k.dismiss(),k.success("Wallet funded with test XRP!")}E({address:We.address,seed:We.seed,publicKey:We.publicKey,privateKey:We.privateKey,network:G}),k.success("Wallet generated successfully!")}catch($){k.error("Failed to generate wallet: "+$.message)}finally{D(!1)}},ke=async $=>{if(!I||!$){k.error("Please provide a wallet name");return}try{const be=localStorage.getItem("wallets"),We=be?JSON.parse(be):[],tt={id:Date.now().toString(),name:$,address:I.address,encrypted_seed:I.seed,purpose:"trading",notes:`Generated on ${I.network}`,network:I.network,is_favorite:!1,balance_xrp:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};We.push(tt),localStorage.setItem("wallets",JSON.stringify(We)),k.success("Wallet saved successfully!"),w(!1),E(null),Y()}catch{k.error("Failed to save wallet")}},he=async()=>{var $;if(!se.trim()){k.error("Please enter a seed phrase");return}Ce(!0),J(null);try{let be;try{be=Re.Wallet.fromSeed(se.trim())}catch{throw new Error("Invalid seed phrase format")}let We=0,tt="mainnet";try{const{requestWithRetry:M}=await Pt(()=>Promise.resolve().then(()=>Lt),void 0),fe=await Promise.race([M({command:"account_info",account:be.address,ledger_index:"validated"}),new Promise((K,v)=>setTimeout(()=>v(new Error("Timeout fetching account info")),15e3))]);We=parseFloat(fe.result.account_data.Balance)/1e6}catch(M){(($=M.data)==null?void 0:$.error)==="actNotFound"||M.message,We=0}const nt={address:be.address,seed:be.seed,publicKey:be.publicKey,balance:We,network:tt};J(nt),k.success("Wallet imported successfully!")}catch(be){k.error(be.message||"Failed to import wallet"),J(null)}finally{Ce(!1)}},Oe=async $=>{if(!ue||!$){k.error("Please provide a wallet name");return}try{if(r.find(M=>M.address===ue.address)){k.error("This wallet address already exists!");return}const We=localStorage.getItem("wallets"),tt=We?JSON.parse(We):[],nt={id:Date.now().toString(),name:$,address:ue.address,encrypted_seed:ue.seed,purpose:"trading",notes:"Imported from seed",network:ue.network||"mainnet",balance_xrp:ue.balance,is_favorite:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};tt.push(nt),localStorage.setItem("wallets",JSON.stringify(tt)),re(nt),k.success("Wallet saved and connected successfully!"),P(!1),J(null),F(""),Y()}catch{k.error("Failed to save wallet")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-purple-200",children:"Wallet Management"}),e.jsx("p",{className:"text-purple-400 mt-1",children:"Manage your XRPL wallets"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>l("grid"),className:`px-4 py-2 rounded-lg transition-all ${n==="grid"?"bg-purple-600 text-white":"glass text-purple-300"}`,children:"▦ Grid"}),e.jsx("button",{onClick:()=>l("list"),className:`px-4 py-2 rounded-lg transition-all ${n==="list"?"bg-purple-600 text-white":"glass text-purple-300"}`,children:"☰ List"})]}),e.jsx("button",{onClick:()=>w(!0),className:"btn-primary text-white px-6 py-2 rounded-lg font-medium",children:"🎲 Generate Wallet"}),e.jsx("button",{onClick:()=>{F(""),J(null),P(!0)},className:"btn text-purple-300 px-6 py-2 rounded-lg font-medium",children:"📥 Import from Seed"}),e.jsx("button",{onClick:()=>{_(null),$e({name:"",address:"",seed:"",purpose:"trading",notes:""}),y(!0)},className:"btn text-purple-300 px-6 py-2 rounded-lg font-medium",children:"+ Add Existing"}),s&&e.jsx($h,{wallet:s,network:s.network||"testnet",tokenBalances:pe,onTrustlineUpdate:()=>{k.success("Trustlines updated")}})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-1 relative",children:e.jsx("input",{type:"text",value:i,onChange:$=>o($.target.value),placeholder:"🔍 Search wallets by name or address...",className:"input w-full text-purple-200 pl-4"})}),e.jsx("button",{onClick:()=>d(!c),className:`px-6 py-2 rounded-lg font-medium transition-all ${c?"bg-yellow-500 text-white":"glass text-purple-300 hover:text-yellow-400"}`,children:c?"⭐ Favorites Only":"☆ Show All"})]}),s&&e.jsx(Bh,{wallet:s,xrpPrice:2.5}),n==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:ee.map($=>e.jsxs("div",{className:"glass rounded-lg p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200",children:$.name}),e.jsx("button",{onClick:()=>Ne($),className:"text-xl hover:scale-110 transition-transform",children:$.is_favorite?"⭐":"☆"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block px-3 py-1 rounded-full text-xs font-medium bg-purple-500/20 text-purple-300",children:$.purpose}),e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-medium ${$.network==="mainnet"?"bg-green-500/20 text-green-300":"bg-blue-500/20 text-blue-300"}`,children:$.network==="mainnet"?"🌐 Mainnet":"🧪 Testnet"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>te($),className:"text-purple-400 hover:text-purple-300",children:"✏️"}),e.jsx("button",{onClick:()=>ye($.id),className:"text-red-400 hover:text-red-300",children:"🗑️"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-purple-400 text-xs mb-1 flex items-center justify-between",children:[e.jsx("span",{children:"Address"}),e.jsx("button",{onClick:()=>q($.address,"Address"),className:"text-purple-400 hover:text-purple-300",children:"📋"})]}),e.jsx("div",{className:"text-purple-200 text-sm font-mono bg-black/30 p-2 rounded break-all",children:$.address})]}),$.encrypted_seed&&e.jsxs("div",{children:[e.jsxs("div",{className:"text-purple-400 text-xs mb-1 flex items-center justify-between",children:[e.jsx("span",{children:"Seed"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{if(u===$.id)h(null);else{const We=localStorage.getItem(`wallet_pin_${$.address}`);He($),me(!0)}},className:"text-purple-400 hover:text-purple-300",children:u===$.id?"🙈":"👁️"}),u===$.id&&e.jsx("button",{onClick:()=>q($.encrypted_seed,"Seed"),className:"text-purple-400 hover:text-purple-300",children:"📋"})]})]}),e.jsx("div",{className:"text-purple-200 text-sm font-mono bg-black/30 p-2 rounded break-all",children:u===$.id?$.encrypted_seed:"••••••••••••••••"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"Balance"}),e.jsxs("div",{className:"text-purple-200 text-lg font-bold",children:[$.balance_xrp||0," XRP"]})]}),$.notes&&e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"Notes"}),e.jsx("div",{className:"text-purple-300 text-sm",children:$.notes})]}),e.jsx(xi,{wallet:$,xrpPrice:2.5})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-purple-500/20",children:[e.jsxs("div",{className:"text-purple-500 text-xs",children:["Added: ",new Date($.created_at).toLocaleDateString()]}),(s==null?void 0:s.id)===$.id?e.jsx("button",{onClick:B,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-medium text-sm",children:"Disconnect"}):e.jsx("button",{onClick:()=>re($),className:"btn-primary text-white px-4 py-2 rounded-lg font-medium text-sm",children:"Connect"})]})]},$.id))}):e.jsx("div",{className:"glass rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-purple-900/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-purple-300 font-medium",children:"Fav"}),e.jsx("th",{className:"text-left px-6 py-4 text-purple-300 font-medium",children:"Name"}),e.jsx("th",{className:"text-left px-6 py-4 text-purple-300 font-medium",children:"Network"}),e.jsx("th",{className:"text-left px-6 py-4 text-purple-300 font-medium",children:"Address"}),e.jsx("th",{className:"text-left px-6 py-4 text-purple-300 font-medium",children:"Seed"}),e.jsx("th",{className:"text-left px-6 py-4 text-purple-300 font-medium",children:"Purpose"}),e.jsx("th",{className:"text-left px-6 py-4 text-purple-300 font-medium",children:"Balance"}),e.jsx("th",{className:"text-left px-6 py-4 text-purple-300 font-medium",children:"Rewards"}),e.jsx("th",{className:"text-left px-6 py-4 text-purple-300 font-medium",children:"Connection"}),e.jsx("th",{className:"text-left px-6 py-4 text-purple-300 font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:ee.map($=>e.jsxs("tr",{className:"border-t border-purple-500/20 hover:bg-purple-900/20",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("button",{onClick:()=>Ne($),className:"text-xl hover:scale-110 transition-transform",children:$.is_favorite?"⭐":"☆"})}),e.jsx("td",{className:"px-6 py-4 text-purple-200 font-medium",children:$.name}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${$.network==="mainnet"?"bg-green-500/20 text-green-300":"bg-blue-500/20 text-blue-300"}`,children:$.network==="mainnet"?"🌐":"🧪"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-purple-300 font-mono text-sm",children:[$.address.slice(0,15),"..."]}),e.jsx("button",{onClick:()=>q($.address,"Address"),className:"text-purple-400 hover:text-purple-300",children:"📋"})]})}),e.jsx("td",{className:"px-6 py-4",children:$.encrypted_seed&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-purple-300 font-mono text-sm",children:u===$.id?$.encrypted_seed.slice(0,15)+"...":"••••••••"}),e.jsx("button",{onClick:()=>{u===$.id?h(null):(He($),me(!0))},className:"text-purple-400 hover:text-purple-300",children:u===$.id?"🙈":"👁️"}),u===$.id&&e.jsx("button",{onClick:()=>q($.encrypted_seed,"Seed"),className:"text-purple-400 hover:text-purple-300",children:"📋"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-purple-500/20 text-purple-300",children:$.purpose})}),e.jsxs("td",{className:"px-6 py-4 text-purple-200 font-bold",children:[$.balance_xrp||0," XRP"]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"max-w-xs",children:e.jsx(xi,{wallet:$,xrpPrice:2.5})})}),e.jsx("td",{className:"px-6 py-4",children:(s==null?void 0:s.id)===$.id?e.jsx("button",{onClick:B,className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm",children:"Disconnect"}):e.jsx("button",{onClick:()=>re($),className:"btn-primary text-white px-3 py-1 rounded text-sm",children:"Connect"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>te($),className:"text-purple-400 hover:text-purple-300",children:"✏️"}),e.jsx("button",{onClick:()=>ye($.id),className:"text-red-400 hover:text-red-300",children:"🗑️"})]})})]},$.id))})]})}),g&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-lg p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-6",children:A?"Edit Wallet":"Add New Wallet"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Wallet Name *"}),e.jsx("input",{type:"text",value:le.name,onChange:$=>$e({...le,name:$.target.value}),className:"input w-full text-purple-200",placeholder:"My Trading Wallet"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Wallet Address *"}),e.jsx("input",{type:"text",value:le.address,onChange:$=>$e({...le,address:$.target.value}),className:"input w-full text-purple-200 font-mono",placeholder:"rXXXXXXXXXXXXXXXXXXXXXXXXXXXX",disabled:A})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-purple-300 mb-2",children:["Seed ",A?"(leave empty to keep current)":"(optional)"]}),e.jsx("input",{type:"password",value:le.seed,onChange:$=>$e({...le,seed:$.target.value}),className:"input w-full text-purple-200 font-mono",placeholder:"sXXXXXXXXXXXXXXXXXXXXXXXXXXXX"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Purpose"}),e.jsxs("select",{value:le.purpose,onChange:$=>$e({...le,purpose:$.target.value}),className:"input w-full text-purple-200",children:[e.jsx("option",{value:"trading",children:"Trading"}),e.jsx("option",{value:"issuer",children:"Token Issuer"}),e.jsx("option",{value:"receiver",children:"Token Receiver"}),e.jsx("option",{value:"hodl",children:"HODL"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Notes"}),e.jsx("textarea",{value:le.notes,onChange:$=>$e({...le,notes:$.target.value}),className:"input w-full text-purple-200 h-24",placeholder:"Additional notes about this wallet..."})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsxs("button",{onClick:ie,className:"btn-primary text-white px-6 py-2 rounded-lg font-medium flex-1",children:[A?"Update":"Add"," Wallet"]}),e.jsx("button",{onClick:()=>{y(!1),_(null),$e({name:"",address:"",seed:"",purpose:"trading",notes:""})},className:"btn text-purple-300 px-6 py-2 rounded-lg font-medium",children:"Cancel"})]})]})}),r.length===0&&e.jsxs("div",{className:"glass rounded-lg p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"💼"}),e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-2",children:"No Wallets Yet"}),e.jsx("p",{className:"text-purple-400",children:"Generate or add your first wallet to get started"})]}),f&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"glass rounded-lg p-8 max-w-2xl w-full",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-6",children:"Generate New XRPL Wallet"}),I?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"text-green-400 text-xl",children:"✓"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-green-300 mb-1",children:"Wallet Generated Successfully!"}),e.jsxs("div",{className:"text-green-200/80 text-sm",children:["Your new ",I.network," wallet has been created. Save your seed phrase securely!"]})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-400 text-sm mb-2",children:"Wallet Address"}),e.jsx("div",{className:"input text-purple-200 font-mono text-sm break-all",children:I.address})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-400 text-sm mb-2",children:"Seed Phrase (Secret Key)"}),e.jsx("div",{className:"input text-red-400 font-mono text-sm break-all bg-red-500/10 border-red-500/30",children:I.seed}),e.jsx("div",{className:"text-red-400 text-xs mt-2",children:"⚠️ Keep this secret! Anyone with this can access your wallet."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-400 text-sm mb-2",children:"Public Key"}),e.jsx("div",{className:"input text-purple-300 font-mono text-xs break-all",children:I.publicKey})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-400 text-sm mb-2",children:"Network"}),e.jsx("div",{className:"input text-purple-200 uppercase",children:I.network})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Wallet Name *"}),e.jsx("input",{type:"text",id:"walletName",className:"input w-full text-purple-200",placeholder:"My Trading Wallet"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{const $=document.getElementById("walletName").value;ke($)},className:"btn-primary text-white px-6 py-3 rounded-lg font-medium flex-1",children:"💾 Save Wallet"}),e.jsx("button",{onClick:()=>{confirm("Are you sure? Make sure you've saved your seed phrase!")&&(w(!1),E(null))},className:"btn text-purple-300 px-6 py-3 rounded-lg font-medium",children:"Close"})]}),e.jsx("div",{className:"bg-purple-500/10 border border-purple-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"text-purple-300 text-sm",children:[e.jsx("div",{className:"font-medium mb-2",children:"📋 Next Steps:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[e.jsx("li",{children:"Copy and securely store your seed phrase"}),e.jsx("li",{children:"Save this wallet to your list"}),I.network==="mainnet"&&e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"Send at least 2 XRP to activate the wallet (10-20 XRP recommended)"}),e.jsx("li",{children:"Budget 0.01 XRP per token trade and 5 XRP per trading bot"})]}),e.jsx("li",{children:"Start using your new wallet!"})]})]})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-3 font-medium",children:"Select Network"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>_e("testnet"),className:`p-4 rounded-lg border-2 transition-all ${G==="testnet"?"border-purple-500 bg-purple-500/20":"border-purple-500/30 bg-purple-900/20 hover:border-purple-500/50"}`,children:[e.jsx("div",{className:"text-xl mb-2",children:"🧪"}),e.jsx("div",{className:"font-bold text-purple-200",children:"Testnet"}),e.jsx("div",{className:"text-sm text-purple-400 mt-1",children:"Free test XRP included"})]}),e.jsxs("button",{onClick:()=>_e("mainnet"),className:`p-4 rounded-lg border-2 transition-all ${G==="mainnet"?"border-purple-500 bg-purple-500/20":"border-purple-500/30 bg-purple-900/20 hover:border-purple-500/50"}`,children:[e.jsx("div",{className:"text-xl mb-2",children:"🌐"}),e.jsx("div",{className:"font-bold text-purple-200",children:"Mainnet"}),e.jsx("div",{className:"text-sm text-purple-400 mt-1",children:"Production network"})]})]})]}),G==="testnet"?e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"text-yellow-400 text-xl",children:"⚠️"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-yellow-300 mb-1",children:"Important"}),e.jsx("div",{className:"text-yellow-200/80 text-sm",children:"Testnet wallets receive free test XRP automatically. This is for testing only."})]})]})}):e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"text-yellow-400 text-xl",children:"⚠️"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-yellow-300 mb-2",children:"XRP Requirements for Mainnet"}),e.jsxs("div",{className:"text-yellow-200/80 text-sm space-y-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Wallet Activation:"})," 2 XRP minimum required to activate your wallet"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Token Trading:"})," 0.01 XRP per buy or sell transaction"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Trading Bots:"})," 5 XRP per bot (unlimited bots supported)"]}),e.jsxs("div",{className:"pt-2 border-t border-yellow-500/30 mt-2",children:[e.jsx("strong",{children:"Recommendation:"})," Send at least 10-20 XRP to your wallet for comfortable trading and platform usage."]})]})]})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:U,disabled:W,className:"btn-primary text-white px-6 py-3 rounded-lg font-medium flex-1 disabled:opacity-50",children:W?"🔄 Generating...":"🎲 Generate Wallet"}),e.jsx("button",{onClick:()=>{w(!1),E(null)},className:"btn text-purple-300 px-6 py-3 rounded-lg font-medium",disabled:W,children:"Cancel"})]})]})]})}),b&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:()=>P(!1),children:e.jsxs("div",{className:"glass rounded-lg max-w-2xl w-full p-8",onClick:$=>$.stopPropagation(),children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-6",children:"Import Wallet from Seed"}),ue?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"text-green-400 text-2xl",children:"✓"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-green-400 font-medium mb-1",children:"Wallet Imported Successfully!"}),e.jsx("div",{className:"text-green-300 text-sm",children:"Please review the details and save this wallet."})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-400 text-sm mb-2",children:"Wallet Address"}),e.jsxs("div",{className:"input text-purple-200 font-mono break-all flex items-center justify-between gap-2",children:[e.jsx("span",{children:ue.address}),e.jsx("button",{onClick:()=>q(ue.address,"Address"),className:"btn text-purple-300 px-2 py-1 text-xs rounded",children:"📋"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-400 text-sm mb-2",children:"Public Key"}),e.jsx("div",{className:"input text-purple-300 font-mono text-xs break-all",children:ue.publicKey})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-400 text-sm mb-2",children:"Current Balance"}),e.jsxs("div",{className:"input text-purple-200",children:[ue.balance," XRP"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Wallet Name *"}),e.jsx("input",{type:"text",id:"importWalletName",className:"input w-full text-purple-200",placeholder:"My Imported Wallet"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{const $=document.getElementById("importWalletName").value;Oe($)},className:"btn-primary text-white px-6 py-3 rounded-lg font-medium flex-1",children:"💾 Save Wallet"}),e.jsx("button",{onClick:()=>{P(!1),J(null),F("")},className:"btn text-purple-300 px-6 py-3 rounded-lg font-medium",children:"Cancel"})]}),e.jsx("div",{className:"bg-purple-500/10 border border-purple-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"text-purple-300 text-sm",children:[e.jsx("div",{className:"font-medium mb-2",children:"📋 Next Steps:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[e.jsx("li",{children:"Verify the wallet address and balance"}),e.jsx("li",{children:"Give your wallet a memorable name"}),e.jsx("li",{children:"Save the wallet to your list"}),e.jsx("li",{children:"Start managing your tokens!"})]})]})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"text-yellow-400 text-xl",children:"⚠️"}),e.jsxs("div",{className:"flex-1 text-yellow-200 text-sm",children:[e.jsx("div",{className:"font-medium mb-1",children:"Security Warning"}),e.jsx("div",{children:"Never share your seed phrase with anyone. Make sure you're in a secure environment."})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Seed Phrase *"}),e.jsx("textarea",{value:se,onChange:$=>F($.target.value),className:"input w-full text-purple-200 font-mono h-24",placeholder:"sXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",autoFocus:!0}),e.jsx("p",{className:"text-purple-400 text-xs mt-1",children:"Enter your XRPL seed phrase (starts with 's')"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:he,disabled:ge||!se.trim(),className:"btn-primary text-white px-6 py-3 rounded-lg font-medium flex-1 disabled:opacity-50",children:ge?"🔄 Importing...":"📥 Import Wallet"}),e.jsx("button",{onClick:()=>{P(!1),F("")},disabled:ge,className:"btn text-purple-300 px-6 py-3 rounded-lg font-medium disabled:opacity-50",children:"Cancel"})]}),e.jsx("div",{className:"bg-purple-500/10 border border-purple-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"text-purple-300 text-sm",children:[e.jsx("div",{className:"font-medium mb-2",children:"ℹ️ About Importing"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"This will import an existing XRPL wallet using its seed phrase"}),e.jsx("li",{children:"The wallet will be checked on the mainnet network"}),e.jsx("li",{children:"Your seed phrase is securely stored locally in your browser"}),e.jsx("li",{children:"You'll get full control over the imported wallet"})]})]})})]})]})}),X&&ve&&e.jsx(Oh,{walletAddress:ve.address,onSuccess:()=>{h(ve.id),He(null),me(!1)},onCancel:()=>{He(null),me(!1)}})]})}function Uh(){const[r,t]=m.useState([]),[s,a]=m.useState([]),[n,l]=m.useState([]),[i,o]=m.useState(""),[c,d]=m.useState("");m.useState(null),m.useEffect(()=>{u()},[]);const u=async()=>{var P,A;try{const[_,W,D]=await Promise.all([S.from("meme_tokens").select("*").order("created_at",{ascending:!1}),S.from("wallets").select("*").order("created_at",{ascending:!1}),S.from("activity_logs").select("*").order("created_at",{ascending:!1})]);if(_.error)throw _.error;if(W.error)throw W.error;if(D.error)throw D.error;t(_.data||[]),a(W.data||[]),l(D.data||[]),W.data&&W.data.length>=2&&(o(((P=W.data[0])==null?void 0:P.id)||""),d(((A=W.data[1])==null?void 0:A.id)||""))}catch{k.error("Failed to load data")}},h=async()=>{try{const P={tokens:r,wallets:s.map(D=>({...D,encrypted_seed:D.encrypted_seed?"***ENCRYPTED***":null})),activityLogs:n,settings:{issuer:i,receiver:c},stats:{totalTokens:r.length,totalWallets:s.length,totalActivities:n.length,activePools:r.filter(D=>D.amm_pool_created).length,totalXRPLocked:r.reduce((D,I)=>D+(I.amm_xrp_amount||0),0)},exportDate:new Date().toISOString(),version:"2.0"},A=new Blob([JSON.stringify(P,null,2)],{type:"application/json"}),_=URL.createObjectURL(A),W=document.createElement("a");W.href=_,W.download=`memekings-export-${Date.now()}.json`,document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(_),k.success("Data exported successfully!")}catch{k.error("Failed to export data")}},g=()=>{try{const P=["Token Name","Issuer Address","Supply","Market Cap (XRP)","XRP Locked","Status","Created"],A=r.map(E=>{const G=E.amm_pool_created&&E.amm_xrp_amount&&E.amm_asset_amount?(E.supply*(E.amm_xrp_amount/E.amm_asset_amount)).toFixed(4):"0";return[E.token_name,E.issuer_address,E.supply,G,E.amm_xrp_amount||0,E.amm_pool_created?"Active":"Pending",new Date(E.created_at).toLocaleString()]}),_=[P,...A].map(E=>E.join(",")).join(`
`),W=new Blob([_],{type:"text/csv"}),D=URL.createObjectURL(W),I=document.createElement("a");I.href=D,I.download=`memekings-tokens-${Date.now()}.csv`,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(D),k.success("Tokens exported to CSV!")}catch{k.error("Failed to export CSV")}},y=async P=>{var _,W;const A=P.target.files[0];if(A)try{const D=await A.text(),I=JSON.parse(D);if(!I.tokens)throw new Error("Invalid data format - missing tokens");const E=((_=I.activityLogs)==null?void 0:_.length)||0,G=((W=I.wallets)==null?void 0:W.length)||0;if(!confirm(`Import Data Summary:
• ${I.tokens.length} tokens
• ${G} wallets
• ${E} activity logs

This will add to your existing data. Continue?`))return;const ge=[];I.tokens&&I.tokens.length>0&&ge.push(S.from("meme_tokens").upsert(I.tokens,{onConflict:"id"})),I.wallets&&I.wallets.length>0&&ge.push(S.from("wallets").upsert(I.wallets,{onConflict:"id"})),I.activityLogs&&I.activityLogs.length>0&&ge.push(S.from("activity_logs").upsert(I.activityLogs,{onConflict:"id"}));const ue=(await Promise.all(ge)).filter(J=>J.error);if(ue.length>0)throw new Error("Some imports failed: "+ue.map(J=>J.error.message).join(", "));k.success(`Imported successfully!
${I.tokens.length} tokens, ${G} wallets, ${E} activities`),u()}catch(D){k.error("Failed to import data: "+D.message)}},f=async()=>{if(!(!confirm(`WARNING: This will delete ALL tokens, wallets, and activity logs!

This action cannot be undone. Are you sure?`)||!confirm("Are you ABSOLUTELY sure? This will delete everything!")))try{await Promise.all([S.from("meme_tokens").delete().neq("id","00000000-0000-0000-0000-000000000000"),S.from("wallets").delete().neq("id","00000000-0000-0000-0000-000000000000"),S.from("activity_logs").delete().neq("id","00000000-0000-0000-0000-000000000000")]),localStorage.clear(),k.success("All data cleared!"),u()}catch{k.error("Failed to clear data")}},w=s.find(P=>P.id===i),b=s.find(P=>P.id===c);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-purple-200",children:"Setup & Configuration"}),e.jsx("p",{className:"text-purple-400 mt-1",children:"Manage your MEMEKINGS settings and data"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"Token Creation Wallets"}),e.jsx("p",{className:"text-purple-400 text-sm mb-4",children:"Default wallets used for automatic token creation"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Issuer Wallet (Creates Tokens)"}),e.jsx("div",{className:"input w-full text-purple-400 bg-purple-900/20 cursor-not-allowed",children:w?`${w.address}`:"No issuer wallet set"}),w&&e.jsxs("div",{className:"mt-2 text-xs text-purple-400",children:["Balance: ",w.balance_xrp||0," XRP"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-purple-300 mb-2",children:"Receiver Wallet (Receives Tokens)"}),e.jsx("div",{className:"input w-full text-purple-400 bg-purple-900/20 cursor-not-allowed",children:b?`${b.address}`:"No receiver wallet set"}),b&&e.jsxs("div",{className:"mt-2 text-xs text-purple-400",children:["Balance: ",b.balance_xrp||0," XRP"]})]}),s.length<2&&e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"text-yellow-400 text-xl",children:"⚠️"}),e.jsx("div",{className:"flex-1 text-yellow-200 text-sm",children:"You need at least 2 wallets to create tokens. Go to Wallet Management to add or generate wallets."})]})})]})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"Data Statistics"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-purple-900/20 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-300",children:"Total Tokens"}),e.jsx("span",{className:"text-2xl font-bold text-purple-200",children:r.length})]})}),e.jsx("div",{className:"p-4 bg-purple-900/20 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-300",children:"Total Wallets"}),e.jsx("span",{className:"text-2xl font-bold text-purple-200",children:s.length})]})}),e.jsx("div",{className:"p-4 bg-purple-900/20 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-300",children:"Active Pools"}),e.jsx("span",{className:"text-2xl font-bold text-purple-200",children:r.filter(P=>P.amm_pool_created).length})]})}),e.jsx("div",{className:"p-4 bg-purple-900/20 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-300",children:"Total XRP Locked"}),e.jsx("span",{className:"text-2xl font-bold text-purple-200",children:r.reduce((P,A)=>P+(A.amm_xrp_amount||0),0).toFixed(2)})]})}),e.jsx("div",{className:"p-4 bg-purple-900/20 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-purple-300",children:"Activity Logs"}),e.jsx("span",{className:"text-2xl font-bold text-purple-200",children:n.length})]})})]})]})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"Export Data"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("button",{onClick:h,className:"btn-primary text-white px-6 py-3 rounded-lg font-medium",children:"📦 Export All Data (JSON)"}),e.jsx("button",{onClick:g,className:"btn text-purple-300 px-6 py-3 rounded-lg font-medium",children:"📊 Export Tokens (CSV)"}),e.jsx("button",{onClick:()=>{const P=JSON.stringify(s,null,2),A=new Blob([P],{type:"application/json"}),_=URL.createObjectURL(A),W=document.createElement("a");W.href=_,W.download=`wallets-${Date.now()}.json`,W.click(),URL.revokeObjectURL(_),k.success("Wallets exported!")},className:"btn text-purple-300 px-6 py-3 rounded-lg font-medium",children:"💼 Export Wallets (JSON)"}),e.jsx("button",{onClick:()=>{const P=JSON.stringify(n,null,2),A=new Blob([P],{type:"application/json"}),_=URL.createObjectURL(A),W=document.createElement("a");W.href=_,W.download=`activity-logs-${Date.now()}.json`,W.click(),URL.revokeObjectURL(_),k.success("Activity logs exported!")},className:"btn text-purple-300 px-6 py-3 rounded-lg font-medium",children:"📜 Export Activity Logs (JSON)"})]}),e.jsx("p",{className:"text-purple-400 text-sm mt-3",children:'Export your data for backup or migration purposes. "Export All Data" includes everything.'})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"Import Data"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"btn text-purple-300 px-6 py-3 rounded-lg font-medium cursor-pointer inline-block",children:["📥 Import JSON File",e.jsx("input",{type:"file",accept:".json",onChange:y,className:"hidden"})]})}),e.jsx("p",{className:"text-purple-400 text-sm",children:"Import previously exported data. This will add to your existing data without deleting anything."})]})]}),e.jsxs("div",{className:"glass rounded-lg p-6 border-2 border-red-500/30",children:[e.jsx("h3",{className:"text-xl font-bold text-red-400 mb-4",children:"Danger Zone"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-red-500/10 rounded-lg p-4",children:[e.jsx("h4",{className:"text-red-300 font-bold mb-2",children:"Clear All Data"}),e.jsx("p",{className:"text-red-200/80 text-sm mb-3",children:"This will permanently delete all tokens, wallets, and settings. This action cannot be undone!"}),e.jsx("button",{onClick:f,className:"bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg font-medium",children:"🗑️ Clear All Data"})]})})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"Local Storage Info"}),e.jsxs("div",{className:"space-y-2 text-sm text-purple-300",children:[e.jsx("p",{children:"• Wallet settings are saved locally in your browser"}),e.jsx("p",{children:"• Token and wallet data is stored in Supabase database"}),e.jsx("p",{children:"• Export your data regularly for backup"}),e.jsx("p",{children:"• Clearing browser data will remove local settings only"})]})]})]})}const el={WALLET:[{id:"check_balance",label:"Check my XRP balance",prompt:"What is my current XRP balance?"},{id:"wallet_info",label:"Show wallet information",prompt:"Show me detailed information about my connected wallet"},{id:"wallet_history",label:"View transaction history",prompt:"Show my recent transaction history"},{id:"send_xrp",label:"Send XRP to an address",prompt:"I want to send XRP to another wallet"},{id:"send_token",label:"Send tokens",prompt:"I want to send tokens from my wallet"},{id:"receive_token",label:"Receive tokens",prompt:"Show me my wallet address to receive tokens"},{id:"trustline_setup",label:"Setup trustline",prompt:"Help me setup a trustline for a token"},{id:"wallet_assets",label:"View all wallet assets",prompt:"Show me all tokens and assets in my wallet"},{id:"wallet_reserve",label:"Check wallet reserve",prompt:"What is my wallet reserve requirement?"},{id:"export_wallet",label:"Export wallet details",prompt:"Export my wallet information"}],TOKENS:[{id:"token_list",label:"List all tokens",prompt:"Show me all available tokens"},{id:"token_search",label:"Search for a token",prompt:"I want to search for a specific token"},{id:"token_details",label:"Get token details",prompt:"Show me detailed information about a token"},{id:"token_price",label:"Check token price",prompt:"What is the current price of a token?"},{id:"token_holders",label:"View token holders",prompt:"Show me who holds a specific token"},{id:"token_supply",label:"Check token supply",prompt:"What is the total supply of a token?"},{id:"my_tokens",label:"View my tokens",prompt:"Show me all tokens I own"},{id:"token_stats",label:"Token statistics",prompt:"Show me statistics for a token"},{id:"token_performance",label:"Token performance",prompt:"How is a token performing?"},{id:"token_comparison",label:"Compare tokens",prompt:"Compare two tokens for me"}],TRADING:[{id:"buy_token",label:"Buy a token",prompt:"I want to buy tokens"},{id:"sell_token",label:"Sell a token",prompt:"I want to sell my tokens"},{id:"swap_tokens",label:"Swap tokens",prompt:"I want to swap one token for another"},{id:"trade_history",label:"View trade history",prompt:"Show me my recent trades"},{id:"open_orders",label:"View open orders",prompt:"Show me my open orders"},{id:"cancel_order",label:"Cancel an order",prompt:"I want to cancel an order"},{id:"trade_analyze",label:"Analyze trade",prompt:"Analyze my trading performance"},{id:"best_price",label:"Find best price",prompt:"Find the best price for a token"},{id:"price_alert",label:"Set price alert",prompt:"Set a price alert for a token"},{id:"slippage_settings",label:"Adjust slippage",prompt:"Help me adjust my slippage settings"}],LIQUIDITY:[{id:"add_liquidity",label:"Add liquidity",prompt:"I want to add liquidity to a pool"},{id:"remove_liquidity",label:"Remove liquidity",prompt:"I want to remove liquidity from a pool"},{id:"pool_stats",label:"Pool statistics",prompt:"Show me statistics for a liquidity pool"},{id:"pool_apr",label:"Check pool APR",prompt:"What is the APR for a pool?"},{id:"my_pools",label:"My liquidity positions",prompt:"Show me my liquidity positions"},{id:"pool_earnings",label:"Pool earnings",prompt:"How much have I earned from pools?"},{id:"best_pools",label:"Best pools",prompt:"Which pools have the best returns?"},{id:"pool_history",label:"Pool history",prompt:"Show me the history of a pool"},{id:"impermanent_loss",label:"Check impermanent loss",prompt:"Calculate my impermanent loss"},{id:"pool_share",label:"My pool share",prompt:"What is my share of a pool?"}],BOT_TRADING:[{id:"create_bot",label:"Create trading bot",prompt:"I want to create a new trading bot"},{id:"bot_status",label:"Check bot status",prompt:"What is the status of my trading bots?"},{id:"bot_performance",label:"Bot performance",prompt:"How are my bots performing?"},{id:"bot_trades",label:"View bot trades",prompt:"Show me trades executed by my bots"},{id:"stop_bot",label:"Stop a bot",prompt:"Stop a trading bot"},{id:"bot_settings",label:"Adjust bot settings",prompt:"I want to adjust my bot settings"},{id:"bot_strategy",label:"Change bot strategy",prompt:"Change the strategy for my bot"},{id:"bot_profits",label:"Bot profits",prompt:"How much profit have my bots made?"},{id:"bot_errors",label:"Check bot errors",prompt:"Show me any errors from my bots"},{id:"bot_analytics",label:"Bot analytics",prompt:"Show me detailed analytics for my bots"}],MARKET:[{id:"xrp_price",label:"XRP Price (USD)",prompt:"What is the price of XRP?"},{id:"market_overview",label:"Market overview",prompt:"Give me a market overview"},{id:"top_gainers",label:"Top gainers",prompt:"Show me the top gaining tokens"},{id:"top_losers",label:"Top losers",prompt:"Show me the biggest losing tokens"},{id:"trending_tokens",label:"Trending tokens",prompt:"What tokens are trending right now?"},{id:"market_cap",label:"Market cap rankings",prompt:"Show me tokens ranked by market cap"},{id:"volume_leaders",label:"Volume leaders",prompt:"Which tokens have the highest volume?"},{id:"new_tokens",label:"New tokens",prompt:"Show me recently created tokens"},{id:"market_sentiment",label:"Market sentiment",prompt:"What is the current market sentiment?"},{id:"price_changes",label:"24h price changes",prompt:"Show me 24 hour price changes"},{id:"market_alerts",label:"Market alerts",prompt:"Show me any market alerts"}],ANALYTICS:[{id:"portfolio_value",label:"Portfolio value",prompt:"What is my total portfolio value?"},{id:"portfolio_breakdown",label:"Portfolio breakdown",prompt:"Break down my portfolio by asset"},{id:"profit_loss",label:"Profit & Loss",prompt:"Show me my profit and loss"},{id:"performance_chart",label:"Performance chart",prompt:"Show me a performance chart"},{id:"roi_calculation",label:"Calculate ROI",prompt:"Calculate my return on investment"},{id:"asset_allocation",label:"Asset allocation",prompt:"Show me my asset allocation"},{id:"transaction_summary",label:"Transaction summary",prompt:"Summarize my transactions"},{id:"tax_report",label:"Tax report",prompt:"Generate a tax report"},{id:"historical_data",label:"Historical data",prompt:"Show me historical data"},{id:"export_data",label:"Export analytics",prompt:"Export my analytics data"}],TOKEN_CREATION:[{id:"create_token",label:"Create new token",prompt:"I want to create a new token"},{id:"token_wizard",label:"Token creation wizard",prompt:"Guide me through creating a token"},{id:"upload_metadata",label:"Upload token metadata",prompt:"Help me upload token metadata"},{id:"set_supply",label:"Set token supply",prompt:"How do I set the token supply?"},{id:"token_settings",label:"Configure token settings",prompt:"Help me configure my token settings"},{id:"deploy_token",label:"Deploy token",prompt:"I'm ready to deploy my token"},{id:"verify_token",label:"Verify token",prompt:"How do I verify my token?"},{id:"token_branding",label:"Add token branding",prompt:"Help me add branding to my token"},{id:"token_icon",label:"Upload token icon",prompt:"I want to upload an icon for my token"},{id:"token_whitepaper",label:"Create whitepaper",prompt:"Help me create a whitepaper"}],PLATFORM:[{id:"navigate_dashboard",label:"Go to Dashboard",prompt:"Take me to the dashboard"},{id:"navigate_trade",label:"Go to Trade",prompt:"Take me to the trading page"},{id:"navigate_pools",label:"Go to Pools",prompt:"Take me to the pools page"},{id:"navigate_vault",label:"Go to Vault",prompt:"Take me to the vault"},{id:"navigate_analytics",label:"Go to Analytics",prompt:"Take me to analytics"},{id:"platform_stats",label:"Platform statistics",prompt:"Show me platform statistics"},{id:"recent_activity",label:"Recent activity",prompt:"Show me recent platform activity"},{id:"notifications",label:"View notifications",prompt:"Show me my notifications"},{id:"settings",label:"Open settings",prompt:"Open platform settings"},{id:"help_center",label:"Help center",prompt:"I need help with something"}],XRPL:[{id:"xrp_price",label:"XRP price",prompt:"What is the current XRP price?"},{id:"xrpl_status",label:"XRPL network status",prompt:"What is the status of the XRPL network?"},{id:"ledger_info",label:"Ledger information",prompt:"Show me current ledger information"},{id:"transaction_cost",label:"Transaction costs",prompt:"What are the current transaction costs?"},{id:"network_stats",label:"Network statistics",prompt:"Show me XRPL network statistics"},{id:"validators",label:"Validator information",prompt:"Show me information about validators"},{id:"xrpl_explorer",label:"Open XRPL explorer",prompt:"Open the XRPL explorer"},{id:"ripple_news",label:"Ripple news",prompt:"What's the latest news about Ripple?"},{id:"xrpl_docs",label:"XRPL documentation",prompt:"I need XRPL documentation"},{id:"network_upgrades",label:"Network upgrades",prompt:"Are there any upcoming network upgrades?"}]};function Wh(){return Object.entries(el).flatMap(([r,t])=>t.map(s=>({...s,category:r})))}function qh(r){const t=r.toLowerCase();return Wh().filter(s=>s.label.toLowerCase().includes(t)||s.prompt.toLowerCase().includes(t))}function Hh({onSelectCommand:r,onClose:t}){const[s,a]=m.useState("WALLET"),[n,l]=m.useState(""),[i,o]=m.useState(""),[c,d]=m.useState(null),u=m.useRef(null);m.useEffect(()=>{const b=P=>{u.current&&!u.current.contains(P.target)&&t()};return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[t]);const h=Object.keys(el),g=n?qh(n):el[s]||[],y=b=>{d(b),o(b.prompt)},f=()=>{i.trim()&&(r(i.trim()),t())},w=b=>{r(b),t()};return e.jsxs("div",{ref:u,className:"absolute bottom-full left-0 right-0 mb-2 rounded-xl border border-purple-500/50 shadow-2xl shadow-purple-500/30 overflow-hidden animate-slideUp",style:{maxHeight:"70vh",background:"linear-gradient(135deg, rgba(88, 28, 135, 0.98), rgba(59, 7, 100, 0.98))",backdropFilter:"blur(24px)"},children:[e.jsx("div",{className:"p-4 border-b border-purple-500/30 bg-purple-900/40",children:e.jsx("input",{type:"text",value:n,onChange:b=>l(b.target.value),placeholder:"Search commands...",className:"w-full bg-purple-950/60 border border-purple-500/40 rounded-lg px-4 py-2 text-white placeholder-purple-400/60 focus:outline-none focus:border-purple-400/60 focus:ring-2 focus:ring-purple-500/30"})}),e.jsxs("div",{className:"flex h-[400px]",children:[e.jsx("div",{className:"w-48 border-r border-purple-500/30 overflow-y-auto bg-purple-900/30",children:h.map(b=>e.jsx("button",{onClick:()=>{a(b),l("")},className:`w-full text-left px-4 py-3 transition-all duration-200 ${s===b?"bg-purple-600/50 text-white border-r-2 border-purple-400":"text-purple-200 hover:bg-purple-800/40"}`,children:e.jsx("div",{className:"font-medium text-sm",children:b.replace("_"," ")})},b))}),e.jsx("div",{className:"flex-1 overflow-y-auto p-2 bg-purple-900/20",children:g.length>0?e.jsx("div",{className:"space-y-1",children:g.map(b=>e.jsxs("div",{className:`group rounded-lg transition-all duration-200 ${(c==null?void 0:c.id)===b.id?"bg-purple-600/40 border border-purple-500/40":"hover:bg-purple-800/30 border border-transparent"}`,children:[e.jsxs("button",{onClick:()=>y(b),className:"w-full text-left px-3 py-2",children:[e.jsx("div",{className:"font-medium text-white text-sm",children:b.label}),e.jsx("div",{className:"text-purple-300/80 text-xs mt-0.5 line-clamp-1",children:b.prompt})]}),e.jsx("button",{onClick:()=>w(b.prompt),className:"w-full text-center px-3 py-1.5 text-xs text-purple-200 hover:text-white border-t border-purple-500/20 opacity-0 group-hover:opacity-100 transition-opacity bg-purple-800/20",children:"Quick Send ➤"})]},b.id))}):e.jsx("div",{className:"flex items-center justify-center h-full text-purple-300/60",children:"No commands found"})})]}),c&&e.jsxs("div",{className:"border-t border-purple-500/30 p-4 bg-purple-900/50",children:[e.jsx("div",{className:"mb-2 text-xs text-purple-200 font-medium",children:"Edit prompt before sending:"}),e.jsx("textarea",{value:i,onChange:b=>o(b.target.value),className:"w-full bg-purple-950/60 border border-purple-500/40 rounded-lg px-3 py-2 text-white text-sm resize-none focus:outline-none focus:border-purple-400/60 focus:ring-2 focus:ring-purple-500/30",rows:"3"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("button",{onClick:f,className:"flex-1 px-4 py-2 bg-gradient-to-r from-purple-600 to-blue-600 hover:shadow-lg hover:shadow-purple-500/50 text-white rounded-lg font-medium transition-all duration-200",children:"Send Command"}),e.jsx("button",{onClick:()=>{d(null),o("")},className:"px-4 py-2 bg-purple-800/40 hover:bg-purple-800/60 text-purple-200 rounded-lg font-medium transition-all duration-200 border border-purple-500/30",children:"Cancel"})]})]}),e.jsxs("div",{className:"px-4 py-2 bg-purple-900/60 border-t border-purple-500/30 flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-purple-300/80",children:[g.length," commands available"]}),e.jsx("button",{onClick:t,className:"text-xs text-purple-300 hover:text-purple-100 transition-colors",children:"Close (Esc)"})]})]})}function Vh({onSend:r,disabled:t}){const[s,a]=m.useState(""),[n,l]=m.useState(!1),i=m.useRef(null);m.useEffect(()=>{const y=f=>{f.key==="Escape"&&n&&l(!1)};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[n]);const o=[{label:"💰 Check balance",prompt:"Check my wallet balance"}],c=y=>{y.preventDefault(),s.trim()&&!t&&(r(s.trim()),a(""),i.current&&(i.current.style.height="auto"))},d=y=>{y.key==="Enter"&&!y.shiftKey&&(y.preventDefault(),c(y))},u=y=>{a(y.target.value),y.target.style.height="auto",y.target.style.height=Math.min(y.target.scrollHeight,150)+"px"},h=y=>{t||r(y)},g=y=>{t||r(y)};return e.jsxs("div",{className:"space-y-3 relative",children:[n&&e.jsx(Hh,{onSelectCommand:g,onClose:()=>l(!1)}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.map((y,f)=>e.jsx("button",{onClick:()=>h(y.prompt),disabled:t,className:"px-3 py-1.5 bg-purple-900/30 hover:bg-purple-900/50 text-purple-200 rounded-full text-xs font-medium transition-all duration-200 border border-purple-500/20 disabled:opacity-50 disabled:cursor-not-allowed hover:scale-105 hover:shadow-lg hover:shadow-purple-500/20",children:y.label},f)),e.jsx("button",{onClick:()=>l(!n),disabled:t,className:"px-3 py-1.5 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-500 hover:to-blue-500 text-white rounded-full text-xs font-medium transition-all duration-200 border border-purple-500/30 disabled:opacity-50 disabled:cursor-not-allowed hover:scale-105 hover:shadow-lg hover:shadow-purple-500/30",children:"⚡ All Commands (100+)"})]}),e.jsxs("form",{onSubmit:c,className:"flex gap-2",children:[e.jsx("textarea",{ref:i,value:s,onChange:u,onKeyDown:d,placeholder:"Ask me anything about XRPL, tokens, trading, or the platform...",disabled:t,rows:"1",className:"flex-1 bg-purple-900/20 border border-purple-500/30 rounded-lg px-4 py-3 text-white placeholder-purple-400/50 focus:outline-none focus:border-purple-500/50 focus:ring-2 focus:ring-purple-500/20 disabled:opacity-50 disabled:cursor-not-allowed resize-none overflow-hidden transition-all duration-200",style:{minHeight:"48px",maxHeight:"150px"}}),e.jsxs("button",{type:"submit",disabled:t||!s.trim(),className:"px-6 bg-gradient-to-r from-purple-600 to-blue-600 hover:shadow-lg hover:shadow-purple-500/50 text-white rounded-lg font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:shadow-none hover:scale-105",children:[e.jsx("span",{className:"hidden sm:inline",children:"Send"}),e.jsx("span",{className:"sm:hidden",children:"➤"})]})]}),e.jsx("div",{className:"flex items-center justify-center gap-2 text-xs text-purple-400/60",children:e.jsx("span",{children:"💡 Press Enter to send • Shift+Enter for new line • Esc to close dropdown"})})]})}function zh(){const[r,t]=m.useState([]),[s,a]=m.useState(!1),[n,l]=m.useState(null),i=m.useRef(null),o=m.useRef(new Ro);m.useEffect(()=>{d(),u();const b=P=>{y(P.detail)};return window.addEventListener("sendAIMessage",b),()=>{window.removeEventListener("sendAIMessage",b)}},[]),m.useEffect(()=>{c()},[r]);const c=()=>{var b;(b=i.current)==null||b.scrollIntoView({behavior:"smooth"})},d=()=>{const b=localStorage.getItem("ai_chat_session");if(b)l(b);else{const P=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;l(P),localStorage.setItem("ai_chat_session",P)}},u=async()=>{try{const{data:b,error:P}=await S.from("ai_chat_messages").select("*").order("created_at",{ascending:!0}).limit(50);if(P)throw P;b&&b.length>0?t(b.map(A=>({id:A.id,role:A.role,content:A.content,timestamp:new Date(A.created_at),data:A.metadata}))):h()}catch{h()}},h=()=>{const b={id:`welcome_${Date.now()}`,role:"assistant",content:`Hello! I'm your advanced XRPL command-based AI assistant. I can execute commands directly! Try:

**Natural Language Commands:**
• "SEND rXXX... 15 XRP" - Send XRP instantly
• "BUY 1000 ORANGE" - Buy tokens
• "SELL 500 BANANA" - Sell tokens
• "CHECK BALANCE" - View your balance
• "PRICE OF BANANA" - Get token price
• "SETUP TRUSTLINE ORANGE" - Add trustline

**Quick Actions:**
• "Send 100 APPLE to rXXX..." - Send tokens
• "What's my balance?" - Check wallet
• "Show top tokens" - Market data
• "Trade history" - View trades

Just type naturally or use the commands above. What would you like to do?`,timestamp:new Date,data:null};t([b])},g=async b=>{try{await S.from("ai_chat_messages").insert({session_id:n,role:b.role,content:b.content,metadata:b.data||null})}catch{}},y=async b=>{const P={id:`user_${Date.now()}`,role:"user",content:b,timestamp:new Date,data:null};t(A=>[...A,P]),await g(P),a(!0);try{const A=await o.current.processMessage(b),_={id:`assistant_${Date.now()}`,role:"assistant",content:A.content,timestamp:new Date,data:A.data||null};t(W=>[...W,_]),await g(_)}catch{const _={id:`error_${Date.now()}`,role:"assistant",content:"I apologize, but I encountered an error processing your request. Please try again.",timestamp:new Date,data:null};t(W=>[...W,_])}finally{a(!1)}},f=async()=>{if(window.confirm("Are you sure you want to clear the chat history?"))try{await S.from("ai_chat_messages").delete().eq("session_id",n),t([]),h(),k.success("Chat history cleared")}catch{k.error("Failed to clear chat history")}},w=()=>{const b=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;l(b),localStorage.setItem("ai_chat_session",b),t([]),h(),k.success("New chat session started")};return e.jsxs("div",{className:"flex flex-col",style:{height:"calc(100vh - 140px)"},children:[e.jsx("div",{className:"glass rounded-t-xl p-4 sm:p-6 border-b border-purple-500/20 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-blue-600 rounded-lg flex items-center justify-center animate-pulse",children:e.jsx("span",{className:"text-2xl",children:"🤖"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"AI Chat Assistant"}),e.jsx("p",{className:"text-purple-300/80 text-sm",children:"Your intelligent XRPL companion"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:w,className:"px-3 py-2 bg-purple-600/20 hover:bg-purple-600/30 text-purple-300 rounded-lg transition-all duration-200 text-sm border border-purple-500/30 hover:scale-105",children:"New Chat"}),e.jsx("button",{onClick:f,className:"px-3 py-2 bg-red-600/20 hover:bg-red-600/30 text-red-300 rounded-lg transition-all duration-200 text-sm border border-red-500/30 hover:scale-105",children:"Clear"})]})]})}),e.jsx("div",{className:"flex-1 glass p-4 sm:p-6 overflow-y-auto",style:{minHeight:0},children:e.jsxs("div",{className:"space-y-4",children:[r.map((b,P)=>e.jsx("div",{className:"animate-fadeInUp",style:{animationDelay:`${P*50}ms`},children:e.jsx(Ao,{message:b})},b.id)),s&&e.jsxs("div",{className:"flex items-start gap-3 animate-fadeInUp",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-purple-500 to-blue-600 rounded-full flex items-center justify-center flex-shrink-0 animate-pulse",children:e.jsx("span",{className:"text-sm",children:"🤖"})}),e.jsx("div",{className:"flex-1 bg-purple-900/30 rounded-lg p-4 border border-purple-500/20",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})]}),e.jsx("div",{ref:i})]})}),e.jsx("div",{className:"glass rounded-b-xl p-4 border-t border-purple-500/20 flex-shrink-0",children:e.jsx(Vh,{onSend:y,disabled:s})})]})}function Kh({isOpen:r,onClose:t,recipient:s,connectedWallet:a,nickname:n,currentStream:l}){const[i,o]=m.useState([]),[c,d]=m.useState(null),[u,h]=m.useState(""),[g,y]=m.useState(!1),[f,w]=m.useState("0"),[b,P]=m.useState(!1);m.useEffect(()=>{r&&a&&A()},[r,a]);const A=async()=>{if(!(a!=null&&a.address)){k.error("No wallet connected");return}try{const D=a.network||"testnet",I=new Re.Client(D==="mainnet"?"wss://xrplcluster.com":"wss://s.altnet.rippletest.net:51233");await I.connect();const E=await I.request({command:"account_info",account:a.address,ledger_index:"validated"}),G=parseFloat(E.result.account_data.Balance)/1e6,ge=Math.max(0,G-10);w(ge.toFixed(4));const ue=(await I.request({command:"account_lines",account:a.address,ledger_index:"validated"})).result.lines||[];o(ue),d({currency:"XRP",balance:ge,issuer:"XRP"}),await I.disconnect()}catch(D){k.error("Failed to load wallet assets: "+D.message)}},_=async()=>{if(!c||!u||parseFloat(u)<=0){k.error("Please enter a valid amount");return}if(parseFloat(u)>parseFloat(c.balance)){k.error("Insufficient balance");return}if(!(a!=null&&a.seed)){k.error("Wallet seed not available. Please reconnect your wallet.");return}y(!0);try{const D=a.network||"testnet",I=new Re.Client(D==="mainnet"?"wss://xrplcluster.com":"wss://s.altnet.rippletest.net:51233");await I.connect();const E=Re.Wallet.fromSeed(a.seed);let G;c.currency==="XRP"?G={TransactionType:"Payment",Account:E.address,Destination:s.wallet_address,Amount:String(Math.floor(parseFloat(u)*1e6)),Fee:"12"}:G={TransactionType:"Payment",Account:E.address,Destination:s.wallet_address,Amount:{currency:c.currency,issuer:c.account||c.issuer,value:u},Fee:"12"};const _e=await I.autofill(G),ge=E.sign(_e),Ce=await I.submitAndWait(ge.tx_blob);if(Ce.result.meta.TransactionResult==="tesSUCCESS"){if(k.success(`Sent ${u} ${c.currency} to ${s.nickname}!`),l){await S.from("stream_tips").insert([{stream_id:l.id,from_wallet:a.address,from_nickname:n,to_wallet:s.wallet_address,to_nickname:s.nickname,currency:c.currency,amount:parseFloat(u),tx_hash:Ce.result.hash}]);const{data:ue}=await S.from("live_streams").select("total_tips").eq("id",l.id).maybeSingle(),se=parseFloat((ue==null?void 0:ue.total_tips)||0)+parseFloat(u);await S.from("live_streams").update({total_tips:se}).eq("id",l.id);const{data:F}=await S.from("chat_rooms").select("id").eq("type","general").maybeSingle();F&&await S.from("chat_messages").insert([{room_id:F.id,wallet_address:a.address,nickname:n,message_type:"tip",content:`sent ${u} ${c.currency} to ${s.nickname}! 💸`,tip_data:{type:"tip",amount:parseFloat(u),currency:c.currency,to_nickname:s.nickname,to_wallet:s.wallet_address,tx_hash:Ce.result.hash}}])}t(),h("")}else k.error("Transaction failed: "+Ce.result.meta.TransactionResult);await I.disconnect()}catch(D){k.error("Failed to send tip: "+D.message)}finally{y(!1)}};if(!r||!s)return null;const W=[{currency:"XRP",balance:f,issuer:"XRP"},...i.map(D=>({currency:D.currency,balance:D.balance,account:D.account}))];return e.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-purple-900 via-slate-900 to-purple-900 rounded-2xl p-8 max-w-lg w-full border-2 border-yellow-500/30 shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-3xl",children:"💸"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Send Tip"})]}),e.jsx("button",{onClick:t,className:"text-purple-400 hover:text-purple-200 transition-colors text-3xl leading-none",children:"×"})]}),e.jsx("div",{className:"mb-6 p-5 bg-gradient-to-r from-purple-800/40 to-slate-800/40 rounded-xl border border-yellow-500/20",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-green-500 to-emerald-600 flex items-center justify-center text-white font-bold text-lg",children:(n==null?void 0:n.charAt(0).toUpperCase())||"Y"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-xs text-purple-400 font-semibold mb-1",children:"FROM"}),e.jsx("div",{className:"text-white font-bold",children:n||"You"}),e.jsx("div",{className:"text-purple-300 text-xs truncate font-mono",children:a==null?void 0:a.address})]})]}),e.jsx("div",{className:"text-yellow-400 text-2xl mx-4",children:"→"}),e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white font-bold text-lg",children:s.nickname.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-xs text-purple-400 font-semibold mb-1",children:"TO"}),e.jsx("div",{className:"text-white font-bold",children:s.nickname}),e.jsx("div",{className:"text-purple-300 text-xs truncate font-mono",children:s.wallet_address})]})]})]})}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-white font-bold mb-3 text-sm",children:"SELECT TOKEN"}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>P(!b),className:"w-full bg-slate-800/70 text-white px-4 py-4 rounded-xl focus:outline-none focus:ring-2 focus:ring-yellow-500 border border-purple-500/30 flex items-center justify-between hover:border-yellow-500/50 transition-all",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-2xl",children:(c==null?void 0:c.currency)==="XRP"?"💎":"🪙"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-bold",children:(c==null?void 0:c.currency)||"Select Token"}),e.jsx("div",{className:"text-green-400 text-sm",children:c?`${parseFloat(c.balance).toFixed(4)} available`:""})]})]}),e.jsx("svg",{className:"w-5 h-5 text-purple-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),b&&e.jsx("div",{className:"absolute z-10 w-full mt-2 bg-slate-800 rounded-xl border border-purple-500/30 shadow-2xl max-h-64 overflow-y-auto",children:W.map((D,I)=>e.jsxs("button",{onClick:()=>{d(D),P(!1)},disabled:parseFloat(D.balance)<=0,className:`w-full p-4 flex items-center justify-between hover:bg-purple-800/50 transition-all border-b border-purple-500/10 last:border-b-0 ${parseFloat(D.balance)<=0?"opacity-50 cursor-not-allowed":""} ${(c==null?void 0:c.currency)===D.currency?"bg-purple-800/50":""}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-2xl",children:D.currency==="XRP"?"💎":"🪙"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-white font-bold",children:D.currency}),D.currency!=="XRP"&&D.account&&e.jsxs("div",{className:"text-purple-400 text-xs truncate max-w-[200px]",children:[D.account.slice(0,12),"..."]})]})]}),e.jsx("div",{className:"text-green-400 font-bold",children:parseFloat(D.balance).toFixed(4)})]},I))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-white font-bold mb-3 text-sm",children:"AMOUNT"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:u,onChange:D=>h(D.target.value),placeholder:"0.00",step:"0.01",min:"0",max:c==null?void 0:c.balance,className:"w-full bg-slate-800/70 text-white text-3xl px-6 py-4 rounded-xl focus:outline-none focus:ring-2 focus:ring-yellow-500 border border-purple-500/30 text-center font-bold"}),c&&e.jsx("div",{className:"absolute right-6 top-1/2 -translate-y-1/2 text-purple-400 font-bold text-lg",children:c.currency})]}),c&&e.jsxs("div",{className:"flex justify-between items-center mt-3 text-sm",children:[e.jsxs("div",{className:"text-purple-400",children:["Available: ",e.jsx("span",{className:"text-green-400 font-bold",children:parseFloat(c.balance).toFixed(4)})]}),e.jsx("button",{onClick:()=>h(c.balance),className:"text-yellow-400 hover:text-yellow-300 font-bold",children:"Max"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-8",children:[e.jsx("button",{onClick:t,className:"flex-1 bg-slate-700/50 hover:bg-slate-700/70 text-white py-4 rounded-xl font-bold transition-all",children:"Cancel"}),e.jsx("button",{onClick:_,disabled:!c||!u||parseFloat(u)<=0||g,className:"flex-1 bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-500 hover:to-orange-500 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed text-white py-4 rounded-xl font-bold transition-all shadow-lg",children:g?"💸 Sending...":`💸 Send ${u||"0"} ${(c==null?void 0:c.currency)||""}`})]})]})]})})}const fi="rphatRpwXcPAo7CVm46dC78JAQ6kLMqb2M";function Gh({onViewStream:r,connectedWallet:t}){const[s,a]=m.useState([]),[n,l]=m.useState([]),[i,o]=m.useState("all"),[c,d]=m.useState(""),[u,h]=m.useState("viewers"),[g,y]=m.useState("grid");m.useEffect(()=>{f(),w(),b();const _=setInterval(w,1e4);return()=>clearInterval(_)},[]);const f=async()=>{const{data:_}=await S.from("stream_categories").select("*").order("name",{ascending:!0});_&&l(_)},w=async()=>{let _=S.from("live_streams").select("*").eq("is_active",!0);i!=="all"&&(_=_.eq("category",i));const{data:W,error:D}=await _.order("started_at",{ascending:!1});if(!D&&W){const I=new Map;W.forEach(G=>{if(!I.has(G.wallet_address))I.set(G.wallet_address,G);else{const _e=I.get(G.wallet_address);new Date(G.started_at)>new Date(_e.started_at)&&I.set(G.wallet_address,G)}});let E=Array.from(I.values());c&&(E=E.filter(G=>G.nickname.toLowerCase().includes(c.toLowerCase())||G.title.toLowerCase().includes(c.toLowerCase()))),u==="viewers"?E.sort((G,_e)=>_e.viewer_count-G.viewer_count):u==="tips"?E.sort((G,_e)=>parseFloat(_e.total_tips)-parseFloat(G.total_tips)):u==="crowns"?E.sort((G,_e)=>_e.crown_count-G.crown_count):u==="recent"&&E.sort((G,_e)=>new Date(_e.started_at)-new Date(G.started_at)),a(E)}},b=()=>{const _=S.channel("live_streams_feed").on("postgres_changes",{event:"*",schema:"public",table:"live_streams"},()=>{w()}).subscribe();return()=>{S.removeChannel(_)}};m.useEffect(()=>{w()},[i,c,u]);const P=_=>new Date(_).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),A=_=>{const W=Math.floor((new Date-new Date(_))/6e4);if(W<60)return`${W}m`;const D=Math.floor(W/60),I=W%60;return`${D}h ${I}m`};return e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"p-6 bg-purple-900/20 backdrop-blur-xl border-b border-purple-500/20",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-purple-200",children:"Live Streams"}),e.jsxs("p",{className:"text-purple-400 text-sm mt-1",children:[s.length," channels live"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>y("grid"),className:`p-2 rounded-lg transition-all ${g==="grid"?"bg-purple-600 text-white":"bg-purple-800/30 text-purple-400 hover:text-purple-200"}`,children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),e.jsx("button",{onClick:()=>y("list"),className:`p-2 rounded-lg transition-all ${g==="list"?"bg-purple-600 text-white":"bg-purple-800/30 text-purple-400 hover:text-purple-200"}`,children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[e.jsx("div",{className:"flex-1 min-w-[300px]",children:e.jsx("input",{type:"text",value:c,onChange:_=>d(_.target.value),placeholder:"Search streams...",className:"w-full bg-purple-800/30 text-purple-100 px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 border border-purple-500/20 placeholder-purple-400/50"})}),e.jsxs("select",{value:u,onChange:_=>h(_.target.value),className:"bg-purple-800/30 text-purple-100 px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 border border-purple-500/20",children:[e.jsx("option",{value:"viewers",children:"Most Viewers"}),e.jsx("option",{value:"tips",children:"Most Tips"}),e.jsx("option",{value:"crowns",children:"Most Crowns"}),e.jsx("option",{value:"recent",children:"Recently Started"})]})]})]})}),e.jsx("div",{className:"px-6 py-4 bg-purple-900/10 border-b border-purple-500/20 overflow-x-auto",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex gap-2",children:[e.jsx("button",{onClick:()=>o("all"),className:`px-4 py-2 rounded-lg font-medium whitespace-nowrap transition-all ${i==="all"?"bg-purple-600 text-white":"bg-purple-800/30 text-purple-300 hover:bg-purple-800/50"}`,children:"🌟 All"}),n.map(_=>e.jsxs("button",{onClick:()=>o(_.name),className:`px-4 py-2 rounded-lg font-medium whitespace-nowrap transition-all ${i===_.name?"bg-purple-600 text-white":"bg-purple-800/30 text-purple-300 hover:bg-purple-800/50"}`,children:[_.icon," ",_.name]},_.id))]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:s.length===0?e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"text-6xl mb-4",children:"📡"}),e.jsx("div",{className:"text-purple-400 text-xl",children:"No live streams found"}),e.jsx("div",{className:"text-purple-500 text-sm mt-2",children:"Try adjusting your filters"})]}):g==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:s.map(_=>e.jsxs("button",{onClick:()=>r(_),className:"bg-purple-800/30 rounded-lg overflow-hidden border border-purple-500/20 hover:border-purple-500/50 transition-all group",children:[e.jsxs("div",{className:"aspect-video bg-black relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"text-6xl",children:"📹"})}),e.jsxs("div",{className:"absolute top-2 right-2 flex items-center gap-2 bg-red-500 px-3 py-1 rounded",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),e.jsx("span",{className:"text-white font-bold text-xs",children:"LIVE"})]}),e.jsx("div",{className:"absolute top-2 left-2 bg-purple-900/90 backdrop-blur-xl px-3 py-1 rounded",children:e.jsxs("span",{className:"text-green-400 font-bold text-xs",children:["💸 ",parseFloat(_.total_tips).toFixed(2)]})}),e.jsx("div",{className:"absolute bottom-2 left-2 bg-black/80 backdrop-blur-xl px-2 py-1 rounded text-xs text-white font-medium",children:A(_.started_at)})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white font-bold flex-shrink-0",children:_.nickname.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1 text-left min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-purple-200 font-bold truncate",children:_.nickname}),_.wallet_address===fi&&e.jsx("span",{className:"text-yellow-400 text-sm",children:"👑"})]}),e.jsx("div",{className:"text-purple-400 text-xs truncate",children:_.title})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-3 text-purple-300",children:[e.jsxs("span",{children:["👥 ",_.viewer_count]}),e.jsxs("span",{children:["👑 ",_.crown_count]})]}),e.jsx("div",{className:"bg-purple-700/50 px-2 py-1 rounded text-purple-200",children:_.category})]})]})]},_.id))}):e.jsx("div",{className:"space-y-3",children:s.map(_=>e.jsxs("button",{onClick:()=>r(_),className:"w-full bg-purple-800/30 rounded-lg p-4 border border-purple-500/20 hover:border-purple-500/50 transition-all group flex items-center gap-4",children:[e.jsxs("div",{className:"w-48 h-28 bg-black rounded-lg flex-shrink-0 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"text-4xl",children:"📹"})}),e.jsxs("div",{className:"absolute top-2 right-2 flex items-center gap-1 bg-red-500 px-2 py-0.5 rounded text-xs",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full animate-pulse"}),e.jsx("span",{className:"text-white font-bold",children:"LIVE"})]})]}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white font-bold",children:_.nickname.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-purple-200 font-bold text-lg",children:_.nickname}),_.wallet_address===fi&&e.jsx("span",{className:"text-yellow-400",children:"👑"})]}),e.jsx("div",{className:"text-purple-400 text-sm",children:_.title})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-3",children:[e.jsx("div",{className:"bg-purple-700/50 px-3 py-1 rounded text-purple-200 text-sm",children:_.category}),e.jsxs("div",{className:"text-purple-300 text-sm",children:["👥 ",_.viewer_count," viewers"]}),e.jsxs("div",{className:"text-purple-300 text-sm",children:["👑 ",_.crown_count," crowns"]}),e.jsxs("div",{className:"text-green-400 text-sm font-bold",children:["💸 ",parseFloat(_.total_tips).toFixed(2)," XRP"]}),e.jsxs("div",{className:"text-purple-400 text-sm ml-auto",children:["Started ",P(_.started_at)]})]})]})]},_.id))})})})]})}function Jh(){const[r,t]=m.useState({totalStreams:0,activeStreams:0,totalViewers:0,totalTips:0,totalCrowns:0,totalSessions:0,avgSessionDuration:0,totalStreamTime:0,topStreamers:[],topCategories:[],recentTips:[],tokenBreakdown:[],sessionsToday:0,tipsToday:0,crownsToday:0,peakConcurrentViewers:0,avgTipsPerSession:0,avgCrownsPerSession:0,topTippers:[]});m.useEffect(()=>{s()},[]);const s=async()=>{const{data:l}=await S.from("live_streams").select("*").eq("is_active",!0),i=(l==null?void 0:l.length)||0,o=(l==null?void 0:l.reduce((pe,xe)=>pe+xe.viewer_count,0))||0,c=(l==null?void 0:l.reduce((pe,xe)=>pe+parseFloat(xe.total_tips),0))||0,d=(l==null?void 0:l.reduce((pe,xe)=>pe+xe.crown_count,0))||0,u=(l==null?void 0:l.reduce((pe,xe)=>Math.max(pe,xe.peak_viewers||0),0))||0,{data:h}=await S.from("live_streams").select("*"),g=(h==null?void 0:h.length)||0,{data:y}=await S.from("stream_sessions").select("*"),f=(y==null?void 0:y.length)||0,w=(y==null?void 0:y.reduce((pe,xe)=>pe+(xe.duration_seconds||0),0))||0,b=f>0?Math.floor(w/f):0,P=new Date;P.setHours(0,0,0,0);const A=(y==null?void 0:y.filter(pe=>new Date(pe.started_at)>=P).length)||0,{data:_}=await S.from("stream_tips").select("amount").gte("created_at",P.toISOString()),W=(_==null?void 0:_.reduce((pe,xe)=>pe+parseFloat(xe.amount),0))||0,{data:D}=await S.from("stream_reactions").select("*").gte("created_at",P.toISOString()),I=(D==null?void 0:D.length)||0,E=[...l||[]].sort((pe,xe)=>parseFloat(xe.total_tips)-parseFloat(pe.total_tips)).slice(0,10).map(pe=>({...pe,totalSessions:(y==null?void 0:y.filter(xe=>xe.streamer_wallet===pe.wallet_address).length)||0,totalStreamTime:(y==null?void 0:y.filter(xe=>xe.streamer_wallet===pe.wallet_address).reduce((xe,le)=>xe+(le.duration_seconds||0),0))||0})),G={},_e={},ge={};l==null||l.forEach(pe=>{G[pe.category]=(G[pe.category]||0)+1,_e[pe.category]=(_e[pe.category]||0)+pe.crown_count,ge[pe.category]=(ge[pe.category]||0)+parseFloat(pe.total_tips)});const Ce=Object.entries(G).sort((pe,xe)=>xe[1]-pe[1]).slice(0,5).map(([pe,xe])=>({name:pe,count:xe,crowns:_e[pe]||0,tips:ge[pe]||0})),{data:ue}=await S.from("stream_tips").select("*").order("created_at",{ascending:!1}).limit(20),J={};ue==null||ue.forEach(pe=>{const xe=pe.currency;J[xe]||(J[xe]={currency:xe,total:0,count:0}),J[xe].total+=parseFloat(pe.amount),J[xe].count+=1});const se=Object.values(J).sort((pe,xe)=>xe.total-pe.total),F=f>0?((y==null?void 0:y.reduce((pe,xe)=>pe+parseFloat(xe.total_tips||0),0))||0)/f:0,X=f>0?((y==null?void 0:y.reduce((pe,xe)=>pe+(xe.total_crowns||0),0))||0)/f:0,{data:me}=await S.from("stream_tips").select("from_wallet, from_nickname, amount, currency"),ve={};me==null||me.forEach(pe=>{ve[pe.from_wallet]||(ve[pe.from_wallet]={wallet:pe.from_wallet,nickname:pe.from_nickname,total:0,count:0}),ve[pe.from_wallet].total+=parseFloat(pe.amount),ve[pe.from_wallet].count+=1});const He=Object.values(ve).sort((pe,xe)=>xe.total-pe.total).slice(0,10);t({totalStreams:g,activeStreams:i,totalViewers:o,totalTips:c,totalCrowns:d,totalSessions:f,avgSessionDuration:b,totalStreamTime:w,topStreamers:E,topCategories:Ce,recentTips:ue||[],tokenBreakdown:se,sessionsToday:A,tipsToday:W,crownsToday:I,peakConcurrentViewers:u,avgTipsPerSession:F,avgCrownsPerSession:X,topTippers:He})},a=l=>{const i=Math.floor(l/3600),o=Math.floor(l%3600/60);return i>0?`${i}h ${o}m`:`${o}m`},n=l=>new Date(l).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"});return e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("h2",{className:"text-3xl font-bold text-purple-200 mb-6",children:"Advanced Stream Analytics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-purple-800/30 rounded-lg p-4 border border-purple-500/20",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"📊 Total Streams"}),e.jsx("div",{className:"text-purple-200 text-2xl font-bold",children:r.totalStreams})]}),e.jsxs("div",{className:"bg-purple-800/30 rounded-lg p-4 border border-purple-500/20",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"🔴 Live Now"}),e.jsx("div",{className:"text-red-400 text-2xl font-bold",children:r.activeStreams})]}),e.jsxs("div",{className:"bg-purple-800/30 rounded-lg p-4 border border-purple-500/20",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"👥 Total Viewers"}),e.jsx("div",{className:"text-purple-200 text-2xl font-bold",children:r.totalViewers})]}),e.jsxs("div",{className:"bg-purple-800/30 rounded-lg p-4 border border-purple-500/20",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"💸 Total Tips"}),e.jsx("div",{className:"text-green-400 text-2xl font-bold",children:r.totalTips.toFixed(2)})]}),e.jsxs("div",{className:"bg-purple-800/30 rounded-lg p-4 border border-purple-500/20",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"👑 Total Crowns"}),e.jsx("div",{className:"text-yellow-400 text-2xl font-bold",children:r.totalCrowns})]}),e.jsxs("div",{className:"bg-purple-800/30 rounded-lg p-4 border border-purple-500/20",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"📺 Sessions"}),e.jsx("div",{className:"text-purple-200 text-2xl font-bold",children:r.totalSessions})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-600/20 to-blue-800/20 rounded-lg p-4 border border-blue-500/30",children:[e.jsx("div",{className:"text-blue-300 text-sm mb-2",children:"📅 Sessions Today"}),e.jsx("div",{className:"text-blue-200 text-3xl font-bold",children:r.sessionsToday})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-600/20 to-green-800/20 rounded-lg p-4 border border-green-500/30",children:[e.jsx("div",{className:"text-green-300 text-sm mb-2",children:"💰 Tips Today"}),e.jsx("div",{className:"text-green-200 text-3xl font-bold",children:r.tipsToday.toFixed(2)})]}),e.jsxs("div",{className:"bg-gradient-to-br from-yellow-600/20 to-yellow-800/20 rounded-lg p-4 border border-yellow-500/30",children:[e.jsx("div",{className:"text-yellow-300 text-sm mb-2",children:"👑 Crowns Today"}),e.jsx("div",{className:"text-yellow-200 text-3xl font-bold",children:r.crownsToday})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-600/20 to-purple-800/20 rounded-lg p-4 border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-300 text-sm mb-2",children:"⏱️ Avg Session"}),e.jsx("div",{className:"text-purple-200 text-3xl font-bold",children:a(r.avgSessionDuration)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-purple-800/30 rounded-lg p-4 border border-purple-500/20",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"⏰ Total Stream Time"}),e.jsx("div",{className:"text-purple-200 text-2xl font-bold",children:a(r.totalStreamTime)})]}),e.jsxs("div",{className:"bg-purple-800/30 rounded-lg p-4 border border-purple-500/20",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"📊 Peak Viewers"}),e.jsx("div",{className:"text-purple-200 text-2xl font-bold",children:r.peakConcurrentViewers})]}),e.jsxs("div",{className:"bg-purple-800/30 rounded-lg p-4 border border-purple-500/20",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"💸 Avg Tips/Session"}),e.jsx("div",{className:"text-green-400 text-2xl font-bold",children:r.avgTipsPerSession.toFixed(2)})]}),e.jsxs("div",{className:"bg-purple-800/30 rounded-lg p-4 border border-purple-500/20",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"👑 Avg Crowns/Session"}),e.jsx("div",{className:"text-yellow-400 text-2xl font-bold",children:r.avgCrownsPerSession.toFixed(1)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-purple-800/30 rounded-lg p-6 border border-purple-500/20",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"🏆 Top Streamers"}),e.jsx("div",{className:"space-y-3 max-h-[500px] overflow-y-auto",children:r.topStreamers.length===0?e.jsx("div",{className:"text-center py-8 text-purple-400",children:"No active streamers"}):r.topStreamers.map((l,i)=>e.jsxs("div",{className:"bg-purple-900/30 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-400",children:["#",i+1]}),e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white font-bold",children:l.nickname.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-purple-200 font-bold",children:l.nickname}),e.jsxs("div",{className:"text-purple-400 text-xs",children:[l.totalSessions," sessions • ",a(l.totalStreamTime)," total"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-purple-800/30 rounded px-2 py-1",children:[e.jsx("div",{className:"text-purple-400",children:"Viewers"}),e.jsxs("div",{className:"text-purple-200 font-bold",children:["👥 ",l.viewer_count]})]}),e.jsxs("div",{className:"bg-green-900/30 rounded px-2 py-1",children:[e.jsx("div",{className:"text-green-400",children:"Tips"}),e.jsxs("div",{className:"text-green-300 font-bold",children:["💸 ",parseFloat(l.total_tips).toFixed(2)]})]}),e.jsxs("div",{className:"bg-yellow-900/30 rounded px-2 py-1",children:[e.jsx("div",{className:"text-yellow-400",children:"Crowns"}),e.jsxs("div",{className:"text-yellow-300 font-bold",children:["👑 ",l.crown_count]})]})]})]},l.id))})]}),e.jsxs("div",{className:"bg-purple-800/30 rounded-lg p-6 border border-purple-500/20",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"💎 Token Breakdown"}),e.jsx("div",{className:"space-y-3 max-h-[500px] overflow-y-auto",children:r.tokenBreakdown.length===0?e.jsx("div",{className:"text-center py-8 text-purple-400",children:"No tips yet"}):r.tokenBreakdown.map((l,i)=>e.jsxs("div",{className:"bg-purple-900/30 p-3 rounded-lg flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-2xl",children:l.currency==="XRP"?"💎":"🪙"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-200 font-bold",children:l.currency}),e.jsxs("div",{className:"text-purple-400 text-sm",children:[l.count," tips"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-green-400 font-bold text-lg",children:l.total.toFixed(4)}),e.jsxs("div",{className:"text-purple-400 text-xs",children:[r.totalTips>0?(l.total/r.totalTips*100).toFixed(1):0,"%"]})]})]},i))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-purple-800/30 rounded-lg p-6 border border-purple-500/20",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"📊 Popular Categories"}),e.jsx("div",{className:"space-y-3",children:r.topCategories.length===0?e.jsx("div",{className:"text-center py-8 text-purple-400",children:"No categories yet"}):r.topCategories.map((l,i)=>e.jsxs("div",{className:"bg-purple-900/30 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-400",children:["#",i+1]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-purple-200 font-bold",children:l.name}),e.jsxs("div",{className:"text-purple-400 text-sm",children:[l.count," stream",l.count!==1?"s":""]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-green-900/30 rounded px-2 py-1",children:[e.jsx("div",{className:"text-green-400",children:"Tips"}),e.jsxs("div",{className:"text-green-300 font-bold",children:["💸 ",l.tips.toFixed(2)]})]}),e.jsxs("div",{className:"bg-yellow-900/30 rounded px-2 py-1",children:[e.jsx("div",{className:"text-yellow-400",children:"Crowns"}),e.jsxs("div",{className:"text-yellow-300 font-bold",children:["👑 ",l.crowns]})]})]})]},l.name))})]}),e.jsxs("div",{className:"bg-purple-800/30 rounded-lg p-6 border border-purple-500/20",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"💸 Top Tippers"}),e.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:r.topTippers.length===0?e.jsx("div",{className:"text-center py-8 text-purple-400",children:"No tippers yet"}):r.topTippers.map((l,i)=>e.jsxs("div",{className:"flex items-center gap-3 bg-purple-900/30 p-3 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-400",children:["#",i+1]}),e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-yellow-500 to-orange-500 flex items-center justify-center text-white font-bold",children:l.nickname.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-purple-200 font-bold",children:l.nickname}),e.jsxs("div",{className:"text-purple-400 text-sm",children:[l.count," tips"]})]}),e.jsx("div",{className:"text-green-400 font-bold text-lg",children:l.total.toFixed(2)})]},l.wallet))})]})]}),e.jsxs("div",{className:"bg-purple-800/30 rounded-lg p-6 border border-purple-500/20",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"💸 Recent Tips"}),e.jsx("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:r.recentTips.length===0?e.jsx("div",{className:"text-center py-8 text-purple-400",children:"No tips yet"}):r.recentTips.map(l=>e.jsxs("div",{className:"flex items-center gap-3 bg-purple-900/30 p-3 rounded-lg",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-yellow-500 to-orange-500 flex items-center justify-center text-white font-bold text-sm",children:l.from_nickname.charAt(0).toUpperCase()}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"text-purple-200",children:[e.jsx("span",{className:"font-bold",children:l.from_nickname}),e.jsx("span",{className:"text-purple-400 mx-2",children:"→"}),e.jsx("span",{className:"font-bold",children:l.to_nickname})]})}),e.jsxs("div",{className:"text-green-400 font-bold",children:[parseFloat(l.amount).toFixed(4)," ",l.currency]}),e.jsx("div",{className:"text-purple-400 text-sm",children:n(l.created_at)})]},l.id))})]})]})})}function Yh({notification:r,onClose:t}){const[s,a]=m.useState(!1);return m.useEffect(()=>{a(!0);const n=setTimeout(()=>{a(!1),setTimeout(t,300)},5e3);return()=>clearTimeout(n)},[t]),r?e.jsxs("div",{className:`transform transition-all duration-300 ${s?"translate-y-0 opacity-100":"-translate-y-full opacity-0"}`,children:[r.type==="tip"&&e.jsx("div",{className:"bg-gradient-to-r from-yellow-600 to-orange-600 rounded-lg p-4 shadow-2xl border-2 border-yellow-400/50 min-w-[320px]",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-4xl animate-bounce",children:"💸"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-white font-bold text-lg",children:"New Tip!"}),e.jsxs("div",{className:"text-yellow-100 text-sm",children:[e.jsx("span",{className:"font-bold",children:r.from})," tipped"," ",e.jsx("span",{className:"font-bold",children:r.to})]}),e.jsxs("div",{className:"text-yellow-200 font-bold text-lg mt-1",children:[r.amount," ",r.currency]})]})]})}),r.type==="crown"&&e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-lg p-4 shadow-2xl border-2 border-purple-400/50 min-w-[320px]",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-4xl animate-pulse",children:"👑"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-white font-bold text-lg",children:"Crown Reaction!"}),e.jsxs("div",{className:"text-purple-100 text-sm",children:[e.jsx("span",{className:"font-bold",children:r.from})," sent a crown to"," ",e.jsx("span",{className:"font-bold",children:r.to})]})]})]})})]}):null}const Qs="rphatRpwXcPAo7CVm46dC78JAQ6kLMqb2M";function Qh(){const[r,t]=m.useState("chat"),[s,a]=m.useState(null),[n,l]=m.useState([]),[i,o]=m.useState([]),[c,d]=m.useState([]),[u,h]=m.useState([]),[g,y]=m.useState(""),[f,w]=m.useState(""),[b,P]=m.useState(!1),[A,_]=m.useState(!1),[W,D]=m.useState(null),[I,E]=m.useState([]),[G,_e]=m.useState(null),[ge,Ce]=m.useState([]),[ue,J]=m.useState(!1),[se,F]=m.useState(null),[X,me]=m.useState(!1),[ve,He]=m.useState([]),[pe,xe]=m.useState(null),[le,$e]=m.useState(!1),[Ne,q]=m.useState("bottom-right"),[ee,L]=m.useState(!1),[re,B]=m.useState([]),[Y,oe]=m.useState([]),[ie,ye]=m.useState(0),[te,U]=m.useState(null),[ke,he]=m.useState(!1),[Oe,$]=m.useState(null),[be,We]=m.useState(0),[tt,nt]=m.useState([]),[M,fe]=m.useState("Just Chatting"),[K,v]=m.useState(0),[p,x]=m.useState([]),[R,H]=m.useState(!1),[z,ae]=m.useState({title:"",description:"",category:"Just Chatting",date:"",time:"",duration:60}),qe=m.useRef(null),Ie=m.useRef(null),Je=m.useRef(null),et=m.useRef(null),ze=m.useRef(null),dt=m.useRef(null),Rt=["😀","😂","🤣","😊","😍","🥰","😎","🤔","😭","😱","🤯","😴","🥳","🤑","🤗","👍","👎","👏","🙏","💪","🤝","✌️","🤞","👌","🤘","🔥","⭐","✨","💎","💰","🚀","🎉","🎊","🏆","👑","💯","💸","📈","📊","🌟"],Tt=(s==null?void 0:s.address)===Qs;m.useEffect(()=>{ut(),Ae(),jt(),de(),Pe(),T(),at(),ne();const O=setInterval(()=>{s&&f&&st(f,!0),ue&&se&&($t(),v(Math.floor((new Date-new Date(se.started_at))/1e3)))},1e3);return()=>{clearInterval(O),s&&f&&st(f,!1),ue&&se&&fs()}},[]),m.useEffect(()=>{if(s){pt();const O=localStorage.getItem(`nickname_${s.address}`);O?(w(O),st(O,!0)):P(!0),Q(s),Z(),Nt(),Se()}},[s]),m.useEffect(()=>{G&&(xt(),Ge())},[G]),m.useEffect(()=>{if(te!=null&&te.stream_signal)if(te.wallet_address===(s==null?void 0:s.address))viewerVideoRef.current&&ze.current&&(viewerVideoRef.current.srcObject=ze.current,viewerVideoRef.current.play().catch(O=>{}));else{const O=new Peer({initiator:!1,trickle:!1});return O.on("signal",Te=>{}),O.on("stream",Te=>{viewerVideoRef.current&&(viewerVideoRef.current.srcObject=Te,viewerVideoRef.current.play().catch(Ue=>{}))}),O.on("error",Te=>{}),O.signal(te.stream_signal),viewerPeerRef.current=O,()=>{viewerPeerRef.current&&(viewerPeerRef.current.destroy(),viewerPeerRef.current=null)}}},[te,ze.current]),m.useEffect(()=>{wt()},[u]),m.useEffect(()=>{G&&Mt()},[ge]),m.useEffect(()=>{if(se){Qt();const O=setInterval(Qt,5e3);return()=>clearInterval(O)}},[se]);const wt=()=>{var O;(O=qe.current)==null||O.scrollIntoView({behavior:"smooth"})},Mt=()=>{var O;(O=Ie.current)==null||O.scrollIntoView({behavior:"smooth"})},ut=()=>{const O=localStorage.getItem("connectedWallet");O&&a(JSON.parse(O));const Te=()=>{const Ue=localStorage.getItem("connectedWallet");Ue?a(JSON.parse(Ue)):(a(null),l([]))};return window.addEventListener("walletConnected",Te),window.addEventListener("walletDisconnected",Te),()=>{window.removeEventListener("walletConnected",Te),window.removeEventListener("walletDisconnected",Te)}},jt=async()=>{const{data:O}=await S.from("banned_wallets").select("wallet_address");O&&B(O.map(Te=>Te.wallet_address))},pt=async()=>{if(!s)return;const{data:O}=await S.from("banned_wallets").select("*").eq("wallet_address",s.address).maybeSingle();O&&(k.error("Your wallet has been banned from Social"),window.dispatchEvent(new Event("walletDisconnected")),localStorage.removeItem("connectedWallet"))},lt=async O=>{if(!Tt){k.error("Only developer can ban wallets");return}const Te=prompt("Reason for ban (optional):"),{error:Ue}=await S.from("banned_wallets").insert([{wallet_address:O,banned_by:s.address,reason:Te||"No reason provided"}]);Ue?k.error("Failed to ban wallet"):(k.success("Wallet banned successfully"),jt(),Ae())},j=async O=>{if(!Tt){k.error("Only developer can delete messages");return}const{error:Te}=await S.from("chat_messages").delete().eq("id",O);Te?k.error("Failed to delete message"):(h(u.filter(Ue=>Ue.id!==O)),k.success("Message deleted"))},Q=async O=>{if(O!=null&&O.address)try{const Te=new Re.Client(O.network==="mainnet"?"wss://xrplcluster.com":"wss://s.altnet.rippletest.net:51233");await Te.connect();const it=(await Te.request({command:"account_lines",account:O.address,ledger_index:"validated"})).result.lines||[];l(it),await Te.disconnect()}catch{}},Z=async()=>{const{data:O}=await S.from("chat_rooms").select("id").eq("type","general").maybeSingle();if(!O)return;const{data:Te,error:Ue}=await S.from("chat_messages").select("*").eq("room_id",O.id).order("created_at",{ascending:!0});Ue||h(Te||[])},Se=()=>{const O=S.channel("general_chat").on("postgres_changes",{event:"INSERT",schema:"public",table:"chat_messages"},Te=>{h(Ue=>[...Ue,Te.new])}).on("postgres_changes",{event:"DELETE",schema:"public",table:"chat_messages"},Te=>{h(Ue=>Ue.filter(it=>it.id!==Te.old.id))}).subscribe();return()=>{S.removeChannel(O)}},Ae=async()=>{const{data:O,error:Te}=await S.from("user_presence").select("*").eq("is_online",!0).order("nickname",{ascending:!0});if(!Te&&O){const Ue=O.filter(it=>!re.includes(it.wallet_address));o(Ue)}},de=async()=>{const{data:O,error:Te}=await S.from("live_streams").select("*").eq("is_active",!0).order("started_at",{ascending:!1});!Te&&O&&d(O)},Pe=async()=>{const O=new Date,{data:Te,error:Ue}=await S.from("scheduled_streams").select("*").eq("is_active",!0).eq("is_cancelled",!1).gte("scheduled_at",O.toISOString()).order("scheduled_at",{ascending:!0});!Ue&&Te&&x(Te)},Ve=async()=>{if(!s||!f){k.error("Please connect wallet and set nickname");return}if(!z.title||!z.date||!z.time){k.error("Please fill in all required fields");return}const O=new Date(`${z.date}T${z.time}`);if(O<=new Date){k.error("Schedule time must be in the future");return}const{error:Te}=await S.from("scheduled_streams").insert([{wallet_address:s.address,nickname:f,title:z.title,description:z.description,category:z.category,scheduled_at:O.toISOString(),duration_minutes:z.duration}]);if(Te){k.error("Failed to schedule stream");return}k.success("Stream scheduled successfully!"),H(!1),ae({title:"",description:"",category:"Just Chatting",date:"",time:"",duration:60}),Pe()},Ye=async O=>{if(!s){k.error("Please connect your wallet");return}if(O.wallet_address!==s.address){k.error("You can only go live for your own scheduled streams");return}fe(O.category),t("chat"),me(!0),k.success(`Starting stream: ${O.title}`)},Le=async O=>{const{error:Te}=await S.from("scheduled_streams").update({is_cancelled:!0}).eq("id",O);Te||(k.success("Stream cancelled"),Pe())},at=()=>{const O=S.channel("live_streams_changes").on("postgres_changes",{event:"*",schema:"public",table:"live_streams"},()=>{de()}).subscribe();return()=>{S.removeChannel(O)}},T=()=>{const O=S.channel("user_presence_changes").on("postgres_changes",{event:"*",schema:"public",table:"user_presence"},()=>{Ae()}).subscribe();return()=>{S.removeChannel(O)}},ne=()=>{const O=S.channel("tips_notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"stream_tips"},Ue=>{Fe({type:"tip",from:Ue.new.from_nickname,to:Ue.new.to_nickname,amount:parseFloat(Ue.new.amount).toFixed(4),currency:Ue.new.currency})}).subscribe(),Te=S.channel("crowns_notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"stream_reactions"},Ue=>{Fe({type:"crown",from:Ue.new.from_nickname,to:Ue.new.from_wallet})}).subscribe();return()=>{S.removeChannel(O),S.removeChannel(Te)}},Fe=O=>{const Te=Date.now();nt(Ue=>[...Ue,{id:Te,...O}]),setTimeout(()=>{nt(Ue=>Ue.filter(it=>it.id!==Te))},5e3)},Xe=async O=>{if(!s||!f){k.error("Please connect wallet and set nickname");return}if(!se&&!te){k.error("No active stream");return}const Te=(se==null?void 0:se.id)||(te==null?void 0:te.id),{error:Ue}=await S.from("stream_reactions").insert([{stream_id:Te,from_wallet:s.address,from_nickname:f,reaction_type:"crown"}]);if(Ue)k.error("Failed to send crown");else{const{data:it}=await S.from("live_streams").select("crown_count").eq("id",Te).maybeSingle();await S.from("live_streams").update({crown_count:((it==null?void 0:it.crown_count)||0)+1}).eq("id",Te);const{data:Et}=await S.from("chat_rooms").select("id").eq("type","general").maybeSingle();Et&&await S.from("chat_messages").insert([{room_id:Et.id,wallet_address:s.address,nickname:f,message_type:"crown",content:`sent a crown to ${O.nickname||"streamer"}! 👑`,tip_data:{type:"crown",to_nickname:O.nickname||"streamer",to_wallet:O.wallet_address}}]),k.success("Crown sent! 👑"),te&&Cs(Te)}},st=async(O,Te)=>{s&&(await S.from("user_presence").upsert({wallet_address:s.address,nickname:O,is_online:Te,last_seen:new Date().toISOString(),updated_at:new Date().toISOString()}),Te&&Ae())},gt=async()=>{if(!f.trim()||!s){k.error("Please enter a nickname");return}localStorage.setItem(`nickname_${s.address}`,f),await st(f,!0),P(!1),k.success("Nickname saved!")},Qe=async()=>{if(!g.trim()||!s||!f){k.error("Please ensure you have a nickname set");return}const{data:O}=await S.from("chat_rooms").select("id").eq("type","general").maybeSingle();if(!O){k.error("Chat room not found");return}const Te={room_id:O.id,wallet_address:s.address,nickname:f,message_type:"text",content:g.trim()},{data:Ue,error:it}=await S.from("chat_messages").insert([Te]).select();if(it){k.error("Failed to send message: "+it.message);return}Ue&&Ue.length>0&&h(Et=>[...Et,Ue[0]]),y("")},ot=O=>{O.wallet_address!==(s==null?void 0:s.address)&&(D(O),_(!0))},yt=async O=>{_(!1);const Te=[s.address,O.wallet_address].sort(),{data:Ue}=await S.from("dm_conversations").select("*").eq("participant_1",Te[0]).eq("participant_2",Te[1]).maybeSingle();if(Ue)_e({...Ue,otherWallet:O.wallet_address,otherNickname:O.nickname});else{const{data:it}=await S.from("dm_conversations").insert([{participant_1:Te[0],participant_2:Te[1],last_message:"",last_message_at:new Date().toISOString()}]).select().single();_e({...it,otherWallet:O.wallet_address,otherNickname:O.nickname})}Nt()},Nt=async()=>{if(!s)return;const{data:O}=await S.from("dm_conversations").select("*").or(`participant_1.eq.${s.address},participant_2.eq.${s.address}`).order("last_message_at",{ascending:!1});if(O){const Te=await Promise.all(O.map(async Ue=>{const it=Ue.participant_1===s.address?Ue.participant_2:Ue.participant_1,{data:Et}=await S.from("user_presence").select("nickname").eq("wallet_address",it).maybeSingle();return{...Ue,otherWallet:it,otherNickname:(Et==null?void 0:Et.nickname)||it.slice(0,8)}}));E(Te)}},xt=async()=>{if(!G||!s)return;const{data:O}=await S.from("direct_messages").select("*").or(`and(from_wallet.eq.${s.address},to_wallet.eq.${G.otherWallet}),and(from_wallet.eq.${G.otherWallet},to_wallet.eq.${s.address})`).order("created_at",{ascending:!0});Ce(O||[])},Ge=()=>{if(!G)return;const O=S.channel(`dm_${G.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"direct_messages"},Te=>{(Te.new.from_wallet===s.address&&Te.new.to_wallet===G.otherWallet||Te.new.from_wallet===G.otherWallet&&Te.new.to_wallet===s.address)&&Ce(Ue=>[...Ue,Te.new])}).subscribe();return()=>{S.removeChannel(O)}},kt=async()=>{if(!g.trim()||!G||!s)return;const O={from_wallet:s.address,to_wallet:G.otherWallet,from_nickname:f,to_nickname:G.otherNickname,message_type:"text",content:g.trim()},{data:Te,error:Ue}=await S.from("direct_messages").insert([O]).select();if(Ue){k.error("Failed to send DM: "+Ue.message);return}Te&&Te.length>0&&Ce(it=>[...it,Te[0]]),await S.from("dm_conversations").update({last_message:g.trim(),last_message_at:new Date().toISOString()}).eq("id",G.id),y(""),Nt()},bt=()=>{_e(null),Ce([])},St=O=>{_(!1),$(O),he(!0)},Ct=async()=>{try{const Te=(await navigator.mediaDevices.enumerateDevices()).filter(Ue=>Ue.kind==="videoinput");He(Te),me(!0)}catch{k.error("Failed to enumerate cameras")}},_t=async O=>{try{const{data:Te}=await S.from("live_streams").select("*").eq("wallet_address",s.address).eq("is_active",!0).maybeSingle();if(Te){k.error("You already have an active stream. Please end it first.");return}const Ue=await navigator.mediaDevices.getUserMedia({video:O?{deviceId:{exact:O}}:!0,audio:!0});ze.current=Ue,Je.current&&(Je.current.srcObject=Ue,Je.current.play().catch(rs=>{}));const{data:it,error:Et}=await S.from("live_streams").insert([{wallet_address:s.address,nickname:f,title:`${f}'s Stream`,category:M,is_active:!0,viewer_count:0,total_tips:0,crown_count:0}]).select().single();if(Et){k.error("Failed to create stream record");return}F(it),J(!0),me(!1);const ss=new Peer({initiator:!0,trickle:!1,stream:Ue});ss.on("signal",async rs=>{await S.from("live_streams").update({stream_signal:rs}).eq("id",it.id)}),ss.on("error",rs=>{}),broadcasterPeerRef.current=ss,k.success("🎥 Stream started! You are now LIVE!"),de()}catch(Te){k.error("Failed to start stream: "+Te.message)}},Gt=async()=>{try{if(le)dt.current&&(Je.current&&(Je.current.srcObject=dt.current),ze.current=dt.current,dt.current=null,et.current&&(et.current.srcObject=null)),$e(!1);else{const O=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!0});Je.current&&(Je.current.srcObject=O,ze.current&&!dt.current&&(dt.current=ze.current,et.current&&(et.current.srcObject=dt.current)),ze.current=O),$e(!0),k.success("Screen sharing started")}}catch{k.error("Failed to toggle screen share")}},fs=async()=>{ze.current&&(ze.current.getTracks().forEach(O=>O.stop()),ze.current=null),dt.current&&(dt.current.getTracks().forEach(O=>O.stop()),dt.current=null),Je.current&&(Je.current.srcObject=null),et.current&&(et.current.srcObject=null),broadcasterPeerRef.current&&(broadcasterPeerRef.current.destroy(),broadcasterPeerRef.current=null),se&&await S.from("live_streams").update({is_active:!1,ended_at:new Date().toISOString()}).eq("id",se.id),J(!1),$e(!1),F(null),oe([]),U(null),ye(0),k.success("Stream ended"),de()},$t=async()=>{se&&await S.from("live_streams").update({updated_at:new Date().toISOString()}).eq("id",se.id)},Qt=async()=>{if(!se)return;const{data:O}=await S.from("stream_tips").select("*").eq("stream_id",se.id).order("created_at",{ascending:!1});if(O){oe(O);const Te=O.reduce((Ue,it)=>Ue+parseFloat(it.amount),0);ye(Te.toFixed(4))}},Bt=async O=>{U(O),t("viewing"),Cs(O.id),gs(O.id)},Cs=async O=>{const{data:Te}=await S.from("stream_tips").select("*").eq("stream_id",O).order("created_at",{ascending:!1});if(Te){oe(Te);const it=Te.reduce((Et,ss)=>Et+parseFloat(ss.amount),0);ye(it.toFixed(4))}const{data:Ue}=await S.from("stream_viewers").select("*").eq("stream_id",O);Ue&&We(Ue.length)},gs=async O=>{s&&(await S.from("stream_viewers").upsert({stream_id:O,viewer_address:s.address,last_seen:new Date().toISOString()}),await S.from("live_streams").update({viewer_count:be+1}).eq("id",O))},bs=()=>{te&&s&&Xt(te.id),U(null),oe([]),ye(0),We(0),t("feeds")},Xt=async O=>{if(!s)return;await S.from("stream_viewers").delete().eq("stream_id",O).eq("viewer_address",s.address);const{data:Te}=await S.from("stream_viewers").select("*").eq("stream_id",O);await S.from("live_streams").update({viewer_count:(Te==null?void 0:Te.length)||0}).eq("id",O)},Ut=O=>new Date(O).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),Ts=O=>c.some(Te=>Te.wallet_address===O&&Te.is_active);return e.jsxs("div",{className:"h-screen flex flex-col bg-gradient-to-br from-purple-900 via-slate-900 to-purple-900 overflow-hidden",children:[e.jsx("div",{className:"fixed top-20 right-6 z-50 space-y-2",children:tt.map(O=>e.jsx(Yh,{notification:O,onClose:()=>nt(Te=>Te.filter(Ue=>Ue.id!==O.id))},O.id))}),e.jsx("div",{className:"flex-shrink-0 bg-purple-900/20 backdrop-blur-xl border-b border-purple-500/20 px-6 pt-4",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>t("chat"),className:`px-6 py-3 rounded-t-lg font-bold transition-all ${r==="chat"?"bg-purple-800/50 text-purple-200 border-t-2 border-x-2 border-purple-500/50":"text-purple-400 hover:text-purple-200"}`,children:"Chat"}),c.length>0&&e.jsxs("button",{onClick:()=>t("feeds"),className:`px-6 py-3 rounded-t-lg font-bold transition-all relative ${r==="feeds"?"bg-purple-800/50 text-purple-200 border-t-2 border-x-2 border-purple-500/50":"text-purple-400 hover:text-purple-200"}`,children:["Live Feeds",e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse",children:c.length})]}),e.jsxs("button",{onClick:()=>t("upcoming"),className:`px-6 py-3 rounded-t-lg font-bold transition-all relative ${r==="upcoming"?"bg-purple-800/50 text-purple-200 border-t-2 border-x-2 border-purple-500/50":"text-purple-400 hover:text-purple-200"}`,children:["Upcoming",p.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-blue-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center",children:p.length})]}),e.jsx("button",{onClick:()=>t("analytics"),className:`px-6 py-3 rounded-t-lg font-bold transition-all ${r==="analytics"?"bg-purple-800/50 text-purple-200 border-t-2 border-x-2 border-purple-500/50":"text-purple-400 hover:text-purple-200"}`,children:"Analytics"})]})}),r==="chat"&&e.jsxs("div",{className:"flex-1 flex overflow-hidden min-h-0",children:[e.jsxs("div",{className:"w-72 bg-purple-900/20 backdrop-blur-xl flex flex-col border-r border-purple-500/20 flex-shrink-0",children:[e.jsxs("div",{className:"p-6 border-b border-purple-500/20",children:[e.jsx("h2",{className:"text-2xl font-bold text-purple-200",children:"Online Users"}),e.jsxs("p",{className:"text-purple-400 text-sm mt-1",children:[i.length," online"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:i.map(O=>e.jsx("button",{onClick:()=>ot(O),className:"w-full p-4 rounded-lg bg-purple-800/30 hover:bg-purple-800/50 transition-all duration-300 border border-purple-500/20 hover:border-purple-500/40",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white font-bold",children:O.nickname.charAt(0).toUpperCase()}),Ts(O.wallet_address)?e.jsx("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-red-500 rounded-full border-2 border-purple-900 animate-pulse"}):e.jsx("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-purple-900"})]}),e.jsxs("div",{className:"flex-1 text-left min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-purple-200 font-bold truncate",children:O.nickname}),O.wallet_address===Qs&&e.jsx("span",{className:"text-yellow-400 text-lg",title:"Developer",children:"👑"}),Ts(O.wallet_address)&&e.jsx("span",{className:"text-red-400 text-xs font-bold",children:"LIVE"})]}),e.jsxs("div",{className:"text-purple-400 text-xs truncate",children:[O.wallet_address.slice(0,12),"..."]})]})]})},O.wallet_address))}),e.jsx("div",{className:"p-4 border-t border-purple-500/20 space-y-2",children:ue?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:Gt,className:"w-full bg-purple-700/50 hover:bg-purple-700/70 text-white py-2 px-4 rounded-lg font-medium transition-all",children:le?"Stop Screen Share":"Share Screen"}),e.jsx("button",{onClick:fs,className:"w-full bg-red-600/50 hover:bg-red-600/70 text-white py-2 px-4 rounded-lg font-medium transition-all",children:"End Stream"})]}):e.jsx("button",{onClick:Ct,className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white py-3 px-4 rounded-lg font-bold transition-all duration-300",children:"Start Streaming"})})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"p-4 bg-purple-900/20 backdrop-blur-xl border-b border-purple-500/20",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200",children:"General Chat"}),e.jsx("p",{className:"text-purple-400 text-sm",children:"Public conversation"})]}),ue&&e.jsxs("div",{className:"p-4 bg-purple-900/10",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-200 font-bold text-lg",children:"Your Live Stream"}),e.jsx("div",{className:"text-purple-400 text-sm",children:"Now visible in Live Feeds tab - viewers can watch and chat!"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-red-500 px-4 py-2 rounded-lg",children:[e.jsx("div",{className:"w-3 h-3 bg-white rounded-full animate-pulse"}),e.jsx("span",{className:"text-white font-bold",children:"BROADCASTING"})]})]}),e.jsxs("div",{className:"bg-black rounded-lg overflow-hidden border-2 border-purple-500/30 relative aspect-video",children:[e.jsx("video",{ref:Je,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),le&&dt.current&&e.jsx("div",{className:`absolute w-48 h-36 border-2 border-purple-500/50 rounded-lg overflow-hidden cursor-move ${Ne==="top-left"?"top-4 left-4":Ne==="top-right"?"top-4 right-4":Ne==="bottom-left"?"bottom-4 left-4":"bottom-4 right-4"}`,children:e.jsx("video",{ref:et,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"absolute top-4 left-4 bg-purple-900/90 backdrop-blur-xl px-4 py-2 rounded-lg border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-200 font-bold text-sm",children:"💸 Total Tips"}),e.jsxs("div",{className:"text-green-400 font-bold text-xl",children:[ie," XRP"]})]}),e.jsxs("div",{className:"absolute top-4 right-4 bg-red-500/90 backdrop-blur-xl px-4 py-2 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-3 h-3 bg-white rounded-full animate-pulse"}),e.jsx("span",{className:"text-white font-bold text-sm",children:"LIVE"})]}),e.jsxs("div",{className:"text-white font-mono text-xs text-center",children:[Math.floor(K/3600),":",String(Math.floor(K%3600/60)).padStart(2,"0"),":",String(K%60).padStart(2,"0")]})]}),le&&e.jsx("div",{className:"absolute bottom-4 left-4 flex gap-2",children:["top-left","top-right","bottom-left","bottom-right"].map(O=>e.jsx("button",{onClick:()=>q(O),className:`w-8 h-8 rounded ${Ne===O?"bg-purple-500":"bg-purple-800/50 hover:bg-purple-700/70"} transition-all`},O))})]}),Y.length>0&&e.jsx("div",{className:"mt-2 space-y-1 max-h-24 overflow-y-auto",children:Y.slice(0,5).map(O=>e.jsxs("div",{className:"bg-purple-800/30 px-3 py-1 rounded text-sm flex items-center gap-2",children:[e.jsx("span",{className:"text-yellow-400",children:"💸"}),e.jsx("span",{className:"text-purple-200 font-medium",children:O.from_nickname}),e.jsx("span",{className:"text-purple-400",children:"sent"}),e.jsxs("span",{className:"text-green-400 font-bold",children:[O.amount," ",O.currency]})]},O.id))}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsx("button",{onClick:()=>U(se),className:"flex-1 bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg font-bold transition-all",children:"📺 View Full Stream"}),e.jsx("button",{onClick:fs,className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg font-bold transition-all",children:"Stop Stream"})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[u.map(O=>{const Te=O.message_type==="tip",Ue=O.message_type==="crown";return Te||Ue?e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:`px-6 py-3 rounded-xl border-2 ${Te?"bg-gradient-to-r from-yellow-900/50 to-orange-900/50 border-yellow-500/50":"bg-gradient-to-r from-purple-900/50 to-pink-900/50 border-purple-500/50"} max-w-md`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-3xl",children:Te?"💸":"👑"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-bold",children:O.nickname}),Te&&O.tip_data&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-yellow-300",children:"sent"}),e.jsxs("span",{className:"text-green-400 font-bold text-lg",children:[O.tip_data.amount," ",O.tip_data.currency]}),e.jsx("span",{className:"text-yellow-300",children:"to"}),e.jsx("span",{className:"text-white font-bold",children:O.tip_data.to_nickname})]}),Ue&&e.jsx("span",{className:"text-purple-200",children:O.content})]}),e.jsx("div",{className:"text-purple-400 text-xs mt-1",children:Ut(O.created_at)})]})]})})},O.id):e.jsxs("div",{className:`flex gap-3 group ${O.wallet_address===(s==null?void 0:s.address)?"flex-row-reverse":""}`,children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white font-bold flex-shrink-0",children:O.nickname.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1 max-w-2xl",children:[e.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[e.jsx("span",{className:"text-purple-200 font-bold",children:O.nickname}),O.wallet_address===Qs&&e.jsx("span",{className:"text-yellow-400 text-sm",title:"Developer",children:"👑"}),e.jsx("span",{className:"text-purple-400 text-xs",children:Ut(O.created_at)}),Tt&&e.jsx("button",{onClick:()=>j(O.id),className:"opacity-0 group-hover:opacity-100 text-red-400 hover:text-red-300 text-xs font-medium transition-all",children:"Delete"})]}),e.jsx("div",{className:`p-3 rounded-lg ${O.wallet_address===(s==null?void 0:s.address)?"bg-purple-600/30 border border-purple-500/50":"bg-purple-800/30 border border-purple-500/20"}`,children:e.jsx("p",{className:"text-purple-100",children:O.content})})]})]},O.id)}),e.jsx("div",{ref:qe})]}),e.jsx("div",{className:"p-4 bg-purple-900/20 backdrop-blur-xl border-t border-purple-500/20",children:e.jsxs("div",{className:"flex gap-2 relative",children:[e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>L(!ee),className:"bg-purple-800/30 hover:bg-purple-800/50 text-white p-3 rounded-lg border border-purple-500/20 transition-all text-xl",title:"Emojis",children:"😀"}),ee&&e.jsx("div",{className:"absolute bottom-full left-0 mb-2 bg-purple-900/95 backdrop-blur-xl p-3 rounded-lg shadow-2xl border border-purple-500/30 z-50",children:e.jsx("div",{className:"grid grid-cols-8 gap-1 max-h-48 overflow-y-auto",style:{width:"320px"},children:Rt.map((O,Te)=>e.jsx("button",{onClick:()=>{y(g+O),L(!1)},className:"hover:bg-purple-700/50 p-2 rounded text-2xl transition-all hover:scale-110",children:O},Te))})})]}),e.jsx("input",{type:"text",value:g,onChange:O=>y(O.target.value),onKeyPress:O=>O.key==="Enter"&&(G?kt():Qe()),placeholder:f?"Type a message...":"Set nickname first...",disabled:!s||!f,className:"flex-1 bg-purple-800/30 text-purple-100 px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 border border-purple-500/20 placeholder-purple-400/50"}),e.jsx("button",{onClick:G?kt:Qe,disabled:!g.trim()||!s||!f,className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg font-bold transition-all",children:"Send"})]})})]}),e.jsxs("div",{className:"w-80 bg-purple-900/20 backdrop-blur-xl border-l border-purple-500/20 flex flex-col flex-shrink-0",children:[e.jsx("div",{className:"p-4 border-b border-purple-500/20",children:e.jsx("h3",{className:"text-xl font-bold text-purple-200",children:"Direct Messages"})}),G?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-purple-800/30 border-b border-purple-500/20 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white font-bold",children:G.otherNickname.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-200 font-bold",children:G.otherNickname}),e.jsxs("div",{className:"text-purple-400 text-xs",children:[G.otherWallet.slice(0,12),"..."]})]})]}),e.jsx("button",{onClick:bt,className:"text-purple-400 hover:text-purple-200 transition-colors",children:"✕"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[ge.map(O=>e.jsxs("div",{className:`flex gap-2 ${O.from_wallet===(s==null?void 0:s.address)?"flex-row-reverse":""}`,children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white font-bold text-sm flex-shrink-0",children:O.from_nickname.charAt(0).toUpperCase()}),e.jsxs("div",{className:`p-3 rounded-lg max-w-[70%] ${O.from_wallet===(s==null?void 0:s.address)?"bg-purple-600/30 border border-purple-500/50":"bg-purple-800/30 border border-purple-500/20"}`,children:[e.jsx("p",{className:"text-purple-100 text-sm",children:O.content}),e.jsx("span",{className:"text-purple-400 text-xs mt-1 block",children:Ut(O.created_at)})]})]},O.id)),e.jsx("div",{ref:Ie})]})]}):e.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:I.length===0?e.jsx("div",{className:"text-center text-purple-400 text-sm p-8",children:"Click on a user to start a conversation"}):I.map(O=>e.jsx("button",{onClick:()=>_e(O),className:"w-full p-3 rounded-lg bg-purple-800/30 hover:bg-purple-800/50 transition-all border border-purple-500/20 text-left",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white font-bold text-sm",children:O.otherNickname.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-purple-200 font-medium truncate text-sm",children:O.otherNickname}),e.jsx("div",{className:"text-purple-400 text-xs truncate",children:O.last_message||"No messages yet"})]})]})},O.id))})]})]}),r==="feeds"&&e.jsx(Gh,{onViewStream:Bt,connectedWallet:s}),r==="analytics"&&e.jsx(Jh,{}),r==="upcoming"&&e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-purple-200",children:"Upcoming Streams"}),e.jsxs("p",{className:"text-purple-400 mt-1",children:[p.length," scheduled streams"]})]}),s&&f&&e.jsxs("button",{onClick:()=>H(!0),className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white px-6 py-3 rounded-lg font-bold transition-all flex items-center gap-2",children:[e.jsx("span",{children:"📅"}),"Schedule Stream"]})]}),p.length===0?e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"text-6xl mb-4",children:"📅"}),e.jsx("div",{className:"text-purple-300 text-xl font-bold mb-2",children:"No Upcoming Streams"}),e.jsx("div",{className:"text-purple-400",children:"Schedule a stream to let your audience know when you'll be live!"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map(O=>{const Te=new Date(O.scheduled_at),it=Math.floor((Te-new Date)/(1e3*60*60)),Et=(s==null?void 0:s.address)===O.wallet_address;return e.jsxs("div",{className:"bg-purple-800/30 rounded-lg p-5 border border-purple-500/30 hover:border-purple-400/50 transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold text-lg",children:O.nickname.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-200 font-bold",children:O.nickname}),Et&&e.jsx("span",{className:"text-xs bg-purple-600 px-2 py-0.5 rounded text-white",children:"Your Stream"})]})]}),e.jsx("span",{className:"bg-blue-600/30 text-blue-300 px-2 py-1 rounded text-xs font-bold",children:O.category})]}),e.jsx("h3",{className:"text-purple-100 font-bold text-lg mb-2",children:O.title}),O.description&&e.jsx("p",{className:"text-purple-400 text-sm mb-3 line-clamp-2",children:O.description}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-purple-300 text-sm",children:[e.jsx("span",{children:"📅"}),e.jsx("span",{children:Te.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-purple-300 text-sm",children:[e.jsx("span",{children:"🕐"}),e.jsx("span",{children:Te.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-purple-300 text-sm",children:[e.jsx("span",{children:"⏱️"}),e.jsxs("span",{children:[O.duration_minutes," minutes"]})]}),e.jsxs("div",{className:`flex items-center gap-2 text-sm font-bold ${it<1?"text-red-400":it<24?"text-yellow-400":"text-purple-400"}`,children:[e.jsx("span",{children:"⏳"}),e.jsx("span",{children:it<1?"Starting soon!":it<24?`In ${it} hours`:`In ${Math.floor(it/24)} days`})]})]}),Et&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Ye(O),className:"flex-1 bg-gradient-to-r from-green-600 to-green-500 hover:from-green-500 hover:to-green-400 text-white py-2 px-4 rounded-lg font-bold transition-all",children:"🎥 Go Live Now"}),e.jsx("button",{onClick:()=>Le(O.id),className:"bg-red-600/30 hover:bg-red-600/50 text-red-300 py-2 px-4 rounded-lg font-bold transition-all",children:"Cancel"})]}),!Et&&e.jsx("button",{className:"w-full bg-purple-600/30 hover:bg-purple-600/50 text-purple-300 py-2 px-4 rounded-lg font-bold transition-all",children:"🔔 Remind Me"})]},O.id)})})]})}),r==="viewing"&&te&&e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden min-h-0",children:[e.jsxs("div",{className:"flex-shrink-0 p-4 bg-purple-900/20 backdrop-blur-xl border-b border-purple-500/20 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:bs,className:"text-purple-400 hover:text-purple-200 transition-colors",children:"← Back"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white font-bold",children:te.nickname.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-purple-200 font-bold",children:te.nickname}),te.wallet_address===Qs&&e.jsx("span",{className:"text-yellow-400 text-sm",children:"👑"}),e.jsxs("span",{className:"flex items-center gap-1 bg-red-500 px-2 py-0.5 rounded text-xs",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),"LIVE"]})]}),e.jsx("div",{className:"text-purple-400 text-sm",children:te.title})]})]})]}),e.jsx("button",{onClick:()=>{const O={wallet_address:te.wallet_address,nickname:te.nickname};St(O)},className:"bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-500 hover:to-orange-500 text-white px-6 py-2 rounded-lg font-bold transition-all",children:"💸 Send Tip"})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden min-h-0",children:[e.jsxs("div",{className:"flex-1 bg-black flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-1 flex items-center justify-center relative min-h-0",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-8xl mb-4",children:"📹"}),e.jsx("div",{className:"text-purple-400 text-xl",children:"Stream Preview"}),e.jsx("div",{className:"text-purple-500 text-sm mt-2",children:"Live video streaming coming soon"})]}),e.jsxs("div",{className:"absolute top-4 right-4 flex items-center gap-2 bg-red-500/90 backdrop-blur-xl px-4 py-2 rounded-lg",children:[e.jsx("div",{className:"w-3 h-3 bg-white rounded-full animate-pulse"}),e.jsx("span",{className:"text-white font-bold text-sm",children:"LIVE"})]})]}),e.jsx("div",{className:"flex-shrink-0 p-4 bg-purple-900/20 backdrop-blur-xl border-t border-purple-500/20",children:e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-purple-800/30 rounded-lg p-4 border border-purple-500/20",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"👥 Viewers"}),e.jsx("div",{className:"text-purple-200 text-2xl font-bold",children:be})]}),e.jsxs("div",{className:"bg-purple-800/30 rounded-lg p-4 border border-purple-500/20",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"💸 Total Tips"}),e.jsx("div",{className:"text-green-400 text-2xl font-bold",children:ie})]}),e.jsxs("div",{className:"bg-purple-800/30 rounded-lg p-4 border border-purple-500/20",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"🎁 Tip Count"}),e.jsx("div",{className:"text-purple-200 text-2xl font-bold",children:Y.length})]}),e.jsxs("div",{className:"bg-purple-800/30 rounded-lg p-4 border border-purple-500/20",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"⏱️ Duration"}),e.jsxs("div",{className:"text-purple-200 text-2xl font-bold",children:[Math.floor((new Date-new Date(te.started_at))/6e4),"m"]})]})]})})]}),e.jsxs("div",{className:"w-96 bg-purple-900/20 backdrop-blur-xl border-l border-purple-500/20 flex flex-col flex-shrink-0",children:[e.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-purple-500/20",children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200",children:"Stream Chat 💬"}),e.jsxs("p",{className:"text-purple-400 text-sm",children:[u.length," messages"]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[u.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-5xl mb-3",children:"💬"}),e.jsx("div",{className:"text-purple-400",children:"No messages yet"}),e.jsx("div",{className:"text-purple-500 text-sm mt-1",children:"Start the conversation!"})]}):u.map(O=>{const Te=O.message_type==="tip",Ue=O.message_type==="crown";return Te||Ue?e.jsx("div",{className:`px-4 py-3 rounded-lg border ${Te?"bg-gradient-to-r from-yellow-900/40 to-orange-900/40 border-yellow-500/40":"bg-gradient-to-r from-purple-900/40 to-pink-900/40 border-purple-500/40"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:Te?"💸":"👑"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap text-sm",children:[e.jsx("span",{className:"text-white font-bold",children:O.nickname}),Te&&O.tip_data&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-yellow-300",children:"sent"}),e.jsxs("span",{className:"text-green-400 font-bold",children:[O.tip_data.amount," ",O.tip_data.currency]}),e.jsx("span",{className:"text-yellow-300",children:"to"}),e.jsx("span",{className:"text-white font-bold",children:O.tip_data.to_nickname})]}),Ue&&e.jsx("span",{className:"text-purple-200",children:O.content})]}),e.jsx("div",{className:"text-purple-400 text-xs mt-0.5",children:Ut(O.created_at)})]})]})},O.id):e.jsx("div",{className:"bg-purple-800/30 rounded-lg p-3 border border-purple-500/20",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white font-bold text-sm flex-shrink-0",children:O.nickname.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-purple-200 font-bold text-sm",children:O.nickname}),O.wallet_address===Qs&&e.jsx("span",{className:"text-yellow-400 text-xs",children:"👑"})]}),e.jsx("div",{className:"text-purple-100 text-sm break-words",children:O.content||O.message}),e.jsx("div",{className:"text-purple-400 text-xs mt-1",children:Ut(O.created_at)})]})]})},O.id)}),e.jsx("div",{ref:qe})]}),e.jsxs("div",{className:"p-4 border-t border-purple-500/20 space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:g,onChange:O=>y(O.target.value),onKeyPress:O=>O.key==="Enter"&&Qe(),placeholder:"Type a message...",className:"flex-1 bg-purple-800/30 text-purple-100 px-4 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 border border-purple-500/20"}),e.jsx("button",{onClick:Qe,className:"bg-purple-600 hover:bg-purple-500 text-white px-4 py-2 rounded-lg font-bold transition-all",children:"Send"})]}),e.jsx("button",{onClick:()=>{const O={wallet_address:te.wallet_address,nickname:te.nickname};Xe(O)},className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white py-2 rounded-lg font-bold transition-all text-sm",children:"👑 Send Crown"}),e.jsx("button",{onClick:()=>{const O={wallet_address:te.wallet_address,nickname:te.nickname};St(O)},className:"w-full bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-500 hover:to-orange-500 text-white py-3 rounded-lg font-bold transition-all",children:"💸 Send Tip"})]})]})]})]}),b&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-purple-900 to-slate-900 rounded-lg p-8 max-w-md w-full border border-purple-500/30",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-6",children:"Set Your Nickname"}),e.jsx("input",{type:"text",value:f,onChange:O=>w(O.target.value),placeholder:"Enter nickname...",maxLength:20,className:"w-full bg-purple-800/30 text-purple-100 px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 border border-purple-500/30 mb-4"}),e.jsx("button",{onClick:gt,className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white py-3 rounded-lg font-bold transition-all",children:"Save Nickname"})]})}),A&&W&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-purple-900 to-slate-900 rounded-lg p-8 max-w-md w-full border border-purple-500/30",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-20 h-20 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white font-bold text-3xl mx-auto mb-4",children:W.nickname.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200",children:W.nickname}),W.wallet_address===Qs&&e.jsx("span",{className:"text-yellow-400 text-2xl",title:"Developer",children:"👑"})]}),e.jsx("p",{className:"text-purple-400 text-sm mt-1",children:W.wallet_address})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>yt(W),className:"w-full bg-purple-700/50 hover:bg-purple-700/70 text-white py-3 rounded-lg font-medium transition-all",children:"💬 Send Direct Message"}),e.jsx("button",{onClick:()=>St(W),className:"w-full bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-500 hover:to-orange-500 text-white py-3 rounded-lg font-medium transition-all",children:"💸 Send Tip"}),Tt&&W.wallet_address!==Qs&&e.jsx("button",{onClick:()=>{lt(W.wallet_address),_(!1)},className:"w-full bg-red-700/50 hover:bg-red-700/70 text-white py-3 rounded-lg font-medium transition-all",children:"🚫 Ban Wallet"}),e.jsx("button",{onClick:()=>_(!1),className:"w-full bg-slate-700/50 hover:bg-slate-700/70 text-white py-3 rounded-lg font-medium transition-all",children:"Cancel"})]})]})}),X&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-purple-900 to-slate-900 rounded-lg p-8 max-w-md w-full border border-purple-500/30",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200 mb-6",children:"Select Camera"}),e.jsx("div",{className:"space-y-2 mb-4",children:ve.map(O=>e.jsx("button",{onClick:()=>{xe(O.deviceId),_t(O.deviceId)},className:"w-full bg-purple-800/30 hover:bg-purple-800/50 text-purple-200 px-4 py-3 rounded-lg transition-all text-left",children:O.label||`Camera ${O.deviceId.slice(0,8)}`},O.deviceId))}),e.jsx("button",{onClick:()=>me(!1),className:"w-full bg-slate-700/50 hover:bg-slate-700/70 text-white py-3 rounded-lg font-medium transition-all",children:"Cancel"})]})}),e.jsx(Kh,{isOpen:ke,onClose:()=>{he(!1),$(null),te&&Cs(te.id)},recipient:Oe,connectedWallet:s,nickname:f,currentStream:te}),R&&e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-purple-900 rounded-xl max-w-2xl w-full p-6 border-2 border-purple-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-purple-200",children:"📅 Schedule Stream"}),e.jsx("button",{onClick:()=>H(!1),className:"text-purple-400 hover:text-purple-200 text-2xl",children:"×"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-purple-300 text-sm font-bold mb-2 block",children:"Stream Title *"}),e.jsx("input",{type:"text",value:z.title,onChange:O=>ae({...z,title:O.target.value}),className:"w-full bg-purple-800/30 text-purple-100 px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 border border-purple-500/20",placeholder:"e.g., Trading Strategy Session"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-purple-300 text-sm font-bold mb-2 block",children:"Description"}),e.jsx("textarea",{value:z.description,onChange:O=>ae({...z,description:O.target.value}),className:"w-full bg-purple-800/30 text-purple-100 px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 border border-purple-500/20 h-24 resize-none",placeholder:"Tell viewers what to expect..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-purple-300 text-sm font-bold mb-2 block",children:"Category *"}),e.jsxs("select",{value:z.category,onChange:O=>ae({...z,category:O.target.value}),className:"w-full bg-purple-800/30 text-purple-100 px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 border border-purple-500/20",children:[e.jsx("option",{value:"Just Chatting",children:"Just Chatting"}),e.jsx("option",{value:"Trading",children:"Trading"}),e.jsx("option",{value:"Education",children:"Education"}),e.jsx("option",{value:"Gaming",children:"Gaming"}),e.jsx("option",{value:"Music",children:"Music"}),e.jsx("option",{value:"Art",children:"Art"}),e.jsx("option",{value:"Crypto Talk",children:"Crypto Talk"}),e.jsx("option",{value:"Entertainment",children:"Entertainment"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-purple-300 text-sm font-bold mb-2 block",children:"Duration (minutes) *"}),e.jsx("input",{type:"number",value:z.duration,onChange:O=>ae({...z,duration:parseInt(O.target.value)}),className:"w-full bg-purple-800/30 text-purple-100 px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 border border-purple-500/20",min:"15",step:"15"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-purple-300 text-sm font-bold mb-2 block",children:"Date *"}),e.jsx("input",{type:"date",value:z.date,onChange:O=>ae({...z,date:O.target.value}),min:new Date().toISOString().split("T")[0],className:"w-full bg-purple-800/30 text-purple-100 px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 border border-purple-500/20"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-purple-300 text-sm font-bold mb-2 block",children:"Time *"}),e.jsx("input",{type:"time",value:z.time,onChange:O=>ae({...z,time:O.target.value}),className:"w-full bg-purple-800/30 text-purple-100 px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 border border-purple-500/20"})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>H(!1),className:"flex-1 bg-purple-800/30 hover:bg-purple-800/50 text-purple-200 py-3 rounded-lg font-bold transition-all",children:"Cancel"}),e.jsx("button",{onClick:Ve,className:"flex-1 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white py-3 rounded-lg font-bold transition-all",children:"Schedule Stream"})]})]})})]})}function Zh({data:r}){const t=m.useRef(null),s=m.useRef(null);return m.useEffect(()=>{if(!t.current||!r||r.length===0)return;const a=()=>{s.current&&s.current.applyOptions({width:t.current.clientWidth,height:t.current.clientHeight})},n=Er(t.current,{layout:{background:{type:"solid",color:"transparent"},textColor:"#9CA3AF"},grid:{vertLines:{color:"#1F2937"},horzLines:{color:"#1F2937"}},width:t.current.clientWidth,height:t.current.clientHeight,timeScale:{timeVisible:!0,secondsVisible:!1,borderColor:"#374151"},rightPriceScale:{borderColor:"#374151",scaleMargins:{top:.2,bottom:.2}},crosshair:{vertLine:{color:"#22C55E",width:1,style:3,labelBackgroundColor:"#1F2937"},horzLine:{color:"#22C55E",width:1,style:3,labelBackgroundColor:"#1F2937"}}});return n.addAreaSeries({lineColor:"#22C55E",topColor:"rgba(34, 197, 94, 0.2)",bottomColor:"rgba(34, 197, 94, 0)",lineWidth:2,priceFormat:{type:"price",precision:6,minMove:1e-6}}).setData(r),n.timeScale().fitContent(),window.addEventListener("resize",a),s.current=n,()=>{window.removeEventListener("resize",a),n.remove()}},[r]),e.jsx("div",{ref:t,className:"w-full h-full"})}function ex({tokenSlug:r}){var le,$e;const[t,s]=m.useState(null),[a,n]=m.useState(!0),[l,i]=m.useState(null),[o,c]=m.useState(null),[d,u]=m.useState(2.5),[h,g]=m.useState(null),[y,f]=m.useState(!1),[w,b]=m.useState("overview"),[P,A]=m.useState([]),[_,W]=m.useState(null),[D,I]=m.useState(!1),[E,G]=m.useState(!1);m.useEffect(()=>{_e(),ge(),Ce()},[r]),m.useEffect(()=>{t&&l&&me()},[t,l]),m.useEffect(()=>{t&&(ue(),ve(),He())},[t,l]);const _e=async()=>{try{n(!0);const Ne=localStorage.getItem("cachedTokens");if(Ne){const re=JSON.parse(Ne).find(B=>{var Y;return((Y=B.token_name)==null?void 0:Y.toLowerCase())===(r==null?void 0:r.toLowerCase())});if(re){s(re),n(!1);return}}const{data:q,error:ee}=await S.from("meme_tokens").select("*").ilike("token_name",r).single();if(ee)throw ee;q?s(q):k.error("Token not found")}catch{k.error("Failed to load token")}finally{n(!1)}},ge=()=>{const Ne=localStorage.getItem("connectedWallet");Ne&&i(JSON.parse(Ne))},Ce=async()=>{var Ne;try{const ee=await(await fetch("https://api.coingecko.com/api/v3/simple/price?ids=ripple&vs_currencies=usd")).json();u(((Ne=ee.ripple)==null?void 0:Ne.usd)||2.5)}catch{}},ue=async()=>{var Ne;if(!(!t||!t.amm_pool_created))try{const{data:q,error:ee}=await S.from("pool_data_cache").select("*").eq("token_id",t.id).order("last_updated",{ascending:!1}).limit(1).maybeSingle();if(q){const B=Date.now()-new Date(q.last_updated).getTime();if(c({xrpAmount:parseFloat(q.xrp_amount),tokenAmount:parseFloat(q.token_amount),lpTokens:parseFloat(q.lp_tokens),price:parseFloat(q.price),volume24h:parseFloat(q.volume_24h||0),fees24h:parseFloat(q.fees_24h||0),apr:parseFloat(q.apr||0),contributors:parseInt(q.contributors||0)}),l&&J(q.lp_tokens),B<12e4)return}const L=new Re.Client("wss://xrplcluster.com");await L.connect();const re=await L.request({command:"amm_info",asset:{currency:"XRP"},asset2:{currency:t.currency_hex||t.currency_code,issuer:t.issuer_address}});if((Ne=re.result)!=null&&Ne.amm){const B=re.result.amm,Y=parseFloat(B.amount)/1e6,oe=parseFloat(B.amount2.value),ie=parseFloat(B.lp_token.value),ye=Y/oe,te=t.volume_24h?parseFloat(t.volume_24h):0,U=parseFloat(B.trading_fee)/1e3||0,ke=te*(U/100),he=Y>0?ke*365/Y*100:0;c({xrpAmount:Y,tokenAmount:oe,lpTokens:ie,price:ye,volume24h:te,fees24h:ke,apr:he,contributors:0}),await S.from("pool_data_cache").upsert({token_id:t.id,xrp_amount:Y,token_amount:oe,lp_tokens:ie,price:ye,volume_24h:te,fees_24h:ke,apr:he,contributors:0,last_updated:new Date().toISOString()},{onConflict:"token_id"}),l&&J(ie)}await L.disconnect()}catch{}},J=async Ne=>{var q;if(!(!l||!t))try{const{data:ee}=await S.from("lp_balance_cache").select("*").eq("token_id",t.id).eq("user_address",l.address).order("cached_at",{ascending:!1}).limit(1).single();if(ee&&Date.now()-new Date(ee.cached_at).getTime()<6e4){g({balance:parseFloat(ee.lp_balance),share:parseFloat(ee.share_percentage)});return}const L=new Re.Client(l.network==="mainnet"?"wss://xrplcluster.com":"wss://s.altnet.rippletest.net:51233");await L.connect();const re=t.lp_token_currency||`03${(q=t.currency_hex)==null?void 0:q.slice(2,38)}`,oe=((await L.request({command:"account_lines",account:l.address,ledger_index:"validated"})).result.lines||[]).find(ie=>ie.currency===re&&ie.account===t.issuer_address);if(oe){const ie=parseFloat(oe.balance),ye=ie/Ne*100;g({balance:ie,share:ye}),await S.from("lp_balance_cache").upsert({token_id:t.id,user_address:l.address,lp_balance:ie,share_percentage:ye,cached_at:new Date().toISOString()},{onConflict:"token_id,user_address"})}await L.disconnect()}catch{}},se=()=>t?o?o.price.toFixed(8):t.amm_xrp_amount&&t.amm_token_amount?(t.amm_xrp_amount/t.amm_token_amount).toFixed(8):"0.00000000":"0.00000000",F=()=>t?(parseFloat(se())*t.supply).toFixed(2):"0",X=()=>{if(!t||!t.initial_xrp_amount||!t.initial_token_amount||!o)return"0.00";const Ne=t.initial_xrp_amount/t.initial_token_amount;return((o.price-Ne)/Ne*100).toFixed(2)},me=async()=>{if(!(!l||!t))try{const{data:Ne,error:q}=await S.from("token_holdings_cache").select("balance").eq("wallet_address",l.address).eq("token_id",t.id).order("last_updated",{ascending:!1}).limit(1).maybeSingle();if(q)throw q;Ne?W(parseFloat(Ne.balance)):ve()}catch{ve()}},ve=async()=>{if(!(!l||!t))try{const Ne=new Re.Client(l.network==="mainnet"?"wss://xrplcluster.com":"wss://s.altnet.rippletest.net:51233");await Ne.connect();const L=((await Ne.request({command:"account_lines",account:l.address,ledger_index:"validated"})).result.lines||[]).find(B=>B.account===t.issuer_address&&(B.currency===t.currency_hex||B.currency===t.currency_code)),re=L?parseFloat(L.balance):0;W(re),await S.from("token_holdings_cache").upsert({wallet_address:l.address,token_id:t.id,balance:re,price:parseFloat(se()),value:re*parseFloat(se()),last_updated:new Date().toISOString()},{onConflict:"wallet_address,token_id"}),await Ne.disconnect()}catch{W(0)}},He=()=>{if(!t)return;const Ne=parseFloat(se())||1e-8,q=Math.floor(Date.now()/1e3),ee=[];for(let L=30;L>=0;L--){const re=q-L*3600,B=(Math.random()-.5)*.2,Y=Math.max(Ne*(1+B),1e-8);ee.push({time:re,value:Y})}A(ee)},pe=()=>{const Ne=se(),q=`${window.location.origin}/token/${t.token_name}`,ee=`Check out $${t.currency_code} on #XRP Ledger!

💰 Price: ${Ne} XRP
📊 Market Cap: ${F()} XRP

#${t.currency_code} #XRPL #Crypto

${q}`,L=`https://twitter.com/intent/tweet?text=${encodeURIComponent(ee)}`;window.open(L,"_blank")},xe=()=>{const Ne=`${window.location.origin}/token/${t.token_name}`;navigator.clipboard.writeText(Ne).then(()=>{k.success("Link copied to clipboard!")}).catch(()=>{k.error("Failed to copy link")})};return a?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-purple-500 mx-auto mb-4"}),e.jsx("div",{className:"text-purple-300",children:"Loading token..."})]})}):t?e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"glass rounded-xl p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Ft,{token:t,size:"3xl"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl md:text-4xl font-bold text-purple-200 mb-2",children:t.token_name}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx("span",{className:"text-purple-400 text-lg font-mono",children:t.currency_code}),e.jsx(Ls,{type:"address",value:t.issuer_address,network:"mainnet"}),t.amm_pool_created&&e.jsx("span",{className:"bg-green-500/20 text-green-400 px-3 py-1 rounded-full text-sm font-medium",children:"AMM Pool Active"})]}),t.description&&e.jsx("p",{className:"text-purple-300 mt-3 max-w-2xl",children:t.description}),(t.twitter_handle||t.website_url)&&e.jsxs("div",{className:"flex items-center gap-3 mt-3 flex-wrap",children:[t.website_url&&e.jsxs("a",{href:t.website_url.startsWith("http")?t.website_url:`https://${t.website_url}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-purple-300 hover:text-purple-100 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})}),e.jsx("span",{className:"text-sm",children:"Website"})]}),t.twitter_handle&&e.jsxs("a",{href:`https://twitter.com/${t.twitter_handle.replace("@","")}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-purple-300 hover:text-purple-100 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),e.jsxs("span",{className:"text-sm",children:["@",t.twitter_handle.replace("@","")]})]})]})]})]}),e.jsxs("div",{className:"lg:ml-auto flex flex-col gap-3",children:[e.jsxs("div",{className:"glass rounded-lg p-4 text-center min-w-[200px]",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"Live Price"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200 font-mono",children:[se()," XRP"]}),e.jsxs("div",{className:"text-green-400 text-sm",children:["$",(parseFloat(se())*d).toFixed(6)]}),t.amm_pool_created&&e.jsxs("div",{className:`text-sm font-bold mt-2 ${parseFloat(X())>=0?"text-green-400":"text-red-400"}`,children:[parseFloat(X())>=0?"+":"",X(),"% 24h"]})]}),l&&e.jsxs("div",{className:"glass rounded-lg p-4 text-center min-w-[200px] bg-purple-500/10 border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"Your Holdings"}),e.jsx("div",{className:"text-lg sm:text-xl font-bold text-purple-200 truncate",children:_!==null?_.toFixed(4):"0.0000"}),e.jsx("div",{className:"text-purple-400 text-xs truncate",children:t.currency_code}),e.jsxs("div",{className:"text-green-400 text-sm mt-1 truncate",children:[((_||0)*parseFloat(se())).toFixed(4)," XRP"]}),e.jsxs("div",{className:"text-green-400 text-xs truncate",children:["$",((_||0)*parseFloat(se())*d).toFixed(2)]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("button",{onClick:()=>I(!0),className:"flex-1 bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white text-xs font-bold py-2 px-3 rounded-lg transition-all",children:"Send"}),e.jsx("button",{onClick:()=>G(!0),className:"flex-1 bg-gradient-to-r from-teal-500 to-cyan-500 hover:from-teal-600 hover:to-cyan-600 text-white text-xs font-bold py-2 px-3 rounded-lg transition-all",children:"Receive"})]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Market Cap"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[F()," XRP"]}),e.jsxs("div",{className:"text-green-400 text-sm",children:["$",(parseFloat(F())*d).toFixed(2)]})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Total Supply"}),e.jsx("div",{className:"text-2xl font-bold text-purple-200",children:t.supply.toLocaleString()}),e.jsx("div",{className:"text-purple-400 text-sm",children:t.currency_code})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"24h Volume"}),e.jsx("div",{className:"text-2xl font-bold text-purple-200",children:o?`${o.volume24h.toFixed(2)} XRP`:"0 XRP"}),e.jsxs("div",{className:"text-green-400 text-sm",children:["$",o?((o.volume24h||0)*d).toFixed(2):"0.00"]})]})]}),o&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 mb-6",children:[e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"XRP Liquidity"}),e.jsxs("div",{className:"text-xl font-bold text-purple-200",children:[o.xrpAmount.toFixed(2)," XRP"]}),e.jsxs("div",{className:"text-green-400 text-sm",children:["$",(o.xrpAmount*d).toFixed(2)]})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"Token Liquidity"}),e.jsx("div",{className:"text-xl font-bold text-purple-200",children:o.tokenAmount.toFixed(2)}),e.jsx("div",{className:"text-purple-400 text-sm",children:t.currency_code})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"LP Tokens"}),e.jsxs("div",{className:"text-xl font-bold text-purple-200",children:[(o.lpTokens/1e3).toFixed(2),"K"]})]}),e.jsxs("div",{className:"glass rounded-lg p-6",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"APR (1 year)"}),e.jsxs("div",{className:"text-xl font-bold text-green-400",children:[o.apr.toFixed(2),"%"]})]})]}),h&&o&&e.jsx("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-6 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-green-300 text-lg font-medium mb-2",children:"Your LP Position"}),e.jsxs("div",{className:"text-green-200",children:[h.balance.toFixed(4)," LP Tokens (",h.share.toFixed(4),"% of pool)"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-green-200 font-bold text-xl",children:["~",(o.xrpAmount*h.share/100).toFixed(4)," XRP"]}),e.jsxs("div",{className:"text-green-400",children:["$",(o.xrpAmount*h.share/100*d).toFixed(2)]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:flex gap-2 mb-6 justify-center items-stretch",children:[e.jsx(Xa,{token:t,connectedWallet:l,tokenBalance:0,onTrustlineUpdate:()=>{},size:"lg",showDropdown:!0}),e.jsxs("div",{className:"relative swap-dropdown",children:[e.jsxs("button",{onClick:()=>f(!y),className:"w-full bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white font-bold px-6 py-3 rounded-lg shadow-lg transition-all duration-300 flex items-center justify-center gap-2 text-base whitespace-nowrap",children:[e.jsx("span",{children:"💱 Swap"}),e.jsx("svg",{className:`w-4 h-4 transition-transform ${y?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),y&&e.jsx("div",{className:"absolute top-full left-0 mt-2 w-64 glass bg-gradient-to-br from-purple-900/95 to-purple-800/95 border border-purple-500/30 rounded-lg shadow-xl z-50",children:e.jsx("button",{onClick:()=>{localStorage.setItem("selectedTradeToken",JSON.stringify(t)),window.dispatchEvent(new CustomEvent("navigateToTrade",{detail:t}))},className:"w-full px-4 py-3 text-left hover:bg-purple-600/30 transition-colors flex items-center gap-3",children:e.jsx("div",{className:"text-purple-100 font-medium",children:"Trade on MEMEKINGS"})})})]}),e.jsx("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"dashboard"})),className:"w-full bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white font-bold px-6 py-3 rounded-lg shadow-lg transition-all duration-300 text-base whitespace-nowrap",children:"← Back"}),e.jsxs("button",{onClick:xe,className:"w-full col-span-2 sm:col-span-1 bg-gradient-to-r from-cyan-600 to-cyan-700 hover:from-cyan-700 hover:to-cyan-800 text-white font-bold px-6 py-3 rounded-lg shadow-lg transition-all duration-300 flex items-center justify-center gap-2 text-base whitespace-nowrap",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"Share Link"]}),e.jsxs("button",{onClick:pe,className:"w-full col-span-2 sm:col-span-1 bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white font-bold px-6 py-3 rounded-lg shadow-lg transition-all duration-300 flex items-center justify-center gap-2 text-base whitespace-nowrap",children:[e.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),"Share on X"]}),t.twitter_handle?e.jsxs("a",{href:`https://twitter.com/${t.twitter_handle.replace("@","")}`,target:"_blank",rel:"noopener noreferrer",className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold px-6 py-3 rounded-lg shadow-lg transition-all duration-300 flex items-center justify-center gap-2 text-base whitespace-nowrap",children:[e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),"Twitter"]}):e.jsxs("button",{disabled:!0,className:"w-full bg-gray-600 text-gray-400 font-bold px-6 py-3 rounded-lg shadow-lg cursor-not-allowed opacity-50 flex items-center justify-center gap-2 text-base whitespace-nowrap",children:[e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),"Twitter"]}),t.website_url?e.jsxs("a",{href:t.website_url.startsWith("http")?t.website_url:`https://${t.website_url}`,target:"_blank",rel:"noopener noreferrer",className:"w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold px-6 py-3 rounded-lg shadow-lg transition-all duration-300 flex items-center justify-center gap-2 text-base whitespace-nowrap",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})}),"Website"]}):e.jsxs("button",{disabled:!0,className:"w-full bg-gray-600 text-gray-400 font-bold px-6 py-3 rounded-lg shadow-lg cursor-not-allowed opacity-50 flex items-center justify-center gap-2 text-base whitespace-nowrap",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})}),"Website"]})]}),e.jsxs("div",{className:"glass rounded-xl overflow-hidden mb-6",children:[e.jsxs("div",{className:"flex border-b border-purple-500/30 overflow-x-auto",children:[e.jsx("button",{onClick:()=>b("overview"),className:`px-6 py-4 font-medium transition-colors whitespace-nowrap ${w==="overview"?"text-purple-200 border-b-2 border-purple-500 bg-purple-500/10":"text-purple-400 hover:text-purple-200"}`,children:"Overview"}),e.jsx("button",{onClick:()=>b("chart"),className:`px-6 py-4 font-medium transition-colors whitespace-nowrap ${w==="chart"?"text-purple-200 border-b-2 border-purple-500 bg-purple-500/10":"text-purple-400 hover:text-purple-200"}`,children:"Chart"}),e.jsx("button",{onClick:()=>b("analytics"),className:`px-6 py-4 font-medium transition-colors whitespace-nowrap ${w==="analytics"?"text-purple-200 border-b-2 border-purple-500 bg-purple-500/10":"text-purple-400 hover:text-purple-200"}`,children:"Analytics"}),e.jsx("button",{onClick:()=>b("trades"),className:`px-6 py-4 font-medium transition-colors whitespace-nowrap ${w==="trades"?"text-purple-200 border-b-2 border-purple-500 bg-purple-500/10":"text-purple-400 hover:text-purple-200"}`,children:"Trade History"})]}),e.jsxs("div",{className:"p-6",children:[w==="overview"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"Issuer Address"}),e.jsx("div",{className:"font-mono text-sm text-purple-200 break-all",children:t.issuer_address})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"Currency Code"}),e.jsx("div",{className:"font-mono text-sm text-purple-200",children:t.currency_code})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"Currency Hex"}),e.jsx("div",{className:"font-mono text-sm text-purple-200 break-all",children:t.currency_hex||"N/A"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-purple-400 text-sm mb-1",children:"Created"}),e.jsx("div",{className:"text-sm text-purple-200",children:new Date(t.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]})}),w==="chart"&&t.amm_pool_created&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"glass rounded-lg p-3 border border-green-500/30",children:[e.jsx("div",{className:"text-green-400 text-xs mb-1",children:"Current Price"}),e.jsxs("div",{className:"text-xl font-bold text-green-200",children:[se()," XRP"]}),e.jsxs("div",{className:"text-green-400 text-xs",children:["$",(parseFloat(se())*d).toFixed(6)]})]}),e.jsxs("div",{className:"glass rounded-lg p-3 border border-blue-500/30",children:[e.jsx("div",{className:"text-blue-400 text-xs mb-1",children:"24h Change"}),e.jsxs("div",{className:`text-xl font-bold ${parseFloat(X())>=0?"text-green-200":"text-red-200"}`,children:[parseFloat(X())>=0?"+":"",X(),"%"]}),e.jsx("div",{className:"text-blue-400 text-xs",children:"Price movement"})]}),e.jsxs("div",{className:"glass rounded-lg p-3 border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-400 text-xs mb-1",children:"XRP Liquidity"}),e.jsx("div",{className:"text-xl font-bold text-purple-200",children:((le=o==null?void 0:o.xrpAmount)==null?void 0:le.toFixed(2))||"0.00"}),e.jsx("div",{className:"text-purple-400 text-xs",children:"In AMM pool"})]}),e.jsxs("div",{className:"glass rounded-lg p-3 border border-cyan-500/30",children:[e.jsx("div",{className:"text-cyan-400 text-xs mb-1",children:"Token Liquidity"}),e.jsx("div",{className:"text-xl font-bold text-cyan-200",children:(($e=o==null?void 0:o.tokenAmount)==null?void 0:$e.toLocaleString())||"0"}),e.jsx("div",{className:"text-cyan-400 text-xs",children:t.currency_code})]})]}),e.jsx("div",{className:"h-[600px] glass rounded-lg p-4",children:e.jsx(Zh,{data:P})})]}),w==="chart"&&!t.amm_pool_created&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"📊"}),e.jsx("div",{className:"text-purple-300",children:"Chart will be available once AMM pool is created"}),e.jsx("div",{className:"text-purple-400 text-sm mt-2",children:"Historical price data requires an active trading pool"})]}),w==="analytics"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-purple-900/30 rounded-lg p-4 border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"💰 Market Cap"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[F()," XRP"]}),e.jsxs("div",{className:"text-green-400 text-sm",children:["$",(parseFloat(F())*d).toFixed(2)]})]}),e.jsxs("div",{className:"bg-purple-900/30 rounded-lg p-4 border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"📊 Total Supply"}),e.jsx("div",{className:"text-2xl font-bold text-purple-200",children:t.supply.toLocaleString()}),e.jsx("div",{className:"text-purple-400 text-sm",children:t.currency_code})]}),e.jsxs("div",{className:"bg-purple-900/30 rounded-lg p-4 border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"💹 Current Price"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[se()," XRP"]}),e.jsxs("div",{className:"text-green-400 text-sm",children:["$",(parseFloat(se())*d).toFixed(6)]})]}),o&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-purple-900/30 rounded-lg p-4 border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"💧 Total Liquidity"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[o.xrpAmount.toFixed(2)," XRP"]}),e.jsxs("div",{className:"text-green-400 text-sm",children:["$",(o.xrpAmount*d).toFixed(2)]})]}),e.jsxs("div",{className:"bg-purple-900/30 rounded-lg p-4 border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"📈 24h Volume"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[o.volume24h.toFixed(2)," XRP"]}),e.jsxs("div",{className:"text-green-400 text-sm",children:["$",(o.volume24h*d).toFixed(2)]})]}),e.jsxs("div",{className:"bg-purple-900/30 rounded-lg p-4 border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"💎 APR (Annual)"}),e.jsxs("div",{className:"text-2xl font-bold text-green-400",children:[o.apr.toFixed(2),"%"]}),e.jsx("div",{className:"text-purple-400 text-sm",children:"Estimated returns"})]}),e.jsxs("div",{className:"bg-purple-900/30 rounded-lg p-4 border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"🔄 24h Change"}),e.jsxs("div",{className:`text-2xl font-bold ${parseFloat(X())>=0?"text-green-400":"text-red-400"}`,children:[parseFloat(X())>=0?"+":"",X(),"%"]}),e.jsx("div",{className:"text-purple-400 text-sm",children:"Price movement"})]}),e.jsxs("div",{className:"bg-purple-900/30 rounded-lg p-4 border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"💵 24h Fees"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[o.fees24h.toFixed(4)," XRP"]}),e.jsxs("div",{className:"text-green-400 text-sm",children:["$",(o.fees24h*d).toFixed(2)]})]}),e.jsxs("div",{className:"bg-purple-900/30 rounded-lg p-4 border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"🎯 LP Tokens"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[(o.lpTokens/1e3).toFixed(2),"K"]}),e.jsx("div",{className:"text-purple-400 text-sm",children:"Outstanding"})]})]}),e.jsxs("div",{className:"bg-purple-900/30 rounded-lg p-4 border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"📅 Token Age"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-200",children:[Math.floor((Date.now()-new Date(t.created_at).getTime())/(1e3*60*60*24))," days"]}),e.jsx("div",{className:"text-purple-400 text-sm",children:"Since creation"})]}),e.jsxs("div",{className:"bg-purple-900/30 rounded-lg p-4 border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"🏷️ Category"}),e.jsx("div",{className:"text-2xl font-bold text-purple-200",children:t.category||"Meme"}),e.jsx("div",{className:"text-purple-400 text-sm",children:"Token type"})]}),e.jsxs("div",{className:"bg-purple-900/30 rounded-lg p-4 border border-purple-500/30",children:[e.jsx("div",{className:"text-purple-400 text-sm mb-2",children:"✅ Pool Status"}),e.jsx("div",{className:"text-2xl font-bold text-purple-200",children:t.amm_pool_created?"🟢 Active":"🔴 Inactive"}),e.jsx("div",{className:"text-purple-400 text-sm",children:"AMM Pool"})]})]}),h&&o&&e.jsxs("div",{className:"bg-gradient-to-r from-green-900/30 to-emerald-900/30 border border-green-500/30 rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-green-300 mb-4",children:"Your Position Analytics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-green-400 text-sm mb-1",children:"LP Tokens Owned"}),e.jsx("div",{className:"text-2xl font-bold text-green-200",children:h.balance.toFixed(4)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-green-400 text-sm mb-1",children:"Pool Share"}),e.jsxs("div",{className:"text-2xl font-bold text-green-200",children:[h.share.toFixed(4),"%"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-green-400 text-sm mb-1",children:"XRP Value"}),e.jsx("div",{className:"text-2xl font-bold text-green-200",children:(o.xrpAmount*h.share/100).toFixed(4)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-green-400 text-sm mb-1",children:"USD Value"}),e.jsxs("div",{className:"text-2xl font-bold text-green-200",children:["$",(o.xrpAmount*h.share/100*d).toFixed(2)]})]})]})]})]}),w==="trades"&&e.jsx("div",{children:l?e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-purple-200 mb-4",children:"My Trades"}),e.jsx(Po,{tokenId:t.id,connectedWallet:l})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🔒"}),e.jsx("div",{className:"text-purple-300 mb-2",children:"Connect wallet to view your trades"}),e.jsx("div",{className:"text-purple-400 text-sm",children:"Your personal trade history will appear here"})]})})]})]}),D&&l&&e.jsx(ml,{token:t,balance:_||0,wallet:l,onClose:()=>I(!1),onSuccess:()=>{I(!1),ve()}}),E&&l&&e.jsx(hl,{token:t,wallet:l,onClose:()=>G(!1)})]}):e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"glass rounded-lg p-8 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🔍"}),e.jsx("h1",{className:"text-2xl font-bold text-purple-200 mb-2",children:"Token Not Found"}),e.jsx("p",{className:"text-purple-400 mb-6",children:"The token you're looking for doesn't exist."}),e.jsx("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigateToPage",{detail:"dashboard"})),className:"btn-primary px-6 py-3 rounded-lg",children:"Back to Dashboard"})]})})}let Yr=null,Ea=!1;const tx=r=>{if(Yr)return;Yr=setInterval(async()=>{if(!Ea){Ea=!0;try{await bi(r)}catch{}finally{Ea=!1}}},5e3);const t=S.channel("global_bot_executor").on("postgres_changes",{event:"*",schema:"public",table:"trading_bots",filter:`wallet_address=eq.${r}`},s=>{(s.eventType==="UPDATE"||s.eventType==="INSERT")&&s.new.status==="running"&&setTimeout(()=>bi(r),1e3)}).subscribe();window.__botExecutorSubscription=t},gi=()=>{Yr&&(clearInterval(Yr),Yr=null),window.__botExecutorSubscription&&(window.__botExecutorSubscription.unsubscribe(),window.__botExecutorSubscription=null),Ea=!1},bi=async r=>{try{const{data:t,error:s}=await S.from("trading_bots").select("*").eq("wallet_address",r).eq("status","running");if(s)throw s;if(!t||t.length===0)return;const a=new Date;for(const n of t){if(!n.next_trade_time){const i=new Date(Date.now()+n.interval*60*1e3);await S.from("trading_bots").update({next_trade_time:i.toISOString()}).eq("id",n.id);continue}const l=new Date(n.next_trade_time);a>=l&&await sx(n)}}catch{}},sx=async r=>{try{await S.from("trading_bots").update({last_execution_attempt:new Date().toISOString()}).eq("id",r.id);const{data:t}=await S.from("wallets").select("*").eq("address",r.wallet_address).maybeSingle();if(!t||!t.seed)return;const{data:s}=await S.from("meme_tokens").select("*").eq("id",r.token_id).maybeSingle();if(!s)return;const{data:a}=await S.from("pool_data_cache").select("*").eq("token_id",s.id).order("last_updated",{ascending:!1}).limit(1).maybeSingle();if(!a)return;const n=Math.random()*100<r.trade_mode,l=r.min_amount+Math.random()*(r.max_amount-r.min_amount),i=new Re.Client(t.network==="mainnet"?"wss://xrplcluster.com":"wss://s.altnet.rippletest.net:51233");await i.connect();const o=Re.Wallet.fromSeed(t.seed),c=s.currency_code.length>3?vt.Buffer.from(s.currency_code,"utf8").toString("hex").toUpperCase().padEnd(40,"0"):s.currency_code,d=n?{TransactionType:"Payment",Account:t.address,Destination:t.address,Amount:{currency:c,value:l.toFixed(6),issuer:s.issuer_address},SendMax:Re.xrpToDrops((l*parseFloat(a.price)*(1+r.slippage/100)).toFixed(6)),Paths:[[{account:s.issuer_address,type:1}]]}:{TransactionType:"Payment",Account:t.address,Destination:t.address,Amount:Re.xrpToDrops((l*parseFloat(a.price)*(1-r.slippage/100)).toFixed(6)),SendMax:{currency:c,value:l.toFixed(6),issuer:s.issuer_address},Paths:[[{account:s.issuer_address,type:1}]]},u=await i.autofill(d),h=o.sign(u),g=await i.submitAndWait(h.tx_blob);await i.disconnect();const y=g.result.meta.TransactionResult==="tesSUCCESS",f=n?parseFloat(g.result.DeliveredAmount||0)/1e6:l*parseFloat(a.price),w=n?l:0;await S.from("bot_trades").insert({bot_id:r.id,wallet_address:r.wallet_address,token_id:r.token_id,trade_type:n?"buy":"sell",xrp_amount:f,token_amount:w,price:parseFloat(a.price),success:y,tx_hash:g.result.hash});const b={total_trades:(r.total_trades||0)+1,successful_trades:(r.successful_trades||0)+(y?1:0),last_trade_time:new Date().toISOString(),next_trade_time:new Date(Date.now()+r.interval*60*1e3).toISOString()};n&&y?(b.total_xrp_spent=(parseFloat(r.total_xrp_spent||0)+f).toString(),b.total_token_received=(parseFloat(r.total_token_received||0)+w).toString(),b.token_balance=(parseFloat(r.token_balance||0)+w).toString()):!n&&y&&(b.total_xrp_received=(parseFloat(r.total_xrp_received||0)+f).toString(),b.total_token_spent=(parseFloat(r.total_token_spent||0)+w).toString(),b.token_balance=(parseFloat(r.token_balance||0)-w).toString());const P=parseFloat(b.total_xrp_received||r.total_xrp_received||0)-parseFloat(b.total_xrp_spent||r.total_xrp_spent||0);b.net_profit=P.toFixed(6),await S.from("trading_bots").update(b).eq("id",r.id)}catch(t){await S.from("trading_bots").update({last_error:t.message,last_error_time:new Date().toISOString(),next_trade_time:new Date(Date.now()+r.interval*60*1e3).toISOString()}).eq("id",r.id)}};class rx extends m.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,s){}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900",children:e.jsxs("div",{className:"glass rounded-lg p-8 max-w-md text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"⚠️"}),e.jsx("h1",{className:"text-2xl font-bold text-purple-200 mb-4",children:"Something went wrong"}),e.jsx("p",{className:"text-purple-400 mb-6",children:"The app encountered an error. Please refresh the page."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"btn-primary px-6 py-3 rounded-lg",children:"Refresh Page"})]})}):this.props.children}}function ax(){const[r,t]=m.useState("dashboard"),[s,a]=m.useState(null),[n,l]=m.useState(0),[i,o]=m.useState(null);m.useEffect(()=>{const u=window.location.pathname;if(u.startsWith("/token/")){const g=u.replace("/token/","");o(g),t("tokenprofile")}const h=()=>{const g=window.location.pathname;if(g.startsWith("/token/")){const y=g.replace("/token/","");o(y),t("tokenprofile")}else t("dashboard"),o(null)};return window.addEventListener("popstate",h),()=>{window.removeEventListener("popstate",h)}},[]),m.useEffect(()=>{const u=b=>{b.preventDefault()},h=b=>{b.preventDefault()};window.addEventListener("error",u),window.addEventListener("unhandledrejection",h);const g=setInterval(()=>{Gn.cleanOldEntries()},60*60*1e3),y=()=>{const b=localStorage.getItem("connectedWallet");if(b)try{const P=JSON.parse(b);P.address&&tx(P.address)}catch{}};y();const f=()=>{setTimeout(y,1e3)},w=()=>{gi()};return window.addEventListener("walletConnected",f),window.addEventListener("walletDisconnected",w),()=>{window.removeEventListener("error",u),window.removeEventListener("unhandledrejection",h),window.removeEventListener("walletConnected",f),window.removeEventListener("walletDisconnected",w),clearInterval(g),gi()}},[]),m.useEffect(()=>{const u=y=>{c("trade"),y.detail&&a(y.detail)},h=y=>{c(y.detail),y.detail!=="trade"&&a(null)},g=y=>{o(y.detail),c("tokenprofile"),window.history.pushState({},"",`/token/${y.detail}`)};return window.addEventListener("navigateToTrade",u),window.addEventListener("navigateToPage",h),window.addEventListener("navigateToToken",g),()=>{window.removeEventListener("navigateToTrade",u),window.removeEventListener("navigateToPage",h),window.removeEventListener("navigateToToken",g)}},[]);const c=u=>{t(u),l(h=>h+1),u!=="tokenprofile"&&window.history.pushState({},"","/")},d=()=>{switch(r){case"dashboard":return e.jsx(ii,{},n);case"memes":return e.jsx(Q0,{},n);case"pools":return e.jsx(eh,{},n);case"trade":return e.jsx(fh,{preselectedToken:s},n);case"bottrader":return e.jsx(vh,{},n);case"vault":return e.jsx(Nh,{},n);case"mytokens":return e.jsx(kh,{},n);case"xrprewards":return e.jsx(Th,{},n);case"airdropper":return e.jsx(Rh,{},n);case"analytics":return e.jsx(Fh,{},n);case"top10":return e.jsx(Lh,{},n);case"kingslist":return e.jsx(Dh,{},n);case"about":return e.jsx(Mh,{},n);case"wallets":return e.jsx(Xh,{},n);case"setup":return e.jsx(Uh,{},n);case"aichat":return e.jsx(zh,{},n);case"social":return e.jsx(Qh,{},n);case"tokenprofile":return e.jsx(ex,{tokenSlug:i},n);default:return e.jsx(ii,{},n)}};return e.jsx(rx,{children:e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ki,{position:"top-right",toastOptions:{style:{background:"rgba(88, 28, 135, 0.9)",color:"#e9d5ff",border:"1px solid rgba(139, 92, 246, 0.3)",backdropFilter:"blur(10px)"},success:{iconTheme:{primary:"#a78bfa",secondary:"#581c87"}},error:{iconTheme:{primary:"#f87171",secondary:"#581c87"}}}}),e.jsx(Nu,{currentPage:r,onNavigate:c}),e.jsx("div",{className:"lg:ml-64 pt-20 lg:pt-6 p-3 sm:p-4 md:p-6 lg:p-8",children:e.jsx("div",{className:"w-full mx-auto",children:d()})})]})})}window.Buffer=vt.Buffer;Sn.createRoot(document.getElementById("root")).render(e.jsxs(Ur.StrictMode,{children:[e.jsx(ax,{}),e.jsx(ki,{position:"bottom-right",toastOptions:{duration:5e3,style:{background:"#1e1b4b",color:"#e9d5ff",border:"1px solid #7c3aed"},success:{iconTheme:{primary:"#10b981",secondary:"#fff"}},error:{duration:8e3,iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]}));
